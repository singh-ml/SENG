Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-4', '--weight-decay', '2e-4', '--beta1', '0.99', '--beta2', '0.999', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1303     95.940  0.3253    89.372  7.59
   2   0.1056     96.320  0.1018    96.715  13.68
   3   0.0566     98.080  0.0794    97.540  19.86
   4   0.0897     97.200  0.0693    97.828  26.00
   5   0.0824     97.370  0.0645    98.070  32.09
   6   0.0605     97.870  0.0623    98.047  38.18
   7   0.0549     98.280  0.0579    98.190  44.29
   8   0.0598     97.900  0.0581    98.115  50.39
   9   0.0541     98.230  0.0570    98.197  56.63
  10   0.0460     98.580  0.0530    98.365  62.78
  11   0.0458     98.580  0.0521    98.450  68.94
  12   0.0549     98.200  0.0553    98.315  75.05
  13   0.0383     98.850  0.0467    98.562  81.15
  14   0.0663     97.800  0.0473    98.522  87.32
  15   0.0388     98.730  0.0500    98.460  93.42
  16   0.0505     98.300  0.0466    98.585  99.53
  17   0.0435     98.700  0.0449    98.597  105.64
  18   0.0385     98.770  0.0407    98.728  111.72
  19   0.0462     98.540  0.0417    98.727  117.85
  20   0.0446     98.540  0.0436    98.637  124.05
  21   0.0442     98.650  0.0440    98.677  130.15
  22   0.0331     98.990  0.0394    98.775  136.25
  23   0.0376     98.880  0.0395    98.783  142.36
  24   0.0278     99.090  0.0371    98.872  148.47
  25   0.0590     98.220  0.0396    98.785  154.66
  26   0.0383     98.770  0.0402    98.787  160.74
  27   0.0427     98.500  0.0384    98.817  166.87
  28   0.0384     98.730  0.0368    98.855  172.98
  29   0.0350     98.940  0.0375    98.875  179.09
  30   0.0406     98.690  0.0365    98.867  185.16
  31   0.0311     98.940  0.0352    98.923  191.35
  32   0.0291     99.140  0.0355    98.920  197.46
  33   0.0431     98.680  0.0342    98.905  203.57
  34   0.0326     98.950  0.0352    98.897  209.66
  35   0.0278     99.190  0.0344    98.918  215.76
  36   0.0379     98.790  0.0319    99.010  221.99
  37   0.0288     98.970  0.0310    99.030  228.12
  38   0.0385     98.750  0.0326    98.988  234.21
  39   0.0375     98.830  0.0327    99.003  240.32
  40   0.0383     98.840  0.0325    98.990  246.39
  41   0.0352     98.850  0.0315    99.032  252.50
  42   0.0376     98.650  0.0273    99.127  258.70
  43   0.0399     98.620  0.0286    99.090  264.82
  44   0.0397     98.670  0.0303    99.047  270.91
  45   0.0341     98.870  0.0284    99.115  277.02
  46   0.0299     99.060  0.0268    99.153  283.12
  47   0.0397     98.900  0.0297    99.065  289.25
  48   0.0329     98.990  0.0298    99.043  295.45
  49   0.0334     98.960  0.0274    99.137  301.55
  50   0.0312     99.030  0.0259    99.203  307.64
  51   0.0360     98.830  0.0265    99.152  313.74
  52   0.0464     98.440  0.0278    99.132  319.90
  53   0.0333     98.970  0.0279    99.133  326.02
  54   0.0279     99.190  0.0257    99.218  332.25
  55   0.0309     98.980  0.0243    99.235  338.40
  56   0.0352     98.930  0.0266    99.198  344.53
  57   0.0403     98.630  0.0248    99.233  350.61
  58   0.0358     98.860  0.0255    99.190  356.73
  59   0.0274     99.130  0.0245    99.238  362.83
  60   0.0323     98.940  0.0240    99.237  369.01
  61   0.0284     99.160  0.0230    99.303  375.12
  62   0.0302     99.030  0.0253    99.208  381.19
  63   0.0282     99.140  0.0231    99.305  387.31
  64   0.0319     98.940  0.0235    99.258  393.43
  65   0.0433     98.560  0.0237    99.247  399.53
  66   0.0447     98.620  0.0231    99.258  405.76
  67   0.0270     99.070  0.0245    99.215  411.87
  68   0.0384     98.820  0.0251    99.275  417.98
  69   0.0370     98.820  0.0228    99.313  424.08
  70   0.0276     99.190  0.0227    99.260  430.18
  71   0.0350     98.920  0.0221    99.298  436.28
  72   0.0322     98.910  0.0225    99.288  442.47
  73   0.0293     99.050  0.0230    99.273  448.58
  74   0.0329     98.960  0.0238    99.273  454.67
  75   0.0291     99.080  0.0220    99.323  460.76
  76   0.0256     99.130  0.0228    99.243  466.87
  77   0.0305     99.020  0.0227    99.267  472.97
  78   0.0282     99.040  0.0228    99.300  479.17
  79   0.0235     99.250  0.0214    99.328  485.26
  80   0.0399     98.800  0.0207    99.340  491.40
  81   0.0404     98.680  0.0213    99.332  497.52
  82   0.0266     99.110  0.0205    99.342  503.64
  83   0.0353     98.850  0.0221    99.288  509.80
  84   0.0310     98.900  0.0230    99.268  515.89
  85   0.0252     99.190  0.0218    99.342  521.99
  86   0.0396     98.630  0.0203    99.387  528.11
  87   0.0306     99.080  0.0229    99.287  534.22
  88   0.0362     98.850  0.0202    99.357  540.32
  89   0.0302     99.070  0.0202    99.367  546.56
  90   0.0428     98.680  0.0211    99.302  552.66
