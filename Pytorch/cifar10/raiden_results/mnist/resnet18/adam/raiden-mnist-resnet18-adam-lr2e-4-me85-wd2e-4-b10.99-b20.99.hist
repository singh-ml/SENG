Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '2e-4', '--weight-decay', '2e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2316     91.970  0.4425    85.523  7.57
   2   0.1019     96.610  0.1164    96.262  13.67
   3   0.0589     98.100  0.0788    97.587  19.73
   4   0.0781     97.440  0.0648    97.912  25.78
   5   0.0517     98.190  0.0612    98.080  31.84
   6   0.0560     98.130  0.0564    98.225  38.03
   7   0.0443     98.690  0.0526    98.358  44.13
   8   0.0513     98.350  0.0488    98.442  50.21
   9   0.0364     98.830  0.0459    98.567  56.29
  10   0.0506     98.410  0.0447    98.597  62.35
  11   0.0336     98.910  0.0416    98.695  68.51
  12   0.0493     98.440  0.0413    98.690  74.59
  13   0.0444     98.610  0.0407    98.725  80.68
  14   0.0317     98.930  0.0372    98.842  86.73
  15   0.0455     98.460  0.0347    98.902  92.81
  16   0.0505     98.390  0.0379    98.792  98.89
  17   0.0421     98.670  0.0351    98.892  105.02
  18   0.0374     98.890  0.0343    98.920  111.12
  19   0.0419     98.570  0.0324    99.010  117.20
  20   0.0345     98.900  0.0318    98.982  123.29
  21   0.0403     98.770  0.0326    98.977  129.36
  22   0.0359     98.830  0.0342    98.893  135.55
  23   0.0331     98.960  0.0311    99.060  141.64
  24   0.0370     98.860  0.0303    99.050  147.71
  25   0.0313     98.950  0.0303    99.063  153.79
  26   0.0388     98.720  0.0295    99.112  159.86
  27   0.0320     98.970  0.0307    99.028  165.97
  28   0.0437     98.610  0.0302    99.060  172.14
  29   0.0332     98.960  0.0271    99.165  178.21
  30   0.0393     98.780  0.0268    99.187  184.29
  31   0.0269     99.160  0.0280    99.162  190.35
  32   0.0321     99.070  0.0276    99.135  196.39
  33   0.0343     98.950  0.0271    99.160  202.60
  34   0.0309     98.980  0.0272    99.158  208.67
  35   0.0414     98.730  0.0265    99.198  214.72
  36   0.0269     99.120  0.0272    99.160  220.81
  37   0.0419     98.690  0.0258    99.195  226.88
  38   0.0335     98.980  0.0258    99.212  232.96
  39   0.0447     98.600  0.0266    99.152  239.14
  40   0.0312     99.010  0.0240    99.233  245.19
  41   0.0336     98.940  0.0234    99.258  251.27
  42   0.0302     99.120  0.0226    99.305  257.35
  43   0.0352     98.880  0.0259    99.127  263.40
  44   0.0290     99.030  0.0244    99.257  269.48
  45   0.0323     98.970  0.0236    99.237  275.66
  46   0.0328     98.900  0.0232    99.288  281.75
  47   0.0282     99.100  0.0224    99.288  287.83
  48   0.0264     99.170  0.0241    99.242  293.91
  49   0.0302     98.950  0.0245    99.202  300.00
  50   0.0306     99.040  0.0229    99.278  306.08
  51   0.0354     98.790  0.0225    99.298  312.30
  52   0.0342     98.960  0.0238    99.238  318.38
  53   0.0311     99.090  0.0214    99.340  324.45
  54   0.0270     99.150  0.0189    99.397  330.54
  55   0.0348     98.910  0.0219    99.285  336.63
  56   0.0299     99.110  0.0210    99.325  342.76
  57   0.0304     99.070  0.0216    99.343  348.94
  58   0.0286     99.020  0.0210    99.363  355.02
  59   0.0350     98.940  0.0211    99.327  361.12
  60   0.0268     99.240  0.0189    99.395  367.18
  61   0.0301     99.120  0.0190    99.408  373.30
  62   0.0322     99.030  0.0186    99.438  379.45
  63   0.0415     98.750  0.0203    99.370  385.52
  64   0.0389     98.730  0.0201    99.378  391.60
  65   0.0232     99.260  0.0206    99.345  397.67
  66   0.0362     98.840  0.0191    99.417  403.74
  67   0.0234     99.250  0.0189    99.407  409.80
  68   0.0336     98.980  0.0190    99.403  415.96
  69   0.0270     99.130  0.0190    99.393  422.05
  70   0.0315     99.070  0.0180    99.437  428.15
  71   0.0354     98.890  0.0173    99.445  434.26
  72   0.0272     99.180  0.0167    99.478  440.32
  73   0.0344     98.910  0.0186    99.398  446.47
  74   0.0264     99.200  0.0163    99.512  452.54
  75   0.0269     99.130  0.0178    99.453  458.59
  76   0.0383     98.800  0.0197    99.375  464.66
  77   0.0355     99.040  0.0187    99.392  470.73
  78   0.0389     98.860  0.0169    99.443  476.80
  79   0.0364     98.900  0.0165    99.512  482.98
  80   0.0308     99.070  0.0176    99.423  489.02
  81   0.0379     98.910  0.0181    99.428  495.08
  82   0.0259     99.190  0.0185    99.425  501.16
  83   0.0308     99.140  0.0175    99.442  507.22
  84   0.0350     98.930  0.0162    99.490  513.36
  85   0.0248     99.180  0.0157    99.507  519.42
