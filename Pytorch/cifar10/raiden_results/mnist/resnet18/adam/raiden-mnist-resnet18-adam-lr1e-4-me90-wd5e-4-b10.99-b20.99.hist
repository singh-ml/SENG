Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-4', '--weight-decay', '5e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1766     94.100  0.6309    79.302  7.68
   2   0.0852     97.390  0.1379    95.557  13.86
   3   0.0604     98.050  0.0856    97.307  19.93
   4   0.0533     98.210  0.0661    97.922  26.00
   5   0.0458     98.460  0.0576    98.223  32.09
   6   0.0446     98.530  0.0550    98.260  38.17
   7   0.0469     98.310  0.0479    98.468  44.36
   8   0.0457     98.530  0.0451    98.558  50.42
   9   0.0413     98.620  0.0449    98.587  56.48
  10   0.0583     98.030  0.0404    98.755  62.57
  11   0.0480     98.480  0.0408    98.722  68.63
  12   0.0373     98.750  0.0401    98.755  74.70
  13   0.0419     98.660  0.0380    98.793  80.86
  14   0.0378     98.600  0.0366    98.860  86.97
  15   0.0328     98.930  0.0355    98.847  93.05
  16   0.0484     98.530  0.0352    98.888  99.13
  17   0.0366     98.610  0.0365    98.882  105.20
  18   0.0420     98.590  0.0336    98.920  111.39
  19   0.0343     98.910  0.0348    98.915  117.48
  20   0.0433     98.590  0.0304    99.010  123.59
  21   0.0287     99.080  0.0318    99.008  129.66
  22   0.0495     98.510  0.0307    99.042  135.72
  23   0.0581     97.960  0.0293    99.107  141.80
  24   0.0401     98.730  0.0304    99.008  148.00
  25   0.0330     98.930  0.0282    99.120  154.08
  26   0.0312     98.950  0.0289    99.128  160.17
  27   0.0358     98.900  0.0286    99.077  166.22
  28   0.0246     99.210  0.0296    99.080  172.31
  29   0.0365     98.860  0.0288    99.078  178.38
  30   0.0343     98.850  0.0290    99.097  184.51
  31   0.0320     98.930  0.0279    99.127  190.59
  32   0.0307     99.060  0.0266    99.193  196.67
  33   0.0338     99.080  0.0267    99.137  202.73
  34   0.0428     98.570  0.0261    99.182  208.81
  35   0.0385     98.880  0.0250    99.225  214.89
  36   0.0393     98.750  0.0243    99.248  221.04
  37   0.0420     98.690  0.0236    99.308  227.19
  38   0.0325     98.950  0.0250    99.248  233.27
  39   0.0250     99.250  0.0257    99.212  239.34
  40   0.0372     98.810  0.0260    99.228  245.42
  41   0.0367     98.770  0.0250    99.277  251.51
  42   0.0286     99.120  0.0248    99.287  257.62
  43   0.0290     99.100  0.0220    99.343  263.70
  44   0.0431     98.610  0.0251    99.250  269.79
  45   0.0215     99.340  0.0232    99.315  275.87
  46   0.0375     98.780  0.0235    99.257  281.93
  47   0.0313     98.970  0.0248    99.217  288.00
  48   0.0383     98.750  0.0221    99.355  294.17
  49   0.0327     98.970  0.0228    99.305  300.24
  50   0.0366     98.800  0.0235    99.335  306.35
  51   0.0349     98.970  0.0228    99.337  312.42
  52   0.0399     98.900  0.0225    99.287  318.51
  53   0.0287     99.140  0.0202    99.393  324.71
  54   0.0273     99.130  0.0200    99.398  330.80
  55   0.0415     98.730  0.0199    99.407  336.87
  56   0.0277     99.210  0.0215    99.350  342.97
  57   0.0352     98.900  0.0192    99.417  349.03
  58   0.0290     99.140  0.0205    99.412  355.11
  59   0.0398     98.850  0.0215    99.318  361.28
  60   0.0335     98.990  0.0196    99.435  367.36
  61   0.0385     98.620  0.0201    99.402  373.42
  62   0.0343     98.910  0.0196    99.423  379.53
  63   0.0366     98.880  0.0198    99.393  385.66
  64   0.0334     99.020  0.0191    99.427  391.85
  65   0.0358     98.850  0.0213    99.357  397.93
  66   0.0294     99.150  0.0199    99.377  404.00
  67   0.0200     99.390  0.0190    99.415  410.07
  68   0.0312     98.980  0.0186    99.428  416.14
  69   0.0231     99.300  0.0186    99.490  422.22
  70   0.0364     98.840  0.0193    99.400  428.38
  71   0.0300     99.160  0.0194    99.438  434.46
  72   0.0352     99.010  0.0183    99.480  440.54
  73   0.0321     99.080  0.0180    99.465  446.63
  74   0.0262     99.120  0.0175    99.473  452.72
  75   0.0331     98.910  0.0184    99.437  458.85
  76   0.0293     99.080  0.0180    99.457  464.93
  77   0.0315     98.860  0.0168    99.482  471.01
  78   0.0288     99.110  0.0175    99.498  477.09
  79   0.0285     99.110  0.0157    99.497  483.16
  80   0.0314     99.000  0.0164    99.508  489.25
  81   0.0304     99.100  0.0156    99.515  495.37
  82   0.0290     99.120  0.0157    99.523  501.45
  83   0.0299     99.110  0.0173    99.525  507.52
  84   0.0289     99.060  0.0163    99.508  513.58
  85   0.0335     99.100  0.0156    99.530  519.65
  86   0.0319     99.010  0.0163    99.543  525.75
  87   0.0353     98.980  0.0178    99.445  531.82
  88   0.0309     99.060  0.0170    99.478  537.98
  89   0.0302     99.040  0.0150    99.533  544.06
  90   0.0257     99.240  0.0154    99.538  550.14
