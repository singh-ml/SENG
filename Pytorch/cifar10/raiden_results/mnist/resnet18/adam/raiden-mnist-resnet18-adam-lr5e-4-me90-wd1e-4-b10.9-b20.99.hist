Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-4', '--weight-decay', '1e-4', '--beta1', '0.9', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1622     94.550  0.2740    90.915  7.67
   2   0.1515     95.190  0.0918    97.178  13.77
   3   0.1485     95.190  0.0742    97.685  19.86
   4   0.1154     96.430  0.0661    97.928  25.97
   5   0.0590     98.190  0.0620    98.098  32.07
   6   0.0747     97.720  0.0562    98.238  38.17
   7   0.0665     97.790  0.0532    98.343  44.26
   8   0.0721     97.550  0.0530    98.367  50.35
   9   0.0659     97.890  0.0507    98.427  56.52
  10   0.0497     98.560  0.0466    98.528  62.60
  11   0.0519     98.460  0.0475    98.533  68.71
  12   0.0507     98.340  0.0446    98.602  74.80
  13   0.0678     97.890  0.0433    98.623  80.91
  14   0.0578     98.110  0.0432    98.640  87.01
  15   0.0400     98.750  0.0411    98.697  93.10
  16   0.0635     98.040  0.0396    98.753  99.28
  17   0.0426     98.590  0.0402    98.773  105.37
  18   0.0412     98.640  0.0390    98.792  111.46
  19   0.0577     98.140  0.0384    98.818  117.57
  20   0.0399     98.590  0.0380    98.825  123.69
  21   0.0716     97.660  0.0345    98.888  129.77
  22   0.0413     98.660  0.0359    98.838  135.93
  23   0.0362     98.780  0.0346    98.900  142.02
  24   0.0357     98.880  0.0346    98.932  148.11
  25   0.0390     98.690  0.0339    98.928  154.24
  26   0.0291     99.020  0.0326    99.002  160.34
  27   0.0366     98.830  0.0320    98.985  166.50
  28   0.0386     98.670  0.0327    98.970  172.59
  29   0.0363     98.730  0.0302    99.038  178.70
  30   0.0503     98.330  0.0308    99.032  184.79
  31   0.0360     98.920  0.0305    99.003  190.89
  32   0.0292     99.140  0.0299    99.013  197.00
  33   0.0336     98.970  0.0296    99.078  203.21
  34   0.0550     98.270  0.0287    99.095  209.33
  35   0.0513     98.530  0.0284    99.103  215.44
  36   0.0367     98.790  0.0299    99.022  221.56
  37   0.0301     98.960  0.0279    99.102  227.68
  38   0.0346     98.890  0.0267    99.110  233.85
  39   0.0299     99.060  0.0266    99.182  239.93
  40   0.0364     98.880  0.0283    99.123  246.02
  41   0.0317     98.920  0.0275    99.155  252.12
  42   0.0326     98.950  0.0253    99.180  258.22
  43   0.0319     99.020  0.0278    99.110  264.31
  44   0.0386     98.660  0.0251    99.220  270.49
  45   0.0356     98.860  0.0256    99.187  276.57
  46   0.0256     99.120  0.0258    99.195  282.68
  47   0.0344     98.900  0.0260    99.163  288.81
  48   0.0459     98.580  0.0246    99.243  294.98
  49   0.0333     98.850  0.0243    99.242  301.16
  50   0.0236     99.310  0.0240    99.233  307.28
  51   0.0485     98.470  0.0233    99.238  313.39
  52   0.0348     98.890  0.0236    99.230  319.48
  53   0.0307     98.980  0.0245    99.217  325.56
  54   0.0273     99.100  0.0220    99.290  331.66
  55   0.0286     98.950  0.0212    99.328  337.83
  56   0.0377     98.750  0.0239    99.232  343.93
  57   0.0331     99.020  0.0221    99.310  350.04
  58   0.0286     99.070  0.0231    99.257  356.15
  59   0.0329     98.950  0.0226    99.293  362.26
  60   0.0491     98.370  0.0220    99.312  368.38
  61   0.0350     98.740  0.0216    99.282  374.59
  62   0.0381     98.790  0.0211    99.313  380.72
  63   0.0265     99.160  0.0214    99.328  386.86
  64   0.0305     99.010  0.0213    99.310  393.03
  65   0.0420     98.570  0.0214    99.322  399.13
  66   0.0362     98.890  0.0208    99.328  405.25
  67   0.0302     99.020  0.0199    99.348  411.42
  68   0.0296     99.060  0.0191    99.370  417.53
  69   0.0397     98.790  0.0207    99.347  423.63
  70   0.0369     98.780  0.0202    99.362  429.73
  71   0.0382     98.790  0.0191    99.367  435.84
  72   0.0335     99.020  0.0199    99.315  441.98
  73   0.0307     99.040  0.0189    99.395  448.11
  74   0.0286     99.100  0.0198    99.348  454.20
  75   0.0270     99.140  0.0190    99.402  460.29
  76   0.0293     98.950  0.0189    99.397  466.38
  77   0.0305     98.960  0.0183    99.417  472.46
  78   0.0317     98.950  0.0190    99.368  478.66
  79   0.0396     98.740  0.0189    99.403  484.77
  80   0.0420     98.680  0.0189    99.423  490.86
  81   0.0378     98.850  0.0193    99.368  496.97
  82   0.0385     98.800  0.0188    99.403  503.08
  83   0.0330     98.940  0.0185    99.417  509.26
  84   0.0250     99.080  0.0180    99.418  515.35
  85   0.0329     98.930  0.0189    99.382  521.48
  86   0.0314     98.960  0.0183    99.400  527.58
  87   0.0351     98.790  0.0175    99.443  533.67
  88   0.0391     98.770  0.0183    99.400  539.77
  89   0.0267     99.180  0.0181    99.403  545.95
  90   0.0302     99.100  0.0179    99.388  552.05
