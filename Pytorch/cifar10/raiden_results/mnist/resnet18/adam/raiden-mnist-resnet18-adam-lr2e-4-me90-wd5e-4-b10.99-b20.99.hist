Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '2e-4', '--weight-decay', '5e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1684     94.670  0.4464    85.317  7.58
   2   0.2156     92.850  0.1108    96.427  13.65
   3   0.0723     97.580  0.0797    97.512  19.72
   4   0.0656     98.050  0.0688    97.827  25.79
   5   0.0804     97.430  0.0607    98.140  31.96
   6   0.0544     98.210  0.0575    98.208  38.05
   7   0.0510     98.430  0.0519    98.425  44.12
   8   0.0514     98.330  0.0483    98.452  50.20
   9   0.0603     97.950  0.0483    98.528  56.28
  10   0.0555     98.310  0.0458    98.567  62.35
  11   0.0510     98.250  0.0463    98.577  68.52
  12   0.0415     98.780  0.0450    98.638  74.59
  13   0.0621     98.060  0.0491    98.468  80.65
  14   0.0418     98.560  0.0404    98.693  86.73
  15   0.0487     98.600  0.0418    98.702  92.81
  16   0.0353     98.830  0.0433    98.708  99.03
  17   0.0499     98.420  0.0412    98.787  105.10
  18   0.0453     98.590  0.0373    98.907  111.17
  19   0.0357     98.860  0.0394    98.812  117.24
  20   0.0405     98.730  0.0380    98.870  123.30
  21   0.0346     98.900  0.0360    98.947  129.37
  22   0.0268     99.140  0.0342    98.927  135.51
  23   0.0424     98.550  0.0337    99.003  141.58
  24   0.0438     98.590  0.0375    98.878  147.65
  25   0.0327     98.880  0.0353    98.958  153.77
  26   0.0374     98.860  0.0363    98.885  159.90
  27   0.0338     98.950  0.0325    99.068  166.07
  28   0.0387     98.720  0.0326    99.022  172.15
  29   0.0425     98.660  0.0322    99.033  178.22
  30   0.0433     98.700  0.0305    99.085  184.28
  31   0.0425     98.630  0.0330    98.982  190.32
  32   0.0309     99.060  0.0338    98.995  196.40
  33   0.0347     98.900  0.0301    99.108  202.59
  34   0.0362     98.780  0.0311    99.047  208.67
  35   0.0325     98.940  0.0287    99.135  214.74
  36   0.0321     98.950  0.0310    99.058  220.79
  37   0.0412     98.670  0.0303    99.068  226.87
  38   0.0380     98.810  0.0304    99.070  233.04
  39   0.0369     98.850  0.0279    99.170  239.11
  40   0.0354     98.940  0.0291    99.148  245.18
  41   0.0309     99.030  0.0281    99.137  251.27
  42   0.0336     98.930  0.0287    99.115  257.35
  43   0.0314     98.890  0.0311    99.063  263.44
  44   0.0345     98.850  0.0280    99.172  269.59
  45   0.0279     99.190  0.0281    99.170  275.67
  46   0.0340     99.020  0.0247    99.275  281.75
  47   0.0324     99.010  0.0257    99.218  287.83
  48   0.0354     98.970  0.0276    99.170  293.91
  49   0.0214     99.320  0.0260    99.230  299.98
  50   0.0279     99.120  0.0268    99.217  306.11
  51   0.0364     98.820  0.0250    99.242  312.20
  52   0.0290     99.020  0.0237    99.282  318.28
  53   0.0324     99.040  0.0259    99.227  324.36
  54   0.0370     98.940  0.0243    99.238  330.49
  55   0.0244     99.170  0.0244    99.288  336.57
  56   0.0283     99.170  0.0243    99.285  342.74
  57   0.0307     99.150  0.0241    99.268  348.82
  58   0.0289     99.200  0.0230    99.295  354.88
  59   0.0310     99.110  0.0226    99.302  360.96
  60   0.0310     99.000  0.0225    99.317  367.05
  61   0.0446     98.620  0.0234    99.270  373.26
  62   0.0258     99.110  0.0222    99.350  379.35
  63   0.0389     98.850  0.0214    99.368  385.42
  64   0.0369     98.940  0.0227    99.325  391.49
  65   0.0395     98.780  0.0225    99.317  397.58
  66   0.0391     98.750  0.0218    99.357  403.67
  67   0.0347     98.930  0.0208    99.353  409.89
  68   0.0252     99.150  0.0204    99.412  415.95
  69   0.0357     98.880  0.0217    99.335  422.02
  70   0.0292     99.120  0.0209    99.387  428.13
  71   0.0355     98.960  0.0204    99.375  434.22
  72   0.0330     99.010  0.0206    99.388  440.43
  73   0.0270     99.130  0.0202    99.415  446.50
  74   0.0211     99.290  0.0208    99.388  452.63
  75   0.0247     99.280  0.0208    99.338  458.71
  76   0.0234     99.260  0.0187    99.433  464.79
  77   0.0327     98.990  0.0204    99.372  470.88
  78   0.0279     99.090  0.0204    99.372  477.05
  79   0.0364     98.930  0.0207    99.355  483.12
  80   0.0311     98.930  0.0189    99.420  489.18
  81   0.0329     99.060  0.0191    99.390  495.23
  82   0.0325     98.980  0.0194    99.438  501.30
  83   0.0307     99.100  0.0193    99.422  507.37
  84   0.0360     98.920  0.0202    99.405  513.55
  85   0.0359     98.950  0.0202    99.352  519.63
  86   0.0326     99.080  0.0194    99.370  525.74
  87   0.0265     99.210  0.0196    99.412  531.80
  88   0.0282     99.130  0.0180    99.465  537.86
  89   0.0278     99.140  0.0180    99.448  543.92
  90   0.0302     99.000  0.0175    99.463  549.99
