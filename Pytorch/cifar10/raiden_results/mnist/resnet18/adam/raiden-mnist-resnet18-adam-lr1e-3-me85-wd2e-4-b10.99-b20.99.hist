Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.0969     96.780  0.3142    89.568  7.71
   2   0.1294     95.520  0.1058    96.723  13.77
   3   0.0694     97.690  0.0935    97.092  19.94
   4   0.0983     96.930  0.0863    97.397  26.02
   5   0.0943     97.050  0.0757    97.622  32.10
   6   0.0974     97.090  0.0710    97.747  38.18
   7   0.0569     98.210  0.0661    97.920  44.25
   8   0.0940     97.080  0.0643    98.043  50.34
   9   0.0699     97.820  0.0567    98.273  56.50
  10   0.0583     98.260  0.0573    98.228  62.59
  11   0.0434     98.590  0.0549    98.322  68.66
  12   0.0513     98.460  0.0544    98.330  74.75
  13   0.0745     97.630  0.0489    98.547  80.84
  14   0.0465     98.560  0.0508    98.387  86.89
  15   0.0361     98.890  0.0462    98.582  93.08
  16   0.0461     98.540  0.0470    98.593  99.18
  17   0.0329     98.880  0.0451    98.623  105.24
  18   0.0435     98.630  0.0444    98.637  111.34
  19   0.0443     98.580  0.0419    98.718  117.45
  20   0.0354     98.910  0.0413    98.657  123.52
  21   0.0418     98.620  0.0396    98.757  129.70
  22   0.0353     98.860  0.0416    98.692  135.78
  23   0.0432     98.580  0.0390    98.803  141.86
  24   0.0416     98.640  0.0379    98.813  147.95
  25   0.0364     98.870  0.0392    98.787  154.04
  26   0.0376     98.710  0.0368    98.855  160.10
  27   0.0311     98.970  0.0352    98.915  166.29
  28   0.0358     98.840  0.0361    98.838  172.37
  29   0.0342     98.840  0.0349    98.903  178.44
  30   0.0400     98.690  0.0342    98.915  184.51
  31   0.0335     98.910  0.0340    98.928  190.58
  32   0.0394     98.770  0.0350    98.923  196.77
  33   0.0359     98.800  0.0345    98.935  202.84
  34   0.0376     98.780  0.0338    98.942  208.92
  35   0.0424     98.670  0.0339    98.988  215.01
  36   0.0387     98.690  0.0330    99.005  221.08
  37   0.0366     98.890  0.0313    99.035  227.15
  38   0.0319     98.940  0.0311    99.015  233.31
  39   0.0400     98.750  0.0314    99.027  239.39
  40   0.0381     98.850  0.0329    99.002  245.46
  41   0.0368     98.750  0.0300    99.047  251.51
  42   0.0337     98.950  0.0294    99.080  257.59
  43   0.0400     98.770  0.0303    99.053  263.80
  44   0.0401     98.620  0.0322    99.020  269.89
  45   0.0348     98.760  0.0308    99.052  275.99
  46   0.0382     98.870  0.0292    99.048  282.05
  47   0.0348     98.880  0.0290    99.117  288.15
  48   0.0362     98.800  0.0304    99.057  294.33
  49   0.0399     98.780  0.0307    99.053  300.38
  50   0.0399     98.650  0.0286    99.075  306.44
  51   0.0348     98.900  0.0297    99.075  312.55
  52   0.0406     98.780  0.0279    99.087  318.62
  53   0.0368     98.840  0.0277    99.117  324.69
  54   0.0402     98.750  0.0279    99.135  330.86
  55   0.0390     98.710  0.0286    99.100  336.97
  56   0.0401     98.690  0.0275    99.152  343.09
  57   0.0339     98.990  0.0269    99.133  349.16
  58   0.0423     98.700  0.0291    99.107  355.22
  59   0.0423     98.730  0.0274    99.165  361.29
  60   0.0352     98.880  0.0271    99.158  367.45
  61   0.0333     98.890  0.0264    99.178  373.57
  62   0.0412     98.750  0.0254    99.207  379.65
  63   0.0313     99.040  0.0277    99.128  385.72
  64   0.0353     98.810  0.0265    99.178  391.80
  65   0.0329     98.830  0.0256    99.197  397.86
  66   0.0430     98.700  0.0275    99.098  404.02
  67   0.0334     98.930  0.0265    99.190  410.08
  68   0.0395     98.780  0.0263    99.160  416.12
  69   0.0406     98.710  0.0261    99.193  422.17
  70   0.0447     98.560  0.0271    99.193  428.26
  71   0.0315     99.030  0.0256    99.202  434.34
  72   0.0343     98.960  0.0266    99.172  440.48
  73   0.0333     98.980  0.0262    99.175  446.56
  74   0.0320     99.030  0.0275    99.133  452.64
  75   0.0336     98.930  0.0266    99.178  458.69
  76   0.0379     98.770  0.0252    99.205  464.77
  77   0.0306     99.070  0.0256    99.202  470.83
  78   0.0334     98.870  0.0245    99.218  476.93
  79   0.0359     98.900  0.0248    99.212  483.01
  80   0.0449     98.630  0.0255    99.187  489.11
  81   0.0379     98.850  0.0257    99.243  495.19
  82   0.0365     98.720  0.0255    99.200  501.26
  83   0.0317     98.990  0.0242    99.233  507.40
  84   0.0314     99.030  0.0247    99.255  513.46
  85   0.0322     98.950  0.0256    99.185  519.52
