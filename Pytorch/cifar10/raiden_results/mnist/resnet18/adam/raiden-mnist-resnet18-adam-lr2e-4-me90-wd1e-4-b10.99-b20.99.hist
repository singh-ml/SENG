Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '2e-4', '--weight-decay', '1e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1395     95.370  0.4610    84.728  7.51
   2   0.0931     97.030  0.1155    96.393  13.58
   3   0.0680     97.710  0.0799    97.472  19.76
   4   0.0609     97.900  0.0638    97.992  25.84
   5   0.0404     98.490  0.0551    98.237  31.92
   6   0.0428     98.620  0.0485    98.457  37.99
   7   0.0478     98.380  0.0490    98.463  44.05
   8   0.0472     98.600  0.0455    98.542  50.13
   9   0.0317     98.890  0.0435    98.648  56.27
  10   0.0400     98.670  0.0417    98.700  62.36
  11   0.0388     98.770  0.0390    98.778  68.41
  12   0.0367     98.780  0.0373    98.785  74.50
  13   0.0330     99.080  0.0370    98.848  80.56
  14   0.0381     98.720  0.0353    98.895  86.65
  15   0.0317     98.900  0.0357    98.870  92.72
  16   0.0391     98.740  0.0334    98.973  98.78
  17   0.0396     98.710  0.0312    98.987  104.83
  18   0.0405     98.710  0.0319    98.988  110.91
  19   0.0353     98.930  0.0324    98.940  117.07
  20   0.0367     98.890  0.0316    98.985  123.14
  21   0.0373     98.780  0.0290    99.058  129.21
  22   0.0394     98.750  0.0306    99.027  135.29
  23   0.0426     98.690  0.0284    99.050  141.36
  24   0.0344     99.020  0.0287    99.060  147.45
  25   0.0324     98.970  0.0280    99.068  153.60
  26   0.0289     99.090  0.0274    99.130  159.71
  27   0.0356     98.850  0.0283    99.063  165.85
  28   0.0316     98.880  0.0253    99.172  171.93
  29   0.0352     98.840  0.0281    99.113  178.01
  30   0.0300     98.930  0.0266    99.167  184.09
  31   0.0356     98.900  0.0253    99.190  190.27
  32   0.0444     98.530  0.0253    99.195  196.33
  33   0.0287     99.090  0.0253    99.162  202.40
  34   0.0237     99.280  0.0235    99.218  208.46
  35   0.0330     98.940  0.0221    99.272  214.50
  36   0.0251     99.170  0.0230    99.253  220.58
  37   0.0277     99.100  0.0214    99.292  226.76
  38   0.0289     98.970  0.0221    99.278  232.84
  39   0.0245     99.220  0.0215    99.313  238.90
  40   0.0356     98.770  0.0211    99.307  244.96
  41   0.0272     99.170  0.0234    99.207  251.03
  42   0.0277     99.100  0.0203    99.340  257.07
  43   0.0313     98.900  0.0208    99.315  263.23
  44   0.0348     98.880  0.0218    99.293  269.30
  45   0.0321     98.880  0.0199    99.348  275.38
  46   0.0261     99.280  0.0205    99.347  281.42
  47   0.0312     98.990  0.0211    99.297  287.52
  48   0.0249     99.190  0.0197    99.367  293.59
  49   0.0336     98.930  0.0209    99.282  299.75
  50   0.0293     99.040  0.0207    99.312  305.81
  51   0.0381     98.760  0.0177    99.438  311.90
  52   0.0333     99.010  0.0210    99.327  318.03
  53   0.0289     99.080  0.0187    99.395  324.10
  54   0.0451     98.570  0.0187    99.360  330.25
  55   0.0249     99.220  0.0196    99.372  336.32
  56   0.0296     99.010  0.0187    99.402  342.40
  57   0.0464     98.610  0.0186    99.368  348.49
  58   0.0243     99.240  0.0184    99.395  354.55
  59   0.0430     98.650  0.0175    99.448  360.62
  60   0.0262     99.260  0.0190    99.382  366.78
  61   0.0293     98.900  0.0177    99.422  372.85
  62   0.0311     98.960  0.0177    99.402  378.91
  63   0.0294     99.130  0.0178    99.412  384.99
  64   0.0256     99.210  0.0189    99.385  391.14
  65   0.0359     98.870  0.0178    99.437  397.22
  66   0.0236     99.250  0.0162    99.455  403.33
  67   0.0305     99.020  0.0154    99.482  409.40
  68   0.0345     98.800  0.0141    99.547  415.48
  69   0.0371     98.910  0.0166    99.445  421.55
  70   0.0360     98.860  0.0165    99.472  427.63
  71   0.0281     99.090  0.0171    99.447  433.81
  72   0.0317     99.020  0.0152    99.493  439.88
  73   0.0355     98.900  0.0176    99.408  445.98
  74   0.0338     98.940  0.0171    99.435  452.08
  75   0.0307     99.070  0.0155    99.497  458.17
  76   0.0292     99.110  0.0147    99.547  464.25
  77   0.0300     99.050  0.0138    99.528  470.41
  78   0.0287     99.020  0.0141    99.532  476.48
  79   0.0306     99.090  0.0146    99.518  482.56
  80   0.0253     99.230  0.0147    99.530  488.63
  81   0.0297     99.210  0.0140    99.528  494.71
  82   0.0386     98.810  0.0142    99.525  500.81
  83   0.0317     99.060  0.0135    99.573  506.89
  84   0.0323     99.010  0.0145    99.520  512.97
  85   0.0330     99.000  0.0132    99.587  519.04
  86   0.0387     98.830  0.0131    99.580  525.11
  87   0.0358     98.880  0.0153    99.488  531.19
  88   0.0334     98.940  0.0152    99.475  537.25
  89   0.0290     99.010  0.0156    99.518  543.43
  90   0.0360     98.870  0.0138    99.545  549.52
