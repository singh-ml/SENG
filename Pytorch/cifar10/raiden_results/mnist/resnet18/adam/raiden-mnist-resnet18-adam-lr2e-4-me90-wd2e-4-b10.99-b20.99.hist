Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '2e-4', '--weight-decay', '2e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1799     94.100  0.4393    85.582  7.63
   2   0.0847     97.190  0.1088    96.575  13.69
   3   0.0785     97.540  0.0764    97.587  19.76
   4   0.0754     97.550  0.0668    97.960  25.90
   5   0.0593     98.020  0.0576    98.183  31.96
   6   0.0551     98.160  0.0548    98.293  38.01
   7   0.0570     98.260  0.0493    98.450  44.07
   8   0.0502     98.340  0.0468    98.478  50.11
   9   0.0411     98.700  0.0441    98.615  56.25
  10   0.0406     98.690  0.0427    98.677  62.32
  11   0.0442     98.500  0.0397    98.760  68.36
  12   0.0426     98.630  0.0386    98.798  74.41
  13   0.0343     98.880  0.0403    98.727  80.46
  14   0.0344     98.950  0.0402    98.743  86.49
  15   0.0358     98.860  0.0376    98.795  92.66
  16   0.0397     98.640  0.0358    98.878  98.72
  17   0.0418     98.390  0.0362    98.862  104.74
  18   0.0518     98.360  0.0357    98.852  110.78
  19   0.0540     98.300  0.0337    98.933  116.81
  20   0.0343     98.810  0.0347    98.875  122.94
  21   0.0292     99.070  0.0324    98.977  128.99
  22   0.0434     98.550  0.0317    98.988  135.04
  23   0.0403     98.700  0.0305    99.058  141.12
  24   0.0349     98.880  0.0313    99.037  147.18
  25   0.0323     98.910  0.0288    99.128  153.24
  26   0.0455     98.530  0.0303    99.020  159.48
  27   0.0230     99.240  0.0281    99.108  165.53
  28   0.0357     98.760  0.0298    99.053  171.59
  29   0.0346     98.750  0.0291    99.085  177.65
  30   0.0556     98.290  0.0272    99.158  183.73
  31   0.0379     98.830  0.0285    99.095  189.88
  32   0.0426     98.650  0.0274    99.148  195.91
  33   0.0494     98.440  0.0276    99.145  201.95
  34   0.0381     98.890  0.0266    99.145  207.99
  35   0.0279     99.120  0.0262    99.148  214.03
  36   0.0393     98.660  0.0257    99.230  220.09
  37   0.0325     98.950  0.0247    99.212  226.22
  38   0.0253     99.280  0.0263    99.160  232.30
  39   0.0390     98.690  0.0267    99.175  238.35
  40   0.0337     98.970  0.0244    99.252  244.42
  41   0.0323     99.020  0.0236    99.298  250.48
  42   0.0435     98.650  0.0241    99.263  256.66
  43   0.0344     98.920  0.0240    99.268  262.72
  44   0.0277     99.120  0.0235    99.275  268.77
  45   0.0290     99.110  0.0220    99.313  274.82
  46   0.0310     98.990  0.0238    99.278  280.88
  47   0.0370     98.870  0.0227    99.277  286.93
  48   0.0391     98.800  0.0219    99.287  293.09
  49   0.0358     98.770  0.0217    99.317  299.14
  50   0.0344     98.850  0.0243    99.227  305.19
  51   0.0295     99.050  0.0209    99.322  311.24
  52   0.0268     99.180  0.0207    99.390  317.31
  53   0.0289     99.000  0.0205    99.365  323.41
  54   0.0282     99.070  0.0209    99.355  329.56
  55   0.0289     99.150  0.0221    99.312  335.63
  56   0.0391     98.660  0.0229    99.272  341.69
  57   0.0261     99.120  0.0208    99.338  347.75
  58   0.0297     99.020  0.0207    99.332  353.81
  59   0.0307     98.970  0.0212    99.335  359.87
  60   0.0303     98.940  0.0214    99.305  366.02
  61   0.0283     99.170  0.0192    99.405  372.08
  62   0.0268     99.100  0.0188    99.408  378.17
  63   0.0397     98.790  0.0194    99.387  384.27
  64   0.0333     98.940  0.0203    99.363  390.33
  65   0.0385     98.860  0.0192    99.397  396.39
  66   0.0331     98.880  0.0178    99.415  402.51
  67   0.0267     99.180  0.0189    99.410  408.58
  68   0.0361     98.960  0.0188    99.417  414.64
  69   0.0318     98.940  0.0180    99.462  420.71
  70   0.0297     99.050  0.0179    99.450  426.75
  71   0.0353     98.850  0.0179    99.445  432.80
  72   0.0313     99.050  0.0173    99.450  438.95
  73   0.0375     98.820  0.0182    99.427  445.03
  74   0.0402     98.660  0.0180    99.438  451.14
  75   0.0400     98.710  0.0171    99.438  457.21
  76   0.0403     98.740  0.0174    99.422  463.25
  77   0.0289     99.160  0.0177    99.447  469.28
  78   0.0283     99.170  0.0179    99.453  475.41
  79   0.0281     99.130  0.0175    99.428  481.44
  80   0.0273     99.150  0.0178    99.432  487.49
  81   0.0297     99.050  0.0153    99.518  493.54
  82   0.0281     99.080  0.0164    99.487  499.59
  83   0.0300     99.040  0.0170    99.475  505.78
  84   0.0320     99.080  0.0163    99.472  511.83
  85   0.0381     98.910  0.0160    99.500  517.89
  86   0.0314     98.980  0.0193    99.383  523.96
  87   0.0330     98.920  0.0160    99.508  530.01
  88   0.0328     99.040  0.0153    99.515  536.19
  89   0.0338     98.930  0.0157    99.487  542.24
  90   0.0287     99.060  0.0166    99.477  548.28
