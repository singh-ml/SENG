Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-4', '--weight-decay', '1e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.0971     96.880  0.3278    89.190  7.57
   2   0.1030     96.800  0.1037    96.780  13.73
   3   0.0558     98.090  0.0797    97.528  19.79
   4   0.0682     97.850  0.0672    97.865  25.87
   5   0.0464     98.460  0.0619    98.085  31.92
   6   0.0542     98.260  0.0574    98.218  38.00
   7   0.0493     98.410  0.0541    98.333  44.08
   8   0.0671     97.780  0.0519    98.422  50.14
   9   0.0649     97.850  0.0506    98.465  56.21
  10   0.0578     98.020  0.0476    98.525  62.29
  11   0.0433     98.530  0.0476    98.537  68.41
  12   0.0543     98.350  0.0448    98.633  74.48
  13   0.0368     98.820  0.0444    98.583  80.65
  14   0.0472     98.440  0.0415    98.732  86.75
  15   0.0446     98.560  0.0402    98.743  92.81
  16   0.0459     98.470  0.0414    98.698  98.88
  17   0.0474     98.450  0.0384    98.808  104.93
  18   0.0374     98.760  0.0374    98.790  111.01
  19   0.0344     98.830  0.0381    98.793  117.17
  20   0.0453     98.590  0.0358    98.875  123.23
  21   0.0491     98.430  0.0350    98.877  129.31
  22   0.0465     98.450  0.0342    98.927  135.44
  23   0.0484     98.550  0.0346    98.908  141.57
  24   0.0340     98.890  0.0341    98.945  147.73
  25   0.0376     98.700  0.0355    98.868  153.82
  26   0.0446     98.480  0.0318    98.973  159.90
  27   0.0451     98.520  0.0340    98.965  165.99
  28   0.0367     98.790  0.0317    99.035  172.07
  29   0.0345     98.870  0.0305    99.062  178.14
  30   0.0325     98.860  0.0313    98.975  184.31
  31   0.0296     98.970  0.0288    99.055  190.40
  32   0.0345     98.890  0.0297    99.073  196.46
  33   0.0283     99.090  0.0302    99.047  202.53
  34   0.0404     98.690  0.0310    98.968  208.60
  35   0.0296     99.010  0.0286    99.128  214.67
  36   0.0284     99.070  0.0296    99.077  220.83
  37   0.0412     98.670  0.0283    99.108  226.91
  38   0.0327     98.910  0.0287    99.068  233.03
  39   0.0300     99.050  0.0257    99.212  239.09
  40   0.0323     98.940  0.0281    99.080  245.18
  41   0.0287     99.090  0.0255    99.152  251.25
  42   0.0341     98.910  0.0228    99.248  257.39
  43   0.0281     99.140  0.0244    99.225  263.46
  44   0.0342     98.920  0.0238    99.223  269.53
  45   0.0318     99.050  0.0269    99.153  275.61
  46   0.0263     99.170  0.0240    99.218  281.66
  47   0.0349     98.910  0.0258    99.190  287.75
  48   0.0260     99.210  0.0259    99.160  293.85
  49   0.0361     98.890  0.0229    99.253  299.93
  50   0.0320     98.930  0.0226    99.275  305.99
  51   0.0319     98.920  0.0234    99.242  312.07
  52   0.0295     99.040  0.0240    99.237  318.14
  53   0.0257     99.210  0.0217    99.310  324.31
  54   0.0441     98.600  0.0231    99.290  330.36
  55   0.0319     98.990  0.0231    99.307  336.45
  56   0.0339     98.870  0.0214    99.318  342.52
  57   0.0268     99.090  0.0228    99.245  348.59
  58   0.0240     99.180  0.0219    99.292  354.73
  59   0.0321     98.990  0.0209    99.320  360.82
  60   0.0280     99.000  0.0217    99.330  366.89
  61   0.0317     98.910  0.0199    99.357  372.97
  62   0.0252     99.170  0.0196    99.360  379.05
  63   0.0229     99.210  0.0213    99.335  385.13
  64   0.0247     99.250  0.0207    99.355  391.26
  65   0.0355     98.940  0.0197    99.382  397.34
  66   0.0415     98.710  0.0199    99.352  403.48
  67   0.0282     99.230  0.0204    99.350  409.60
  68   0.0260     99.190  0.0197    99.328  415.67
  69   0.0288     99.020  0.0196    99.368  421.85
  70   0.0290     99.140  0.0192    99.352  427.96
  71   0.0319     98.950  0.0195    99.383  434.02
  72   0.0319     98.970  0.0178    99.450  440.08
  73   0.0254     99.260  0.0181    99.423  446.15
  74   0.0312     99.010  0.0187    99.387  452.23
  75   0.0288     98.990  0.0193    99.383  458.30
  76   0.0337     98.920  0.0192    99.413  464.37
  77   0.0292     99.040  0.0178    99.430  470.45
  78   0.0292     99.120  0.0183    99.403  476.51
  79   0.0347     99.020  0.0169    99.440  482.58
  80   0.0344     98.900  0.0173    99.452  488.67
  81   0.0378     98.910  0.0167    99.473  494.72
  82   0.0395     98.770  0.0172    99.433  500.78
  83   0.0339     98.870  0.0166    99.457  506.85
  84   0.0418     98.800  0.0173    99.448  512.92
  85   0.0404     98.850  0.0170    99.450  518.98
  86   0.0319     98.950  0.0174    99.427  525.04
  87   0.0424     98.700  0.0155    99.518  531.18
  88   0.0364     98.920  0.0158    99.475  537.26
  89   0.0290     99.050  0.0174    99.453  543.31
  90   0.0255     99.200  0.0158    99.465  549.40
