Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1961     93.760  0.3213    89.410  7.65
   2   0.1290     95.910  0.1155    96.337  13.68
   3   0.1765     94.130  0.1006    96.920  19.73
   4   0.1490     95.040  0.0896    97.268  25.78
   5   0.1150     96.340  0.0788    97.585  31.93
   6   0.0753     97.740  0.0771    97.718  38.01
   7   0.1414     95.540  0.0698    97.925  44.04
   8   0.0859     97.360  0.0705    97.885  50.10
   9   0.0678     97.950  0.0623    98.113  56.17
  10   0.0516     98.230  0.0600    98.222  62.24
  11   0.0458     98.600  0.0560    98.268  68.43
  12   0.0371     98.820  0.0577    98.240  74.50
  13   0.0395     98.660  0.0561    98.362  80.57
  14   0.0630     98.050  0.0507    98.472  86.63
  15   0.0394     98.770  0.0500    98.480  92.70
  16   0.0474     98.490  0.0480    98.548  98.89
  17   0.0461     98.530  0.0472    98.610  104.96
  18   0.0584     98.140  0.0451    98.623  111.04
  19   0.0543     98.350  0.0443    98.652  117.10
  20   0.0413     98.660  0.0449    98.635  123.17
  21   0.0415     98.590  0.0437    98.703  129.32
  22   0.0378     98.850  0.0423    98.718  135.36
  23   0.0353     98.950  0.0439    98.648  141.40
  24   0.0404     98.630  0.0423    98.692  147.47
  25   0.0383     98.840  0.0409    98.778  153.58
  26   0.0480     98.440  0.0412    98.767  159.68
  27   0.0518     98.210  0.0409    98.785  165.84
  28   0.0338     98.910  0.0398    98.855  171.92
  29   0.0371     98.790  0.0400    98.778  178.00
  30   0.0447     98.530  0.0402    98.820  184.05
  31   0.0404     98.670  0.0377    98.808  190.11
  32   0.0398     98.600  0.0409    98.818  196.28
  33   0.0353     98.880  0.0376    98.838  202.34
  34   0.0422     98.770  0.0398    98.820  208.39
  35   0.0322     99.080  0.0369    98.838  214.44
  36   0.0469     98.470  0.0358    98.920  220.51
  37   0.0302     99.070  0.0371    98.905  226.58
  38   0.0355     98.810  0.0367    98.907  232.74
  39   0.0367     98.820  0.0391    98.837  238.82
  40   0.0448     98.590  0.0369    98.893  244.87
  41   0.0406     98.680  0.0365    98.917  250.92
  42   0.0437     98.460  0.0376    98.858  256.99
  43   0.0421     98.590  0.0377    98.820  263.06
  44   0.0301     98.980  0.0343    98.927  269.24
  45   0.0398     98.670  0.0349    98.918  275.29
  46   0.0305     98.950  0.0350    98.948  281.34
  47   0.0438     98.600  0.0356    98.937  287.41
  48   0.0417     98.710  0.0335    98.963  293.49
  49   0.0339     98.980  0.0350    98.968  299.53
  50   0.0379     98.750  0.0338    98.968  305.69
  51   0.0403     98.700  0.0352    98.948  311.75
  52   0.0359     98.840  0.0348    98.905  317.80
  53   0.0371     98.860  0.0325    99.010  323.87
  54   0.0361     98.930  0.0361    98.930  329.96
  55   0.0348     98.990  0.0335    98.988  336.01
  56   0.0324     98.980  0.0338    98.938  342.18
  57   0.0376     98.860  0.0343    98.978  348.23
  58   0.0281     99.080  0.0347    99.000  354.28
  59   0.0468     98.550  0.0327    98.992  360.36
  60   0.0294     99.120  0.0314    99.043  366.41
  61   0.0349     98.900  0.0342    98.948  372.55
  62   0.0333     98.980  0.0337    98.995  378.63
  63   0.0399     98.760  0.0327    99.050  384.71
  64   0.0391     98.780  0.0326    98.983  390.77
  65   0.0322     99.110  0.0326    98.962  396.84
  66   0.0381     98.770  0.0331    99.052  402.92
  67   0.0397     98.710  0.0325    99.033  409.00
  68   0.0386     98.680  0.0333    99.007  415.06
  69   0.0360     98.830  0.0329    98.985  421.12
  70   0.0396     98.810  0.0326    99.042  427.23
  71   0.0367     98.740  0.0328    99.023  433.29
  72   0.0263     99.170  0.0301    99.098  439.43
  73   0.0296     99.030  0.0330    99.008  445.50
  74   0.0446     98.480  0.0331    99.025  451.59
  75   0.0368     98.910  0.0338    98.972  457.65
  76   0.0337     98.940  0.0305    99.067  463.71
  77   0.0373     98.790  0.0325    98.980  469.79
  78   0.0305     99.050  0.0316    99.065  475.95
  79   0.0426     98.640  0.0316    99.053  482.01
  80   0.0460     98.630  0.0332    99.023  488.07
  81   0.0387     98.590  0.0323    98.998  494.13
  82   0.0332     98.910  0.0315    99.045  500.17
  83   0.0420     98.650  0.0302    99.095  506.24
  84   0.0314     98.920  0.0315    99.095  512.41
  85   0.0348     98.990  0.0302    99.100  518.48
  86   0.0424     98.570  0.0310    99.050  524.54
  87   0.0423     98.520  0.0309    99.055  530.60
  88   0.0340     98.990  0.0312    99.062  536.64
  89   0.0421     98.570  0.0325    99.027  542.69
  90   0.0357     98.840  0.0307    99.107  548.84
