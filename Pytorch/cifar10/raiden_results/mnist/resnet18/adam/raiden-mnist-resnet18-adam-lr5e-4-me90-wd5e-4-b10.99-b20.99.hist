Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-4', '--weight-decay', '5e-4', '--beta1', '0.99', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3795903488 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1072     96.490  0.3414    88.655  7.61
   2   0.1237     96.050  0.1067    96.730  13.73
   3   0.1175     96.290  0.0863    97.332  19.79
   4   0.0704     97.750  0.0747    97.817  25.86
   5   0.0884     96.970  0.0719    97.808  31.91
   6   0.0680     98.010  0.0660    98.027  37.96
   7   0.0692     97.700  0.0671    97.950  44.17
   8   0.0621     98.110  0.0594    98.155  50.22
   9   0.0583     98.060  0.0574    98.258  56.26
  10   0.0612     98.030  0.0572    98.288  62.31
  11   0.0558     98.390  0.0540    98.402  68.37
  12   0.0633     98.060  0.0549    98.350  74.59
  13   0.0563     98.330  0.0516    98.443  80.66
  14   0.0423     98.690  0.0463    98.642  86.71
  15   0.0599     98.040  0.0472    98.582  92.80
  16   0.0386     98.880  0.0445    98.648  98.83
  17   0.0612     98.100  0.0437    98.665  104.88
  18   0.0389     98.780  0.0442    98.640  111.08
  19   0.0385     98.740  0.0435    98.660  117.13
  20   0.0587     98.170  0.0410    98.767  123.24
  21   0.0448     98.670  0.0433    98.705  129.29
  22   0.0424     98.680  0.0386    98.818  135.35
  23   0.0320     98.920  0.0407    98.755  141.39
  24   0.0461     98.590  0.0386    98.833  147.57
  25   0.0333     99.040  0.0396    98.833  153.63
  26   0.0386     98.900  0.0393    98.812  159.71
  27   0.0476     98.510  0.0379    98.858  165.75
  28   0.0501     98.450  0.0363    98.870  171.81
  29   0.0510     98.280  0.0376    98.853  177.85
  30   0.0365     98.780  0.0381    98.853  184.00
  31   0.0285     99.060  0.0340    98.923  190.04
  32   0.0409     98.760  0.0368    98.880  196.12
  33   0.0471     98.410  0.0328    99.005  202.19
  34   0.0325     98.990  0.0351    98.953  208.25
  35   0.0384     98.830  0.0341    98.965  214.29
  36   0.0285     99.030  0.0349    98.948  220.39
  37   0.0300     99.080  0.0324    99.043  226.51
  38   0.0369     98.780  0.0326    99.025  232.57
  39   0.0377     98.670  0.0330    99.003  238.62
  40   0.0452     98.550  0.0320    99.065  244.68
  41   0.0375     98.790  0.0344    98.977  250.75
  42   0.0423     98.650  0.0307    99.060  256.93
  43   0.0305     99.010  0.0319    99.065  262.97
  44   0.0304     99.020  0.0302    99.083  269.03
  45   0.0375     98.790  0.0312    99.068  275.10
  46   0.0321     99.000  0.0298    99.123  281.17
  47   0.0374     98.840  0.0300    99.097  287.20
  48   0.0334     99.010  0.0307    99.063  293.34
  49   0.0325     98.910  0.0304    99.068  299.40
  50   0.0315     99.020  0.0289    99.117  305.45
  51   0.0310     99.050  0.0275    99.122  311.50
  52   0.0517     98.430  0.0280    99.182  317.57
  53   0.0387     98.820  0.0304    99.108  323.74
  54   0.0337     98.890  0.0275    99.180  329.79
  55   0.0379     98.870  0.0271    99.153  335.89
  56   0.0312     99.000  0.0281    99.165  341.96
  57   0.0376     98.900  0.0283    99.125  348.01
  58   0.0342     98.920  0.0283    99.187  354.08
  59   0.0371     98.890  0.0286    99.147  360.21
  60   0.0378     98.820  0.0269    99.157  366.28
  61   0.0322     98.920  0.0270    99.190  372.33
  62   0.0286     99.060  0.0277    99.110  378.44
  63   0.0329     99.010  0.0297    99.100  384.54
  64   0.0365     98.820  0.0264    99.242  390.69
  65   0.0292     99.040  0.0260    99.192  396.74
  66   0.0299     99.000  0.0263    99.232  402.78
  67   0.0404     98.850  0.0269    99.177  408.83
  68   0.0421     98.730  0.0253    99.250  414.91
  69   0.0285     99.130  0.0265    99.202  420.96
  70   0.0321     98.990  0.0272    99.188  427.13
  71   0.0344     98.870  0.0259    99.227  433.23
  72   0.0356     98.860  0.0264    99.197  439.30
  73   0.0392     98.750  0.0242    99.275  445.35
  74   0.0362     98.780  0.0270    99.223  451.41
  75   0.0293     99.130  0.0247    99.270  457.59
  76   0.0336     98.900  0.0277    99.163  463.65
  77   0.0299     99.010  0.0270    99.203  469.70
  78   0.0387     98.720  0.0248    99.273  475.75
  79   0.0295     98.970  0.0241    99.270  481.80
  80   0.0346     98.870  0.0254    99.255  487.84
  81   0.0389     98.710  0.0254    99.230  493.97
  82   0.0295     99.100  0.0232    99.312  500.02
  83   0.0347     99.040  0.0244    99.260  506.07
  84   0.0457     98.500  0.0262    99.228  512.13
  85   0.0306     99.010  0.0257    99.242  518.21
  86   0.0271     99.060  0.0248    99.282  524.25
  87   0.0336     98.940  0.0241    99.282  530.30
  88   0.0283     99.140  0.0255    99.247  536.48
  89   0.0347     99.000  0.0232    99.300  542.53
  90   0.0414     98.830  0.0241    99.288  548.58
