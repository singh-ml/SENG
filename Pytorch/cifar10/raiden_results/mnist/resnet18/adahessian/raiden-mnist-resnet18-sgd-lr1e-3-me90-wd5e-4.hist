Use GPU: 0 for training
==> Running with ['main_adahessian.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 6742119936 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.3325     63.660  1.8941    36.677  30.36
   2   0.5231     84.600  0.8789    75.673  58.93
   3   0.3578     88.780  0.4637    85.795  87.48
   4   0.2611     91.780  0.3408    89.533  116.00
   5   0.2071     93.640  0.2648    91.913  144.63
   6   0.1707     94.540  0.2129    93.547  173.19
   7   0.1374     95.590  0.1766    94.607  201.77
   8   0.1152     96.410  0.1501    95.478  230.34
   9   0.1064     96.540  0.1327    96.020  258.88
  10   0.0944     97.140  0.1192    96.393  287.42
  11   0.0867     97.320  0.1093    96.660  315.96
  12   0.0814     97.480  0.0992    96.982  344.51
  13   0.0744     97.600  0.0936    97.175  373.04
  14   0.0723     97.800  0.0855    97.392  401.63
  15   0.0696     97.730  0.0810    97.523  430.15
  16   0.0622     98.080  0.0774    97.670  458.71
  17   0.0621     98.050  0.0753    97.703  487.26
  18   0.0637     97.990  0.0702    97.892  515.80
  19   0.0643     97.910  0.0675    97.957  544.33
  20   0.0604     98.070  0.0630    98.035  572.89
  21   0.0584     98.140  0.0620    98.063  601.41
  22   0.0545     98.190  0.0602    98.152  629.95
  23   0.0513     98.430  0.0572    98.272  658.48
  24   0.0506     98.400  0.0551    98.310  687.04
  25   0.0503     98.460  0.0537    98.358  715.58
  26   0.0501     98.410  0.0522    98.410  744.11
  27   0.0457     98.520  0.0502    98.420  772.65
  28   0.0440     98.600  0.0492    98.437  801.23
  29   0.0468     98.420  0.0473    98.475  829.88
  30   0.0474     98.500  0.0467    98.595  858.41
  31   0.0462     98.530  0.0454    98.585  886.95
  32   0.0427     98.530  0.0450    98.558  915.46
  33   0.0491     98.300  0.0438    98.617  944.03
  34   0.0437     98.460  0.0415    98.737  972.58
  35   0.0411     98.620  0.0411    98.707  1001.09
  36   0.0433     98.610  0.0403    98.745  1029.61
  37   0.0423     98.660  0.0392    98.793  1058.17
  38   0.0395     98.710  0.0392    98.735  1086.73
  39   0.0379     98.660  0.0385    98.823  1115.28
  40   0.0402     98.680  0.0378    98.808  1143.80
  41   0.0401     98.800  0.0359    98.900  1172.32
  42   0.0386     98.730  0.0376    98.847  1200.90
  43   0.0396     98.750  0.0354    98.885  1229.45
  44   0.0391     98.600  0.0348    98.893  1258.00
  45   0.0365     98.780  0.0340    98.922  1286.54
  46   0.0340     98.820  0.0339    98.947  1315.09
  47   0.0367     98.780  0.0323    98.970  1343.69
  48   0.0362     98.760  0.0333    98.952  1372.28
  49   0.0400     98.660  0.0319    99.000  1400.81
  50   0.0400     98.560  0.0312    99.043  1429.34
  51   0.0350     98.760  0.0302    99.092  1457.96
  52   0.0340     98.880  0.0302    99.065  1486.54
  53   0.0322     98.980  0.0297    99.065  1515.11
  54   0.0381     98.740  0.0303    99.077  1543.65
  55   0.0362     98.790  0.0298    99.068  1572.18
  56   0.0340     98.890  0.0296    99.103  1600.76
  57   0.0339     98.830  0.0292    99.118  1629.35
  58   0.0365     98.790  0.0280    99.077  1657.89
  59   0.0380     98.810  0.0269    99.173  1686.44
  60   0.0336     98.880  0.0275    99.092  1714.98
  61   0.0377     98.660  0.0268    99.155  1743.52
  62   0.0357     98.830  0.0270    99.148  1772.11
  63   0.0340     99.000  0.0257    99.198  1800.71
  64   0.0332     98.920  0.0267    99.160  1829.29
  65   0.0351     98.880  0.0250    99.205  1857.81
  66   0.0319     98.970  0.0248    99.225  1886.32
  67   0.0326     98.910  0.0255    99.202  1914.92
  68   0.0367     98.800  0.0248    99.252  1943.48
  69   0.0357     98.850  0.0247    99.237  1972.08
  70   0.0365     98.780  0.0242    99.222  2000.60
  71   0.0329     98.980  0.0240    99.203  2029.16
  72   0.0329     98.930  0.0234    99.255  2057.70
  73   0.0341     98.860  0.0245    99.195  2086.26
  74   0.0318     98.880  0.0233    99.273  2114.81
  75   0.0322     98.940  0.0228    99.298  2143.38
  76   0.0344     98.930  0.0226    99.288  2171.92
  77   0.0346     98.900  0.0223    99.320  2200.49
  78   0.0287     99.050  0.0221    99.305  2229.04
  79   0.0326     99.000  0.0216    99.310  2257.59
  80   0.0364     98.820  0.0207    99.392  2286.15
  81   0.0313     98.880  0.0212    99.337  2314.72
  82   0.0335     98.930  0.0209    99.338  2343.30
  83   0.0356     98.760  0.0222    99.305  2371.88
  84   0.0306     99.000  0.0202    99.362  2400.45
  85   0.0354     98.880  0.0200    99.342  2429.05
  86   0.0326     99.010  0.0197    99.390  2457.68
  87   0.0314     99.010  0.0192    99.400  2486.29
  88   0.0305     99.040  0.0193    99.382  2514.92
  89   0.0335     98.920  0.0187    99.412  2543.49
  90   0.0337     98.930  0.0192    99.408  2572.09
