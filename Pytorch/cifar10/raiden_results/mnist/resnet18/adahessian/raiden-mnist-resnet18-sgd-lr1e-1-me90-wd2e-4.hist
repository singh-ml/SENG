Use GPU: 0 for training
==> Running with ['main_adahessian.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 6742119936 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1341     95.530  0.5221    84.913  30.51
   2   0.1312     95.930  0.0958    96.993  58.99
   3   0.0521     98.290  0.0772    97.603  87.48
   4   0.0643     97.910  0.0615    98.087  115.98
   5   0.0721     97.500  0.0612    98.123  144.47
   6   0.1051     96.410  0.0565    98.273  172.94
   7   0.0464     98.430  0.0517    98.422  201.47
   8   0.1346     95.530  0.0506    98.402  230.01
   9   0.0735     97.640  0.0503    98.403  258.52
  10   0.0547     98.140  0.0472    98.545  287.01
  11   0.0388     98.660  0.0463    98.520  315.55
  12   0.0578     98.200  0.0429    98.663  344.11
  13   0.0381     98.780  0.0395    98.748  372.67
  14   0.0461     98.430  0.0414    98.697  401.14
  15   0.0319     99.030  0.0416    98.642  429.62
  16   0.0412     98.680  0.0398    98.722  458.08
  17   0.0549     98.200  0.0393    98.780  486.52
  18   0.0429     98.690  0.0368    98.855  515.00
  19   0.0820     97.520  0.0363    98.847  543.50
  20   0.0494     98.630  0.0366    98.857  571.94
  21   0.0588     97.890  0.0362    98.842  600.37
  22   0.0593     98.140  0.0372    98.762  628.85
  23   0.0257     99.110  0.0354    98.860  657.31
  24   0.0551     98.130  0.0341    98.892  685.78
  25   0.0715     97.820  0.0334    98.945  714.22
  26   0.0328     98.930  0.0351    98.833  742.67
  27   0.0367     98.620  0.0328    98.953  771.10
  28   0.0340     98.830  0.0312    98.990  799.54
  29   0.0381     98.730  0.0336    98.973  827.99
  30   0.0326     98.910  0.0316    99.028  856.45
  31   0.0485     98.310  0.0310    99.008  884.90
  32   0.0479     98.520  0.0289    99.042  913.36
  33   0.0317     98.960  0.0300    99.048  941.81
  34   0.0409     98.840  0.0295    99.037  970.31
  35   0.0441     98.420  0.0312    98.998  998.74
  36   0.0361     98.940  0.0272    99.122  1027.18
  37   0.0451     98.570  0.0283    99.140  1055.65
  38   0.0335     98.850  0.0266    99.143  1084.12
  39   0.0329     99.010  0.0281    99.052  1112.59
  40   0.0380     98.870  0.0265    99.127  1141.04
  41   0.0327     98.950  0.0259    99.180  1169.48
  42   0.0325     98.970  0.0254    99.207  1197.94
  43   0.0374     98.830  0.0253    99.193  1226.40
  44   0.0449     98.430  0.0222    99.283  1254.87
  45   0.0322     98.980  0.0226    99.243  1283.31
  46   0.0278     99.010  0.0215    99.305  1311.75
  47   0.0313     99.060  0.0213    99.283  1340.20
  48   0.0355     98.840  0.0210    99.292  1368.66
  49   0.0466     98.440  0.0185    99.375  1397.12
  50   0.0341     98.980  0.0192    99.348  1425.62
  51   0.0264     99.230  0.0188    99.383  1454.07
  52   0.0485     98.650  0.0170    99.425  1482.54
  53   0.0364     98.920  0.0170    99.407  1511.00
  54   0.0318     99.080  0.0168    99.445  1539.47
  55   0.0315     99.000  0.0141    99.508  1567.96
  56   0.0323     98.930  0.0145    99.517  1596.41
  57   0.0315     98.990  0.0140    99.505  1624.86
  58   0.0278     99.160  0.0133    99.558  1653.31
  59   0.0296     99.060  0.0103    99.638  1681.80
  60   0.0273     99.270  0.0109    99.633  1710.29
  61   0.0247     99.150  0.0104    99.618  1738.72
  62   0.0261     99.220  0.0091    99.637  1767.22
  63   0.0270     99.260  0.0086    99.678  1795.72
  64   0.0264     99.300  0.0070    99.737  1824.19
  65   0.0333     98.960  0.0081    99.692  1852.66
  66   0.0265     99.250  0.0061    99.782  1881.11
  67   0.0277     99.220  0.0062    99.768  1909.58
  68   0.0267     99.230  0.0056    99.778  1938.03
  69   0.0251     99.310  0.0043    99.853  1966.52
  70   0.0259     99.350  0.0042    99.832  1994.98
  71   0.0297     99.330  0.0043    99.842  2023.47
  72   0.0316     99.190  0.0042    99.845  2051.95
  73   0.0270     99.360  0.0034    99.875  2080.42
  74   0.0351     99.100  0.0026    99.905  2108.87
  75   0.0369     99.080  0.0030    99.887  2137.33
  76   0.0329     99.210  0.0027    99.907  2165.81
  77   0.0358     99.130  0.0023    99.920  2194.27
  78   0.0345     99.190  0.0020    99.943  2222.76
  79   0.0368     99.150  0.0017    99.950  2251.24
  80   0.0350     99.210  0.0019    99.942  2279.72
  81   0.0352     99.290  0.0018    99.947  2308.19
  82   0.0387     99.110  0.0014    99.947  2336.65
  83   0.0370     99.190  0.0015    99.948  2365.12
  84   0.0363     99.200  0.0012    99.968  2393.59
  85   0.0363     99.250  0.0012    99.958  2422.06
  86   0.0395     99.140  0.0013    99.953  2450.53
  87   0.0370     99.210  0.0011    99.963  2478.97
  88   0.0395     99.150  0.0009    99.975  2507.43
  89   0.0396     99.170  0.0010    99.965  2535.91
  90   0.0387     99.170  0.0010    99.970  2564.36
