Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '24', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 5062004224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.1823     21.710  3.5800    15.260  11.15
   2   1.8692     33.020  4.6578    26.410  20.83
   3   1.6725     42.020  3.1042    33.398  30.38
   4   1.2576     66.490  2.7727    50.303  40.39
   5   1.0031     70.090  2.4144    63.443  50.58
   6   0.9382     72.280  2.3231    66.268  60.11
   7   86.0033     10.090  639.2376    50.188  69.69
   8   766.0700     11.560  163449.0281    11.375  79.22
   9   9419.5177      9.740  277358.7635    12.408  89.00
  10   723.9417      9.550  3677.6645    11.688  98.61
  11   201.4697     11.710  2792.6943    10.865  108.16
  12   711.7085      9.580  2129.1622    12.487  117.63
  13   768.8255      9.350  2122.2860    12.455  127.39
  14   907.5952      9.200  2134.2717    12.577  136.82
  15   923.2355      9.290  2160.0095    12.562  146.13
  16   369.3123     13.420  2147.1970    12.487  155.57
  17   829.1164      9.210  2122.0853    12.613  164.92
  18   579.2940     10.420  2137.3354    12.797  174.38
  19   443.6028     12.090  2140.7920    12.748  183.63
  20   971.9727      8.810  2147.2489    12.563  193.14
  21   629.2777     10.440  2132.4762    12.257  202.57
  22   502.9323     10.920  2146.4354    12.567  211.86
  23   385.8168     13.810  2149.9249    12.700  221.22
  24   867.4128      9.350  2120.7501    12.685  230.60
  25   675.5636      9.730  2163.1685    12.607  240.05
  26   1138.5324      8.890  2155.6683    12.700  249.41
  27   1657.0923      8.230  2158.9237    12.515  258.80
  28   807.4638      9.520  2134.0614    12.740  268.10
  29   1151.6598      8.570  2125.8021    12.545  277.36
  30   660.6645     10.620  2121.1024    12.643  286.72
  31   496.6745     12.230  2167.7166    12.615  296.29
  32   843.0992      9.550  2117.1867    12.788  305.51
  33   860.3334      9.050  2145.4114    12.537  315.23
  34   740.1052      9.820  2161.2592    12.512  324.66
  35   715.6852      9.480  2087.5465    12.635  334.02
  36   685.5770      9.600  2136.8683    12.182  343.35
  37   664.6072     10.380  2121.9835    12.510  352.72
  38   1183.0569      8.690  2106.4096    12.455  362.16
  39   805.6969      9.690  2130.1059    12.740  371.64
  40   985.6857      9.170  2123.2674    12.623  380.96
  41   1037.0867      8.550  2119.3873    13.060  390.33
  42   1161.3500      8.640  2134.6650    12.415  399.66
  43   1104.2822      8.570  2107.0867    12.995  409.14
  44   460.3816     10.980  2155.8377    12.698  418.50
  45   748.4331     11.110  2135.2726    12.585  427.74
  46   646.0490     10.860  2114.7619    12.537  437.23
  47   761.5490     10.130  2171.8328    12.910  446.62
  48   629.7059     10.680  2139.4985    12.642  455.93
  49   723.5706      9.910  2130.3885    12.802  465.17
  50   638.5658     10.450  2151.2651    12.727  474.69
  51   661.3121     10.390  2110.2449    12.330  484.09
  52   636.7674     11.200  2124.5614    12.498  493.38
  53   601.8966     11.190  2143.9358    12.437  502.79
  54   759.7166      9.210  2126.8931    12.555  512.44
  55   1031.2705      8.840  2183.5929    12.368  521.83
  56   843.3853      9.590  2110.4327    12.965  531.07
  57   1031.4696      8.500  2115.3943    12.593  540.49
  58   719.5153      9.490  2124.2884    13.125  549.71
  59   1058.5291      8.800  2138.2190    12.825  559.12
  60   678.0970     10.720  2106.1610    12.595  568.76
  61   874.2162      8.910  2135.0272    12.503  578.26
  62   449.4515     11.420  2120.3532    12.788  587.52
  63   721.8978      9.390  2117.5583    12.623  596.84
  64   563.4306     10.710  2129.6784    12.453  606.25
  65   953.3312      8.600  2134.2411    12.585  615.53
  66   911.9749      9.600  2153.3691    12.733  624.82
  67   747.6881      9.640  2126.6925    12.608  634.20
  68   669.9069     10.420  2183.5390    12.533  643.37
  69   664.6264     10.450  2123.9172    12.707  652.79
  70   815.2380      8.680  2123.2898    13.057  662.07
  71   932.7964      8.720  2154.6303    12.547  671.43
  72   899.6794      9.020  2131.4270    12.425  680.84
  73   681.1016     10.030  2142.7406    12.770  690.25
  74   623.8551     10.190  2163.0552    12.700  699.62
  75   412.3857     12.440  2147.9952    12.447  708.92
  76   984.4540      8.660  2131.9597    12.585  718.37
  77   999.2019      9.450  2125.0061    12.915  727.80
  78   534.5452     12.010  2126.7951    12.493  737.06
  79   557.1403     12.140  2122.5615    12.768  746.42
  80   670.9063      9.910  2139.7490    12.580  755.87
  81   1035.7876      9.450  2134.7144    12.492  765.60
  82   719.2477      9.660  2119.9838    12.713  774.94
  83   937.7378      9.540  2121.1261    12.528  784.31
  84   893.7907      9.270  2134.9688    12.685  793.72
  85   1022.5091      8.720  2119.3969    12.588  803.41
  86   844.2612      9.250  2115.5616    12.625  812.82
  87   881.4262      9.160  2136.8951    12.615  822.19
  88   968.1862      8.970  2121.9415    12.690  831.70
  89   599.4283     11.080  2134.6444    12.257  840.99
  90   405.0083     11.900  2115.5403    12.850  850.40
