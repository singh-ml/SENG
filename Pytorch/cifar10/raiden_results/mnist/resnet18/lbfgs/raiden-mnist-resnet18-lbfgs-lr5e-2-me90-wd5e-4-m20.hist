Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 4705085440 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3911      9.390  8.6686    10.265  10.61
   2   2.2277     16.560  8.7826    10.113  19.77
   3   1.9329     27.850  8.4035    22.397  29.08
   4   1.7587     36.770  8.0747    30.545  38.32
   5   1.5249     47.600  7.8926    40.328  47.47
   6   642.1210      9.580  19938.7545    49.995  56.59
   7   628372.5508     11.350  6439147.2887    11.413  65.91
   8   939236.0609     11.350  2046481.9851    11.492  75.14
   9   833962.9844     11.350  1895985.8641    11.328  84.38
  10   1359594.6531     11.350  1392936.1362    11.260  93.57
  11   442653.5531     11.350  880551.5843    11.128  103.07
  12   413703.6391     11.350  859216.6085    11.155  112.27
  13   428341.9477     11.350  859974.5842    11.123  121.48
  14   198714.2582     10.110  664853.4157    10.852  130.74
  15   211952.5557     10.380  440549.6529    10.685  140.06
  16   232963.5738     10.250  434669.8613    10.767  149.26
  17   158743.0918     10.200  449379.4278    10.440  158.41
  18   166.0616      8.380  42976.6187    10.933  167.76
  19   98.3388     10.170  1242.1525    11.737  177.00
  20   90.4224      8.490  1212.2450    11.272  186.19
  21   91.8987      8.680  1211.2280    11.382  195.49
  22   87.7596      8.020  1213.5111    11.617  204.69
  23   97.9840      9.560  1214.7623    11.458  214.13
  24   87.7769      8.460  1208.8488    11.320  223.36
  25   91.7868      9.650  1208.5825    11.720  232.44
  26   95.7452      8.850  1212.9995    11.635  241.79
  27   94.5407     12.510  1212.7855    11.557  250.93
  28   80.8092      8.100  1213.7966    11.492  260.13
  29   85.4740      8.360  1212.1194    11.562  269.62
  30   99.2883     13.780  1210.0321    11.388  278.91
  31   92.7713      8.130  1211.3420    11.620  288.02
  32   93.7767     11.390  1209.6078    11.925  297.52
  33   98.1801      9.250  1212.0585    11.663  306.71
  34   96.6454     13.180  1209.6502    11.543  316.03
  35   84.9490      8.920  1211.9421    11.560  325.14
  36   98.4216     15.670  1209.9220    11.313  334.70
  37   85.3615      8.530  1209.8958    11.500  343.90
  38   93.3770      9.640  1214.6217    11.612  353.26
  39   95.7486      8.350  1207.1541    11.483  362.46
  40   95.2616      8.420  1213.3879    11.625  371.60
  41   91.1218      7.850  1211.3011    11.470  380.72
  42   89.2355      8.400  1210.5432    11.503  389.96
  43   91.8101     10.130  1209.0994    11.355  399.10
  44   84.6914      8.120  1207.9019    11.537  408.51
  45   98.0705     11.800  1209.5682    11.800  417.73
  46   96.0242      8.740  1207.4976    11.623  427.32
  47   101.8528     10.080  1210.1687    11.652  436.48
  48   90.3131      7.600  1212.7235    11.425  445.71
  49   91.4087      8.640  1211.6088    11.463  454.86
  50   85.0604      8.740  1213.6997    11.590  464.49
  51   89.4548      9.300  1209.5409    12.000  473.73
  52   98.5302     11.380  1211.4855    11.608  482.89
  53   92.7663      8.730  1210.6276    11.592  492.34
  54   92.1355      8.760  1208.5229    11.438  501.54
  55   102.3431     11.550  1213.6294    11.667  510.70
  56   89.7002      8.510  1210.5792    11.675  519.85
  57   90.0967      7.960  1214.2542    11.485  529.53
  58   101.1780     13.760  1211.1583    11.577  539.07
  59   92.9416     10.270  1210.8224    11.647  548.15
  60   95.8086      9.230  1210.2806    11.470  557.60
  61   89.0547      9.910  1212.6151    11.473  567.31
  62   100.2353      8.580  1208.0068    11.303  576.53
  63   94.2917      9.510  1209.5139    11.783  585.68
  64   100.1423     11.560  1209.9347    11.883  594.86
  65   99.9156     15.670  1208.8437    11.457  604.08
  66   86.6235      8.420  1209.8818    11.710  613.28
  67   97.6157     10.420  1209.6661    11.592  622.47
  68   89.5792      8.400  1214.1721    11.500  631.67
  69   97.6200     10.650  1208.9032    11.525  640.92
  70   93.1397      8.250  1209.5451    11.552  650.08
  71   111.0039     15.810  1210.3844    11.712  659.22
  72   94.6870     10.020  1208.6253    11.695  668.30
  73   89.0535      8.900  1212.0127    11.388  677.60
  74   89.0348      7.990  1211.9942    11.523  687.09
  75   91.8180      8.190  1209.8486    11.348  696.17
  76   86.8599      8.470  1210.7318    11.522  705.34
  77   92.3803      7.830  1212.0197    12.007  714.73
  78   96.8548     11.120  1212.2254    11.853  724.00
  79   101.1366     12.980  1209.1781    11.483  733.19
  80   98.2266     14.050  1209.5515    11.507  742.44
  81   86.4653      8.650  1209.9846    11.822  751.62
  82   87.1985      8.400  1213.8574    11.760  760.80
  83   86.8405      8.900  1208.4623    11.740  770.03
  84   92.2440      9.050  1212.5538    11.675  779.36
  85   106.4287     14.310  1210.3471    11.607  788.49
  86   85.8391      8.410  1208.9524    11.617  797.63
  87   97.4399      8.510  1211.0312    11.438  806.80
  88   90.1117      8.220  1209.6775    11.497  816.49
  89   91.7282      8.940  1212.5572    11.763  826.03
  90   104.8400     15.210  1210.9208    11.330  835.19
