Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '24', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 5061739008 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3342     10.430  4.8402     9.845  11.34
   2   2.2285     15.980  4.8071    11.392  21.00
   3   2.1175     22.170  4.6513    21.743  30.59
   4   1.8058     36.070  5.0396    27.705  40.23
   5   1.7611     35.170  4.2947    36.553  49.99
   6   5.5037      9.820  321.3148    42.392  59.50
   7   0.7968     75.370  4.3517    57.520  69.07
   8   0.7133     78.440  3.3851    73.413  78.82
   9   106.6082      9.800  15176.1737    33.715  88.34
  10   264369065269657.5938     10.280  58041127055289072.0000    10.537  98.11
  11   52583703773184.0000     12.320  384820910782978.1875    14.220  107.73
  12   32166078368972.8008      8.080  152664709308729.7500    15.035  117.47
  13   25797065467494.3984     13.390  182805061952986.9688    15.077  127.05
  14   26187772723200.0000     14.790  138338308772136.3125    14.697  136.78
  15   24690510790656.0000     10.920  132822873617203.2031    16.362  146.40
  16   25807377635737.6016     10.750  127126413194035.2031    14.020  156.17
  17   25315639938252.8008     10.900  126096584554940.4531    13.888  165.79
  18   23551181730611.1992     11.010  126763662226645.5156    13.928  175.41
  19   15985709252608.0000     11.050  125404984554709.5156    13.247  184.90
  20   18812851375308.8008     17.150  125529621707057.0156    12.882  194.69
  21   20948144357376.0000     12.100  135609476134798.7031    15.128  204.34
  22   25642087265075.1992     12.560  131520904684461.2031    15.690  213.93
  23   20042017557708.8008     10.970  130154014386812.1875    15.143  223.54
  24   22684580164403.1992     11.350  129588100900245.2500    14.908  233.34
  25   22274080276480.0000     11.430  129301894874273.2188    15.042  242.96
  26   22521057797734.3984     11.240  128084971898296.1094    14.865  252.22
  27   23965908769177.6016     10.950  129535764053667.4062    14.965  261.51
  28   19055454624153.6016     11.250  128633014687038.0938    15.192  270.77
  29   18033347153100.8008     10.990  128680602117943.5625    15.090  280.02
  30   21381922580070.3984     11.000  130186564363320.6406    14.963  289.36
  31   20204667391180.8008     11.260  128651519420843.0312    15.153  299.18
  32   22147862023372.8008     10.780  128416256304672.6875    14.950  308.42
  33   19939140704665.6016     10.870  128398183245065.7969    14.858  317.73
  34   20447117947699.1992     10.950  129012439922574.7031    15.185  326.96
  35   22122305860403.1992     11.230  128593718591976.0312    15.333  336.42
  36   19843358025318.3984     10.860  127564941598754.8594    15.070  345.68
  37   18159259280998.3984     11.140  129896880598952.8438    15.067  355.01
  38   23064388055859.1992     11.150  128338619773328.8906    15.193  364.38
  39   20035885845708.8008     11.170  129536868708404.2969    15.103  373.69
  40   19969885818060.8008     11.200  129125433794106.8281    15.033  382.99
  41   16639381019033.5996     11.090  129675098618370.1719    14.995  392.28
  42   22596881737318.3984     10.930  128629833048656.6094    14.805  401.73
  43   20718103468441.6016     11.410  129161434772554.0781    15.050  411.11
  44   22906927408742.3984     11.460  128683023998313.6719    15.138  420.46
  45   16361930358784.0000     11.090  128651472980081.2969    14.930  429.76
  46   17250474629529.5996     11.230  128878833135110.5312    14.887  439.26
  47   18861455618867.1992     10.640  129119223118617.0625    14.785  448.57
  48   20180095598592.0000     11.390  127732376108358.8125    14.882  457.81
  49   21224580992204.8008     10.900  129249266246921.7969    14.983  467.19
  50   20052495066726.3984     11.120  128775855511403.8438    15.007  476.47
  51   20790851711795.1992     11.210  128215225098762.8906    14.873  485.72
  52   21056460383846.3984     10.760  129557047130138.1406    15.052  495.05
  53   19419118161100.8008     11.710  128869576859473.7031    15.072  504.33
  54   18974140602777.6016     11.080  128605610889512.3125    14.982  513.69
  55   23321374582374.3984     11.240  127563636081476.6250    15.008  523.02
  56   20764079967436.8008     11.280  128605223478607.5156    15.143  532.43
  57   18797672084275.1992     11.280  128668882554339.6719    15.057  541.72
  58   22141412638720.0000     11.160  128486924544287.5938    15.132  551.14
  59   20630886049382.3984     11.500  128490571839653.5781    15.070  560.49
  60   22142264161075.1992     11.410  129363650342824.8438    15.103  569.82
  61   25135226303283.1992     10.880  128291633859161.3281    15.025  579.14
  62   21145249939456.0000     10.890  129905851519132.8750    14.947  588.56
  63   19768051807027.1992     10.590  129700045303372.2500    14.995  597.88
  64   23356100313088.0000     11.600  128878397926988.2500    15.145  607.36
  65   17861071824486.3984     10.780  129469881354283.5781    15.215  616.80
  66   17776875995136.0000     11.130  129832513489009.2969    14.998  626.15
  67   19355939241984.0000     11.030  129255850054834.6562    15.102  635.48
  68   20210907840512.0000     11.230  128238015411762.1094    15.218  644.77
  69   20302704220569.6016     11.450  128377003723283.6094    15.047  654.22
  70   22221266649088.0000     11.320  128446112645608.0312    14.890  663.62
  71   22463256363008.0000     11.320  129124538676088.9219    14.985  672.85
  72   23489378785689.6016     10.840  129694464344621.7500    15.083  682.04
  73   20559532097536.0000     11.320  129969239732067.1250    14.707  691.32
  74   20097312613990.3984     10.860  128909142460877.8906    15.202  700.59
  75   19950489658982.3984     11.210  129668400332730.2812    14.912  710.04
  76   21522597366988.8008     10.760  127985857567687.3594    15.137  719.82
  77   19348207776563.1992     11.090  128162469107354.6875    14.727  729.23
  78   24007151301427.1992     11.410  128660368509877.9219    15.132  738.47
  79   20759025346150.3984     11.210  127833409074250.0781    14.900  747.69
  80   22421868098355.1992     11.310  127634182025895.7656    15.065  757.17
  81   16039654168985.5996     11.170  128633064947293.6875    15.183  766.51
  82   17349511865958.4004     11.790  128293449867856.6094    15.047  775.83
  83   20672984992972.8008     10.920  128464437720416.9531    15.152  785.16
  84   19035184817766.3984     11.490  128211020799825.7031    14.977  794.58
  85   17942738075648.0000     11.020  128505007134781.0000    14.852  803.79
  86   19009211393638.3984     11.200  128493442064349.1406    14.992  813.09
  87   18640481189888.0000     11.160  127304254182369.5000    15.232  822.47
  88   19100764759654.3984     11.470  129540366757940.2969    15.112  831.89
  89   21595615526912.0000     11.510  129227191035982.4375    14.980  841.16
  90   21846086778880.0000     11.410  129326642481544.1719    15.020  850.47
