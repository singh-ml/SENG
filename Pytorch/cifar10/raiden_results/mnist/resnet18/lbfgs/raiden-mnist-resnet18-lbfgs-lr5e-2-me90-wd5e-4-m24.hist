Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '24', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 5058725888 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3719      8.810  8.6385     9.098  11.33
   2   1.9870     24.550  8.7509    17.758  20.97
   3   19402.3335     11.350  7658652.2463    25.800  31.06
   4   577.8777      7.010  5332.0638    11.477  40.91
   5   431.7358     12.210  435403.5424    13.197  50.63
   6   679.6373     12.450  2620.6433    13.232  60.25
   7   275.1632     10.570  2296.2566    10.938  69.84
   8   195.9475      9.660  2157.1761    10.795  79.64
   9   154.1616     10.550  2094.9648    11.182  89.40
  10   124.4722     10.540  2080.6427    10.948  99.12
  11   244.4973     10.600  2063.3168    10.710  108.94
  12   153.1623     10.620  2067.2686    10.913  118.55
  13   225.8491      9.780  2239.8236    10.572  128.21
  14   279.7923      9.760  2097.7010    10.292  137.79
  15   243.5401      9.810  2075.6190    10.527  147.29
  16   181.7841      9.810  2083.4497    10.293  156.60
  17   246.9364      9.780  2074.0525    10.715  165.97
  18   302.5865      9.810  2072.2342    10.647  175.36
  19   424.7924     10.120  2075.8981    10.408  184.91
  20   417.8690      9.830  2078.5469    10.525  194.25
  21   324.5757      9.670  2079.5180    10.500  203.65
  22   161.4225      9.820  2074.1070    10.445  213.07
  23   281.4489      9.810  2073.9845    10.522  222.57
  24   332.4532      9.720  2075.2676    10.628  231.96
  25   309.6977      9.800  2094.0758    10.252  241.41
  26   316.3710      9.800  2085.9394    10.493  250.77
  27   429.4825      9.670  2067.3826    10.498  260.31
  28   255.2435      9.800  2076.0197    10.317  269.67
  29   312.5327      9.820  2075.4933    10.565  279.06
  30   429.9123      9.750  2063.7952    10.338  288.43
  31   178.9741      9.820  2066.8961    10.433  297.83
  32   196.4082      9.820  2058.5649    10.450  307.14
  33   443.6148      9.740  2089.4310    10.652  316.60
  34   159.0889      9.820  2081.0394    10.397  326.14
  35   417.1645      9.710  2078.9868    10.303  335.55
  36   516.2662      9.700  2067.7296    10.437  344.88
  37   145.3756      9.820  2068.3390    10.342  354.25
  38   207.7035      9.810  2074.3922    10.528  363.82
  39   210.5816      9.790  2074.7508    10.550  373.18
  40   268.4194      9.790  2062.9381    10.640  382.57
  41   657.4254      9.800  2079.7283    10.358  391.91
  42   171.2187      9.820  2070.7307    10.448  401.39
  43   452.0703      9.720  2081.9919    10.382  410.79
  44   283.1969      9.770  2074.9057    10.615  420.51
  45   374.9947      9.670  2078.4959    10.458  430.03
  46   775.6472     10.100  2093.1827    10.473  439.41
  47   224.5300      9.790  2066.2255    10.622  448.76
  48   278.2699      9.810  2064.7269    10.398  458.15
  49   219.2327      9.770  2093.7045    10.580  467.63
  50   220.6553      9.820  2065.9632    10.453  477.01
  51   203.9854      9.770  2070.3682    10.735  486.42
  52   415.4603      9.740  2069.5929    10.250  495.79
  53   423.4990      9.810  2073.0782    10.547  505.27
  54   403.5564      9.730  2083.1319    10.408  514.77
  55   263.8054      9.860  2077.9808    10.428  524.18
  56   480.6921      9.730  2066.5789    10.590  533.55
  57   201.3626      9.800  2073.0243    10.528  542.99
  58   214.1533      9.780  2078.8799    10.527  552.38
  59   193.9470      9.820  2086.5918    10.342  561.71
  60   258.0602      9.810  2082.8013    10.640  571.07
  61   262.1678      9.720  2094.0257    10.620  580.69
  62   290.1681      9.820  2073.1446    10.568  590.15
  63   467.9218      9.660  2070.0550    10.785  599.87
  64   362.1615      9.730  2080.6960    10.413  609.31
  65   488.9023      9.730  2061.3259    10.512  618.72
  66   168.7533      9.810  2076.6051    10.465  628.07
  67   364.8405      9.800  2062.6359    10.462  637.42
  68   316.8427      9.800  2082.7383    10.575  646.96
  69   190.5697      9.790  2074.8766    10.575  656.68
  70   215.4419      9.840  2067.8110    10.397  666.06
  71   365.7961      9.740  2074.3158    10.567  675.42
  72   336.4620      9.810  2078.4350    10.523  684.96
  73   239.0792      9.730  2077.7962    10.677  694.30
  74   270.9117      9.800  2064.9380    10.415  703.64
  75   385.4060      9.720  2075.6237    10.603  713.20
  76   229.5768      9.800  2072.8002    10.358  722.59
  77   364.1089      9.680  2077.8549    10.502  731.94
  78   270.3659      9.830  2087.7306    10.347  741.30
  79   237.3350      9.790  2079.7338    10.778  750.85
  80   267.4137      9.810  2083.1482    10.565  760.19
  81   276.8115      9.790  2074.2530    10.523  769.63
  82   238.5705      9.800  2077.5457    10.302  779.06
  83   255.7662      9.720  2083.8014    10.368  788.58
  84   226.0063      9.780  2078.4628    10.617  798.05
  85   356.3382      9.760  2060.5745    10.422  807.46
  86   289.8894      9.780  2080.7334    10.582  816.82
  87   186.9215      9.790  2079.1319    10.425  826.33
  88   445.6694      9.710  2087.6081    10.660  835.72
  89   488.4554      9.740  2080.4679    10.650  845.06
  90   342.6993      9.770  2066.4593    10.680  854.47
