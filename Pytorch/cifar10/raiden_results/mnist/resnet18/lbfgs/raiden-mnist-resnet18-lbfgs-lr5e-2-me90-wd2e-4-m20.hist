Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 4701422592 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2811     15.680  4.8050    13.248  10.99
   2   2.0784     22.880  4.6634    21.885  20.39
   3   1.9864     27.620  4.4980    27.893  29.70
   4   1.9852     27.690  4.4919    27.887  38.93
   5   1.9866     27.790  4.4913    28.042  48.12
   6   1.9876     27.430  4.4905    28.192  57.51
   7   1.9871     27.480  4.4908    28.060  66.74
   8   1.9856     27.720  4.4903    27.952  76.04
   9   1.9860     27.690  4.4927    27.995  85.35
  10   1.9856     27.790  4.4918    28.092  94.77
  11   1.9835     27.830  4.4919    28.128  103.98
  12   1.9860     27.730  4.4925    27.820  113.21
  13   1.9861     27.690  4.4914    28.060  122.45
  14   1.9877     27.500  4.4916    28.222  131.90
  15   1.9874     27.530  4.4908    28.127  141.17
  16   1.9831     27.720  4.4903    27.990  150.27
  17   1.9842     27.860  4.4922    27.793  159.51
  18   1.9840     27.870  4.4901    28.035  168.82
  19   1.9859     27.690  4.4911    28.207  178.03
  20   1.9876     27.520  4.4903    28.113  187.28
  21   1.9868     27.630  4.4891    28.058  196.46
  22   1.9849     27.710  4.4906    28.208  205.86
  23   1.9860     27.670  4.4918    27.932  215.08
  24   1.9881     27.290  4.4918    27.877  224.27
  25   1.9876     27.510  4.4923    27.935  233.58
  26   1.9877     27.480  4.4897    28.183  243.17
  27   1.9839     27.850  4.4905    28.192  252.41
  28   1.9855     27.780  4.4899    28.290  261.67
  29   1.9844     27.690  4.4921    27.897  271.14
  30   1.9885     27.410  4.4910    28.328  280.34
  31   1.9869     27.650  4.4909    28.010  289.71
  32   1.9857     27.680  4.4913    28.100  299.02
  33   1.9868     27.550  4.4889    28.103  308.25
  34   1.9852     27.850  4.4923    27.997  317.59
  35   1.9857     27.710  4.4906    28.122  326.84
  36   1.9857     27.780  4.4900    28.258  336.24
  37   1.9864     27.630  4.4915    28.270  345.53
  38   1.9844     27.770  4.4917    27.903  354.82
  39   1.9842     27.800  4.4910    28.067  364.11
  40   1.9854     27.720  4.4916    28.115  373.41
  41   1.9845     27.800  4.4897    28.155  382.66
  42   1.9863     27.690  4.4920    27.878  391.88
  43   1.9876     27.350  4.4917    28.015  401.17
  44   1.9863     27.680  4.4904    28.178  410.46
  45   1.9880     27.490  4.4901    28.158  419.71
  46   1.9849     27.780  4.4910    27.940  428.93
  47   1.9857     27.710  4.4902    28.143  438.10
  48   1.9843     27.810  4.4901    28.087  447.42
  49   1.9835     27.930  4.4905    28.185  456.58
  50   1.9871     27.580  4.4899    28.257  465.73
  51   1.9848     27.800  4.4907    28.222  474.98
  52   1.9852     27.760  4.4909    28.152  484.45
  53   1.9865     27.650  4.4910    28.087  493.70
  54   1.9854     27.740  4.4928    27.845  503.13
  55   1.9877     27.450  4.4920    28.180  512.33
  56   1.9867     27.640  4.4907    28.348  521.68
  57   1.9864     27.520  4.4917    28.087  530.79
  58   1.9856     27.770  4.4900    28.267  539.97
  59   1.9839     27.820  4.4909    28.283  549.31
  60   1.9879     27.400  4.4901    28.170  558.56
  61   1.9865     27.600  4.4919    28.043  567.81
  62   1.9841     27.680  4.4911    27.938  577.05
  63   1.9838     27.700  4.4910    28.132  586.44
  64   1.9858     27.790  4.4908    28.227  595.80
  65   1.9854     27.770  4.4913    28.010  605.03
  66   1.9853     27.730  4.4903    28.228  614.21
  67   1.9850     27.760  4.4907    27.975  623.64
  68   1.9843     27.800  4.4914    28.003  632.97
  69   1.9861     27.720  4.4904    28.237  642.11
  70   1.9851     27.880  4.4907    28.133  651.28
  71   1.9875     27.540  4.4910    28.082  660.62
  72   1.9858     27.690  4.4912    28.212  669.88
  73   1.9875     27.480  4.4918    27.938  679.15
  74   1.9853     27.710  4.4919    27.882  688.42
  75   1.9863     27.740  4.4922    28.112  697.88
  76   1.9892     27.300  4.4907    27.702  707.10
  77   1.9854     27.760  4.4894    28.277  716.41
  78   1.9850     27.850  4.4906    28.125  725.62
  79   1.9860     27.510  4.4901    28.278  735.02
  80   1.9853     27.660  4.4894    28.160  744.27
  81   1.9849     27.830  4.4897    28.223  753.77
  82   1.9859     27.700  4.4919    27.977  763.29
  83   1.9854     27.760  4.4919    28.108  772.91
  84   1.9870     27.560  4.4923    27.888  782.19
  85   1.9862     27.680  4.4924    28.075  791.33
  86   1.9842     27.850  4.4913    28.055  800.72
  87   1.9849     27.740  4.4917    28.035  809.92
  88   1.9857     27.720  4.4916    28.022  819.10
  89   1.9851     27.730  4.4895    28.253  828.35
  90   1.9855     27.720  4.4905    28.238  837.63
