Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3842544128 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   768.0399     11.350  757.2238    16.428  9.91
   2   24890.2094     12.760  116546362.6569    10.450  18.31
   3   25361.1240     12.980  127573.2381    10.642  26.68
   4   30591.5138     12.380  128229.1101    10.737  35.04
   5   35679.3550     11.900  128294.3743    10.805  43.29
   6   48588.5909     10.170  171581.5378    10.373  51.85
   7   16994.1390     14.510  104163.8895    10.392  60.10
   8   22298.0450     14.840  96367.0341    10.985  68.41
   9   14138.0162     13.770  96232.0671    10.755  76.42
  10   18374.0364     14.260  96686.1199    10.775  84.58
  11   15405.9809     13.620  95986.1284    10.833  92.62
  12   18968.4845     14.360  96229.2556    10.803  100.60
  13   14896.0791     13.770  96537.6915    10.947  108.62
  14   15268.7038     13.940  96604.4389    10.643  116.75
  15   17103.4748     14.430  95694.9887    10.867  124.75
  16   16012.1096     14.590  97384.0020    10.775  132.69
  17   13183.7824     13.410  96543.4659    10.723  140.57
  18   12360.1320     13.620  96210.1722    10.672  148.37
  19   17875.6099     14.790  95743.8005    11.095  156.51
  20   17817.2974     14.890  96380.2262    10.817  164.49
  21   13082.5298     13.110  97099.5533    10.847  172.48
  22   12250.1914     13.170  95660.8700    10.760  180.44
  23   14809.6318     13.840  96231.3533    10.900  188.49
  24   12693.5168     13.030  96167.2028    10.880  196.63
  25   14443.8024     13.490  96636.4601    10.882  204.55
  26   11667.1124     13.550  95760.2657    10.933  212.60
  27   16001.0406     14.100  96445.1795    10.893  220.64
  28   16129.4357     14.120  95913.0643    10.908  228.80
  29   12356.1896     13.000  96345.0283    10.788  236.87
  30   13123.6422     13.680  96306.3877    10.925  244.87
  31   14317.8224     13.400  95839.5459    10.887  252.92
  32   13255.6371     13.580  94845.5800    10.848  261.01
  33   16229.5671     14.170  96637.0151    10.855  269.12
  34   12215.1507     13.580  96356.1076    10.970  277.42
  35   16558.0397     13.970  96141.8618    10.968  285.47
  36   15823.4374     14.130  96285.8374    11.048  293.76
  37   22099.8554     14.700  96857.6784    10.717  301.81
  38   14060.2257     13.750  96432.5902    10.720  309.91
  39   11956.4474     13.510  96274.3191    10.832  317.95
  40   16157.3036     14.100  96129.2627    10.897  325.94
  41   14956.5850     14.180  96803.0537    10.697  334.06
  42   14360.8893     13.090  95828.3360    10.707  342.12
  43   17062.2019     14.230  95266.4152    10.803  350.21
  44   12361.5167     13.660  96069.8681    10.882  358.24
  45   19604.6122     14.600  96409.9058    10.908  366.30
  46   14829.2625     13.960  95873.7078    10.957  374.21
  47   14834.6710     13.570  96448.2198    10.638  382.10
  48   18448.9740     14.100  97375.3046    10.987  390.11
  49   12585.3022     13.480  96125.9272    10.763  398.24
  50   16941.6572     14.410  96617.4872    10.852  406.24
  51   14756.2210     13.450  95927.9657    10.913  414.14
  52   15839.4700     14.370  97185.0505    10.605  422.15
  53   19699.8171     14.320  96785.7060    10.712  430.29
  54   17199.0279     14.310  95721.9536    10.733  438.20
  55   9840.6394     13.040  96199.3660    10.883  446.20
  56   14861.3486     13.820  96117.1868    10.713  454.19
  57   10814.2133     13.500  95880.5441    10.952  462.07
  58   15619.5426     13.960  96742.5989    10.623  470.14
  59   21470.8735     14.750  97155.0326    10.933  478.08
  60   15652.7558     13.570  95855.2571    10.782  486.01
  61   10340.2858     13.090  96476.6767    10.912  493.95
  62   12296.3935     13.260  96397.6507    11.213  501.91
  63   12019.6120     13.130  95858.4126    10.880  510.04
  64   10692.3231     13.120  95655.6789    11.062  517.89
  65   14941.2629     13.860  95497.1604    10.935  525.87
  66   14348.3034     13.870  95860.1510    10.975  533.77
  67   16028.8146     14.930  96562.1959    10.908  541.82
  68   10303.4272     12.770  96132.0772    10.860  549.76
  69   13136.1496     13.550  95316.2635    10.982  557.79
  70   16359.1407     13.760  96180.2599    10.893  565.83
  71   18813.6477     14.300  96045.5046    10.930  573.73
  72   16602.7153     14.570  96201.5710    10.807  581.90
  73   15719.4942     13.870  95457.0905    10.958  589.84
  74   18081.1471     13.850  95272.3906    10.783  597.87
  75   22588.0020     14.680  95987.3740    10.860  605.90
  76   15150.5914     14.000  95584.1629    10.922  613.91
  77   14727.8134     14.160  96176.8937    10.887  622.00
  78   11341.2695     13.110  96088.2510    10.732  630.36
  79   11594.7644     13.090  96031.4191    10.813  638.39
  80   14662.3197     13.910  96021.7836    11.047  646.45
  81   14071.2631     13.590  95605.9424    11.162  654.59
  82   15038.9860     13.800  96083.1473    10.683  662.67
  83   15566.7475     14.090  95639.7138    10.768  670.60
  84   15933.6525     13.860  96330.3030    10.672  678.69
  85   13329.9158     13.520  96144.5996    10.868  686.80
  86   16693.4680     13.810  96857.5071    10.740  694.80
  87   12515.9449     13.420  95679.7641    10.933  702.80
  88   14173.4258     13.920  96262.8595    10.967  710.78
  89   16508.1281     14.250  96213.3394    11.063  719.23
  90   13903.4667     14.160  95659.1000    10.808  727.25
