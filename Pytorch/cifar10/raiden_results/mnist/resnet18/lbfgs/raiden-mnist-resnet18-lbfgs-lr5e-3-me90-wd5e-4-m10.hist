Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3842544128 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3905      7.960  8.6431     9.227  9.47
   2   2.3913      8.020  8.6438     8.998  17.34
   3   2.3913      7.980  8.6441     9.138  25.32
   4   2.3911      8.060  8.6434     9.343  33.27
   5   2.3901      8.070  8.6430     9.213  41.22
   6   2.3904      8.060  8.6420     9.512  49.13
   7   2.3904      8.090  8.6432     9.058  56.96
   8   2.3909      8.030  8.6434     9.093  64.87
   9   2.3907      8.060  8.6441     8.963  73.02
  10   2.3911      8.040  8.6438     9.107  81.00
  11   2.3906      8.040  8.6439     8.973  89.27
  12   2.3913      8.060  8.6428     9.080  97.26
  13   2.3913      8.020  8.6432     9.043  105.33
  14   2.3900      7.990  8.6427     9.140  113.24
  15   2.3900      8.030  8.6435     8.995  121.24
  16   2.3906      8.050  8.6439     9.148  129.18
  17   2.3912      8.030  8.6430     9.027  137.31
  18   2.3903      8.110  8.6440     8.990  145.31
  19   2.3917      8.090  8.6435     8.997  153.35
  20   2.3905      8.090  8.6425     9.187  161.37
  21   2.3911      8.080  8.6433     9.215  169.56
  22   2.3908      8.040  8.6447     8.985  177.41
  23   2.3907      8.050  8.6428     9.158  185.39
  24   2.3922      8.020  8.6439     9.198  193.31
  25   2.3905      8.060  8.6427     9.210  201.30
  26   2.3914      8.080  8.6440     9.103  209.22
  27   2.3918      7.990  8.6431     9.178  217.13
  28   2.3904      8.060  8.6440     9.095  225.08
  29   2.3913      8.140  8.6437     8.982  232.95
  30   2.3913      8.040  8.6428     9.182  240.97
  31   2.3910      7.990  8.6435     9.227  248.94
  32   2.3907      8.040  8.6440     9.095  256.83
  33   2.3912      8.110  8.6432     9.060  264.81
  34   2.3902      8.100  8.6429     9.112  272.75
  35   2.3907      8.050  8.6437     8.858  280.71
  36   2.3910      7.980  8.6430     9.210  288.68
  37   2.3906      7.960  8.6434     9.075  296.70
  38   2.3906      8.070  8.6440     8.950  304.62
  39   2.3913      8.060  8.6438     9.220  312.66
  40   2.3908      8.110  8.6428     8.990  320.58
  41   2.3912      8.100  8.6434     9.238  328.48
  42   2.3915      8.070  8.6430     9.222  336.38
  43   2.3912      8.060  8.6439     9.207  345.05
  44   2.3909      8.010  8.6431     9.083  353.45
  45   2.3909      8.100  8.6431     9.115  361.34
  46   2.3903      8.100  8.6431     9.075  369.24
  47   2.3914      8.050  8.6428     9.115  377.11
  48   2.3918      8.080  8.6427     9.027  385.20
  49   2.3900      8.060  8.6433     9.143  393.16
  50   2.3910      8.070  8.6430     9.227  401.05
  51   2.3907      8.070  8.6441     8.950  408.96
  52   2.3911      8.050  8.6435     9.093  417.08
  53   2.3908      8.050  8.6441     9.068  425.04
  54   2.3907      8.010  8.6432     9.120  433.08
  55   2.3901      8.030  8.6433     9.073  441.11
  56   2.3901      8.050  8.6432     9.055  449.13
  57   2.3906      8.010  8.6423     9.258  457.02
  58   2.3906      7.980  8.6437     9.130  465.31
  59   2.3906      8.070  8.6424     9.178  473.34
  60   2.3914      8.070  8.6443     9.123  481.31
  61   2.3911      8.020  8.6428     8.987  489.29
  62   2.3910      8.010  8.6432     9.252  497.13
  63   2.3916      8.090  8.6435     8.993  504.93
  64   2.3911      8.070  8.6426     9.238  512.87
  65   2.3913      8.000  8.6429     9.112  520.96
  66   2.3906      8.070  8.6431     9.000  528.83
  67   2.3906      8.070  8.6433     9.113  536.75
  68   2.3908      8.000  8.6430     9.095  545.13
  69   2.3908      8.040  8.6432     9.075  553.05
  70   2.3908      8.010  8.6440     9.078  561.12
  71   2.3915      8.080  8.6432     9.080  569.02
  72   2.3907      8.080  8.6438     9.118  577.25
  73   2.3911      8.010  8.6436     9.027  585.20
  74   2.3907      8.070  8.6430     9.000  593.53
  75   2.3907      8.030  8.6439     8.997  601.55
  76   2.3909      7.970  8.6430     9.172  609.55
  77   2.3901      8.110  8.6433     8.952  617.55
  78   2.3911      8.050  8.6430     9.125  625.45
  79   2.3903      8.130  8.6435     8.983  633.56
  80   2.3906      8.050  8.6427     9.142  641.61
  81   2.3915      8.060  8.6432     9.070  649.46
  82   2.3905      8.050  8.6435     9.040  657.40
  83   2.3901      7.990  8.6427     9.118  665.49
  84   2.3901      8.040  8.6438     9.078  673.42
  85   2.3902      8.000  8.6437     9.172  681.28
  86   2.3906      8.110  8.6438     8.977  689.24
  87   2.3910      8.050  8.6431     9.043  697.20
  88   2.3911      8.030  8.6440     9.090  705.19
  89   2.3906      8.140  8.6440     9.067  713.22
  90   2.3905      8.090  8.6443     9.228  721.20
