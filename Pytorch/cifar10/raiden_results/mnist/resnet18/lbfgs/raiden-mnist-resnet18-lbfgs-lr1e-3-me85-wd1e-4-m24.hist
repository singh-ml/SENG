Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '-m', '24', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3842544128 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3650      7.980  3.6110     8.770  9.31
   2   2.3642      8.160  3.6112     8.450  16.94
   3   2.3640      8.100  3.6116     8.668  24.57
   4   2.3642      8.010  3.6122     8.638  32.19
   5   2.3648      8.020  3.6118     8.448  40.03
   6   2.3646      8.090  3.6110     8.678  47.74
   7   2.3641      8.130  3.6125     8.752  55.44
   8   2.3647      8.040  3.6116     8.535  63.15
   9   2.3640      8.040  3.6109     8.580  70.83
  10   2.3640      8.110  3.6114     8.563  78.54
  11   2.3648      8.000  3.6108     8.437  86.34
  12   2.3640      8.050  3.6112     8.635  93.92
  13   2.3647      8.050  3.6106     8.547  101.73
  14   2.3641      8.040  3.6113     8.748  109.71
  15   2.3645      8.010  3.6110     8.588  117.51
  16   2.3643      8.040  3.6109     8.650  125.09
  17   2.3643      8.000  3.6119     8.783  132.81
  18   2.3646      8.140  3.6116     8.682  140.84
  19   2.3642      8.120  3.6114     8.645  148.62
  20   2.3643      8.030  3.6116     8.620  156.30
  21   2.3634      8.190  3.6111     8.502  163.93
  22   2.3644      8.040  3.6118     8.675  171.64
  23   2.3648      8.030  3.6110     8.620  179.43
  24   2.3646      8.100  3.6116     8.597  187.12
  25   2.3633      8.050  3.6120     8.532  194.83
  26   2.3643      8.170  3.6124     8.430  202.49
  27   2.3652      8.030  3.6115     8.648  210.37
  28   2.3650      8.090  3.6110     8.665  217.99
  29   2.3640      8.040  3.6118     8.658  225.67
  30   2.3641      8.030  3.6118     8.805  233.41
  31   2.3633      8.110  3.6120     8.510  241.11
  32   2.3636      8.030  3.6121     8.655  248.93
  33   2.3647      8.060  3.6111     8.678  256.58
  34   2.3639      8.090  3.6117     8.755  264.27
  35   2.3644      7.990  3.6116     8.602  271.97
  36   2.3647      8.110  3.6107     8.453  279.84
  37   2.3633      8.120  3.6115     8.727  287.54
  38   2.3644      8.060  3.6109     8.588  295.56
  39   2.3639      8.030  3.6111     8.522  303.18
  40   2.3646      8.020  3.6110     8.665  310.92
  41   2.3639      8.060  3.6101     8.627  318.72
  42   2.3642      8.050  3.6125     8.467  326.56
  43   2.3645      7.990  3.6122     8.683  334.21
  44   2.3645      8.110  3.6119     8.640  341.95
  45   2.3644      8.020  3.6111     8.717  349.78
  46   2.3642      8.030  3.6107     8.593  357.47
  47   2.3638      8.030  3.6108     8.590  365.23
  48   2.3638      8.060  3.6124     8.597  373.17
  49   2.3641      8.130  3.6112     8.458  380.90
  50   2.3642      8.070  3.6120     8.567  388.68
  51   2.3647      8.030  3.6121     8.520  396.37
  52   2.3636      8.040  3.6107     8.728  404.19
  53   2.3645      8.130  3.6116     8.532  411.93
  54   2.3644      8.130  3.6121     8.538  419.64
  55   2.3639      8.030  3.6122     8.520  427.43
  56   2.3645      7.950  3.6113     8.587  435.11
  57   2.3643      8.060  3.6105     8.708  442.81
  58   2.3644      8.030  3.6118     8.560  450.56
  59   2.3641      8.100  3.6125     8.327  458.34
  60   2.3649      8.040  3.6116     8.678  465.96
  61   2.3645      8.090  3.6124     8.632  473.56
  62   2.3639      8.110  3.6119     8.440  481.20
  63   2.3647      8.040  3.6102     8.728  489.29
  64   2.3649      8.040  3.6121     8.610  496.93
  65   2.3647      8.070  3.6118     8.632  504.64
  66   2.3643      8.050  3.6122     8.652  512.24
  67   2.3643      8.020  3.6117     8.682  519.96
  68   2.3638      8.120  3.6122     8.635  527.77
  69   2.3637      8.120  3.6111     8.505  535.42
  70   2.3640      8.180  3.6121     8.540  543.08
  71   2.3642      8.050  3.6111     8.585  550.68
  72   2.3635      8.080  3.6103     8.668  558.56
  73   2.3637      8.100  3.6116     8.657  566.20
  74   2.3640      8.100  3.6116     8.663  573.82
  75   2.3643      8.090  3.6107     8.795  581.48
  76   2.3651      8.050  3.6110     8.775  589.20
  77   2.3643      8.180  3.6106     8.780  597.09
  78   2.3637      8.100  3.6124     8.655  604.77
  79   2.3638      8.190  3.6119     8.553  612.38
  80   2.3647      8.010  3.6113     8.647  620.02
  81   2.3635      8.050  3.6116     8.523  627.66
  82   2.3646      8.080  3.6113     8.630  635.52
  83   2.3645      8.050  3.6111     8.672  643.63
  84   2.3646      8.090  3.6112     8.635  651.38
  85   2.3633      8.030  3.6119     8.692  659.10
