Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3842544128 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.4670      9.450  3.7004     9.952  9.49
   2   2.4678      9.550  3.7006    10.033  17.10
   3   2.4670      9.470  3.6999    10.145  24.69
   4   2.4666      9.480  3.7015     9.998  32.52
   5   2.4667      9.500  3.7010     9.975  40.19
   6   2.4668      9.440  3.7008     9.923  47.89
   7   2.4675      9.540  3.7018     9.987  55.54
   8   2.4678      9.480  3.7013     9.930  63.16
   9   2.4677      9.440  3.7015     9.912  70.83
  10   2.4671      9.520  3.7014    10.102  78.69
  11   2.4671      9.550  3.7018     9.868  86.25
  12   2.4668      9.520  3.7011    10.088  93.91
  13   2.4677      9.520  3.7015     9.928  101.59
  14   2.4667      9.480  3.7012     9.975  109.24
  15   2.4674      9.520  3.7010    10.045  116.92
  16   2.4670      9.460  3.7011    10.047  124.57
  17   2.4682      9.460  3.7019     9.888  132.05
  18   2.4676      9.550  3.7003     9.940  139.67
  19   2.4670      9.530  3.7020     9.860  147.46
  20   2.4672      9.540  3.7011     9.942  155.14
  21   2.4670      9.500  3.7013     9.925  162.71
  22   2.4667      9.520  3.7016     9.838  170.38
  23   2.4683      9.540  3.7012     9.932  178.13
  24   2.4672      9.490  3.7016    10.012  185.80
  25   2.4679      9.520  3.7007    10.173  193.47
  26   2.4686      9.460  3.7012    10.012  201.20
  27   2.4668      9.510  3.7018     9.917  208.82
  28   2.4673      9.480  3.7012     9.953  216.55
  29   2.4676      9.460  3.7008    10.033  224.20
  30   2.4677      9.490  3.7017    10.018  231.85
  31   2.4681      9.460  3.7006     9.868  239.51
  32   2.4673      9.490  3.7019     9.940  247.22
  33   2.4675      9.470  3.7012     9.978  254.83
  34   2.4679      9.520  3.7016     9.948  262.38
  35   2.4690      9.460  3.7013     9.923  269.97
  36   2.4669      9.460  3.7013     9.937  277.69
  37   2.4660      9.510  3.7005    10.033  285.30
  38   2.4674      9.460  3.7017    10.003  293.01
  39   2.4683      9.520  3.7006    10.000  300.66
  40   2.4675      9.440  3.7012     9.868  308.21
  41   2.4679      9.480  3.7008    10.015  316.02
  42   2.4677      9.610  3.7019     9.903  323.65
  43   2.4682      9.510  3.7014     9.943  331.34
  44   2.4664      9.530  3.7011     9.957  339.00
  45   2.4673      9.550  3.7000    10.018  346.63
  46   2.4687      9.580  3.7013    10.120  354.25
  47   2.4676      9.510  3.7020     9.828  361.91
  48   2.4674      9.530  3.7014    10.018  369.58
  49   2.4672      9.480  3.7013     9.953  377.17
  50   2.4675      9.510  3.7006     9.873  385.00
  51   2.4673      9.490  3.7004     9.865  392.69
  52   2.4675      9.520  3.7012     9.935  400.28
  53   2.4674      9.500  3.7017     9.947  407.81
  54   2.4670      9.540  3.7010    10.045  415.42
  55   2.4680      9.560  3.7012    10.042  423.25
  56   2.4662      9.520  3.7016     9.813  431.25
  57   2.4671      9.500  3.7014     9.945  438.88
  58   2.4679      9.490  3.7009    10.135  446.77
  59   2.4670      9.520  3.7016     9.877  454.55
  60   2.4673      9.520  3.7009     9.928  462.25
  61   2.4684      9.460  3.7007     9.885  469.96
  62   2.4676      9.490  3.7004    10.035  477.66
  63   2.4676      9.470  3.7003     9.942  485.21
  64   2.4677      9.430  3.7017     9.857  492.89
  65   2.4666      9.540  3.7012     9.988  500.55
  66   2.4681      9.480  3.7014    10.098  508.22
  67   2.4683      9.540  3.7010    10.082  515.78
  68   2.4682      9.530  3.7014     9.992  523.59
  69   2.4673      9.510  3.7003     9.890  531.20
  70   2.4676      9.490  3.7011     9.975  538.78
  71   2.4669      9.510  3.7013     9.930  546.46
  72   2.4678      9.430  3.7015     9.845  554.10
  73   2.4679      9.520  3.7024     9.882  561.71
  74   2.4666      9.490  3.7016    10.053  569.32
  75   2.4669      9.530  3.7005    10.050  576.92
  76   2.4677      9.530  3.7010     9.902  584.56
  77   2.4677      9.490  3.7004    10.022  592.35
  78   2.4671      9.510  3.7005     9.923  599.93
  79   2.4667      9.440  3.7011     9.952  607.56
  80   2.4674      9.470  3.7017     9.883  615.21
  81   2.4675      9.490  3.7008    10.012  622.98
  82   2.4686      9.510  3.7017     9.942  630.97
  83   2.4667      9.530  3.7020     9.812  638.61
  84   2.4681      9.410  3.7011     9.955  646.28
  85   2.4678      9.510  3.7007     9.982  653.94
  86   2.4669      9.460  3.7014     9.983  661.74
  87   2.4679      9.450  3.7016     9.808  669.52
  88   2.4676      9.570  3.7011     9.938  677.21
  89   2.4672      9.510  3.7008     9.790  684.79
  90   2.4667      9.440  3.7011     9.890  692.42
