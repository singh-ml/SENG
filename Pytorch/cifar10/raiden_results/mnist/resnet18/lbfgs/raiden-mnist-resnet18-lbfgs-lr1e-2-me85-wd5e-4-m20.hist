Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3842888192 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3781     10.090  8.6094    10.892  9.49
   2   2.3780     10.150  8.6092    11.168  17.41
   3   2.3781     10.170  8.6092    11.080  25.63
   4   2.3782     10.090  8.6090    11.027  33.60
   5   2.3780     10.170  8.6090    10.950  41.92
   6   2.3775     10.160  8.6092    11.137  49.97
   7   2.3780     10.130  8.6094    11.107  58.12
   8   2.3788     10.100  8.6094    11.073  66.20
   9   2.3784     10.210  8.6098    11.015  74.16
  10   2.3785     10.150  8.6095    11.045  82.01
  11   2.3782     10.180  8.6090    11.013  89.90
  12   2.3783     10.110  8.6105    10.927  98.04
  13   2.3785     10.170  8.6099    11.145  105.98
  14   2.3786     10.060  8.6092    10.975  113.90
  15   2.3777     10.160  8.6088    11.035  121.86
  16   2.3782     10.130  8.6103    11.127  129.82
  17   2.3781     10.180  8.6100    10.960  137.85
  18   2.3782     10.050  8.6090    11.133  145.72
  19   2.3780     10.190  8.6083    11.125  153.58
  20   2.3782     10.120  8.6095    11.090  161.61
  21   2.3779     10.160  8.6093    10.865  169.64
  22   2.3784     10.170  8.6103    11.135  177.54
  23   2.3777     10.230  8.6090    11.063  185.58
  24   2.3781     10.180  8.6103    10.867  193.60
  25   2.3779     10.170  8.6094    11.045  201.66
  26   2.3776     10.210  8.6091    11.068  209.68
  27   2.3783     10.160  8.6085    11.092  217.61
  28   2.3784     10.140  8.6090    11.177  225.48
  29   2.3782     10.140  8.6089    10.968  233.63
  30   2.3777     10.110  8.6096    11.198  241.58
  31   2.3786     10.100  8.6093    11.073  249.45
  32   2.3783     10.150  8.6102    11.048  257.37
  33   2.3782     10.150  8.6096    11.000  265.25
  34   2.3778     10.190  8.6098    10.930  273.38
  35   2.3783     10.180  8.6089    11.023  281.35
  36   2.3780     10.130  8.6095    11.122  289.41
  37   2.3781     10.140  8.6097    10.967  297.50
  38   2.3782     10.130  8.6088    10.952  305.58
  39   2.3780     10.100  8.6092    11.140  313.88
  40   2.3781     10.170  8.6082    11.120  322.19
  41   2.3780     10.220  8.6098    10.910  330.19
  42   2.3777     10.160  8.6094    11.005  338.24
  43   2.3776     10.140  8.6093    10.892  346.21
  44   2.3788     10.080  8.6091    10.995  354.16
  45   2.3781     10.210  8.6096    10.948  362.11
  46   2.3777     10.230  8.6089    11.145  370.05
  47   2.3784     10.170  8.6088    10.993  378.21
  48   2.3778     10.220  8.6096    10.945  386.10
  49   2.3778     10.150  8.6096    11.117  393.97
  50   2.3777     10.190  8.6090    11.092  402.01
  51   2.3784     10.150  8.6092    10.903  410.02
  52   2.3783     10.150  8.6093    11.050  418.12
  53   2.3779     10.190  8.6096    11.093  426.16
  54   2.3782     10.190  8.6093    11.122  434.07
  55   2.3780     10.190  8.6090    11.083  442.15
  56   2.3784     10.160  8.6082    11.053  450.16
  57   2.3784     10.190  8.6095    11.078  458.35
  58   2.3780     10.180  8.6085    11.125  466.39
  59   2.3787     10.190  8.6097    10.997  474.42
  60   2.3779     10.180  8.6099    10.967  482.57
  61   2.3779     10.140  8.6093    11.060  490.63
  62   2.3780     10.140  8.6101    11.045  498.65
  63   2.3781     10.140  8.6093    11.002  506.69
  64   2.3780     10.290  8.6092    10.995  514.85
  65   2.3783     10.230  8.6090    11.028  522.82
  66   2.3781     10.190  8.6089    11.135  530.81
  67   2.3776     10.160  8.6103    10.963  538.83
  68   2.3781     10.130  8.6092    11.018  546.98
  69   2.3786     10.190  8.6091    11.012  555.17
  70   2.3783     10.130  8.6088    11.122  563.12
  71   2.3783     10.170  8.6092    11.198  571.19
  72   2.3782     10.200  8.6097    11.017  579.17
  73   2.3779     10.160  8.6092    11.145  587.28
  74   2.3785     10.170  8.6090    11.085  595.26
  75   2.3782     10.220  8.6092    11.173  603.32
  76   2.3779     10.130  8.6100    11.145  611.35
  77   2.3780     10.150  8.6094    11.123  619.36
  78   2.3781     10.130  8.6094    10.975  627.42
  79   2.3778     10.140  8.6090    11.177  635.40
  80   2.3776     10.190  8.6092    11.013  643.31
  81   2.3781     10.270  8.6088    11.047  651.24
  82   2.3778     10.210  8.6088    11.018  659.24
  83   2.3781     10.100  8.6090    11.127  667.15
  84   2.3782     10.200  8.6090    10.900  675.15
  85   2.3777     10.260  8.6095    10.998  683.21
