Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 4701550080 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2554     14.740  3.5934    12.162  10.75
   2   1.9407     26.650  3.3548    23.140  20.03
   3   1.7260     39.130  6.7976    26.410  29.36
   4   1.5683     48.330  4.0060    40.073  38.73
   5   0.9711     69.750  2.8153    53.870  48.08
   6   0.7416     74.950  2.1499    71.175  57.41
   7   0.5848     79.790  1.9703    76.053  66.71
   8   0.5835     79.890  1.9041    78.163  76.12
   9   0.5846     79.850  1.9015    78.310  85.31
  10   0.5851     79.910  1.9021    78.450  94.40
  11   0.5834     79.980  1.9012    78.467  103.53
  12   0.5858     79.570  1.9019    78.330  112.70
  13   0.5878     79.390  1.9004    78.247  121.71
  14   0.5844     79.980  1.9039    78.205  130.69
  15   0.5845     79.770  1.9042    78.362  139.87
  16   0.5922     79.050  1.9006    78.437  149.20
  17   0.5865     79.420  1.9045    78.307  158.21
  18   0.5871     79.470  1.9022    78.407  167.28
  19   0.5870     79.540  1.9027    78.222  176.50
  20   0.5819     79.980  1.9007    78.383  185.60
  21   0.5872     79.390  1.9008    78.323  194.60
  22   0.5871     79.480  1.9029    78.347  203.60
  23   0.5846     79.880  1.9039    78.257  212.77
  24   0.5833     80.070  1.9050    78.327  221.80
  25   0.5848     79.900  1.9044    78.153  230.83
  26   0.5872     79.460  1.9044    78.217  239.88
  27   0.5899     79.200  1.9035    78.283  249.10
  28   0.5864     79.580  1.9033    78.262  258.17
  29   0.5849     79.760  1.9027    78.273  267.19
  30   0.5857     79.620  1.9018    78.470  276.37
  31   0.5840     79.680  1.9011    78.300  285.38
  32   0.5877     79.370  1.9043    78.170  294.49
  33   0.5857     79.610  1.9022    78.243  303.52
  34   0.5845     79.890  1.9024    78.330  312.62
  35   0.5857     79.660  1.9018    78.353  321.65
  36   0.5847     79.760  1.9053    78.262  330.70
  37   0.5844     79.940  1.9054    78.242  340.03
  38   0.5886     79.330  1.8986    78.370  349.24
  39   0.5876     79.390  1.9020    78.267  358.29
  40   0.5846     79.790  1.9013    78.302  367.30
  41   0.5845     79.810  1.9012    78.275  376.31
  42   0.5861     79.640  1.9009    78.322  385.52
  43   0.5854     79.720  1.9020    78.458  394.56
  44   0.5856     79.650  1.9025    78.290  403.65
  45   0.5858     79.690  1.9035    78.253  412.61
  46   0.5837     79.780  1.9027    78.352  421.78
  47   0.5870     79.660  1.9007    78.335  430.84
  48   0.5861     79.650  1.9011    78.273  439.87
  49   0.5842     79.830  1.9040    78.292  448.92
  50   0.5888     79.330  1.9012    78.307  457.94
  51   0.5860     79.680  1.9018    78.458  466.86
  52   0.5856     79.820  1.9015    78.363  475.91
  53   0.5876     79.620  1.9020    78.253  484.82
  54   0.5863     79.470  1.9023    78.333  493.95
  55   0.5839     79.890  1.9044    78.293  502.95
  56   0.5832     79.980  1.9034    78.277  512.04
  57   0.5848     79.930  1.9013    78.385  520.99
  58   0.5866     79.690  1.9051    78.272  530.12
  59   0.5867     79.680  1.9001    78.412  539.21
  60   0.5859     79.710  1.9022    78.242  548.26
  61   0.5858     79.560  1.9033    78.183  557.21
  62   0.5828     80.040  1.9026    78.248  566.30
  63   0.5840     79.820  1.9005    78.475  575.34
  64   0.5843     79.770  1.9047    78.258  584.36
  65   0.5848     79.790  1.9041    78.140  593.51
  66   0.5857     79.630  1.9051    78.242  602.56
  67   0.5837     79.940  1.9020    78.178  612.04
  68   0.5853     79.630  1.9038    78.115  621.00
  69   0.5873     79.470  1.9000    78.390  630.12
  70   0.5836     79.870  1.9007    78.228  639.13
  71   0.5859     79.570  1.9029    78.132  648.25
  72   0.5856     79.710  1.9020    78.318  657.31
  73   0.5853     79.690  1.8996    78.477  666.33
  74   0.5858     79.600  1.9016    78.428  675.51
  75   0.5857     79.600  1.9027    78.228  684.56
  76   0.5876     79.650  1.9041    78.195  693.88
  77   0.5872     79.580  1.8986    78.423  703.06
  78   0.5856     79.520  1.9027    78.335  712.28
  79   0.5857     79.660  1.8988    78.438  721.28
  80   0.5872     79.610  1.9019    78.410  730.30
  81   0.5856     79.740  1.9021    78.343  739.36
  82   0.5832     80.080  1.9010    78.322  748.46
  83   0.5842     80.020  1.9019    78.348  757.49
  84   0.5859     79.770  1.9007    78.382  766.89
  85   0.5845     79.930  1.9009    78.387  775.82
