Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 4701676544 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2857     16.450  3.5970    12.317  10.80
   2   2.0463     24.690  3.4114    20.428  20.07
   3   1.7492     38.190  3.4021    31.272  29.19
   4   9.1333     11.350  3.8169    36.925  38.48
   5   1.2439     64.580  2.6579    56.218  47.69
   6   0.7816     75.450  2.2844    66.912  56.95
   7   2.7068     11.400  13.8508    47.070  66.19
   8   2.3447     18.590  3.6331    16.177  75.56
   9   2.3519     18.470  3.5917    17.295  84.69
  10   2.3598     18.630  3.5885    17.220  93.74
  11   2.3352     18.500  3.5903    17.385  103.15
  12   2.3198     18.600  3.5888    17.455  112.32
  13   2.3398     18.570  3.5901    17.215  121.38
  14   2.3357     18.410  3.5915    17.242  130.81
  15   2.3276     18.540  3.5908    17.408  139.96
  16   2.3327     18.550  3.5932    17.290  149.03
  17   2.3385     18.530  3.5899    17.192  158.00
  18   2.3348     18.600  3.5908    17.360  166.91
  19   2.3278     18.520  3.5906    17.393  175.84
  20   2.3370     18.580  3.5890    17.232  184.96
  21   2.3406     18.430  3.5903    17.313  193.94
  22   2.3272     18.370  3.5897    17.238  202.85
  23   2.3444     18.570  3.5898    17.382  211.85
  24   2.3264     18.710  3.5906    17.332  220.80
  25   2.3340     18.690  3.5910    17.312  229.75
  26   2.3496     18.600  3.5884    17.273  238.73
  27   2.3258     18.540  3.5915    17.370  247.72
  28   2.3407     18.500  3.5880    17.312  257.02
  29   2.3355     18.420  3.5900    17.167  266.15
  30   2.3348     18.420  3.5874    17.307  275.08
  31   2.3461     18.580  3.5921    17.382  284.00
  32   2.3373     18.560  3.5922    17.243  293.02
  33   2.3379     18.550  3.5890    17.302  301.96
  34   2.3255     18.480  3.5901    17.113  311.01
  35   2.3510     18.530  3.5912    17.285  320.01
  36   2.3402     18.490  3.5923    17.408  329.05
  37   2.3405     18.610  3.5890    17.357  338.03
  38   2.3329     18.530  3.5899    17.363  346.97
  39   2.3355     18.660  3.5883    17.268  356.23
  40   2.3276     18.500  3.5881    17.313  365.28
  41   2.3276     18.560  3.5917    17.197  374.57
  42   2.3242     18.370  3.5889    17.318  383.49
  43   2.3532     18.490  3.5930    17.437  392.46
  44   2.3466     18.510  3.5901    17.192  401.42
  45   2.3219     18.610  3.5890    17.397  410.38
  46   2.3356     18.350  3.5880    17.300  419.70
  47   2.3362     18.410  3.5910    17.278  428.81
  48   2.3296     18.510  3.5903    17.270  437.80
  49   2.3239     18.400  3.5898    17.343  446.61
  50   2.3328     18.520  3.5905    17.333  455.58
  51   2.3389     18.350  3.5888    17.332  464.73
  52   2.3346     18.490  3.5897    17.437  473.71
  53   2.3399     18.580  3.5879    17.327  482.63
  54   2.3455     18.480  3.5899    17.333  491.45
  55   2.3510     18.560  3.5909    17.292  500.47
  56   2.3275     18.610  3.5905    17.260  509.52
  57   2.3426     18.610  3.5897    17.340  518.54
  58   2.3469     18.450  3.5886    17.367  527.53
  59   2.3395     18.530  3.5890    17.397  536.82
  60   2.3489     18.660  3.5894    17.390  545.86
  61   2.3321     18.460  3.5902    17.355  554.78
  62   2.3483     18.500  3.5904    17.300  563.85
  63   2.3353     18.400  3.5923    17.307  572.84
  64   2.3307     18.260  3.5918    17.258  581.95
  65   2.3453     18.540  3.5897    17.158  590.85
  66   2.3425     18.540  3.5887    17.227  599.75
  67   2.3378     18.540  3.5903    17.268  608.77
  68   2.3508     18.640  3.5892    17.423  617.72
  69   2.3373     18.550  3.5915    17.298  626.74
  70   2.3399     18.510  3.5893    17.305  635.72
  71   2.3536     18.670  3.5883    17.313  644.83
  72   2.3332     18.600  3.5891    17.352  653.79
  73   2.3491     18.670  3.5906    17.367  662.90
  74   2.3382     18.530  3.5881    17.310  671.90
  75   2.3508     18.660  3.5908    17.315  681.02
  76   2.3419     18.440  3.5919    17.385  690.29
  77   2.3490     18.640  3.5920    17.203  699.54
  78   2.3424     18.640  3.5909    17.392  708.62
  79   2.3503     18.420  3.5893    17.282  717.55
  80   2.3474     18.550  3.5901    17.335  726.49
  81   2.3409     18.550  3.5878    17.427  735.38
  82   2.3438     18.640  3.5905    17.312  744.74
  83   2.3379     18.520  3.5929    17.303  753.72
  84   2.3309     18.680  3.5924    17.373  763.04
  85   2.3271     18.670  3.5894    17.282  772.04
  86   2.3519     18.530  3.5903    17.397  781.05
  87   2.3543     18.570  3.5885    17.170  790.20
  88   2.3339     18.610  3.5920    17.210  799.16
  89   2.3416     18.630  3.5915    17.350  808.14
  90   2.3472     18.510  3.5911    17.243  817.14
