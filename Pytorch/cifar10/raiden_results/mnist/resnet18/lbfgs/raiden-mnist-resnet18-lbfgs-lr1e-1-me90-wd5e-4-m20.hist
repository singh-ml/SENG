Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 4701158400 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   7.0234      9.130  9.3397    19.755  10.58
   2   0.6997     76.560  7.7223    48.093  19.90
   3   0.4641     84.090  6.8563    77.263  29.24
   4   0.4240     85.870  6.5200    83.757  38.68
   5   0.3062     89.520  6.4050    85.938  47.97
   6   0.2948     89.890  6.2827    88.535  57.29
   7   0.2793     91.080  6.2589    89.488  66.57
   8   0.2766     91.100  6.2372    89.890  76.00
   9   0.2763     91.210  6.2355    90.035  85.04
  10   0.2761     91.130  6.2399    89.923  93.99
  11   0.2763     91.150  6.2360    90.037  102.87
  12   0.2789     91.120  6.2395    89.943  112.03
  13   0.2773     91.170  6.2378    89.965  121.04
  14   0.2763     91.220  6.2360    89.977  130.10
  15   0.2787     91.080  6.2353    89.957  139.13
  16   0.2763     91.260  6.2379    89.978  148.14
  17   0.2792     91.050  6.2387    89.808  157.04
  18   0.2764     91.190  6.2372    89.895  166.00
  19   0.2779     91.120  6.2363    90.078  175.20
  20   0.2759     91.150  6.2379    90.012  184.21
  21   0.2757     91.250  6.2388    89.925  193.25
  22   0.2783     90.960  6.2372    90.102  202.31
  23   0.2764     91.140  6.2359    89.927  211.33
  24   0.2783     91.120  6.2364    90.042  220.43
  25   0.2777     91.150  6.2364    90.065  229.48
  26   0.2783     91.110  6.2384    89.918  238.45
  27   0.2761     91.130  6.2374    89.965  247.52
  28   0.2772     91.220  6.2384    90.028  256.45
  29   0.2767     91.180  6.2366    90.065  265.45
  30   0.2756     91.230  6.2399    89.878  274.47
  31   0.2756     91.140  6.2378    89.998  283.64
  32   0.2766     91.220  6.2349    90.018  292.71
  33   0.2767     91.240  6.2393    89.912  301.77
  34   0.2761     91.100  6.2354    89.992  310.64
  35   0.2779     91.060  6.2404    89.920  319.51
  36   0.2755     91.230  6.2376    89.975  328.70
  37   0.2759     91.130  6.2379    89.938  337.73
  38   0.2767     91.240  6.2353    89.993  346.67
  39   0.2765     91.110  6.2372    89.933  355.70
  40   0.2770     91.100  6.2355    89.975  364.82
  41   0.2774     91.160  6.2353    90.027  373.80
  42   0.2764     91.180  6.2371    89.967  382.79
  43   0.2759     91.160  6.2365    89.862  391.98
  44   0.2785     91.140  6.2365    90.067  401.09
  45   0.2751     91.310  6.2371    90.043  410.08
  46   0.2764     91.190  6.2352    90.087  419.12
  47   0.2772     91.210  6.2377    89.985  428.29
  48   0.2784     91.040  6.2355    89.978  437.33
  49   0.2756     91.190  6.2365    89.975  446.29
  50   0.2771     91.100  6.2386    89.887  455.34
  51   0.2778     91.120  6.2390    89.992  464.54
  52   0.2757     91.220  6.2370    89.957  473.79
  53   0.2780     91.100  6.2361    90.027  482.80
  54   0.2776     91.160  6.2352    89.947  491.79
  55   0.2763     91.160  6.2370    89.928  500.94
  56   0.2763     91.230  6.2383    90.072  509.94
  57   0.2773     91.070  6.2383    89.970  519.07
  58   0.2773     91.200  6.2369    89.940  528.29
  59   0.2756     91.180  6.2369    89.887  537.16
  60   0.2760     91.230  6.2358    89.858  546.22
  61   0.2750     91.220  6.2380    89.898  555.21
  62   0.2767     91.220  6.2390    89.962  564.28
  63   0.2768     91.120  6.2370    89.972  573.25
  64   0.2751     91.230  6.2373    89.920  582.56
  65   0.2774     91.110  6.2378    89.942  591.61
  66   0.2767     91.240  6.2389    90.030  600.59
  67   0.2762     91.110  6.2376    89.935  609.76
  68   0.2762     91.170  6.2387    89.773  618.69
  69   0.2761     91.250  6.2382    89.970  627.69
  70   0.2785     91.100  6.2378    89.835  637.01
  71   0.2767     91.200  6.2364    90.073  645.98
  72   0.2774     91.040  6.2361    89.907  655.05
  73   0.2756     91.250  6.2355    90.078  664.08
  74   0.2765     91.170  6.2375    90.045  673.26
  75   0.2764     91.030  6.2352    90.057  682.42
  76   0.2753     91.150  6.2380    90.003  691.45
  77   0.2767     91.170  6.2355    89.988  700.46
  78   0.2760     91.220  6.2358    89.968  709.64
  79   0.2776     91.140  6.2363    90.005  718.67
  80   0.2767     91.180  6.2387    89.812  727.66
  81   0.2768     91.090  6.2358    89.968  736.69
  82   0.2771     91.210  6.2388    90.050  745.87
  83   0.2769     91.220  6.2356    89.990  754.85
  84   0.2767     91.210  6.2352    89.975  763.90
  85   0.2757     91.260  6.2348    89.953  772.92
  86   0.2769     91.270  6.2390    89.895  782.09
  87   0.2760     91.190  6.2352    90.010  791.12
  88   0.2761     91.200  6.2358    89.872  800.11
  89   0.2773     91.160  6.2372    89.963  809.11
  90   0.2775     91.240  6.2364    89.997  818.20
