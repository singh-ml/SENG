Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3842544128 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.4314      9.740  3.6842     9.387  9.52
   2   2.4318      9.740  3.6847     9.317  17.84
   3   2.4292      9.880  3.6846     9.420  25.96
   4   2.4313      9.760  3.6845     9.262  34.07
   5   2.4305      9.850  3.6855     9.410  41.98
   6   2.4305      9.830  3.6845     9.225  49.92
   7   2.4310      9.830  3.6845     9.263  57.96
   8   2.4312      9.720  3.6851     9.238  66.18
   9   2.4297      9.810  3.6848     9.300  74.33
  10   2.4312      9.790  3.6844     9.312  82.74
  11   2.4313      9.830  3.6857     9.355  90.86
  12   2.4307      9.780  3.6840     9.358  99.07
  13   2.4309      9.790  3.6848     9.530  107.21
  14   2.4313      9.790  3.6839     9.308  115.36
  15   2.4310      9.820  3.6846     9.322  123.54
  16   2.4308      9.790  3.6840     9.368  131.68
  17   2.4299      9.790  3.6846     9.368  139.75
  18   2.4314      9.800  3.6845     9.240  148.24
  19   2.4308      9.810  3.6846     9.373  156.30
  20   2.4306      9.760  3.6851     9.228  164.44
  21   2.4312      9.810  3.6843     9.392  172.49
  22   2.4313      9.780  3.6843     9.513  180.58
  23   2.4311      9.820  3.6856     9.315  188.70
  24   2.4308      9.780  3.6844     9.257  196.93
  25   2.4308      9.800  3.6849     9.342  204.95
  26   2.4300      9.680  3.6848     9.355  213.06
  27   2.4308      9.790  3.6843     9.378  221.20
  28   2.4313      9.830  3.6855     9.270  229.19
  29   2.4297      9.830  3.6846     9.342  237.45
  30   2.4302      9.860  3.6838     9.320  245.57
  31   2.4310      9.740  3.6854     9.213  253.70
  32   2.4310      9.830  3.6839     9.327  261.88
  33   2.4301      9.780  3.6849     9.303  270.01
  34   2.4304      9.780  3.6847     9.475  278.14
  35   2.4307      9.810  3.6840     9.327  286.22
  36   2.4300      9.790  3.6842     9.328  294.38
  37   2.4303      9.800  3.6847     9.333  302.46
  38   2.4297      9.780  3.6851     9.320  310.67
  39   2.4302      9.750  3.6845     9.405  318.75
  40   2.4306      9.800  3.6849     9.515  326.87
  41   2.4304      9.790  3.6856     9.293  335.26
  42   2.4310      9.770  3.6841     9.330  343.42
  43   2.4297      9.840  3.6850     9.405  351.50
  44   2.4304      9.850  3.6844     9.308  359.62
  45   2.4306      9.850  3.6850     9.178  367.71
  46   2.4303      9.890  3.6856     9.402  375.76
  47   2.4309      9.810  3.6843     9.398  383.98
  48   2.4304      9.830  3.6842     9.373  391.99
  49   2.4307      9.820  3.6849     9.357  400.04
  50   2.4306      9.810  3.6848     9.150  408.15
  51   2.4309      9.830  3.6848     9.253  416.33
  52   2.4300      9.750  3.6848     9.432  424.53
  53   2.4311      9.760  3.6854     9.325  432.59
  54   2.4309      9.830  3.6852     9.278  440.63
  55   2.4301      9.820  3.6851     9.297  449.09
  56   2.4298      9.860  3.6845     9.395  457.27
  57   2.4309      9.800  3.6842     9.430  465.47
  58   2.4306      9.890  3.6842     9.385  473.48
  59   2.4303      9.880  3.6838     9.547  481.71
  60   2.4301      9.840  3.6845     9.365  490.14
  61   2.4298      9.810  3.6849     9.372  498.19
  62   2.4298      9.740  3.6849     9.250  506.31
  63   2.4311      9.830  3.6853     9.428  514.49
  64   2.4303      9.850  3.6841     9.278  522.58
  65   2.4307      9.820  3.6843     9.330  530.70
  66   2.4308      9.820  3.6846     9.338  538.83
  67   2.4306      9.760  3.6847     9.415  546.88
  68   2.4304      9.860  3.6849     9.275  554.97
  69   2.4309      9.830  3.6855     9.170  563.02
  70   2.4308      9.810  3.6846     9.458  571.05
  71   2.4304      9.780  3.6842     9.322  579.11
  72   2.4312      9.720  3.6853     9.350  587.30
  73   2.4308      9.750  3.6851     9.322  595.39
  74   2.4319      9.760  3.6860     9.198  603.35
  75   2.4312      9.800  3.6844     9.505  611.31
  76   2.4309      9.760  3.6856     9.215  619.76
  77   2.4312      9.720  3.6850     9.352  628.01
  78   2.4305      9.830  3.6845     9.445  636.11
  79   2.4307      9.780  3.6833     9.110  644.27
  80   2.4314      9.820  3.6855     9.503  652.38
  81   2.4307      9.800  3.6855     9.378  660.54
  82   2.4299      9.750  3.6836     9.512  668.58
  83   2.4302      9.830  3.6838     9.398  676.65
  84   2.4302      9.830  3.6844     9.257  684.72
  85   2.4305      9.750  3.6846     9.282  692.95
  86   2.4310      9.790  3.6837     9.372  701.03
  87   2.4301      9.800  3.6847     9.313  708.99
  88   2.4303      9.830  3.6851     9.230  717.13
  89   2.4301      9.820  3.6852     9.307  725.39
  90   2.4306      9.860  3.6841     9.290  733.55
