Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '24', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3842544128 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3693     10.360  3.6205    10.060  9.86
   2   2.3693     10.280  3.6195    10.028  17.64
   3   2.3689     10.320  3.6191    10.013  25.42
   4   2.3693     10.360  3.6205    10.102  33.34
   5   2.3690     10.360  3.6202    10.018  41.08
   6   2.3689     10.300  3.6191     9.988  48.75
   7   2.3695     10.380  3.6204    10.070  56.52
   8   2.3696     10.340  3.6192    10.023  64.29
   9   2.3695     10.370  3.6196    10.027  72.16
  10   2.3696     10.380  3.6203    10.012  79.98
  11   2.3693     10.330  3.6198    10.003  87.76
  12   2.3693     10.350  3.6201    10.068  95.67
  13   2.3695     10.360  3.6198    10.055  103.68
  14   2.3693     10.360  3.6198    10.043  111.52
  15   2.3690     10.340  3.6197     9.965  119.42
  16   2.3692     10.370  3.6200     9.972  127.17
  17   2.3687     10.350  3.6202    10.108  135.07
  18   2.3691     10.300  3.6202     9.938  142.77
  19   2.3694     10.350  3.6208    10.037  150.94
  20   2.3690     10.310  3.6194    10.043  158.74
  21   2.3692     10.330  3.6195    10.012  166.95
  22   2.3694     10.320  3.6192     9.988  174.76
  23   2.3697     10.340  3.6191    10.150  182.55
  24   2.3693     10.310  3.6199    10.110  190.54
  25   2.3693     10.380  3.6200    10.070  198.41
  26   2.3689     10.370  3.6200     9.923  206.32
  27   2.3697     10.350  3.6202    10.132  214.05
  28   2.3697     10.400  3.6196     9.862  221.87
  29   2.3691     10.290  3.6193    10.012  229.68
  30   2.3691     10.310  3.6204    10.115  237.80
  31   2.3692     10.340  3.6195    10.012  245.80
  32   2.3690     10.320  3.6189    10.095  253.64
  33   2.3694     10.330  3.6202    10.060  261.48
  34   2.3695     10.380  3.6196    10.033  269.32
  35   2.3691     10.330  3.6204    10.097  277.23
  36   2.3685     10.270  3.6193     9.987  285.08
  37   2.3696     10.310  3.6204     9.892  292.92
  38   2.3686     10.280  3.6198     9.972  300.79
  39   2.3686     10.270  3.6189    10.060  308.56
  40   2.3686     10.310  3.6199    10.225  316.37
  41   2.3695     10.330  3.6206     9.867  324.18
  42   2.3687     10.320  3.6194    10.042  332.02
  43   2.3694     10.300  3.6194    10.130  339.89
  44   2.3687     10.360  3.6200    10.083  347.66
  45   2.3689     10.340  3.6202     9.950  355.57
  46   2.3685     10.350  3.6191    10.010  363.42
  47   2.3699     10.380  3.6197    10.003  371.26
  48   2.3690     10.240  3.6196    10.063  379.02
  49   2.3693     10.400  3.6195    10.088  386.90
  50   2.3698     10.310  3.6210    10.042  394.72
  51   2.3692     10.330  3.6197    10.102  402.63
  52   2.3696     10.420  3.6197    10.032  410.49
  53   2.3690     10.350  3.6193    10.058  418.39
  54   2.3693     10.340  3.6194    10.167  426.30
  55   2.3686     10.310  3.6192     9.973  434.10
  56   2.3693     10.360  3.6196    10.007  442.07
  57   2.3696     10.360  3.6200    10.213  449.96
  58   2.3692     10.370  3.6194    10.163  457.73
  59   2.3692     10.360  3.6205     9.995  465.47
  60   2.3691     10.370  3.6197    10.080  473.30
  61   2.3691     10.390  3.6192    10.132  481.02
  62   2.3693     10.350  3.6201    10.038  488.94
  63   2.3686     10.330  3.6194    10.118  496.81
  64   2.3691     10.260  3.6196    10.138  504.59
  65   2.3690     10.360  3.6192    10.100  512.43
  66   2.3687     10.280  3.6201    10.007  520.37
  67   2.3684     10.350  3.6192    10.007  528.22
  68   2.3687     10.320  3.6195    10.098  536.06
  69   2.3696     10.360  3.6198    10.062  543.88
  70   2.3690     10.350  3.6204     9.975  551.99
  71   2.3692     10.330  3.6195    10.013  559.80
  72   2.3694     10.370  3.6203    10.005  567.56
  73   2.3696     10.440  3.6190     9.975  575.30
  74   2.3693     10.360  3.6207     9.943  583.13
  75   2.3689     10.380  3.6201     9.975  591.14
  76   2.3692     10.320  3.6191    10.045  598.95
  77   2.3690     10.320  3.6193    10.053  606.79
  78   2.3692     10.350  3.6197     9.927  614.44
  79   2.3695     10.380  3.6200    10.007  622.14
  80   2.3690     10.320  3.6209     9.918  630.00
  81   2.3687     10.300  3.6200     9.977  637.78
  82   2.3686     10.350  3.6200    10.042  645.54
  83   2.3690     10.340  3.6196    10.248  653.37
  84   2.3691     10.320  3.6196     9.982  661.32
  85   2.3689     10.320  3.6197    10.038  669.12
  86   2.3687     10.300  3.6197     9.988  676.83
  87   2.3690     10.350  3.6195    10.123  684.59
  88   2.3695     10.340  3.6198     9.990  692.41
  89   2.3691     10.270  3.6192    10.145  700.29
  90   2.3693     10.380  3.6196    10.135  708.18
