Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '-m', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 3842544128 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3830     10.210  3.6303    10.383  9.43
   2   2.3827     10.190  3.6285    10.400  16.97
   3   2.3829     10.240  3.6292    10.472  24.68
   4   2.3828     10.220  3.6295    10.413  32.22
   5   2.3831     10.220  3.6302    10.380  39.74
   6   2.3839     10.230  3.6297    10.408  47.58
   7   2.3837     10.240  3.6296    10.403  55.14
   8   2.3835     10.230  3.6290    10.425  63.15
   9   2.3828     10.230  3.6292    10.403  70.66
  10   2.3836     10.230  3.6286    10.457  78.31
  11   2.3833     10.230  3.6299    10.372  85.96
  12   2.3831     10.230  3.6291    10.465  93.47
  13   2.3833     10.220  3.6298    10.407  101.13
  14   2.3816     10.200  3.6288    10.440  108.70
  15   2.3833     10.230  3.6283    10.447  116.32
  16   2.3835     10.210  3.6300    10.445  123.98
  17   2.3829     10.230  3.6291    10.458  131.51
  18   2.3832     10.210  3.6295    10.337  139.25
  19   2.3828     10.210  3.6313    10.392  147.21
  20   2.3831     10.230  3.6300    10.385  154.81
  21   2.3830     10.220  3.6293    10.397  162.47
  22   2.3821     10.210  3.6294    10.368  170.26
  23   2.3829     10.210  3.6297    10.368  177.89
  24   2.3826     10.210  3.6289    10.368  185.53
  25   2.3823     10.230  3.6295    10.430  193.46
  26   2.3836     10.240  3.6297    10.437  201.13
  27   2.3827     10.210  3.6294    10.392  208.75
  28   2.3824     10.220  3.6294    10.445  216.36
  29   2.3826     10.210  3.6302    10.438  223.93
  30   2.3835     10.220  3.6290    10.485  231.50
  31   2.3832     10.230  3.6290    10.450  239.14
  32   2.3830     10.220  3.6292    10.360  246.92
  33   2.3824     10.220  3.6296    10.420  254.48
  34   2.3832     10.220  3.6296    10.402  262.03
  35   2.3824     10.210  3.6301    10.430  269.68
  36   2.3832     10.230  3.6297    10.432  277.30
  37   2.3824     10.220  3.6293    10.422  284.85
  38   2.3833     10.240  3.6297    10.380  292.49
  39   2.3831     10.230  3.6293    10.438  300.07
  40   2.3822     10.200  3.6300    10.402  307.77
  41   2.3825     10.210  3.6295    10.395  315.75
  42   2.3832     10.210  3.6287    10.422  323.42
  43   2.3832     10.230  3.6303    10.438  331.08
  44   2.3827     10.220  3.6295    10.357  338.86
  45   2.3829     10.230  3.6295    10.398  346.52
  46   2.3828     10.220  3.6299    10.388  353.99
  47   2.3833     10.240  3.6294    10.418  361.53
  48   2.3828     10.210  3.6292    10.412  369.23
  49   2.3832     10.210  3.6294    10.467  376.86
  50   2.3825     10.210  3.6295    10.387  384.48
  51   2.3840     10.240  3.6285    10.427  392.09
  52   2.3836     10.230  3.6298    10.430  400.03
  53   2.3841     10.220  3.6299    10.445  407.67
  54   2.3829     10.230  3.6292    10.433  415.50
  55   2.3829     10.220  3.6292    10.440  423.50
  56   2.3831     10.220  3.6292    10.485  431.05
  57   2.3831     10.220  3.6301    10.353  438.76
  58   2.3834     10.220  3.6291    10.410  446.55
  59   2.3826     10.220  3.6290    10.470  454.19
  60   2.3833     10.220  3.6303    10.387  461.88
  61   2.3831     10.230  3.6302    10.442  469.52
  62   2.3828     10.230  3.6286    10.427  477.07
  63   2.3829     10.220  3.6292    10.397  484.84
  64   2.3821     10.210  3.6301    10.353  492.45
  65   2.3833     10.220  3.6299    10.433  500.12
  66   2.3825     10.220  3.6295    10.418  507.78
  67   2.3829     10.230  3.6299    10.410  515.50
  68   2.3823     10.220  3.6299    10.462  523.16
  69   2.3836     10.230  3.6297    10.428  530.84
  70   2.3835     10.210  3.6297    10.437  538.39
  71   2.3842     10.220  3.6296    10.393  546.16
  72   2.3835     10.230  3.6291    10.418  553.80
  73   2.3835     10.230  3.6285    10.430  561.44
  74   2.3830     10.240  3.6290    10.415  569.02
  75   2.3823     10.210  3.6290    10.378  576.98
  76   2.3837     10.230  3.6298    10.400  584.77
  77   2.3824     10.210  3.6288    10.423  592.44
  78   2.3835     10.230  3.6302    10.392  600.11
  79   2.3828     10.220  3.6296    10.408  607.75
  80   2.3838     10.220  3.6301    10.435  615.24
  81   2.3832     10.220  3.6298    10.368  622.93
  82   2.3829     10.230  3.6293    10.397  630.54
  83   2.3826     10.210  3.6295    10.375  638.07
  84   2.3828     10.220  3.6292    10.378  645.62
  85   2.3837     10.220  3.6299    10.363  653.44
  86   2.3828     10.230  3.6291    10.415  661.02
  87   2.3833     10.220  3.6300    10.443  668.68
  88   2.3826     10.210  3.6297    10.420  676.36
  89   2.3832     10.230  3.6289    10.420  683.97
  90   2.3836     10.230  3.6284    10.345  691.75
