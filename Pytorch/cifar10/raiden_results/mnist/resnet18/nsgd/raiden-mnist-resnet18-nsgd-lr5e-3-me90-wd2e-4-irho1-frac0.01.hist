Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3095     89.760  0.9546    68.065  14.95
   2   0.2034     93.360  0.1931    94.088  27.72
   3   0.1374     95.620  0.1256    96.115  40.47
   4   0.0853     97.460  0.0934    97.072  53.19
   5   0.0785     97.410  0.0786    97.475  65.91
   6   0.0888     97.010  0.0697    97.775  78.66
   7   0.0654     97.950  0.0614    98.030  91.37
   8   0.0617     97.920  0.0570    98.218  104.07
   9   0.0440     98.470  0.0528    98.338  116.78
  10   0.0520     98.250  0.0491    98.408  129.46
  11   0.0518     98.380  0.0455    98.570  142.17
  12   0.0502     98.380  0.0431    98.625  154.92
  13   0.0486     98.340  0.0416    98.640  167.67
  14   0.0487     98.470  0.0387    98.767  180.41
  15   0.0423     98.600  0.0372    98.815  193.28
  16   0.0387     98.690  0.0359    98.865  205.99
  17   0.0563     98.150  0.0339    98.877  218.70
  18   0.0416     98.610  0.0327    98.965  231.42
  19   0.0398     98.650  0.0306    98.980  244.14
  20   0.0448     98.410  0.0300    99.025  256.84
  21   0.0862     97.220  0.0291    99.035  269.56
  22   0.0331     98.980  0.0294    99.060  282.34
  23   0.0443     98.510  0.0276    99.108  295.04
  24   0.0343     98.890  0.0270    99.090  307.76
  25   0.0378     98.810  0.0267    99.088  320.48
  26   0.0346     98.830  0.0256    99.178  333.21
  27   0.0362     98.780  0.0235    99.267  345.95
  28   0.0416     98.540  0.0240    99.222  358.68
  29   0.0340     98.890  0.0232    99.225  371.45
  30   0.0371     98.750  0.0232    99.250  384.17
  31   0.0347     98.760  0.0216    99.293  396.89
  32   0.0327     98.880  0.0228    99.280  409.60
  33   0.0335     98.790  0.0223    99.290  422.33
  34   0.0309     98.980  0.0210    99.315  435.04
  35   0.0276     99.170  0.0197    99.393  447.78
  36   0.0383     98.790  0.0198    99.373  460.64
  37   0.0311     98.860  0.0194    99.397  473.35
  38   0.0285     99.140  0.0190    99.380  486.08
  39   0.0334     98.920  0.0185    99.398  498.92
  40   0.0387     98.620  0.0178    99.447  511.67
  41   0.0322     99.000  0.0175    99.437  524.39
  42   0.0312     98.960  0.0165    99.468  537.21
  43   0.0318     99.050  0.0164    99.463  549.93
  44   0.0343     98.830  0.0164    99.455  562.63
  45   0.0336     98.950  0.0157    99.498  575.52
  46   0.0314     99.020  0.0155    99.480  588.23
  47   0.0380     98.910  0.0153    99.498  600.98
  48   0.0327     98.990  0.0149    99.540  613.84
  49   0.0305     99.060  0.0141    99.558  626.57
  50   0.0284     99.020  0.0139    99.560  639.29
  51   0.0295     99.050  0.0142    99.550  652.11
  52   0.0319     98.990  0.0133    99.577  664.83
  53   0.0277     99.100  0.0128    99.605  677.57
  54   0.0323     98.960  0.0132    99.567  690.27
  55   0.0318     98.960  0.0132    99.578  703.01
  56   0.0300     99.060  0.0125    99.583  715.74
  57   0.0255     99.170  0.0124    99.600  728.47
  58   0.0303     99.040  0.0113    99.637  741.30
  59   0.0277     99.110  0.0126    99.603  754.07
  60   0.0350     98.820  0.0117    99.615  766.75
  61   0.0370     98.940  0.0115    99.623  779.59
  62   0.0292     99.150  0.0112    99.642  792.34
  63   0.0245     99.220  0.0110    99.643  805.04
  64   0.0304     98.970  0.0104    99.680  817.83
  65   0.0295     98.990  0.0105    99.650  830.51
  66   0.0296     99.080  0.0111    99.637  843.19
  67   0.0321     98.890  0.0099    99.703  855.91
  68   0.0311     99.000  0.0093    99.710  868.62
  69   0.0306     99.100  0.0095    99.697  881.32
  70   0.0304     99.000  0.0096    99.697  894.03
  71   0.0279     99.120  0.0090    99.710  906.79
  72   0.0297     99.110  0.0094    99.727  919.54
  73   0.0291     99.000  0.0095    99.688  932.31
  74   0.0296     99.100  0.0088    99.742  945.26
  75   0.0315     99.020  0.0090    99.730  958.02
  76   0.0309     99.020  0.0084    99.732  970.76
  77   0.0290     99.050  0.0087    99.712  983.63
  78   0.0284     99.070  0.0084    99.760  996.35
  79   0.0296     99.020  0.0083    99.740  1009.06
  80   0.0291     99.070  0.0086    99.768  1021.88
  81   0.0267     99.110  0.0085    99.723  1034.56
  82   0.0278     99.120  0.0084    99.735  1047.26
  83   0.0290     99.100  0.0078    99.768  1059.93
  84   0.0321     98.950  0.0079    99.773  1072.65
  85   0.0308     99.010  0.0075    99.802  1085.38
  86   0.0291     99.040  0.0081    99.788  1098.07
  87   0.0306     99.030  0.0081    99.755  1110.80
  88   0.0280     99.090  0.0081    99.745  1123.50
  89   0.0318     99.030  0.0077    99.767  1136.26
  90   0.0310     98.990  0.0077    99.760  1148.99
