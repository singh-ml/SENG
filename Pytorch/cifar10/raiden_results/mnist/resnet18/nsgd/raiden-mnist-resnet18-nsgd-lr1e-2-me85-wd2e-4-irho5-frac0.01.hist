Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2177     93.460  0.4556    85.083  14.78
   2   0.1351     95.690  0.0922    97.107  27.24
   3   0.0889     97.320  0.0656    97.987  39.73
   4   0.0395     98.660  0.0541    98.282  52.16
   5   0.0801     97.450  0.0523    98.362  64.68
   6   0.0505     98.420  0.0452    98.505  77.13
   7   0.0513     98.360  0.0419    98.688  89.56
   8   0.0373     98.650  0.0382    98.755  102.06
   9   0.0410     98.680  0.0368    98.823  114.47
  10   0.0685     97.860  0.0334    98.937  126.86
  11   0.0320     99.000  0.0332    99.003  139.37
  12   0.0333     98.810  0.0318    98.960  151.76
  13   0.0362     98.980  0.0304    98.958  164.16
  14   0.0460     98.440  0.0265    99.090  176.67
  15   0.0428     98.680  0.0280    99.090  189.09
  16   0.0318     98.990  0.0263    99.132  201.50
  17   0.0312     98.970  0.0257    99.145  213.92
  18   0.0401     98.580  0.0247    99.223  226.31
  19   0.0403     98.730  0.0229    99.247  238.71
  20   0.0342     98.900  0.0223    99.248  251.12
  21   0.0351     98.890  0.0223    99.248  263.64
  22   0.0262     99.170  0.0214    99.268  276.05
  23   0.0365     98.880  0.0204    99.310  288.46
  24   0.0298     99.120  0.0192    99.370  300.95
  25   0.0335     99.000  0.0190    99.398  313.37
  26   0.0372     98.830  0.0191    99.380  325.79
  27   0.0272     99.120  0.0185    99.403  338.35
  28   0.0271     99.150  0.0176    99.425  350.78
  29   0.0299     99.050  0.0161    99.468  363.17
  30   0.0336     98.960  0.0168    99.417  375.69
  31   0.0355     98.770  0.0147    99.492  388.10
  32   0.0346     98.940  0.0150    99.502  400.53
  33   0.0243     99.310  0.0142    99.508  413.02
  34   0.0279     99.240  0.0138    99.528  425.45
  35   0.0267     99.130  0.0128    99.562  437.87
  36   0.0275     99.190  0.0134    99.537  450.30
  37   0.0316     99.000  0.0116    99.625  462.73
  38   0.0303     99.080  0.0114    99.588  475.14
  39   0.0240     99.230  0.0119    99.612  487.56
  40   0.0299     99.010  0.0110    99.620  500.11
  41   0.0353     98.990  0.0109    99.635  512.53
  42   0.0295     99.150  0.0106    99.642  524.95
  43   0.0306     99.260  0.0094    99.683  537.47
  44   0.0316     99.060  0.0097    99.695  549.89
  45   0.0280     99.170  0.0095    99.675  562.29
  46   0.0287     99.250  0.0092    99.693  574.72
  47   0.0322     99.050  0.0088    99.708  587.15
  48   0.0247     99.280  0.0076    99.748  599.56
  49   0.0336     98.990  0.0076    99.738  611.99
  50   0.0359     98.990  0.0078    99.742  624.40
  51   0.0323     99.090  0.0070    99.772  636.80
  52   0.0307     99.100  0.0061    99.792  649.21
  53   0.0283     99.140  0.0060    99.803  661.63
  54   0.0316     99.090  0.0067    99.778  674.04
  55   0.0297     99.140  0.0056    99.825  686.45
  56   0.0324     99.050  0.0056    99.815  698.94
  57   0.0281     99.200  0.0053    99.837  711.37
  58   0.0285     99.190  0.0055    99.822  723.77
  59   0.0288     99.260  0.0045    99.863  736.29
  60   0.0317     99.080  0.0043    99.863  748.69
  61   0.0293     99.240  0.0049    99.840  761.11
  62   0.0331     99.050  0.0044    99.858  773.63
  63   0.0282     99.190  0.0045    99.878  786.03
  64   0.0325     99.080  0.0036    99.897  798.45
  65   0.0313     99.130  0.0033    99.895  810.88
  66   0.0307     99.180  0.0036    99.897  823.37
  67   0.0364     99.050  0.0029    99.925  835.78
  68   0.0321     99.150  0.0031    99.903  848.17
  69   0.0304     99.200  0.0030    99.910  860.68
  70   0.0319     99.160  0.0027    99.927  873.10
  71   0.0319     99.170  0.0029    99.910  885.50
  72   0.0340     99.100  0.0029    99.923  897.96
  73   0.0353     99.090  0.0022    99.945  910.42
  74   0.0332     99.190  0.0025    99.937  922.83
  75   0.0362     99.000  0.0024    99.925  935.26
  76   0.0337     99.160  0.0027    99.937  947.68
  77   0.0333     99.150  0.0022    99.940  960.10
  78   0.0328     99.170  0.0021    99.953  972.53
  79   0.0346     99.120  0.0021    99.943  985.02
  80   0.0332     99.160  0.0020    99.963  997.44
  81   0.0344     99.160  0.0018    99.965  1009.85
  82   0.0352     99.100  0.0022    99.957  1022.40
  83   0.0331     99.160  0.0019    99.955  1034.81
  84   0.0344     99.140  0.0019    99.950  1047.22
  85   0.0324     99.220  0.0019    99.963  1059.80
