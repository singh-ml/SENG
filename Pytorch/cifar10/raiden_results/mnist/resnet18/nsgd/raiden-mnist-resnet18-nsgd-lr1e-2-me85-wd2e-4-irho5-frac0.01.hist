Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1440     95.410  0.4142    86.135  14.80
   2   0.0885     97.210  0.0883    97.190  27.34
   3   0.0565     98.200  0.0632    98.032  39.84
   4   0.2603     92.660  0.0593    98.165  52.47
   5   0.0442     98.530  0.0520    98.360  64.96
   6   0.0348     98.850  0.0445    98.597  77.44
   7   0.0539     98.320  0.0406    98.715  90.04
   8   0.0368     98.640  0.0398    98.747  102.54
   9   0.0374     98.710  0.0391    98.777  115.06
  10   0.0418     98.570  0.0351    98.867  127.55
  11   0.0442     98.670  0.0330    98.933  140.09
  12   0.0316     99.000  0.0321    98.995  152.56
  13   0.0421     98.690  0.0308    98.988  165.06
  14   0.0387     98.870  0.0283    99.092  177.70
  15   0.0330     98.920  0.0270    99.122  190.17
  16   0.0395     98.670  0.0264    99.153  202.66
  17   0.0280     99.040  0.0258    99.178  215.27
  18   0.0321     99.010  0.0237    99.200  227.75
  19   0.0318     98.930  0.0242    99.203  240.22
  20   0.0300     99.160  0.0224    99.278  252.81
  21   0.0327     99.020  0.0219    99.263  265.29
  22   0.0391     98.650  0.0206    99.295  277.77
  23   0.0338     98.860  0.0196    99.313  290.30
  24   0.0273     99.120  0.0198    99.320  302.96
  25   0.0374     98.760  0.0203    99.330  315.46
  26   0.0330     98.940  0.0190    99.382  327.98
  27   0.0334     98.910  0.0179    99.405  340.59
  28   0.0273     99.070  0.0177    99.420  353.08
  29   0.0343     98.900  0.0171    99.433  365.55
  30   0.0365     98.730  0.0160    99.442  378.14
  31   0.0354     98.780  0.0159    99.485  390.65
  32   0.0311     98.920  0.0153    99.498  403.15
  33   0.0377     98.720  0.0141    99.525  415.64
  34   0.0374     98.700  0.0135    99.573  428.13
  35   0.0325     99.000  0.0129    99.547  440.61
  36   0.0310     98.900  0.0123    99.582  453.08
  37   0.0314     99.050  0.0124    99.547  465.65
  38   0.0312     99.010  0.0124    99.607  478.16
  39   0.0247     99.300  0.0128    99.537  490.63
  40   0.0306     99.090  0.0114    99.603  503.22
  41   0.0281     99.080  0.0110    99.597  515.72
  42   0.0296     99.150  0.0097    99.705  528.18
  43   0.0341     99.000  0.0096    99.672  540.79
  44   0.0316     99.070  0.0098    99.660  553.23
  45   0.0271     99.240  0.0092    99.677  565.70
  46   0.0343     99.030  0.0082    99.720  578.27
  47   0.0277     99.200  0.0088    99.688  590.75
  48   0.0247     99.190  0.0087    99.697  603.25
  49   0.0293     99.100  0.0071    99.760  615.86
  50   0.0252     99.190  0.0077    99.745  628.37
  51   0.0282     99.140  0.0064    99.790  640.87
  52   0.0258     99.170  0.0062    99.805  653.38
  53   0.0316     99.000  0.0066    99.765  665.97
  54   0.0257     99.200  0.0057    99.810  678.49
  55   0.0289     99.030  0.0055    99.827  690.98
  56   0.0322     98.970  0.0056    99.798  703.64
  57   0.0274     99.210  0.0052    99.835  716.14
  58   0.0256     99.270  0.0047    99.852  728.65
  59   0.0283     99.190  0.0048    99.837  741.14
  60   0.0279     99.190  0.0045    99.862  753.63
  61   0.0297     99.140  0.0043    99.850  766.10
  62   0.0277     99.190  0.0040    99.868  778.70
  63   0.0263     99.260  0.0039    99.873  791.17
  64   0.0281     99.140  0.0034    99.890  803.65
  65   0.0307     99.080  0.0039    99.888  816.17
  66   0.0293     99.180  0.0032    99.910  828.64
  67   0.0328     99.060  0.0029    99.915  841.14
  68   0.0343     99.100  0.0029    99.917  853.64
  69   0.0312     99.110  0.0032    99.908  866.14
  70   0.0313     99.140  0.0035    99.887  878.60
  71   0.0306     99.120  0.0031    99.915  891.10
  72   0.0302     99.150  0.0028    99.908  903.56
  73   0.0352     99.040  0.0027    99.923  916.06
  74   0.0324     99.080  0.0025    99.932  928.56
  75   0.0339     99.050  0.0021    99.943  941.14
  76   0.0329     99.040  0.0022    99.932  953.59
  77   0.0303     99.110  0.0024    99.938  966.08
  78   0.0319     99.150  0.0024    99.930  978.66
  79   0.0335     99.060  0.0024    99.930  991.18
  80   0.0316     99.090  0.0019    99.950  1003.73
  81   0.0354     99.030  0.0020    99.940  1016.39
  82   0.0332     99.020  0.0019    99.950  1028.84
  83   0.0319     99.050  0.0020    99.948  1041.37
  84   0.0343     99.080  0.0017    99.958  1054.02
  85   0.0328     99.130  0.0020    99.945  1066.58
