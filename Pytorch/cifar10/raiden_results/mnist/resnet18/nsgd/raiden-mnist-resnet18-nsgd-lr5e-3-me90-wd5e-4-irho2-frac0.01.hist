Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2274     92.470  0.6592    77.672  14.78
   2   0.1230     96.100  0.1253    96.100  27.26
   3   0.1006     96.830  0.0857    97.335  39.79
   4   0.0592     98.010  0.0691    97.815  52.27
   5   0.1111     96.460  0.0588    98.080  64.70
   6   0.0630     97.940  0.0529    98.368  77.14
   7   0.0538     98.210  0.0509    98.353  89.72
   8   0.0470     98.360  0.0455    98.552  102.18
   9   0.0433     98.460  0.0425    98.615  114.61
  10   0.0406     98.690  0.0393    98.795  127.18
  11   0.0403     98.640  0.0373    98.867  139.67
  12   0.0473     98.460  0.0348    98.880  152.11
  13   0.0374     98.690  0.0345    98.882  164.68
  14   0.0426     98.650  0.0317    98.988  177.13
  15   0.0337     98.800  0.0297    99.058  189.62
  16   0.0364     98.770  0.0297    99.040  202.09
  17   0.0474     98.470  0.0288    99.047  214.58
  18   0.0383     98.710  0.0271    99.137  227.07
  19   0.0410     98.680  0.0256    99.143  239.51
  20   0.0403     98.760  0.0253    99.203  252.16
  21   0.0483     98.380  0.0250    99.173  264.62
  22   0.0435     98.560  0.0249    99.155  277.10
  23   0.0304     99.030  0.0231    99.272  289.69
  24   0.0379     98.710  0.0237    99.208  302.16
  25   0.0279     99.140  0.0225    99.278  314.63
  26   0.0341     98.880  0.0217    99.287  327.21
  27   0.0326     98.940  0.0208    99.297  339.67
  28   0.0260     99.180  0.0209    99.287  352.11
  29   0.0325     98.850  0.0204    99.322  364.71
  30   0.0349     98.840  0.0196    99.350  377.16
  31   0.0315     98.970  0.0178    99.422  389.64
  32   0.0261     99.270  0.0177    99.433  402.13
  33   0.0298     99.000  0.0179    99.413  414.60
  34   0.0311     98.930  0.0172    99.447  427.05
  35   0.0269     99.170  0.0164    99.482  439.51
  36   0.0278     99.070  0.0156    99.482  451.99
  37   0.0270     99.180  0.0159    99.472  464.46
  38   0.0288     99.000  0.0156    99.500  476.92
  39   0.0323     99.020  0.0157    99.515  489.51
  40   0.0311     98.910  0.0151    99.492  501.95
  41   0.0244     99.190  0.0139    99.548  514.38
  42   0.0370     98.860  0.0129    99.600  526.95
  43   0.0311     99.060  0.0143    99.535  539.41
  44   0.0318     98.920  0.0126    99.607  551.85
  45   0.0275     99.070  0.0135    99.532  564.45
  46   0.0281     99.160  0.0129    99.570  576.92
  47   0.0266     99.090  0.0124    99.587  589.39
  48   0.0297     98.980  0.0120    99.598  601.85
  49   0.0272     99.050  0.0110    99.663  614.30
  50   0.0237     99.180  0.0112    99.593  626.75
  51   0.0278     99.090  0.0112    99.650  639.23
  52   0.0254     99.110  0.0098    99.703  651.86
  53   0.0290     99.050  0.0096    99.717  664.32
  54   0.0284     98.970  0.0097    99.692  676.79
  55   0.0288     99.110  0.0098    99.702  689.39
  56   0.0251     99.190  0.0103    99.680  701.87
  57   0.0274     99.130  0.0086    99.743  714.33
  58   0.0218     99.290  0.0092    99.688  726.80
  59   0.0256     99.080  0.0092    99.707  739.26
  60   0.0264     99.180  0.0085    99.743  751.73
  61   0.0242     99.260  0.0082    99.715  764.19
  62   0.0235     99.280  0.0080    99.748  776.77
  63   0.0230     99.270  0.0082    99.760  789.20
  64   0.0258     99.100  0.0074    99.783  801.65
  65   0.0278     99.060  0.0074    99.767  814.08
  66   0.0250     99.130  0.0076    99.782  826.64
  67   0.0245     99.180  0.0070    99.780  839.09
  68   0.0243     99.090  0.0067    99.810  851.57
  69   0.0261     99.140  0.0071    99.788  864.13
  70   0.0263     99.160  0.0064    99.820  876.61
  71   0.0222     99.210  0.0068    99.798  889.08
  72   0.0241     99.130  0.0064    99.808  901.52
  73   0.0307     99.010  0.0061    99.813  913.95
  74   0.0260     99.080  0.0062    99.818  926.41
  75   0.0265     99.080  0.0055    99.860  938.89
  76   0.0389     98.780  0.0058    99.835  951.44
  77   0.0275     99.060  0.0059    99.818  963.90
  78   0.0261     99.020  0.0059    99.828  976.36
  79   0.0272     99.080  0.0054    99.833  988.81
  80   0.0278     99.030  0.0048    99.867  1001.48
  81   0.0291     98.960  0.0052    99.862  1013.94
  82   0.0238     99.130  0.0050    99.865  1026.39
  83   0.0283     99.020  0.0049    99.852  1039.04
  84   0.0282     99.080  0.0051    99.848  1051.49
  85   0.0265     99.060  0.0047    99.882  1063.98
  86   0.0261     99.130  0.0047    99.848  1076.57
  87   0.0265     99.060  0.0050    99.863  1089.03
  88   0.0266     99.100  0.0047    99.867  1101.49
  89   0.0265     99.080  0.0049    99.865  1114.13
  90   0.0280     99.080  0.0043    99.890  1126.60
