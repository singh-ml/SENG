Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2156     93.040  0.6416    78.440  14.50
   2   0.1125     96.340  0.1281    95.962  26.84
   3   0.0811     97.260  0.0859    97.350  39.20
   4   0.0620     97.850  0.0684    97.873  51.56
   5   0.0567     98.170  0.0586    98.135  64.03
   6   0.0593     98.030  0.0515    98.390  76.37
   7   0.0660     97.850  0.0490    98.425  88.69
   8   0.0397     98.640  0.0440    98.603  101.03
   9   0.0811     97.260  0.0433    98.595  113.49
  10   0.0377     98.790  0.0391    98.762  125.88
  11   0.0388     98.730  0.0377    98.768  138.22
  12   0.0657     97.850  0.0358    98.883  150.68
  13   0.0558     98.140  0.0330    98.953  163.04
  14   0.0370     98.780  0.0324    98.975  175.40
  15   0.0403     98.510  0.0312    98.957  187.84
  16   0.0428     98.540  0.0296    99.010  200.18
  17   0.0516     98.270  0.0284    99.090  212.53
  18   0.0303     99.020  0.0281    99.100  224.87
  19   0.0319     98.950  0.0269    99.148  237.21
  20   0.0305     98.970  0.0252    99.193  249.58
  21   0.0365     98.850  0.0256    99.155  261.94
  22   0.0359     98.870  0.0238    99.225  274.40
  23   0.0423     98.600  0.0236    99.188  286.75
  24   0.0225     99.250  0.0224    99.273  299.11
  25   0.0306     98.980  0.0231    99.183  311.47
  26   0.0323     98.940  0.0218    99.272  323.90
  27   0.0303     99.040  0.0206    99.337  336.24
  28   0.0252     99.130  0.0209    99.310  348.58
  29   0.0378     98.800  0.0200    99.368  360.90
  30   0.0272     99.070  0.0195    99.337  373.24
  31   0.0314     99.000  0.0186    99.380  385.59
  32   0.0307     99.000  0.0181    99.407  397.94
  33   0.0286     99.140  0.0171    99.425  410.28
  34   0.0331     98.900  0.0173    99.418  422.62
  35   0.0260     99.150  0.0169    99.447  435.08
  36   0.0228     99.270  0.0158    99.457  447.42
  37   0.0367     98.830  0.0153    99.542  459.77
  38   0.0329     98.950  0.0154    99.508  472.10
  39   0.0288     99.110  0.0159    99.512  484.45
  40   0.0302     99.020  0.0142    99.530  496.80
  41   0.0280     99.180  0.0141    99.532  509.14
  42   0.0256     99.130  0.0132    99.555  521.50
  43   0.0240     99.290  0.0139    99.532  533.83
  44   0.0274     99.140  0.0133    99.565  546.16
  45   0.0250     99.260  0.0128    99.592  558.50
  46   0.0277     99.140  0.0128    99.582  570.83
  47   0.0308     99.090  0.0128    99.557  583.15
  48   0.0221     99.240  0.0114    99.650  595.55
  49   0.0258     99.210  0.0111    99.663  607.88
  50   0.0355     98.970  0.0120    99.635  620.19
  51   0.0260     99.250  0.0115    99.605  632.54
  52   0.0254     99.200  0.0109    99.653  644.97
  53   0.0245     99.250  0.0102    99.668  657.31
  54   0.0236     99.240  0.0097    99.703  669.77
  55   0.0309     99.060  0.0099    99.657  682.09
  56   0.0358     98.930  0.0098    99.688  694.40
  57   0.0253     99.200  0.0089    99.738  706.73
  58   0.0242     99.220  0.0092    99.703  719.06
  59   0.0256     99.180  0.0085    99.745  731.40
  60   0.0314     98.990  0.0088    99.732  743.75
  61   0.0244     99.200  0.0082    99.745  756.16
  62   0.0287     99.150  0.0082    99.750  768.49
  63   0.0216     99.350  0.0076    99.798  780.83
  64   0.0266     99.210  0.0078    99.748  793.18
  65   0.0280     99.070  0.0079    99.755  805.64
  66   0.0240     99.260  0.0076    99.738  817.97
  67   0.0241     99.220  0.0074    99.757  830.29
  68   0.0305     99.090  0.0068    99.800  842.64
  69   0.0245     99.220  0.0064    99.808  854.98
  70   0.0289     99.100  0.0065    99.818  867.31
  71   0.0250     99.220  0.0063    99.815  879.77
  72   0.0260     99.200  0.0062    99.812  892.09
  73   0.0264     99.210  0.0059    99.833  904.43
  74   0.0249     99.200  0.0059    99.822  916.93
  75   0.0250     99.220  0.0056    99.837  929.28
  76   0.0277     99.170  0.0058    99.838  941.61
  77   0.0291     99.100  0.0055    99.838  953.94
  78   0.0293     99.090  0.0053    99.848  966.36
  79   0.0273     99.170  0.0052    99.852  978.69
  80   0.0254     99.230  0.0048    99.865  991.04
  81   0.0241     99.250  0.0050    99.848  1003.39
  82   0.0294     99.150  0.0056    99.837  1015.74
  83   0.0258     99.200  0.0046    99.873  1028.08
  84   0.0272     99.150  0.0047    99.863  1040.43
  85   0.0252     99.240  0.0054    99.843  1052.82
  86   0.0272     99.150  0.0048    99.860  1065.16
  87   0.0270     99.200  0.0047    99.863  1077.62
  88   0.0272     99.160  0.0045    99.865  1090.00
  89   0.0258     99.270  0.0049    99.870  1102.34
  90   0.0308     98.980  0.0046    99.885  1114.69
