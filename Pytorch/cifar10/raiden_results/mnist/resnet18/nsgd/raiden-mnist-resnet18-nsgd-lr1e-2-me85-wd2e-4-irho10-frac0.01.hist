Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.8299     75.160  1.4275    62.510  14.69
   2   0.1442     95.620  0.1737    94.653  27.34
   3   0.0869     97.030  0.1015    96.890  39.84
   4   0.0737     97.680  0.0782    97.595  52.30
   5   0.0797     97.500  0.0645    98.028  64.77
   6   0.0496     98.280  0.0562    98.218  77.24
   7   0.0583     98.190  0.0527    98.337  89.69
   8   0.0899     96.830  0.0475    98.473  102.25
   9   0.0586     97.930  0.0437    98.643  114.68
  10   0.0529     98.220  0.0398    98.727  127.14
  11   0.0520     98.420  0.0403    98.770  139.59
  12   0.0401     98.520  0.0403    98.743  152.16
  13   0.0637     97.840  0.0365    98.818  164.61
  14   0.0457     98.540  0.0334    98.953  177.07
  15   0.0565     98.130  0.0318    98.983  189.64
  16   0.0425     98.610  0.0296    99.025  202.06
  17   0.0320     98.930  0.0298    99.032  214.54
  18   0.0336     98.770  0.0301    99.002  227.12
  19   0.0409     98.650  0.0259    99.115  239.58
  20   0.0327     98.860  0.0267    99.117  252.04
  21   0.0354     98.790  0.0251    99.193  264.49
  22   0.0377     98.810  0.0249    99.193  277.12
  23   0.0294     99.030  0.0248    99.203  289.58
  24   0.0403     98.700  0.0248    99.198  302.07
  25   0.0318     98.990  0.0228    99.285  314.63
  26   0.0284     99.060  0.0212    99.318  327.09
  27   0.0308     99.000  0.0207    99.290  339.57
  28   0.0391     98.690  0.0196    99.353  352.16
  29   0.0325     98.890  0.0203    99.315  364.62
  30   0.0324     99.040  0.0188    99.347  377.09
  31   0.0289     99.100  0.0196    99.348  389.64
  32   0.0420     98.730  0.0182    99.370  402.10
  33   0.0411     98.670  0.0182    99.390  414.55
  34   0.0420     98.660  0.0174    99.398  427.02
  35   0.0309     99.040  0.0158    99.482  439.57
  36   0.0309     99.020  0.0158    99.487  452.02
  37   0.0476     98.430  0.0152    99.510  464.45
  38   0.0341     98.890  0.0154    99.465  477.03
  39   0.0373     98.820  0.0149    99.498  489.48
  40   0.0271     99.070  0.0132    99.567  501.95
  41   0.0333     98.940  0.0134    99.552  514.52
  42   0.0347     98.820  0.0136    99.535  526.98
  43   0.0290     99.080  0.0123    99.570  539.45
  44   0.0261     99.160  0.0114    99.615  551.91
  45   0.0315     99.040  0.0118    99.597  564.37
  46   0.0349     98.870  0.0107    99.635  576.84
  47   0.0317     98.970  0.0105    99.632  589.29
  48   0.0331     98.960  0.0108    99.625  601.75
  49   0.0318     99.040  0.0103    99.667  614.18
  50   0.0340     98.980  0.0093    99.678  626.64
  51   0.0267     99.160  0.0086    99.713  639.13
  52   0.0288     99.160  0.0084    99.745  651.59
  53   0.0336     98.940  0.0084    99.718  664.05
  54   0.0416     98.770  0.0087    99.698  676.57
  55   0.0292     99.110  0.0082    99.713  689.03
  56   0.0336     98.940  0.0073    99.770  701.51
  57   0.0326     99.000  0.0073    99.760  714.04
  58   0.0318     99.020  0.0069    99.777  726.49
  59   0.0329     98.970  0.0069    99.763  738.93
  60   0.0288     99.130  0.0059    99.805  751.53
  61   0.0323     99.050  0.0061    99.800  763.96
  62   0.0314     99.080  0.0056    99.813  776.39
  63   0.0268     99.240  0.0062    99.815  788.85
  64   0.0285     99.170  0.0052    99.842  801.33
  65   0.0329     99.060  0.0051    99.835  813.76
  66   0.0296     99.190  0.0050    99.832  826.24
  67   0.0310     99.090  0.0052    99.842  838.80
  68   0.0328     99.080  0.0052    99.837  851.26
  69   0.0312     99.130  0.0049    99.837  863.70
  70   0.0299     99.180  0.0044    99.867  876.30
  71   0.0318     99.180  0.0042    99.860  888.75
  72   0.0322     99.120  0.0046    99.858  901.19
  73   0.0303     99.170  0.0039    99.877  913.72
  74   0.0307     99.180  0.0037    99.913  926.17
  75   0.0333     99.070  0.0038    99.883  938.65
  76   0.0339     99.010  0.0037    99.887  951.17
  77   0.0332     99.070  0.0036    99.890  963.61
  78   0.0334     99.130  0.0034    99.895  976.07
  79   0.0334     99.080  0.0040    99.878  988.58
  80   0.0323     99.190  0.0033    99.898  1001.19
  81   0.0342     99.090  0.0029    99.920  1013.73
  82   0.0309     99.200  0.0033    99.902  1026.17
  83   0.0343     99.130  0.0031    99.910  1038.63
  84   0.0326     99.140  0.0029    99.917  1051.11
  85   0.0333     99.040  0.0031    99.910  1063.60
