Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1723     94.440  0.4855    83.308  14.81
   2   0.2300     92.640  0.0947    97.002  27.46
   3   0.1182     95.960  0.0702    97.747  40.18
   4   0.0668     97.860  0.0576    98.200  52.77
   5   0.0823     97.450  0.0501    98.398  65.41
   6   0.0603     97.890  0.0478    98.473  78.16
   7   0.0547     98.210  0.0427    98.623  90.77
   8   0.0414     98.540  0.0386    98.752  103.38
   9   0.0525     98.400  0.0365    98.787  115.97
  10   0.0489     98.360  0.0362    98.835  128.57
  11   0.0387     98.760  0.0338    98.895  141.19
  12   0.0386     98.750  0.0328    98.948  153.81
  13   0.0519     98.440  0.0288    99.053  166.40
  14   0.0472     98.440  0.0299    99.000  178.99
  15   0.0412     98.620  0.0281    99.115  191.56
  16   0.0446     98.520  0.0272    99.122  204.38
  17   0.0420     98.630  0.0274    99.103  217.01
  18   0.0387     98.760  0.0253    99.173  229.60
  19   0.0398     98.750  0.0236    99.240  242.32
  20   0.0315     98.930  0.0228    99.238  254.93
  21   0.0400     98.780  0.0231    99.237  267.57
  22   0.0305     99.050  0.0203    99.340  280.27
  23   0.0354     98.790  0.0202    99.333  292.91
  24   0.0379     98.750  0.0212    99.297  305.54
  25   0.0352     98.870  0.0192    99.332  318.17
  26   0.0302     99.090  0.0196    99.355  330.98
  27   0.0390     98.730  0.0177    99.428  343.61
  28   0.0330     99.030  0.0170    99.463  356.35
  29   0.0311     99.070  0.0166    99.428  368.95
  30   0.0279     99.020  0.0151    99.498  381.55
  31   0.0257     99.090  0.0154    99.460  394.15
  32   0.0277     99.060  0.0154    99.523  406.76
  33   0.0350     98.980  0.0156    99.478  419.36
  34   0.0227     99.280  0.0141    99.548  432.03
  35   0.0357     98.930  0.0139    99.550  444.76
  36   0.0306     99.120  0.0137    99.545  457.36
  37   0.0279     99.140  0.0135    99.553  469.99
  38   0.0355     98.790  0.0127    99.592  482.61
  39   0.0327     99.000  0.0128    99.562  495.22
  40   0.0309     99.060  0.0120    99.612  507.85
  41   0.0322     99.050  0.0116    99.642  520.60
  42   0.0280     99.020  0.0117    99.592  533.19
  43   0.0302     99.090  0.0110    99.657  545.79
  44   0.0264     99.190  0.0101    99.663  558.50
  45   0.0270     99.130  0.0103    99.662  571.13
  46   0.0343     98.870  0.0100    99.682  583.73
  47   0.0245     99.250  0.0090    99.705  596.35
  48   0.0327     99.010  0.0092    99.673  609.17
  49   0.0319     98.960  0.0087    99.725  621.79
  50   0.0311     99.040  0.0087    99.710  634.40
  51   0.0308     98.990  0.0082    99.753  646.96
  52   0.0345     98.970  0.0076    99.730  659.60
  53   0.0312     98.990  0.0077    99.750  672.20
  54   0.0331     98.970  0.0071    99.757  684.77
  55   0.0295     99.030  0.0071    99.770  697.35
  56   0.0334     99.040  0.0070    99.763  709.93
  57   0.0320     99.140  0.0067    99.797  722.52
  58   0.0338     99.000  0.0058    99.822  735.11
  59   0.0305     99.080  0.0063    99.808  747.71
  60   0.0304     99.110  0.0055    99.817  760.44
  61   0.0277     99.130  0.0060    99.788  773.04
  62   0.0300     99.090  0.0050    99.818  785.63
  63   0.0313     99.100  0.0052    99.827  798.34
  64   0.0287     99.230  0.0054    99.820  810.96
  65   0.0299     99.050  0.0048    99.840  823.57
  66   0.0299     99.110  0.0052    99.837  836.18
  67   0.0288     99.140  0.0048    99.852  848.81
  68   0.0284     99.180  0.0045    99.872  861.43
  69   0.0278     99.120  0.0043    99.862  874.17
  70   0.0296     99.090  0.0043    99.877  886.81
  71   0.0321     99.070  0.0037    99.902  899.47
  72   0.0291     99.100  0.0041    99.865  912.11
  73   0.0290     99.110  0.0036    99.897  924.72
  74   0.0305     99.080  0.0040    99.890  937.32
  75   0.0329     98.970  0.0038    99.885  949.95
  76   0.0293     99.100  0.0037    99.903  962.74
  77   0.0307     99.060  0.0032    99.910  975.34
  78   0.0308     99.040  0.0034    99.902  987.93
  79   0.0303     99.080  0.0031    99.912  1000.68
  80   0.0306     99.120  0.0034    99.895  1013.28
  81   0.0316     99.000  0.0034    99.900  1025.89
  82   0.0319     99.040  0.0031    99.913  1038.59
  83   0.0315     99.090  0.0032    99.912  1051.24
  84   0.0318     99.030  0.0030    99.918  1063.91
  85   0.0304     99.040  0.0029    99.917  1076.64
  86   0.0299     99.070  0.0029    99.920  1089.24
  87   0.0314     99.080  0.0031    99.905  1101.88
  88   0.0313     99.090  0.0029    99.915  1114.50
  89   0.0299     99.100  0.0030    99.925  1127.24
  90   0.0303     99.050  0.0029    99.917  1139.90
