Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2157     92.800  0.5012    82.755  14.83
   2   0.0933     97.030  0.0976    96.955  27.41
   3   0.0690     97.520  0.0696    97.758  40.04
   4   0.0581     98.060  0.0576    98.177  52.64
   5   0.0517     98.390  0.0521    98.367  65.24
   6   0.0622     97.840  0.0475    98.477  77.92
   7   0.0395     98.710  0.0426    98.650  90.56
   8   0.0499     98.420  0.0406    98.713  103.12
   9   0.0403     98.680  0.0367    98.778  115.66
  10   0.0513     98.390  0.0362    98.815  128.24
  11   0.0344     98.930  0.0324    98.937  140.82
  12   0.0484     98.550  0.0315    98.948  153.37
  13   0.0286     99.050  0.0303    99.023  165.94
  14   0.0341     98.870  0.0294    99.058  178.53
  15   0.0374     98.700  0.0278    99.118  191.10
  16   0.0298     99.030  0.0265    99.137  203.66
  17   0.0346     98.860  0.0246    99.150  216.25
  18   0.0313     98.990  0.0254    99.167  228.84
  19   0.0357     98.790  0.0249    99.180  241.51
  20   0.0352     98.840  0.0228    99.267  254.07
  21   0.0335     98.980  0.0222    99.263  266.66
  22   0.0325     98.930  0.0232    99.237  279.31
  23   0.0510     98.400  0.0207    99.305  291.88
  24   0.0355     98.850  0.0210    99.307  304.45
  25   0.0349     98.840  0.0193    99.408  317.04
  26   0.0318     98.990  0.0194    99.330  329.79
  27   0.0277     99.080  0.0193    99.342  342.35
  28   0.0270     99.080  0.0177    99.392  354.91
  29   0.0328     98.970  0.0174    99.420  367.45
  30   0.0273     99.160  0.0165    99.467  380.03
  31   0.0416     98.800  0.0157    99.498  392.56
  32   0.0270     99.010  0.0170    99.435  405.15
  33   0.0331     98.980  0.0152    99.493  417.74
  34   0.0323     98.900  0.0141    99.542  430.30
  35   0.0276     99.090  0.0142    99.532  442.96
  36   0.0265     99.130  0.0142    99.525  455.51
  37   0.0268     99.120  0.0123    99.602  468.08
  38   0.0264     99.150  0.0128    99.568  480.77
  39   0.0267     99.010  0.0118    99.617  493.32
  40   0.0350     98.950  0.0113    99.605  505.91
  41   0.0327     98.910  0.0119    99.603  518.62
  42   0.0239     99.110  0.0112    99.618  531.19
  43   0.0383     98.820  0.0110    99.645  543.79
  44   0.0235     99.240  0.0100    99.668  556.35
  45   0.0304     99.000  0.0105    99.662  568.90
  46   0.0296     98.980  0.0103    99.667  581.47
  47   0.0229     99.190  0.0098    99.660  594.06
  48   0.0250     99.210  0.0091    99.703  606.79
  49   0.0259     99.210  0.0090    99.707  619.36
  50   0.0281     99.150  0.0088    99.717  631.92
  51   0.0305     99.020  0.0080    99.748  644.62
  52   0.0342     98.860  0.0079    99.727  657.25
  53   0.0340     98.980  0.0079    99.742  669.84
  54   0.0282     99.070  0.0072    99.763  682.53
  55   0.0237     99.190  0.0076    99.735  695.12
  56   0.0291     99.040  0.0072    99.782  707.69
  57   0.0239     99.270  0.0060    99.803  720.39
  58   0.0321     98.930  0.0063    99.813  732.98
  59   0.0314     98.980  0.0065    99.782  745.62
  60   0.0304     98.960  0.0061    99.787  758.16
  61   0.0257     99.140  0.0055    99.833  770.71
  62   0.0249     99.190  0.0057    99.825  783.27
  63   0.0291     99.050  0.0058    99.803  795.83
  64   0.0241     99.250  0.0054    99.825  808.41
  65   0.0256     99.170  0.0048    99.848  820.97
  66   0.0289     99.060  0.0054    99.813  833.50
  67   0.0270     99.060  0.0051    99.845  846.04
  68   0.0286     99.020  0.0042    99.883  858.61
  69   0.0244     99.170  0.0047    99.855  871.17
  70   0.0271     99.070  0.0045    99.862  883.79
  71   0.0308     99.000  0.0043    99.875  896.36
  72   0.0283     99.130  0.0042    99.868  908.95
  73   0.0271     99.120  0.0042    99.888  921.55
  74   0.0278     99.040  0.0039    99.883  934.14
  75   0.0270     99.110  0.0034    99.897  946.76
  76   0.0276     99.010  0.0035    99.892  959.44
  77   0.0290     99.040  0.0036    99.902  971.98
  78   0.0298     99.020  0.0035    99.908  984.53
  79   0.0314     99.040  0.0032    99.907  997.09
  80   0.0289     99.050  0.0031    99.913  1009.67
  81   0.0252     99.140  0.0034    99.913  1022.26
  82   0.0273     99.110  0.0033    99.903  1034.85
  83   0.0300     99.130  0.0031    99.918  1047.47
  84   0.0315     99.050  0.0033    99.915  1060.02
  85   0.0284     99.060  0.0032    99.897  1072.61
  86   0.0295     99.030  0.0028    99.927  1085.23
  87   0.0297     98.990  0.0031    99.902  1097.78
  88   0.0285     99.080  0.0032    99.918  1110.36
  89   0.0283     99.090  0.0029    99.915  1122.99
  90   0.0291     99.120  0.0031    99.922  1135.53
