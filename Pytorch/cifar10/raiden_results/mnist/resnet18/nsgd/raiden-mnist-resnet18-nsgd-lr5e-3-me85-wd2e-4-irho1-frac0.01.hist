Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2902     90.850  0.9341    68.005  14.72
   2   0.1641     94.780  0.2024    93.653  27.10
   3   0.1079     96.560  0.1169    96.420  39.50
   4   0.1491     94.950  0.0884    97.183  51.97
   5   0.0866     97.370  0.0735    97.673  64.34
   6   0.0985     96.910  0.0669    97.883  76.73
   7   0.0751     97.670  0.0599    98.130  89.07
   8   0.0541     98.180  0.0529    98.328  101.41
   9   0.0553     98.260  0.0514    98.387  113.72
  10   0.0556     98.120  0.0479    98.470  126.06
  11   0.0477     98.380  0.0439    98.583  138.49
  12   0.0444     98.470  0.0413    98.702  150.81
  13   0.0427     98.550  0.0397    98.727  163.13
  14   0.0512     98.320  0.0383    98.788  175.58
  15   0.0568     98.180  0.0368    98.867  187.89
  16   0.0430     98.520  0.0359    98.875  200.22
  17   0.0406     98.650  0.0349    98.860  212.52
  18   0.0369     98.760  0.0346    98.878  224.85
  19   0.0459     98.550  0.0312    99.007  237.18
  20   0.0395     98.640  0.0302    98.985  249.53
  21   0.0381     98.740  0.0303    99.013  261.97
  22   0.0409     98.690  0.0279    99.100  274.32
  23   0.0332     98.910  0.0273    99.123  286.68
  24   0.0378     98.640  0.0274    99.145  299.13
  25   0.0322     98.910  0.0257    99.183  311.46
  26   0.0369     98.830  0.0257    99.182  323.77
  27   0.0335     98.850  0.0247    99.227  336.21
  28   0.0383     98.780  0.0246    99.210  348.53
  29   0.0304     99.030  0.0236    99.223  360.85
  30   0.0374     98.670  0.0224    99.267  373.19
  31   0.0354     98.770  0.0226    99.268  385.63
  32   0.0361     98.880  0.0206    99.342  397.96
  33   0.0342     98.840  0.0210    99.322  410.29
  34   0.0290     98.980  0.0203    99.360  422.70
  35   0.0289     99.060  0.0194    99.388  435.03
  36   0.0385     98.760  0.0204    99.352  447.36
  37   0.0345     98.790  0.0196    99.315  459.82
  38   0.0312     98.960  0.0193    99.395  472.15
  39   0.0314     98.890  0.0175    99.448  484.48
  40   0.0323     99.020  0.0191    99.388  496.84
  41   0.0347     98.860  0.0175    99.422  509.31
  42   0.0346     98.880  0.0182    99.425  521.67
  43   0.0414     98.740  0.0173    99.452  534.01
  44   0.0379     98.810  0.0164    99.465  546.42
  45   0.0357     98.910  0.0165    99.462  558.77
  46   0.0328     98.990  0.0153    99.498  571.10
  47   0.0316     99.030  0.0156    99.508  583.41
  48   0.0326     98.930  0.0146    99.530  595.79
  49   0.0346     98.910  0.0147    99.545  608.11
  50   0.0304     99.070  0.0147    99.538  620.44
  51   0.0324     99.010  0.0141    99.528  632.76
  52   0.0353     98.890  0.0140    99.557  645.10
  53   0.0291     99.130  0.0135    99.578  657.41
  54   0.0366     98.820  0.0135    99.570  669.75
  55   0.0291     99.130  0.0130    99.592  682.06
  56   0.0339     98.930  0.0125    99.625  694.38
  57   0.0321     99.050  0.0128    99.608  706.86
  58   0.0304     99.040  0.0120    99.610  719.20
  59   0.0283     99.150  0.0117    99.628  731.54
  60   0.0303     99.040  0.0120    99.602  744.00
  61   0.0368     98.940  0.0119    99.640  756.32
  62   0.0307     99.050  0.0120    99.602  768.64
  63   0.0281     99.070  0.0114    99.643  781.01
  64   0.0317     99.030  0.0106    99.678  793.31
  65   0.0282     99.140  0.0114    99.633  805.65
  66   0.0295     99.070  0.0106    99.682  817.98
  67   0.0298     99.100  0.0101    99.683  830.30
  68   0.0293     99.070  0.0105    99.655  842.64
  69   0.0283     99.110  0.0107    99.660  854.94
  70   0.0339     98.970  0.0100    99.680  867.39
  71   0.0317     99.010  0.0101    99.670  879.73
  72   0.0270     99.130  0.0100    99.700  892.08
  73   0.0302     99.070  0.0102    99.683  904.41
  74   0.0257     99.130  0.0094    99.708  916.91
  75   0.0298     99.060  0.0099    99.675  929.23
  76   0.0313     99.060  0.0097    99.710  941.56
  77   0.0286     99.040  0.0095    99.698  953.90
  78   0.0326     99.040  0.0096    99.730  966.23
  79   0.0326     99.010  0.0091    99.730  978.54
  80   0.0309     99.080  0.0097    99.722  990.86
  81   0.0324     99.010  0.0093    99.733  1003.19
  82   0.0309     99.060  0.0096    99.703  1015.51
  83   0.0293     99.090  0.0096    99.705  1027.96
  84   0.0287     99.090  0.0091    99.737  1040.28
  85   0.0303     99.090  0.0088    99.745  1052.63
