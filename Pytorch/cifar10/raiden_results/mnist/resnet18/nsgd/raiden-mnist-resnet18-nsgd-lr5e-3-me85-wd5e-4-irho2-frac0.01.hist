Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7850115072 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2356     92.560  0.6283    78.830  19.72
   2   0.1384     95.360  0.1261    96.040  32.97
   3   0.0649     97.860  0.0866    97.303  46.09
   4   0.0845     97.240  0.0721    97.780  59.19
   5   0.0850     97.160  0.0593    98.092  72.30
   6   0.0600     98.030  0.0534    98.258  85.44
   7   0.0697     97.700  0.0489    98.472  98.54
   8   0.0502     98.260  0.0441    98.577  111.67
   9   0.1415     95.160  0.0406    98.698  124.75
  10   0.0470     98.470  0.0393    98.742  137.86
  11   0.0352     98.900  0.0370    98.845  150.97
  12   0.0572     98.010  0.0346    98.913  164.25
  13   0.0338     98.950  0.0338    98.942  177.34
  14   0.0430     98.430  0.0317    98.998  190.46
  15   0.0525     98.230  0.0305    99.002  203.55
  16   0.0417     98.620  0.0293    99.067  216.87
  17   0.0396     98.640  0.0290    99.050  229.96
  18   0.0340     98.780  0.0278    99.052  243.07
  19   0.0401     98.680  0.0270    99.142  256.12
  20   0.0452     98.450  0.0247    99.188  269.21
  21   0.0388     98.640  0.0251    99.193  282.32
  22   0.0385     98.760  0.0238    99.220  295.56
  23   0.0326     98.940  0.0238    99.220  308.65
  24   0.0409     98.670  0.0218    99.282  321.75
  25   0.0343     98.860  0.0221    99.293  334.82
  26   0.0450     98.620  0.0215    99.300  347.91
  27   0.0346     98.820  0.0214    99.315  361.04
  28   0.0328     98.950  0.0203    99.347  374.24
  29   0.0340     98.890  0.0200    99.325  387.33
  30   0.0323     98.920  0.0192    99.397  400.46
  31   0.0269     99.110  0.0191    99.385  413.65
  32   0.0261     99.090  0.0175    99.448  426.73
  33   0.0256     99.170  0.0181    99.427  439.86
  34   0.0292     99.000  0.0167    99.483  453.06
  35   0.0289     99.040  0.0158    99.520  466.18
  36   0.0326     98.910  0.0159    99.473  479.29
  37   0.0409     98.730  0.0153    99.487  492.39
  38   0.0281     99.120  0.0152    99.530  505.50
  39   0.0323     98.950  0.0158    99.497  518.55
  40   0.0240     99.280  0.0147    99.545  531.73
  41   0.0303     99.030  0.0143    99.547  544.82
  42   0.0295     99.110  0.0139    99.550  557.94
  43   0.0312     99.000  0.0141    99.547  571.11
  44   0.0352     98.810  0.0131    99.572  584.21
  45   0.0279     99.190  0.0121    99.618  597.33
  46   0.0268     99.260  0.0121    99.603  610.53
  47   0.0271     99.090  0.0121    99.595  623.64
  48   0.0301     99.170  0.0120    99.617  636.72
  49   0.0327     98.910  0.0110    99.650  649.95
  50   0.0312     99.120  0.0110    99.648  663.04
  51   0.0253     99.200  0.0098    99.692  676.13
  52   0.0273     99.060  0.0102    99.663  689.32
  53   0.0254     99.140  0.0094    99.697  702.43
  54   0.0339     98.890  0.0094    99.710  715.53
  55   0.0294     99.050  0.0093    99.717  728.67
  56   0.0290     99.070  0.0090    99.702  741.75
  57   0.0302     99.110  0.0097    99.672  754.82
  58   0.0310     98.990  0.0082    99.767  768.03
  59   0.0354     98.940  0.0090    99.725  781.13
  60   0.0258     99.160  0.0085    99.745  794.21
  61   0.0276     99.090  0.0076    99.763  807.39
  62   0.0362     98.860  0.0081    99.767  820.49
  63   0.0267     99.160  0.0078    99.772  833.57
  64   0.0323     98.920  0.0076    99.745  846.79
  65   0.0322     99.000  0.0075    99.768  859.87
  66   0.0278     99.120  0.0076    99.755  872.97
  67   0.0317     98.990  0.0065    99.825  886.03
  68   0.0330     98.990  0.0072    99.775  899.29
  69   0.0294     99.140  0.0068    99.787  912.40
  70   0.0278     99.120  0.0064    99.813  925.59
  71   0.0311     99.000  0.0061    99.823  938.68
  72   0.0261     99.140  0.0057    99.818  951.76
  73   0.0280     99.140  0.0057    99.827  964.97
  74   0.0317     98.960  0.0062    99.835  978.03
  75   0.0310     99.010  0.0061    99.812  991.13
  76   0.0297     99.060  0.0061    99.825  1004.32
  77   0.0334     98.930  0.0055    99.843  1017.44
  78   0.0327     99.010  0.0059    99.837  1030.56
  79   0.0325     98.980  0.0055    99.840  1043.75
  80   0.0309     98.990  0.0053    99.845  1056.85
  81   0.0283     99.110  0.0050    99.870  1069.95
  82   0.0305     99.080  0.0048    99.855  1083.05
  83   0.0324     98.990  0.0048    99.873  1096.14
  84   0.0339     98.990  0.0049    99.875  1109.35
  85   0.0304     99.010  0.0047    99.870  1122.57
