Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1964     94.080  0.6607    77.430  14.66
   2   0.1255     96.100  0.1314    95.998  27.20
   3   0.0850     97.100  0.0860    97.338  39.69
   4   0.0792     97.510  0.0684    97.855  52.19
   5   0.0731     97.720  0.0606    98.045  64.67
   6   0.0579     98.170  0.0531    98.340  77.14
   7   0.0558     98.140  0.0485    98.443  89.71
   8   0.0506     98.340  0.0456    98.588  102.18
   9   0.0440     98.580  0.0401    98.690  114.67
  10   0.0558     98.090  0.0374    98.828  127.28
  11   0.0447     98.510  0.0351    98.883  139.82
  12   0.0379     98.810  0.0335    98.913  152.33
  13   0.0409     98.640  0.0337    98.937  164.82
  14   0.0455     98.470  0.0329    98.923  177.32
  15   0.0392     98.750  0.0302    99.027  189.80
  16   0.0418     98.640  0.0284    99.062  202.26
  17   0.0461     98.560  0.0274    99.147  214.73
  18   0.0420     98.570  0.0283    99.105  227.21
  19   0.0425     98.590  0.0255    99.143  239.70
  20   0.0365     98.750  0.0260    99.120  252.33
  21   0.0331     98.790  0.0248    99.188  264.82
  22   0.0288     99.050  0.0231    99.233  277.31
  23   0.0331     98.950  0.0217    99.320  289.91
  24   0.0392     98.780  0.0233    99.242  302.38
  25   0.0337     98.900  0.0213    99.318  314.88
  26   0.0336     98.880  0.0219    99.268  327.49
  27   0.0302     99.010  0.0208    99.327  339.97
  28   0.0299     99.080  0.0189    99.403  352.47
  29   0.0335     99.020  0.0195    99.363  365.00
  30   0.0373     98.830  0.0186    99.435  377.48
  31   0.0309     98.980  0.0188    99.397  389.92
  32   0.0389     98.820  0.0170    99.457  402.42
  33   0.0292     99.130  0.0182    99.403  415.04
  34   0.0398     98.740  0.0161    99.488  427.54
  35   0.0331     98.920  0.0157    99.495  440.04
  36   0.0352     98.990  0.0152    99.493  452.64
  37   0.0312     99.040  0.0148    99.520  465.08
  38   0.0278     99.140  0.0156    99.515  477.56
  39   0.0366     98.900  0.0136    99.572  490.10
  40   0.0266     99.130  0.0140    99.547  502.61
  41   0.0307     99.080  0.0142    99.545  515.09
  42   0.0342     98.940  0.0135    99.537  527.71
  43   0.0224     99.230  0.0125    99.590  540.24
  44   0.0274     99.150  0.0119    99.612  552.78
  45   0.0369     98.770  0.0128    99.590  565.31
  46   0.0320     99.000  0.0123    99.602  577.79
  47   0.0332     98.920  0.0112    99.635  590.27
  48   0.0313     98.950  0.0110    99.670  602.76
  49   0.0329     98.890  0.0107    99.663  615.46
  50   0.0265     99.150  0.0101    99.672  627.94
  51   0.0360     98.860  0.0104    99.677  640.40
  52   0.0365     98.890  0.0100    99.690  652.97
  53   0.0288     99.120  0.0093    99.717  665.45
  54   0.0309     99.030  0.0098    99.710  677.94
  55   0.0313     99.050  0.0095    99.715  690.54
  56   0.0332     98.970  0.0088    99.718  703.05
  57   0.0316     99.010  0.0087    99.733  715.54
  58   0.0247     99.180  0.0086    99.732  728.01
  59   0.0316     99.010  0.0086    99.763  740.71
  60   0.0314     98.960  0.0081    99.752  753.19
  61   0.0287     99.160  0.0076    99.778  765.69
  62   0.0298     99.070  0.0077    99.757  778.17
  63   0.0288     99.170  0.0079    99.752  790.67
  64   0.0280     99.220  0.0073    99.808  803.15
  65   0.0289     99.130  0.0074    99.795  815.66
  66   0.0314     98.990  0.0072    99.787  828.16
  67   0.0284     99.090  0.0069    99.795  840.64
  68   0.0291     99.110  0.0062    99.812  853.25
  69   0.0267     99.200  0.0061    99.820  865.72
  70   0.0283     99.100  0.0061    99.813  878.20
  71   0.0315     99.010  0.0060    99.845  890.77
  72   0.0284     99.180  0.0062    99.822  903.26
  73   0.0312     99.020  0.0064    99.817  915.73
  74   0.0262     99.160  0.0056    99.853  928.23
  75   0.0283     99.130  0.0052    99.853  940.72
  76   0.0303     99.060  0.0054    99.842  953.20
  77   0.0302     99.030  0.0054    99.848  965.81
  78   0.0316     99.100  0.0052    99.862  978.29
  79   0.0282     99.070  0.0053    99.852  990.78
  80   0.0335     99.010  0.0056    99.815  1003.30
  81   0.0273     99.140  0.0055    99.835  1015.79
  82   0.0300     99.060  0.0050    99.870  1028.29
  83   0.0288     99.130  0.0052    99.860  1040.79
  84   0.0277     99.190  0.0054    99.835  1053.47
  85   0.0315     99.040  0.0045    99.878  1066.01
