Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2672     15.460  2.6091    11.940  14.55
   2   1.3715     52.760  1.6953    37.440  27.12
   3   0.3990     84.820  0.4519    85.335  39.54
   4   0.2022     93.330  0.1579    95.043  52.00
   5   0.1244     96.020  0.1002    96.877  64.43
   6   0.0642     97.980  0.0810    97.447  76.88
   7   0.0768     97.460  0.0709    97.820  89.27
   8   0.0552     98.150  0.0645    97.967  101.65
   9   0.0560     98.240  0.0561    98.205  114.08
  10   0.0569     98.280  0.0523    98.323  126.49
  11   0.0687     97.730  0.0488    98.495  138.89
  12   0.0530     98.270  0.0445    98.653  151.30
  13   0.0306     99.090  0.0441    98.625  163.70
  14   0.1521     95.240  0.0406    98.718  176.11
  15   0.0716     97.740  0.0392    98.730  188.62
  16   0.0345     98.930  0.0394    98.762  201.03
  17   0.0365     98.820  0.0361    98.832  213.44
  18   0.0537     98.240  0.0363    98.820  225.88
  19   0.0428     98.660  0.0348    98.898  238.29
  20   0.0467     98.470  0.0325    98.945  250.72
  21   0.0363     98.880  0.0313    98.948  263.16
  22   0.0460     98.420  0.0296    99.025  275.59
  23   0.0414     98.650  0.0289    99.067  288.02
  24   0.0427     98.500  0.0289    99.068  300.43
  25   0.0354     98.870  0.0267    99.127  312.98
  26   0.0410     98.680  0.0264    99.177  325.37
  27   0.0362     98.910  0.0262    99.135  337.80
  28   0.0346     98.870  0.0238    99.245  350.38
  29   0.0357     98.810  0.0235    99.215  362.78
  30   0.0394     98.590  0.0250    99.225  375.23
  31   0.0390     98.850  0.0228    99.258  387.74
  32   0.0261     99.130  0.0222    99.287  400.16
  33   0.0386     98.690  0.0211    99.298  412.56
  34   0.0495     98.450  0.0220    99.303  424.97
  35   0.0259     99.210  0.0208    99.340  437.37
  36   0.0285     99.010  0.0190    99.355  449.83
  37   0.0382     98.780  0.0189    99.382  462.25
  38   0.0305     99.070  0.0196    99.332  474.80
  39   0.0257     99.140  0.0171    99.423  487.19
  40   0.0243     99.100  0.0176    99.440  499.60
  41   0.0248     99.160  0.0161    99.467  512.13
  42   0.0425     98.720  0.0160    99.450  524.54
  43   0.0315     98.980  0.0169    99.440  536.95
  44   0.0316     99.060  0.0153    99.485  549.45
  45   0.0357     98.870  0.0148    99.545  561.84
  46   0.0307     98.930  0.0144    99.527  574.27
  47   0.0343     98.930  0.0144    99.535  586.74
  48   0.0236     99.190  0.0132    99.560  599.18
  49   0.0234     99.270  0.0129    99.567  611.60
  50   0.0327     99.030  0.0117    99.612  623.99
  51   0.0264     99.220  0.0107    99.628  636.38
  52   0.0215     99.340  0.0111    99.637  648.80
  53   0.0272     99.180  0.0107    99.672  661.22
  54   0.0299     99.090  0.0103    99.653  673.76
  55   0.0312     99.000  0.0107    99.638  686.15
  56   0.0239     99.280  0.0099    99.675  698.56
  57   0.0244     99.260  0.0091    99.717  710.98
  58   0.0257     99.240  0.0087    99.717  723.40
  59   0.0276     99.240  0.0075    99.765  735.81
  60   0.0244     99.310  0.0080    99.742  748.23
  61   0.0268     99.200  0.0072    99.772  760.65
  62   0.0291     99.090  0.0075    99.778  773.04
  63   0.0291     99.200  0.0068    99.773  785.42
  64   0.0281     99.190  0.0065    99.792  797.95
  65   0.0335     98.980  0.0060    99.828  810.32
  66   0.0329     99.070  0.0059    99.808  822.72
  67   0.0356     99.020  0.0055    99.833  835.25
  68   0.0330     99.100  0.0046    99.857  847.67
  69   0.0313     99.130  0.0044    99.870  860.08
  70   0.0296     99.200  0.0048    99.868  872.61
  71   0.0280     99.200  0.0047    99.870  885.05
  72   0.0326     99.100  0.0040    99.905  897.47
  73   0.0316     99.150  0.0041    99.873  909.90
  74   0.0321     99.120  0.0039    99.885  922.31
  75   0.0302     99.150  0.0038    99.878  934.74
  76   0.0314     99.130  0.0034    99.892  947.16
  77   0.0314     99.150  0.0032    99.908  959.67
  78   0.0312     99.210  0.0031    99.925  972.07
  79   0.0332     99.110  0.0034    99.910  984.47
  80   0.0316     99.190  0.0029    99.923  996.99
  81   0.0314     99.200  0.0029    99.920  1009.42
  82   0.0310     99.190  0.0027    99.930  1021.84
  83   0.0331     99.200  0.0029    99.923  1034.38
  84   0.0320     99.220  0.0025    99.943  1046.78
  85   0.0324     99.190  0.0025    99.942  1059.20
  86   0.0332     99.170  0.0025    99.930  1071.78
  87   0.0332     99.150  0.0027    99.927  1084.27
  88   0.0336     99.160  0.0029    99.932  1096.71
  89   0.0330     99.140  0.0028    99.940  1109.11
  90   0.0339     99.160  0.0025    99.945  1121.60
