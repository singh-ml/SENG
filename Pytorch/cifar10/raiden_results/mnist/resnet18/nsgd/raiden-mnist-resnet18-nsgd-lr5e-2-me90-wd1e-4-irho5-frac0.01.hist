Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.4561     38.790  2.4645    26.998  14.79
   2   0.3651     88.450  0.6844    76.090  27.34
   3   0.2382     92.220  0.2504    92.075  39.71
   4   0.1275     95.880  0.1505    95.320  52.13
   5   0.1194     95.880  0.1099    96.568  64.51
   6   0.0683     97.790  0.0887    97.222  76.90
   7   0.0799     97.340  0.0772    97.540  89.26
   8   0.0770     97.390  0.0713    97.775  101.63
   9   0.0463     98.640  0.0606    98.123  114.16
  10   0.0636     97.910  0.0562    98.232  126.54
  11   0.0636     97.820  0.0546    98.242  138.93
  12   0.0538     98.280  0.0503    98.348  151.43
  13   0.0440     98.590  0.0480    98.483  163.85
  14   0.0378     98.770  0.0448    98.578  176.27
  15   0.0508     98.400  0.0444    98.598  188.79
  16   0.0533     98.240  0.0418    98.653  201.19
  17   0.0393     98.720  0.0398    98.708  213.61
  18   0.0366     98.700  0.0379    98.763  226.02
  19   0.0500     98.290  0.0385    98.820  238.47
  20   0.0367     98.790  0.0348    98.895  250.90
  21   0.0346     98.740  0.0340    98.925  263.38
  22   0.0446     98.450  0.0339    98.865  275.90
  23   0.0395     98.690  0.0336    98.933  288.34
  24   0.0308     99.070  0.0331    98.975  300.80
  25   0.0376     98.690  0.0308    99.000  313.34
  26   0.0360     98.830  0.0293    99.028  325.77
  27   0.0327     98.740  0.0301    99.043  338.24
  28   0.0346     98.750  0.0298    98.982  350.65
  29   0.0375     98.730  0.0279    99.092  363.11
  30   0.0299     98.960  0.0261    99.153  375.56
  31   0.0283     99.010  0.0273    99.105  388.00
  32   0.0280     99.120  0.0256    99.180  400.45
  33   0.0253     99.160  0.0266    99.130  412.89
  34   0.0316     98.940  0.0244    99.195  425.35
  35   0.0389     98.780  0.0217    99.313  437.82
  36   0.0343     98.950  0.0233    99.252  450.31
  37   0.0303     99.060  0.0237    99.182  462.75
  38   0.0316     98.940  0.0218    99.287  475.23
  39   0.0344     98.730  0.0210    99.292  487.88
  40   0.0243     99.170  0.0201    99.345  500.31
  41   0.0288     99.040  0.0201    99.320  512.76
  42   0.0275     99.030  0.0211    99.328  525.25
  43   0.0255     99.000  0.0194    99.368  537.63
  44   0.0304     98.920  0.0187    99.377  550.06
  45   0.0262     99.110  0.0172    99.427  562.53
  46   0.0380     98.920  0.0181    99.410  574.91
  47   0.0407     98.600  0.0175    99.402  587.61
  48   0.0274     99.060  0.0157    99.497  599.93
  49   0.0325     98.860  0.0149    99.508  612.33
  50   0.0323     98.970  0.0149    99.505  624.75
  51   0.0231     99.200  0.0138    99.535  637.20
  52   0.0220     99.300  0.0156    99.475  649.65
  53   0.0284     99.130  0.0147    99.507  662.15
  54   0.0239     99.130  0.0136    99.552  674.56
  55   0.0258     99.100  0.0123    99.598  687.00
  56   0.0221     99.260  0.0128    99.568  699.25
  57   0.0244     99.200  0.0131    99.543  711.67
  58   0.0220     99.330  0.0117    99.622  724.10
  59   0.0287     99.070  0.0114    99.647  736.48
  60   0.0236     99.160  0.0117    99.595  749.07
  61   0.0238     99.170  0.0111    99.630  761.51
  62   0.0272     99.160  0.0105    99.638  773.90
  63   0.0225     99.340  0.0104    99.658  786.48
  64   0.0221     99.280  0.0099    99.665  798.93
  65   0.0293     99.060  0.0090    99.710  811.35
  66   0.0292     99.010  0.0090    99.723  823.78
  67   0.0248     99.140  0.0090    99.718  836.21
  68   0.0269     99.130  0.0080    99.728  848.64
  69   0.0230     99.230  0.0078    99.742  861.13
  70   0.0264     99.190  0.0080    99.740  873.61
  71   0.0235     99.190  0.0074    99.755  886.03
  72   0.0250     99.180  0.0073    99.775  898.45
  73   0.0232     99.220  0.0077    99.758  910.86
  74   0.0263     99.190  0.0068    99.787  923.28
  75   0.0243     99.230  0.0068    99.793  935.70
  76   0.0225     99.290  0.0066    99.800  948.14
  77   0.0236     99.240  0.0066    99.788  960.63
  78   0.0232     99.220  0.0067    99.802  973.07
  79   0.0230     99.230  0.0063    99.800  985.55
  80   0.0258     99.200  0.0059    99.825  998.07
  81   0.0219     99.260  0.0061    99.807  1010.55
  82   0.0230     99.170  0.0062    99.818  1023.02
  83   0.0251     99.170  0.0060    99.825  1035.49
  84   0.0233     99.180  0.0058    99.833  1047.91
  85   0.0246     99.170  0.0059    99.823  1060.38
  86   0.0255     99.190  0.0056    99.822  1072.80
  87   0.0238     99.180  0.0057    99.832  1085.36
  88   0.0241     99.230  0.0050    99.850  1097.81
  89   0.0246     99.250  0.0053    99.832  1110.24
  90   0.0250     99.180  0.0053    99.840  1122.77
