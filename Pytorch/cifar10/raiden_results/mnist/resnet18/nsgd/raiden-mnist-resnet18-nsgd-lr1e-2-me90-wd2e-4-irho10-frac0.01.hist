Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.5181     65.670  0.7997    77.343  15.15
   2   0.0825     97.290  0.1034    96.807  27.54
   3   0.0803     97.440  0.0699    97.817  39.89
   4   0.0721     97.770  0.0587    98.182  52.30
   5   0.0602     98.190  0.0515    98.433  64.65
   6   0.0554     98.210  0.0474    98.502  77.00
   7   0.0564     98.190  0.0427    98.602  89.40
   8   0.0484     98.470  0.0411    98.715  101.72
   9   0.0342     98.780  0.0378    98.838  114.05
  10   0.0431     98.570  0.0367    98.818  126.39
  11   0.0330     98.910  0.0333    98.945  138.72
  12   0.0384     98.710  0.0342    98.880  151.05
  13   0.0274     98.920  0.0299    99.038  163.40
  14   0.0422     98.700  0.0299    99.008  175.91
  15   0.0425     98.500  0.0289    99.055  188.24
  16   0.0326     98.900  0.0273    99.115  200.58
  17   0.0242     99.150  0.0254    99.132  212.90
  18   0.0269     99.100  0.0275    99.120  225.32
  19   0.0262     99.050  0.0236    99.237  237.67
  20   0.0266     99.150  0.0229    99.227  250.15
  21   0.0347     98.920  0.0231    99.245  262.48
  22   0.0308     98.990  0.0215    99.270  274.80
  23   0.0263     99.090  0.0210    99.297  287.15
  24   0.0261     99.160  0.0215    99.310  299.53
  25   0.0464     98.590  0.0202    99.347  311.88
  26   0.0291     99.060  0.0198    99.323  324.19
  27   0.0376     98.880  0.0179    99.412  336.65
  28   0.0258     99.110  0.0185    99.387  348.98
  29   0.0363     98.860  0.0175    99.413  361.31
  30   0.0246     99.190  0.0165    99.425  373.78
  31   0.0291     99.120  0.0156    99.462  386.12
  32   0.0224     99.200  0.0166    99.437  398.52
  33   0.0222     99.280  0.0145    99.508  410.97
  34   0.0259     99.160  0.0149    99.510  423.28
  35   0.0327     98.990  0.0140    99.532  435.60
  36   0.0376     98.810  0.0137    99.560  448.07
  37   0.0274     99.170  0.0130    99.550  460.41
  38   0.0337     98.900  0.0132    99.550  472.75
  39   0.0307     99.150  0.0144    99.532  485.06
  40   0.0261     99.080  0.0122    99.580  497.39
  41   0.0229     99.260  0.0115    99.627  509.73
  42   0.0353     98.880  0.0102    99.662  522.07
  43   0.0265     99.080  0.0106    99.622  534.43
  44   0.0299     99.050  0.0100    99.673  546.77
  45   0.0296     99.010  0.0096    99.680  559.08
  46   0.0353     98.930  0.0095    99.672  571.51
  47   0.0316     98.980  0.0091    99.698  583.85
  48   0.0349     99.050  0.0093    99.688  596.16
  49   0.0302     99.160  0.0092    99.693  608.47
  50   0.0252     99.260  0.0090    99.693  620.83
  51   0.0262     99.320  0.0072    99.765  633.18
  52   0.0277     99.180  0.0076    99.738  645.55
  53   0.0270     99.270  0.0071    99.720  657.87
  54   0.0295     99.110  0.0062    99.778  670.21
  55   0.0300     99.130  0.0064    99.778  682.51
  56   0.0352     99.040  0.0067    99.765  694.97
  57   0.0316     99.160  0.0066    99.758  707.35
  58   0.0333     98.970  0.0058    99.803  719.68
  59   0.0356     99.060  0.0058    99.793  732.10
  60   0.0325     99.070  0.0064    99.788  744.40
  61   0.0239     99.260  0.0047    99.843  756.72
  62   0.0281     99.180  0.0048    99.833  769.15
  63   0.0286     99.120  0.0043    99.862  781.48
  64   0.0310     99.060  0.0045    99.857  793.82
  65   0.0319     99.020  0.0044    99.857  806.14
  66   0.0319     99.120  0.0039    99.872  818.52
  67   0.0300     99.150  0.0035    99.898  830.83
  68   0.0400     98.970  0.0038    99.863  843.15
  69   0.0304     99.210  0.0035    99.885  855.56
  70   0.0319     99.160  0.0032    99.882  867.91
  71   0.0283     99.220  0.0032    99.887  880.23
  72   0.0300     99.190  0.0028    99.905  892.65
  73   0.0373     99.120  0.0028    99.912  904.96
  74   0.0314     99.160  0.0028    99.908  917.26
  75   0.0330     99.120  0.0028    99.900  929.58
  76   0.0325     99.150  0.0024    99.927  941.86
  77   0.0269     99.240  0.0023    99.933  954.16
  78   0.0299     99.160  0.0023    99.940  966.50
  79   0.0283     99.150  0.0021    99.938  978.89
  80   0.0312     99.110  0.0019    99.953  991.20
  81   0.0323     99.120  0.0020    99.932  1003.52
  82   0.0297     99.230  0.0021    99.942  1015.90
  83   0.0328     99.130  0.0019    99.942  1028.25
  84   0.0333     99.110  0.0021    99.938  1040.57
  85   0.0310     99.240  0.0019    99.945  1053.02
  86   0.0300     99.240  0.0017    99.957  1065.32
  87   0.0349     99.150  0.0016    99.960  1077.63
  88   0.0315     99.180  0.0017    99.950  1090.00
  89   0.0337     99.130  0.0016    99.957  1102.33
  90   0.0361     99.070  0.0014    99.965  1114.62
