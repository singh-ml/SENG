Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3025     90.980  0.9293    73.853  14.55
   2   0.0957     96.910  0.1242    96.117  27.04
   3   0.0663     97.750  0.0891    97.155  39.56
   4   0.0713     97.740  0.0701    97.822  52.03
   5   0.0533     98.380  0.0599    98.112  64.51
   6   0.0754     97.570  0.0558    98.212  77.08
   7   0.0448     98.630  0.0539    98.315  89.59
   8   0.0418     98.710  0.0447    98.578  102.09
   9   0.0443     98.410  0.0403    98.712  114.68
  10   0.0420     98.650  0.0388    98.823  127.13
  11   0.0545     98.370  0.0358    98.865  139.58
  12   0.0429     98.560  0.0339    98.902  152.03
  13   0.0502     98.400  0.0332    98.965  164.50
  14   0.0347     98.890  0.0326    98.932  176.94
  15   0.0295     99.030  0.0297    99.047  189.42
  16   0.0433     98.550  0.0290    99.048  201.86
  17   0.0279     99.080  0.0288    99.070  214.36
  18   0.0390     98.670  0.0264    99.150  226.85
  19   0.0331     98.870  0.0264    99.117  239.32
  20   0.0282     99.030  0.0248    99.215  251.80
  21   0.0382     98.740  0.0229    99.238  264.29
  22   0.0325     99.000  0.0234    99.205  276.88
  23   0.0296     98.990  0.0240    99.215  289.35
  24   0.0314     98.900  0.0211    99.312  301.87
  25   0.0302     99.010  0.0225    99.273  314.52
  26   0.0281     99.150  0.0200    99.362  327.00
  27   0.0307     99.050  0.0185    99.382  339.46
  28   0.0315     98.910  0.0191    99.385  352.02
  29   0.0349     98.820  0.0175    99.390  364.52
  30   0.0287     99.140  0.0179    99.425  376.98
  31   0.0310     99.010  0.0175    99.433  389.51
  32   0.0369     98.880  0.0162    99.435  401.99
  33   0.0438     98.710  0.0162    99.480  414.47
  34   0.0262     99.160  0.0170    99.428  426.96
  35   0.0363     98.790  0.0144    99.532  439.55
  36   0.0383     98.800  0.0149    99.495  452.04
  37   0.0216     99.310  0.0142    99.522  464.54
  38   0.0220     99.280  0.0133    99.565  477.12
  39   0.0315     99.010  0.0126    99.545  489.57
  40   0.0275     99.140  0.0127    99.592  502.06
  41   0.0253     99.280  0.0115    99.608  514.61
  42   0.0230     99.340  0.0129    99.547  527.07
  43   0.0278     99.090  0.0108    99.642  539.55
  44   0.0407     98.720  0.0116    99.608  552.03
  45   0.0292     99.080  0.0106    99.622  564.49
  46   0.0255     99.240  0.0105    99.643  576.94
  47   0.0263     99.140  0.0095    99.675  589.45
  48   0.0214     99.370  0.0088    99.698  602.05
  49   0.0324     99.010  0.0090    99.683  614.50
  50   0.0223     99.270  0.0085    99.720  626.94
  51   0.0241     99.250  0.0076    99.745  639.52
  52   0.0267     99.160  0.0070    99.763  651.99
  53   0.0280     99.080  0.0073    99.748  664.49
  54   0.0266     99.210  0.0075    99.767  676.91
  55   0.0269     99.220  0.0072    99.773  689.46
  56   0.0314     99.140  0.0066    99.793  701.93
  57   0.0290     99.130  0.0062    99.792  714.37
  58   0.0303     99.130  0.0057    99.793  726.93
  59   0.0281     99.190  0.0058    99.807  739.40
  60   0.0364     98.950  0.0053    99.815  751.89
  61   0.0309     99.080  0.0050    99.842  764.40
  62   0.0274     99.170  0.0052    99.833  776.98
  63   0.0283     99.170  0.0046    99.837  789.44
  64   0.0287     99.210  0.0046    99.848  801.93
  65   0.0309     99.120  0.0040    99.877  814.42
  66   0.0244     99.290  0.0042    99.865  826.95
  67   0.0278     99.220  0.0040    99.857  839.38
  68   0.0261     99.240  0.0038    99.880  851.80
  69   0.0338     99.030  0.0033    99.905  864.40
  70   0.0312     99.110  0.0035    99.907  876.85
  71   0.0274     99.190  0.0036    99.903  889.28
  72   0.0262     99.280  0.0030    99.913  901.84
  73   0.0295     99.200  0.0029    99.910  914.29
  74   0.0307     99.110  0.0030    99.897  926.71
  75   0.0325     99.090  0.0030    99.907  939.29
  76   0.0275     99.260  0.0028    99.917  951.77
  77   0.0322     99.220  0.0022    99.933  964.23
  78   0.0311     99.170  0.0025    99.928  976.69
  79   0.0277     99.220  0.0025    99.927  989.16
  80   0.0314     99.180  0.0025    99.913  1001.63
  81   0.0305     99.180  0.0026    99.912  1014.10
  82   0.0311     99.170  0.0021    99.950  1026.58
  83   0.0298     99.220  0.0021    99.953  1039.15
  84   0.0334     99.080  0.0021    99.933  1051.66
  85   0.0303     99.140  0.0025    99.935  1064.19
  86   0.0329     99.100  0.0018    99.950  1076.70
  87   0.0300     99.270  0.0021    99.937  1089.20
  88   0.0302     99.170  0.0020    99.945  1101.82
  89   0.0306     99.220  0.0021    99.935  1114.31
  90   0.0294     99.210  0.0019    99.938  1126.81
