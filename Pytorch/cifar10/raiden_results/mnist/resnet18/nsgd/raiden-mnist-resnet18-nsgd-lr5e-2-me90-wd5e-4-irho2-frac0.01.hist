Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2696     91.070  1.0933    72.138  14.52
   2   0.0929     96.930  0.1458    95.473  26.91
   3   0.0731     97.720  0.0933    97.132  39.40
   4   0.1002     96.750  0.0753    97.597  51.82
   5   0.0585     97.990  0.0656    97.947  64.20
   6   0.0761     97.400  0.0585    98.167  76.72
   7   0.0455     98.360  0.0507    98.405  89.11
   8   0.0441     98.470  0.0498    98.425  101.51
   9   0.0688     97.590  0.0448    98.542  113.90
  10   0.0365     98.770  0.0443    98.570  126.29
  11   0.0565     98.240  0.0432    98.602  138.67
  12   0.0625     98.010  0.0411    98.680  151.08
  13   0.0594     98.190  0.0391    98.742  163.68
  14   0.1193     95.930  0.0407    98.782  176.12
  15   0.0417     98.560  0.0386    98.823  188.52
  16   0.0371     98.650  0.0345    98.927  201.04
  17   0.0482     98.510  0.0355    98.895  213.47
  18   0.0481     98.370  0.0363    98.857  225.84
  19   0.0434     98.590  0.0345    98.863  238.33
  20   0.0522     98.240  0.0328    98.967  250.76
  21   0.0398     98.720  0.0339    98.905  263.16
  22   0.0458     98.550  0.0309    99.053  275.57
  23   0.0578     98.300  0.0316    99.000  288.18
  24   0.0350     98.880  0.0320    99.000  300.58
  25   0.0304     99.010  0.0309    98.992  313.01
  26   0.0366     98.880  0.0322    99.000  325.42
  27   0.0331     98.940  0.0300    99.055  337.80
  28   0.0324     98.970  0.0310    98.980  350.18
  29   0.0378     98.710  0.0279    99.117  362.71
  30   0.0301     98.980  0.0283    99.087  375.11
  31   0.0369     98.830  0.0272    99.140  387.54
  32   0.0429     98.630  0.0271    99.123  399.93
  33   0.0550     98.400  0.0275    99.093  412.32
  34   0.0379     98.800  0.0260    99.153  424.69
  35   0.0315     99.000  0.0263    99.137  437.08
  36   0.0461     98.600  0.0240    99.233  449.45
  37   0.0298     98.980  0.0258    99.170  461.87
  38   0.0314     98.960  0.0260    99.162  474.28
  39   0.0751     97.410  0.0235    99.267  486.66
  40   0.0458     98.630  0.0242    99.242  499.05
  41   0.0407     98.610  0.0217    99.340  511.48
  42   0.0459     98.500  0.0226    99.260  523.97
  43   0.0454     98.610  0.0226    99.267  536.39
  44   0.0298     99.090  0.0209    99.362  548.80
  45   0.0281     99.160  0.0199    99.353  561.28
  46   0.0622     97.990  0.0209    99.322  573.68
  47   0.0374     98.780  0.0214    99.288  586.08
  48   0.0327     98.950  0.0195    99.397  598.57
  49   0.0329     98.910  0.0165    99.465  610.98
  50   0.0399     98.670  0.0178    99.435  623.37
  51   0.0308     98.980  0.0185    99.423  635.76
  52   0.0316     98.980  0.0167    99.437  648.26
  53   0.0272     99.080  0.0152    99.550  660.65
  54   0.0335     99.000  0.0149    99.530  673.05
  55   0.0300     99.050  0.0154    99.510  685.52
  56   0.0202     99.320  0.0148    99.515  697.92
  57   0.0286     99.100  0.0128    99.620  710.29
  58   0.0407     98.780  0.0132    99.585  722.76
  59   0.0318     99.090  0.0122    99.600  735.16
  60   0.0251     99.170  0.0115    99.607  747.57
  61   0.0280     99.140  0.0117    99.608  760.05
  62   0.0316     99.020  0.0109    99.635  772.44
  63   0.0287     99.140  0.0088    99.735  784.83
  64   0.0286     99.120  0.0087    99.742  797.23
  65   0.0306     99.060  0.0087    99.743  809.84
  66   0.0267     99.180  0.0072    99.782  822.23
  67   0.0352     98.950  0.0076    99.777  834.61
  68   0.0323     98.970  0.0071    99.805  847.08
  69   0.0244     99.290  0.0070    99.797  859.46
  70   0.0303     99.100  0.0057    99.830  871.86
  71   0.0305     99.100  0.0053    99.848  884.33
  72   0.0289     99.110  0.0051    99.845  896.72
  73   0.0294     99.160  0.0044    99.870  909.10
  74   0.0285     99.160  0.0036    99.893  921.58
  75   0.0312     99.110  0.0037    99.888  933.95
  76   0.0265     99.250  0.0032    99.913  946.35
  77   0.0273     99.220  0.0032    99.920  958.72
  78   0.0281     99.220  0.0027    99.928  971.10
  79   0.0293     99.210  0.0020    99.963  983.49
  80   0.0302     99.220  0.0022    99.955  995.89
  81   0.0331     99.100  0.0017    99.972  1008.36
  82   0.0286     99.180  0.0021    99.950  1020.75
  83   0.0317     99.180  0.0020    99.955  1033.12
  84   0.0333     99.040  0.0015    99.977  1045.67
  85   0.0317     99.160  0.0015    99.972  1058.08
  86   0.0301     99.190  0.0015    99.973  1070.51
  87   0.0312     99.210  0.0013    99.972  1082.93
  88   0.0321     99.090  0.0013    99.983  1095.38
  89   0.0288     99.230  0.0013    99.978  1107.77
  90   0.0290     99.210  0.0013    99.988  1120.17
