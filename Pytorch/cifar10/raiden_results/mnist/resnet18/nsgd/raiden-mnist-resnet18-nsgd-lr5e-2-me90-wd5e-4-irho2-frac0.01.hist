Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2411     91.660  1.4797    53.915  14.73
   2   0.0870     97.090  0.1575    95.110  27.18
   3   0.1814     94.290  0.0924    97.083  39.75
   4   0.0728     97.700  0.0715    97.792  52.15
   5   0.0630     97.750  0.0632    98.003  64.64
   6   0.0539     98.220  0.0555    98.255  77.08
   7   0.0893     96.880  0.0500    98.417  89.54
   8   0.0562     98.250  0.0473    98.523  102.01
   9   0.0488     98.430  0.0453    98.563  114.48
  10   0.0632     97.850  0.0428    98.662  127.00
  11   0.0596     98.170  0.0426    98.622  139.43
  12   0.0436     98.590  0.0411    98.703  151.88
  13   0.0463     98.570  0.0383    98.750  164.46
  14   0.0379     98.770  0.0388    98.783  176.87
  15   0.0815     97.200  0.0375    98.825  189.31
  16   0.0783     97.230  0.0354    98.883  201.90
  17   0.0455     98.500  0.0362    98.865  214.34
  18   0.0627     98.060  0.0356    98.877  226.78
  19   0.0546     98.470  0.0347    98.913  239.38
  20   0.0505     98.330  0.0331    98.950  251.83
  21   0.0605     98.150  0.0329    98.970  264.28
  22   0.0516     98.230  0.0339    98.915  276.84
  23   0.0384     98.740  0.0302    99.027  289.26
  24   0.0391     98.680  0.0312    99.030  301.71
  25   0.0433     98.570  0.0329    98.982  314.13
  26   0.0564     98.100  0.0322    98.997  326.75
  27   0.0489     98.480  0.0304    99.047  339.19
  28   0.0393     98.640  0.0294    99.075  351.62
  29   0.0446     98.440  0.0293    99.057  364.08
  30   0.0384     98.750  0.0286    99.100  376.57
  31   0.0497     98.450  0.0272    99.147  388.98
  32   0.0636     98.070  0.0265    99.120  401.55
  33   0.0440     98.570  0.0261    99.155  414.02
  34   0.0280     99.080  0.0278    99.135  426.49
  35   0.0274     99.020  0.0262    99.153  439.01
  36   0.0364     98.750  0.0252    99.243  451.46
  37   0.0397     98.780  0.0254    99.135  463.92
  38   0.0381     98.740  0.0239    99.198  476.51
  39   0.0368     98.760  0.0253    99.140  488.92
  40   0.0350     98.890  0.0258    99.167  501.37
  41   0.0282     99.090  0.0239    99.277  513.82
  42   0.0249     99.220  0.0215    99.280  526.49
  43   0.0376     98.840  0.0236    99.262  538.94
  44   0.0261     99.150  0.0217    99.310  551.39
  45   0.0334     98.890  0.0203    99.378  563.83
  46   0.0284     99.070  0.0208    99.330  576.26
  47   0.0405     98.670  0.0204    99.353  588.69
  48   0.0205     99.280  0.0202    99.343  601.27
  49   0.0303     99.050  0.0181    99.447  613.73
  50   0.0333     98.920  0.0191    99.393  626.15
  51   0.0374     98.760  0.0162    99.483  638.70
  52   0.0371     98.830  0.0169    99.450  651.17
  53   0.0342     98.920  0.0172    99.465  663.63
  54   0.0215     99.370  0.0152    99.512  676.07
  55   0.0279     99.010  0.0144    99.560  688.49
  56   0.0370     98.780  0.0166    99.482  700.93
  57   0.0275     99.140  0.0150    99.525  713.40
  58   0.0286     99.050  0.0125    99.605  726.02
  59   0.0327     98.980  0.0127    99.588  738.48
  60   0.0231     99.230  0.0119    99.637  750.94
  61   0.0237     99.300  0.0123    99.583  763.48
  62   0.0246     99.220  0.0121    99.600  775.95
  63   0.0256     99.120  0.0103    99.660  788.36
  64   0.0310     98.970  0.0089    99.687  800.95
  65   0.0279     99.100  0.0088    99.742  813.40
  66   0.0286     99.100  0.0084    99.748  825.83
  67   0.0279     99.140  0.0071    99.793  838.28
  68   0.0237     99.270  0.0072    99.785  850.72
  69   0.0272     99.060  0.0066    99.795  863.22
  70   0.0211     99.350  0.0062    99.800  875.65
  71   0.0268     99.190  0.0053    99.830  888.08
  72   0.0242     99.280  0.0053    99.835  900.55
  73   0.0255     99.250  0.0044    99.875  912.98
  74   0.0266     99.180  0.0040    99.885  925.42
  75   0.0258     99.230  0.0039    99.903  937.86
  76   0.0282     99.190  0.0037    99.907  950.28
  77   0.0234     99.260  0.0029    99.922  962.87
  78   0.0262     99.270  0.0023    99.950  975.30
  79   0.0277     99.280  0.0027    99.945  987.75
  80   0.0252     99.350  0.0024    99.948  1000.33
  81   0.0261     99.270  0.0022    99.952  1012.78
  82   0.0300     99.230  0.0019    99.960  1025.23
  83   0.0282     99.210  0.0020    99.947  1037.81
  84   0.0292     99.250  0.0019    99.962  1050.28
  85   0.0289     99.260  0.0018    99.958  1062.72
  86   0.0276     99.210  0.0015    99.973  1075.18
  87   0.0277     99.200  0.0015    99.973  1087.69
  88   0.0293     99.240  0.0015    99.982  1100.18
  89   0.0297     99.230  0.0017    99.957  1112.62
  90   0.0298     99.200  0.0016    99.972  1125.21
