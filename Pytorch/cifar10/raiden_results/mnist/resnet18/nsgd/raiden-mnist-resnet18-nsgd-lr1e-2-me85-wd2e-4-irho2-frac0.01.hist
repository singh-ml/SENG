Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3445     88.960  0.5095    82.358  14.79
   2   0.1458     95.590  0.0993    96.890  27.41
   3   0.0975     96.860  0.0723    97.683  40.13
   4   0.0552     98.200  0.0602    98.033  52.75
   5   0.0490     98.430  0.0528    98.308  65.31
   6   0.0530     98.100  0.0470    98.482  78.02
   7   0.0645     97.880  0.0423    98.660  90.66
   8   0.0524     98.320  0.0390    98.730  103.28
   9   0.0479     98.380  0.0365    98.850  115.84
  10   0.0422     98.640  0.0371    98.825  128.44
  11   0.0497     98.430  0.0348    98.892  141.03
  12   0.0512     98.360  0.0320    99.035  153.62
  13   0.0366     98.800  0.0323    98.982  166.36
  14   0.0414     98.670  0.0290    99.072  178.95
  15   0.0424     98.660  0.0286    99.057  191.55
  16   0.0385     98.730  0.0266    99.128  204.13
  17   0.0338     98.980  0.0265    99.162  216.74
  18   0.0443     98.530  0.0241    99.227  229.35
  19   0.0382     98.730  0.0238    99.228  242.05
  20   0.0398     98.750  0.0243    99.192  254.65
  21   0.0309     98.950  0.0211    99.295  267.24
  22   0.0328     98.950  0.0214    99.295  279.79
  23   0.0288     98.970  0.0207    99.313  292.41
  24   0.0403     98.770  0.0217    99.277  305.03
  25   0.0402     98.780  0.0205    99.303  317.62
  26   0.0433     98.660  0.0187    99.407  330.24
  27   0.0333     98.890  0.0180    99.400  342.81
  28   0.0282     99.050  0.0175    99.407  355.41
  29   0.0331     99.000  0.0174    99.427  368.01
  30   0.0274     99.150  0.0171    99.435  380.59
  31   0.0349     98.830  0.0162    99.497  393.19
  32   0.0325     98.890  0.0159    99.463  405.91
  33   0.0325     99.000  0.0151    99.482  418.48
  34   0.0336     98.990  0.0149    99.520  431.07
  35   0.0277     99.090  0.0149    99.500  443.75
  36   0.0306     99.030  0.0141    99.538  456.35
  37   0.0313     98.910  0.0122    99.618  468.95
  38   0.0271     99.040  0.0123    99.588  481.56
  39   0.0345     98.930  0.0127    99.560  494.15
  40   0.0293     98.970  0.0119    99.608  506.72
  41   0.0262     99.170  0.0113    99.648  519.32
  42   0.0286     99.080  0.0113    99.623  531.91
  43   0.0301     99.010  0.0102    99.657  544.51
  44   0.0344     98.920  0.0106    99.645  557.14
  45   0.0285     99.010  0.0093    99.688  569.70
  46   0.0333     98.880  0.0094    99.705  582.28
  47   0.0248     99.190  0.0089    99.728  594.86
  48   0.0285     99.060  0.0087    99.712  607.47
  49   0.0311     98.930  0.0078    99.743  620.09
  50   0.0291     99.170  0.0080    99.745  632.68
  51   0.0262     99.100  0.0085    99.713  645.48
  52   0.0294     99.000  0.0077    99.738  658.09
  53   0.0274     99.090  0.0077    99.757  670.68
  54   0.0301     99.050  0.0077    99.740  683.38
  55   0.0287     99.060  0.0072    99.787  695.98
  56   0.0292     98.980  0.0075    99.762  708.56
  57   0.0299     99.010  0.0064    99.807  721.29
  58   0.0310     98.970  0.0070    99.785  733.90
  59   0.0256     99.220  0.0060    99.827  746.49
  60   0.0285     99.110  0.0058    99.830  759.07
  61   0.0314     99.040  0.0053    99.842  771.64
  62   0.0303     99.040  0.0054    99.837  784.23
  63   0.0313     98.990  0.0055    99.827  796.82
  64   0.0261     99.120  0.0051    99.860  809.61
  65   0.0324     99.010  0.0048    99.867  822.18
  66   0.0295     99.040  0.0046    99.862  834.79
  67   0.0285     99.060  0.0046    99.865  847.52
  68   0.0287     99.020  0.0043    99.887  860.12
  69   0.0306     98.990  0.0043    99.885  872.73
  70   0.0313     99.030  0.0038    99.888  885.33
  71   0.0294     99.040  0.0037    99.905  897.94
  72   0.0284     99.050  0.0038    99.883  910.53
  73   0.0314     99.060  0.0039    99.887  923.24
  74   0.0287     99.110  0.0039    99.878  935.83
  75   0.0305     99.060  0.0034    99.917  948.44
  76   0.0275     99.120  0.0031    99.913  961.07
  77   0.0288     99.100  0.0038    99.895  973.74
  78   0.0288     99.050  0.0035    99.907  986.39
  79   0.0291     99.080  0.0033    99.905  999.20
  80   0.0294     99.090  0.0036    99.897  1011.84
  81   0.0311     99.010  0.0034    99.915  1024.47
  82   0.0311     99.000  0.0034    99.910  1037.19
  83   0.0274     99.140  0.0032    99.910  1049.82
  84   0.0295     99.040  0.0032    99.918  1062.44
  85   0.0318     99.000  0.0027    99.935  1075.04
