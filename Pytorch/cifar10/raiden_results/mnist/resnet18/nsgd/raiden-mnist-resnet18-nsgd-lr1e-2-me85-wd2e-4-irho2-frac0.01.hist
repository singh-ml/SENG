Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4097     87.630  0.5052    82.637  14.70
   2   0.1080     96.210  0.0964    96.880  27.23
   3   0.0729     97.810  0.0699    97.778  39.61
   4   0.0572     98.130  0.0576    98.190  52.02
   5   0.0585     98.080  0.0513    98.392  64.61
   6   0.0533     98.340  0.0445    98.530  77.02
   7   0.0489     98.350  0.0423    98.702  89.39
   8   0.0364     98.730  0.0425    98.643  101.75
   9   0.0456     98.460  0.0374    98.768  114.14
  10   0.0531     98.350  0.0341    98.938  126.50
  11   0.0376     98.720  0.0323    98.955  139.03
  12   0.0367     98.830  0.0313    98.973  151.42
  13   0.0507     98.330  0.0295    99.037  163.78
  14   0.0276     99.010  0.0296    99.063  176.26
  15   0.0303     99.010  0.0271    99.138  188.61
  16   0.0280     99.080  0.0273    99.108  200.99
  17   0.0331     98.920  0.0275    99.115  213.45
  18   0.0448     98.610  0.0244    99.165  225.82
  19   0.0274     99.120  0.0223    99.272  238.19
  20   0.0326     98.880  0.0235    99.240  250.58
  21   0.0336     98.920  0.0225    99.285  262.96
  22   0.0377     98.770  0.0204    99.338  275.29
  23   0.0348     98.870  0.0205    99.327  287.66
  24   0.0281     99.020  0.0195    99.373  299.98
  25   0.0336     98.980  0.0184    99.417  312.32
  26   0.0292     99.050  0.0190    99.363  324.71
  27   0.0300     99.010  0.0167    99.443  337.21
  28   0.0280     99.060  0.0198    99.330  349.63
  29   0.0257     99.160  0.0165    99.445  361.96
  30   0.0317     98.920  0.0161    99.465  374.41
  31   0.0214     99.240  0.0160    99.447  386.76
  32   0.0307     98.940  0.0154    99.488  399.06
  33   0.0280     99.000  0.0157    99.527  411.50
  34   0.0355     98.850  0.0150    99.487  423.85
  35   0.0286     99.040  0.0135    99.553  436.18
  36   0.0324     98.880  0.0133    99.537  448.55
  37   0.0235     99.220  0.0132    99.540  460.88
  38   0.0322     98.920  0.0126    99.588  473.25
  39   0.0286     98.980  0.0121    99.597  485.61
  40   0.0297     98.990  0.0117    99.610  497.99
  41   0.0253     99.180  0.0111    99.640  510.36
  42   0.0314     99.000  0.0110    99.648  522.73
  43   0.0333     98.870  0.0106    99.622  535.21
  44   0.0256     99.100  0.0112    99.607  547.57
  45   0.0286     99.100  0.0106    99.640  559.90
  46   0.0278     99.100  0.0092    99.695  572.27
  47   0.0247     99.180  0.0097    99.665  584.62
  48   0.0245     99.150  0.0085    99.723  596.99
  49   0.0297     98.970  0.0083    99.737  609.41
  50   0.0240     99.210  0.0084    99.713  621.80
  51   0.0328     98.910  0.0080    99.748  634.18
  52   0.0303     98.890  0.0075    99.775  646.56
  53   0.0298     99.040  0.0069    99.790  658.94
  54   0.0236     99.240  0.0065    99.795  671.31
  55   0.0288     98.990  0.0063    99.830  683.66
  56   0.0298     99.050  0.0065    99.792  696.17
  57   0.0265     99.120  0.0064    99.788  708.50
  58   0.0287     99.160  0.0065    99.808  720.85
  59   0.0312     98.970  0.0057    99.813  733.35
  60   0.0284     99.000  0.0054    99.840  745.74
  61   0.0307     99.000  0.0055    99.842  758.13
  62   0.0332     98.970  0.0055    99.822  770.62
  63   0.0261     99.190  0.0054    99.830  782.97
  64   0.0300     98.990  0.0052    99.835  795.34
  65   0.0264     99.060  0.0046    99.867  807.72
  66   0.0244     99.250  0.0046    99.872  820.22
  67   0.0315     98.920  0.0044    99.858  832.60
  68   0.0306     99.050  0.0039    99.893  844.97
  69   0.0290     99.000  0.0044    99.865  857.49
  70   0.0287     99.100  0.0040    99.882  869.88
  71   0.0274     99.080  0.0039    99.888  882.27
  72   0.0285     99.080  0.0038    99.885  894.81
  73   0.0257     99.150  0.0037    99.892  907.21
  74   0.0271     99.080  0.0036    99.910  919.60
  75   0.0292     99.020  0.0034    99.903  932.02
  76   0.0277     99.050  0.0037    99.893  944.64
  77   0.0294     99.050  0.0032    99.920  957.09
  78   0.0305     98.980  0.0033    99.910  969.49
  79   0.0315     98.970  0.0033    99.913  982.08
  80   0.0309     98.970  0.0030    99.912  994.48
  81   0.0285     99.040  0.0030    99.933  1006.86
  82   0.0305     99.020  0.0029    99.915  1019.33
  83   0.0299     99.010  0.0034    99.903  1031.72
  84   0.0311     99.030  0.0027    99.927  1044.07
  85   0.0301     98.990  0.0032    99.925  1056.64
