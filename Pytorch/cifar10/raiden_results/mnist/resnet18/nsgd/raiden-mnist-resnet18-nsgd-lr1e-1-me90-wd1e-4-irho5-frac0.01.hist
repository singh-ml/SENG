Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2865     14.440  2.7405    10.757  14.79
   2   1.0218     65.890  1.7097    36.897  27.03
   3   0.4900     83.700  0.6247    79.772  39.26
   4   0.6122     82.370  0.2646    91.925  51.47
   5   0.1909     93.610  0.1514    95.278  63.87
   6   0.3209     90.300  0.1184    96.350  76.10
   7   0.1074     96.270  0.0988    96.897  88.30
   8   0.0852     97.150  0.0821    97.480  100.63
   9   0.1051     96.500  0.0792    97.502  112.87
  10   0.0808     97.320  0.0698    97.792  125.12
  11   0.0670     97.880  0.0653    97.962  137.68
  12   0.1356     95.650  0.0594    98.175  149.93
  13   0.0777     97.450  0.0590    98.237  162.39
  14   0.0482     98.420  0.0544    98.320  174.60
  15   0.0461     98.450  0.0509    98.358  187.02
  16   0.0527     98.150  0.0493    98.430  199.36
  17   0.0380     98.740  0.0481    98.517  211.62
  18   0.0487     98.450  0.0490    98.498  224.00
  19   0.0456     98.430  0.0449    98.580  236.31
  20   0.0468     98.500  0.0413    98.710  248.77
  21   0.0519     98.340  0.0400    98.755  261.26
  22   0.0458     98.420  0.0398    98.752  273.77
  23   0.0545     98.140  0.0388    98.753  286.23
  24   0.0413     98.570  0.0382    98.758  298.72
  25   0.0466     98.400  0.0363    98.837  311.04
  26   0.0430     98.480  0.0368    98.813  323.29
  27   0.0568     98.230  0.0358    98.820  335.54
  28   0.0422     98.430  0.0333    98.927  347.89
  29   0.0390     98.620  0.0346    98.885  360.32
  30   0.0440     98.630  0.0328    98.960  372.92
  31   0.0336     98.790  0.0309    99.003  385.38
  32   0.0455     98.480  0.0296    99.087  397.85
  33   0.0498     98.190  0.0304    99.012  410.12
  34   0.0331     98.780  0.0295    99.043  422.45
  35   0.0284     99.000  0.0272    99.150  434.87
  36   0.0410     98.640  0.0271    99.085  447.37
  37   0.0422     98.520  0.0283    99.055  459.65
  38   0.0300     98.900  0.0261    99.145  471.87
  39   0.0399     98.630  0.0252    99.197  484.31
  40   0.0373     98.750  0.0257    99.187  496.63
  41   0.0368     98.900  0.0238    99.265  508.90
  42   0.0340     98.890  0.0228    99.252  521.35
  43   0.0423     98.490  0.0224    99.270  533.68
  44   0.0409     98.630  0.0219    99.313  546.16
  45   0.0298     99.000  0.0227    99.273  558.61
  46   0.0320     98.880  0.0201    99.338  571.23
  47   0.0295     99.020  0.0206    99.328  583.67
  48   0.0344     98.790  0.0189    99.388  596.10
  49   0.0274     99.120  0.0195    99.327  608.51
  50   0.0352     98.860  0.0186    99.410  620.80
  51   0.0365     98.860  0.0162    99.460  633.22
  52   0.0356     98.790  0.0171    99.427  645.66
  53   0.0361     98.800  0.0176    99.447  658.27
  54   0.0321     98.870  0.0156    99.458  670.69
  55   0.0256     99.190  0.0150    99.482  682.99
  56   0.0301     98.970  0.0139    99.543  695.59
  57   0.0347     98.810  0.0130    99.558  708.03
  58   0.0276     99.080  0.0124    99.610  720.31
  59   0.0311     99.000  0.0119    99.608  732.64
  60   0.0294     99.070  0.0130    99.562  745.30
  61   0.0342     98.870  0.0128    99.560  757.71
  62   0.0299     99.060  0.0117    99.605  770.00
  63   0.0328     98.890  0.0102    99.690  782.33
  64   0.0308     99.010  0.0093    99.700  794.81
  65   0.0325     98.990  0.0096    99.662  807.17
  66   0.0298     99.010  0.0098    99.688  819.55
  67   0.0349     98.910  0.0082    99.713  831.86
  68   0.0273     99.030  0.0079    99.750  844.18
  69   0.0252     99.240  0.0080    99.752  856.67
  70   0.0311     99.000  0.0078    99.733  869.25
  71   0.0251     99.150  0.0072    99.758  881.72
  72   0.0310     98.980  0.0070    99.770  894.17
  73   0.0284     99.130  0.0067    99.787  906.61
  74   0.0299     99.040  0.0058    99.812  918.91
  75   0.0273     99.110  0.0060    99.790  931.21
  76   0.0293     99.080  0.0059    99.812  943.80
  77   0.0326     98.960  0.0054    99.825  956.09
  78   0.0297     99.070  0.0054    99.828  968.56
  79   0.0298     99.080  0.0048    99.843  981.08
  80   0.0310     99.040  0.0052    99.828  993.55
  81   0.0301     99.090  0.0049    99.852  1006.01
  82   0.0304     99.050  0.0045    99.860  1018.50
  83   0.0316     99.130  0.0047    99.842  1031.10
  84   0.0314     99.020  0.0044    99.857  1043.60
  85   0.0363     98.940  0.0040    99.863  1055.87
  86   0.0329     99.000  0.0042    99.877  1068.46
  87   0.0331     98.990  0.0042    99.868  1080.80
  88   0.0323     99.000  0.0041    99.878  1093.24
  89   0.0316     99.040  0.0042    99.872  1105.74
  90   0.0311     99.060  0.0041    99.862  1118.14
