Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3035     11.350  2.7568    10.647  15.45
   2   2.2938     11.130  2.3038    10.897  27.78
   3   0.9706     64.660  1.7855    32.493  40.25
   4   0.2793     91.440  0.5434    82.300  52.59
   5   0.2803     91.350  0.2286    93.037  64.93
   6   0.1822     94.560  0.1472    95.457  77.39
   7   0.1302     95.610  0.1139    96.458  89.74
   8   0.1768     94.530  0.1003    96.817  102.09
   9   0.1004     96.560  0.0896    97.137  114.45
  10   0.1154     96.340  0.0749    97.605  126.92
  11   0.0714     97.630  0.0727    97.740  139.27
  12   0.0635     97.760  0.0648    97.958  151.60
  13   0.0550     98.050  0.0610    98.083  163.93
  14   0.0680     97.740  0.0578    98.187  176.29
  15   0.0659     97.790  0.0576    98.207  188.62
  16   0.0817     97.210  0.0532    98.328  201.16
  17   0.0533     98.340  0.0515    98.338  213.50
  18   0.0541     98.380  0.0487    98.417  225.67
  19   0.0548     98.210  0.0464    98.523  238.11
  20   0.0777     97.360  0.0454    98.527  250.42
  21   0.0493     98.190  0.0426    98.640  262.76
  22   0.0428     98.540  0.0422    98.663  275.42
  23   0.0544     98.280  0.0409    98.727  287.78
  24   0.0560     98.060  0.0388    98.767  300.10
  25   0.0509     98.360  0.0371    98.808  312.42
  26   0.0521     98.270  0.0380    98.808  324.77
  27   0.0369     98.670  0.0358    98.852  337.13
  28   0.0506     98.270  0.0353    98.863  349.45
  29   0.0514     98.350  0.0332    98.945  361.92
  30   0.0598     98.060  0.0336    98.887  374.26
  31   0.0323     98.790  0.0335    98.897  386.60
  32   0.0392     98.730  0.0318    98.947  399.06
  33   0.0530     98.440  0.0313    98.952  411.41
  34   0.0364     98.730  0.0310    98.958  423.76
  35   0.0496     98.340  0.0307    98.972  436.09
  36   0.0359     98.760  0.0287    99.072  448.54
  37   0.0397     98.730  0.0277    99.097  460.88
  38   0.0368     98.800  0.0285    99.112  473.23
  39   0.0363     98.950  0.0279    99.062  485.74
  40   0.0403     98.610  0.0268    99.105  498.11
  41   0.0330     98.990  0.0264    99.110  510.46
  42   0.0335     98.950  0.0248    99.145  522.94
  43   0.0479     98.460  0.0239    99.212  535.30
  44   0.0363     98.870  0.0229    99.287  547.80
  45   0.0338     98.870  0.0230    99.218  560.23
  46   0.0331     98.900  0.0224    99.250  572.56
  47   0.0271     99.110  0.0221    99.242  584.89
  48   0.0401     98.730  0.0208    99.295  597.42
  49   0.0280     99.100  0.0208    99.333  609.76
  50   0.0319     99.020  0.0187    99.347  622.25
  51   0.0424     98.500  0.0192    99.357  634.57
  52   0.0346     98.780  0.0189    99.367  646.92
  53   0.0329     98.910  0.0186    99.362  659.26
  54   0.0297     98.980  0.0179    99.408  671.77
  55   0.0350     98.930  0.0171    99.425  684.17
  56   0.0279     99.100  0.0168    99.410  696.70
  57   0.0270     99.050  0.0162    99.450  709.06
  58   0.0320     98.980  0.0153    99.493  721.43
  59   0.0286     99.040  0.0142    99.507  733.83
  60   0.0266     99.180  0.0139    99.530  746.42
  61   0.0272     99.130  0.0136    99.538  759.07
  62   0.0265     99.080  0.0124    99.590  771.47
  63   0.0273     99.160  0.0117    99.580  784.05
  64   0.0260     99.100  0.0127    99.578  796.45
  65   0.0301     99.040  0.0112    99.628  809.03
  66   0.0274     99.040  0.0111    99.637  821.41
  67   0.0235     99.220  0.0104    99.650  834.02
  68   0.0307     98.970  0.0102    99.665  846.41
  69   0.0274     99.040  0.0090    99.683  858.84
  70   0.0284     99.150  0.0091    99.688  871.26
  71   0.0265     99.120  0.0086    99.725  883.78
  72   0.0287     99.120  0.0080    99.730  896.24
  73   0.0263     99.180  0.0079    99.717  908.83
  74   0.0271     99.120  0.0078    99.762  921.51
  75   0.0271     99.130  0.0072    99.767  934.13
  76   0.0276     99.170  0.0072    99.772  946.59
  77   0.0253     99.220  0.0069    99.785  958.97
  78   0.0277     99.050  0.0069    99.787  971.55
  79   0.0243     99.150  0.0067    99.797  983.98
  80   0.0259     99.140  0.0066    99.792  996.44
  81   0.0261     99.190  0.0061    99.805  1009.00
  82   0.0264     99.150  0.0058    99.832  1021.45
  83   0.0256     99.180  0.0055    99.850  1033.88
  84   0.0258     99.110  0.0056    99.810  1046.27
  85   0.0252     99.150  0.0057    99.828  1058.82
  86   0.0273     99.100  0.0056    99.822  1071.25
  87   0.0256     99.160  0.0053    99.827  1083.67
  88   0.0282     99.070  0.0056    99.825  1096.05
  89   0.0269     99.080  0.0057    99.812  1108.68
  90   0.0261     99.140  0.0051    99.845  1121.09
