Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.4671     48.050  2.5789    18.223  14.82
   2   0.4562     84.410  0.7833    72.278  27.23
   3   0.2210     92.740  0.2734    91.042  39.66
   4   0.1239     96.010  0.1511    95.317  52.17
   5   0.1113     96.520  0.1075    96.652  64.61
   6   0.0923     97.090  0.0868    97.233  77.08
   7   0.0799     97.450  0.0785    97.520  89.56
   8   0.0998     96.570  0.0675    97.880  101.97
   9   0.0641     97.880  0.0616    98.115  114.45
  10   0.0625     97.980  0.0565    98.268  126.88
  11   0.0635     98.100  0.0549    98.292  139.36
  12   0.0762     97.510  0.0509    98.418  151.84
  13   0.0428     98.570  0.0487    98.435  164.47
  14   0.0530     98.370  0.0462    98.573  176.84
  15   0.0526     98.330  0.0427    98.652  189.31
  16   0.0495     98.380  0.0411    98.720  201.96
  17   0.0443     98.510  0.0392    98.760  214.44
  18   0.5664     85.000  0.0381    98.790  226.91
  19   0.0409     98.630  0.0393    98.763  239.42
  20   0.0436     98.630  0.0369    98.793  252.03
  21   0.0504     98.350  0.0350    98.840  264.48
  22   0.0372     98.900  0.0334    98.912  276.94
  23   0.0370     98.730  0.0323    98.912  289.51
  24   0.0492     98.410  0.0334    98.973  302.01
  25   0.0348     98.980  0.0314    98.980  314.51
  26   0.0427     98.630  0.0306    99.008  327.07
  27   0.0354     98.730  0.0300    99.015  339.56
  28   0.0421     98.480  0.0284    99.115  352.04
  29   0.0456     98.660  0.0309    99.008  364.53
  30   0.0400     98.800  0.0273    99.123  377.11
  31   0.0539     98.370  0.0253    99.167  389.61
  32   0.0425     98.670  0.0273    99.080  402.07
  33   0.0309     98.990  0.0251    99.202  414.62
  34   0.0596     98.040  0.0245    99.183  427.15
  35   0.0314     98.860  0.0270    99.148  439.57
  36   0.0364     98.780  0.0225    99.235  452.01
  37   0.0278     99.030  0.0227    99.285  464.63
  38   0.0376     98.820  0.0222    99.307  477.11
  39   0.0257     99.170  0.0213    99.302  489.54
  40   0.0331     98.980  0.0207    99.315  502.04
  41   0.0409     98.670  0.0204    99.303  514.65
  42   0.0294     99.110  0.0209    99.303  527.12
  43   0.0356     98.920  0.0215    99.287  539.67
  44   0.0420     98.690  0.0175    99.405  552.27
  45   0.0272     99.140  0.0187    99.358  564.73
  46   0.0415     98.650  0.0178    99.417  577.24
  47   0.0356     98.910  0.0171    99.422  589.88
  48   0.0335     98.920  0.0163    99.470  602.40
  49   0.0269     99.180  0.0161    99.472  614.85
  50   0.0363     98.940  0.0144    99.552  627.29
  51   0.0312     99.070  0.0147    99.522  639.92
  52   0.0375     98.860  0.0146    99.498  652.36
  53   0.0269     99.110  0.0132    99.562  664.80
  54   0.0293     99.030  0.0134    99.582  677.40
  55   0.0255     99.190  0.0119    99.602  689.85
  56   0.0317     98.880  0.0119    99.600  702.35
  57   0.0309     99.090  0.0107    99.657  714.85
  58   0.0281     99.140  0.0107    99.650  727.49
  59   0.0367     99.020  0.0110    99.625  739.94
  60   0.0296     99.040  0.0112    99.628  752.43
  61   0.0323     99.000  0.0103    99.647  764.94
  62   0.0326     99.000  0.0089    99.712  777.46
  63   0.0341     98.850  0.0087    99.708  789.98
  64   0.0271     99.100  0.0085    99.718  802.55
  65   0.0326     98.950  0.0078    99.737  815.03
  66   0.0315     99.060  0.0071    99.767  827.49
  67   0.0286     99.140  0.0072    99.778  839.96
  68   0.0288     99.100  0.0071    99.780  852.41
  69   0.0328     99.010  0.0063    99.793  864.95
  70   0.0297     99.090  0.0059    99.813  877.43
  71   0.0248     99.360  0.0059    99.810  890.05
  72   0.0298     99.130  0.0054    99.835  902.52
  73   0.0298     99.140  0.0049    99.867  915.00
  74   0.0310     99.170  0.0047    99.853  927.57
  75   0.0288     99.140  0.0049    99.843  939.99
  76   0.0284     99.190  0.0041    99.872  952.51
  77   0.0345     99.030  0.0043    99.867  964.94
  78   0.0311     99.170  0.0040    99.882  977.53
  79   0.0316     99.100  0.0038    99.885  990.04
  80   0.0309     99.090  0.0036    99.900  1002.46
  81   0.0289     99.210  0.0034    99.892  1015.05
  82   0.0313     99.130  0.0037    99.880  1027.54
  83   0.0306     99.150  0.0033    99.903  1039.98
  84   0.0313     99.140  0.0032    99.912  1052.56
  85   0.0332     99.120  0.0034    99.897  1065.05
  86   0.0314     99.130  0.0032    99.915  1077.57
  87   0.0304     99.180  0.0030    99.922  1090.10
  88   0.0321     99.100  0.0030    99.918  1102.60
  89   0.0308     99.130  0.0029    99.925  1115.21
  90   0.0307     99.150  0.0031    99.900  1127.77
