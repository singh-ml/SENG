Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.6466     35.010  2.5009    18.572  14.63
   2   0.9505     68.960  0.7073    76.437  27.21
   3   0.1667     94.230  0.2201    93.163  39.73
   4   0.1661     94.460  0.1364    95.770  52.25
   5   0.1118     96.370  0.1028    96.740  64.91
   6   0.1128     96.250  0.0886    97.235  77.43
   7   0.0667     97.700  0.0717    97.717  89.94
   8   0.0802     97.310  0.0659    97.938  102.47
   9   0.0792     97.320  0.0601    98.103  114.97
  10   0.0759     97.390  0.0560    98.170  127.49
  11   0.0759     97.510  0.0523    98.313  140.12
  12   0.0548     98.170  0.0484    98.450  152.68
  13   0.0448     98.480  0.0472    98.522  165.17
  14   0.0499     98.150  0.0434    98.595  177.81
  15   0.0364     98.790  0.0424    98.688  190.36
  16   0.0372     98.700  0.0400    98.748  202.88
  17   0.0402     98.640  0.0381    98.818  215.38
  18   0.0440     98.490  0.0378    98.822  227.90
  19   0.0349     98.810  0.0377    98.783  240.42
  20   0.0465     98.500  0.0337    98.952  252.93
  21   0.0419     98.630  0.0345    98.872  265.54
  22   0.0573     98.000  0.0336    98.952  278.05
  23   0.0410     98.570  0.0330    98.928  290.58
  24   0.0521     98.220  0.0306    98.972  303.24
  25   0.0429     98.550  0.0314    98.993  315.76
  26   0.0427     98.510  0.0293    99.050  328.26
  27   0.0442     98.480  0.0305    99.017  340.87
  28   0.0335     98.890  0.0282    99.103  353.36
  29   0.0369     98.780  0.0286    99.095  365.88
  30   0.0467     98.450  0.0253    99.172  378.51
  31   0.0473     98.520  0.0254    99.173  391.02
  32   0.0410     98.680  0.0274    99.085  403.53
  33   0.0257     99.220  0.0239    99.210  416.06
  34   0.0411     98.630  0.0245    99.190  428.57
  35   0.0345     98.870  0.0239    99.233  441.07
  36   0.0372     98.630  0.0238    99.215  453.58
  37   0.0381     98.670  0.0221    99.282  466.12
  38   0.0362     98.730  0.0211    99.330  478.65
  39   0.0365     98.870  0.0213    99.302  491.14
  40   0.0291     99.110  0.0196    99.343  503.76
  41   0.0287     99.010  0.0198    99.353  516.26
  42   0.0278     99.090  0.0193    99.368  528.78
  43   0.0256     99.110  0.0200    99.330  541.37
  44   0.0293     99.020  0.0189    99.370  553.91
  45   0.0369     98.880  0.0175    99.405  566.44
  46   0.0296     99.000  0.0185    99.387  578.97
  47   0.0321     98.930  0.0160    99.483  591.50
  48   0.0284     99.010  0.0163    99.480  604.02
  49   0.0301     99.090  0.0151    99.492  616.67
  50   0.0333     98.970  0.0146    99.542  629.21
  51   0.0250     99.170  0.0146    99.518  641.77
  52   0.0201     99.370  0.0137    99.530  654.31
  53   0.0418     98.630  0.0134    99.560  666.90
  54   0.0238     99.260  0.0128    99.588  679.46
  55   0.0276     99.140  0.0123    99.623  692.06
  56   0.0312     99.020  0.0121    99.620  704.76
  57   0.0270     99.130  0.0115    99.620  717.30
  58   0.0238     99.250  0.0107    99.663  729.86
  59   0.0282     99.050  0.0104    99.662  742.58
  60   0.0313     99.020  0.0090    99.693  755.15
  61   0.0302     99.060  0.0095    99.707  767.71
  62   0.0212     99.350  0.0093    99.682  780.30
  63   0.0298     99.150  0.0088    99.708  792.87
  64   0.0247     99.180  0.0089    99.710  805.46
  65   0.0275     99.080  0.0078    99.748  818.05
  66   0.0236     99.280  0.0075    99.752  830.62
  67   0.0244     99.220  0.0070    99.772  843.19
  68   0.0240     99.220  0.0064    99.798  855.72
  69   0.0291     99.110  0.0060    99.797  868.47
  70   0.0311     99.100  0.0054    99.828  881.08
  71   0.0262     99.240  0.0058    99.823  893.60
  72   0.0265     99.220  0.0053    99.823  906.20
  73   0.0289     99.120  0.0050    99.842  918.92
  74   0.0268     99.170  0.0050    99.843  931.51
  75   0.0266     99.160  0.0052    99.833  944.08
  76   0.0257     99.230  0.0043    99.877  956.71
  77   0.0259     99.230  0.0041    99.878  969.30
  78   0.0285     99.170  0.0036    99.885  981.89
  79   0.0285     99.200  0.0038    99.885  994.47
  80   0.0269     99.200  0.0038    99.890  1007.21
  81   0.0273     99.170  0.0039    99.880  1019.82
  82   0.0252     99.260  0.0035    99.882  1032.44
  83   0.0276     99.200  0.0035    99.893  1045.05
  84   0.0268     99.240  0.0034    99.898  1057.73
  85   0.0288     99.180  0.0037    99.893  1070.40
  86   0.0279     99.200  0.0035    99.898  1083.06
  87   0.0265     99.220  0.0030    99.928  1095.65
  88   0.0280     99.160  0.0032    99.908  1108.28
  89   0.0269     99.180  0.0030    99.922  1120.94
  90   0.0263     99.210  0.0030    99.917  1133.52
