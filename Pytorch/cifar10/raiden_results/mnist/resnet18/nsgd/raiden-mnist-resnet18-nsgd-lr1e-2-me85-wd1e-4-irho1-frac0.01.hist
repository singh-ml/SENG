Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1989     93.690  0.6675    77.287  14.76
   2   0.1278     96.070  0.1296    95.967  27.16
   3   0.1411     95.360  0.0860    97.300  39.50
   4   0.0895     97.060  0.0698    97.793  51.80
   5   0.0690     97.660  0.0601    98.105  64.09
   6   0.0497     98.360  0.0515    98.385  76.43
   7   0.0543     98.170  0.0489    98.478  88.95
   8   0.0565     98.300  0.0468    98.565  101.30
   9   0.0480     98.450  0.0406    98.698  113.62
  10   0.0480     98.390  0.0384    98.822  125.98
  11   0.0429     98.530  0.0360    98.855  138.40
  12   0.0466     98.360  0.0358    98.843  150.73
  13   0.0288     98.930  0.0333    98.913  163.05
  14   0.0445     98.450  0.0311    99.033  175.37
  15   0.0349     98.800  0.0297    99.025  187.67
  16   0.0348     98.770  0.0298    99.092  200.01
  17   0.0471     98.510  0.0269    99.108  212.35
  18   0.0476     98.510  0.0276    99.112  224.64
  19   0.0336     98.870  0.0265    99.088  236.95
  20   0.0384     98.690  0.0245    99.233  249.34
  21   0.0420     98.690  0.0243    99.208  261.64
  22   0.0345     98.780  0.0239    99.252  273.92
  23   0.0463     98.580  0.0234    99.253  286.35
  24   0.0278     99.020  0.0221    99.273  298.66
  25   0.0341     99.000  0.0216    99.282  310.98
  26   0.0347     98.740  0.0205    99.362  323.43
  27   0.0364     98.820  0.0196    99.337  335.75
  28   0.0342     98.900  0.0202    99.337  348.04
  29   0.0353     98.820  0.0195    99.338  360.36
  30   0.0342     98.860  0.0176    99.425  372.67
  31   0.0316     98.950  0.0182    99.413  384.97
  32   0.0373     98.760  0.0171    99.393  397.27
  33   0.0386     98.760  0.0173    99.422  409.80
  34   0.0392     98.740  0.0175    99.405  422.11
  35   0.0332     98.940  0.0162    99.497  434.44
  36   0.0346     98.920  0.0152    99.465  446.79
  37   0.0377     98.740  0.0146    99.525  459.34
  38   0.0288     98.950  0.0148    99.485  471.65
  39   0.0367     98.810  0.0147    99.507  483.99
  40   0.0320     98.860  0.0142    99.522  496.31
  41   0.0322     99.000  0.0133    99.568  508.66
  42   0.0318     98.940  0.0129    99.565  520.97
  43   0.0261     99.080  0.0113    99.633  533.39
  44   0.0378     98.740  0.0123    99.610  545.70
  45   0.0286     99.110  0.0119    99.605  558.00
  46   0.0298     98.990  0.0117    99.612  570.41
  47   0.0370     98.850  0.0107    99.663  582.74
  48   0.0300     98.990  0.0104    99.675  595.07
  49   0.0333     98.830  0.0104    99.663  607.51
  50   0.0339     98.870  0.0100    99.682  619.84
  51   0.0291     99.070  0.0092    99.670  632.18
  52   0.0288     99.040  0.0100    99.672  644.50
  53   0.0318     98.920  0.0099    99.688  656.93
  54   0.0283     99.040  0.0092    99.710  669.25
  55   0.0282     99.020  0.0087    99.735  681.56
  56   0.0246     99.140  0.0089    99.720  693.97
  57   0.0300     99.010  0.0081    99.727  706.31
  58   0.0287     98.980  0.0081    99.728  718.63
  59   0.0317     98.990  0.0083    99.747  730.94
  60   0.0325     98.870  0.0080    99.728  743.27
  61   0.0280     99.080  0.0078    99.765  755.58
  62   0.0303     98.980  0.0067    99.767  767.99
  63   0.0294     99.020  0.0071    99.793  780.30
  64   0.0274     99.080  0.0067    99.798  792.65
  65   0.0275     99.040  0.0070    99.780  805.09
  66   0.0296     98.990  0.0074    99.782  817.40
  67   0.0299     98.980  0.0068    99.793  829.70
  68   0.0292     99.020  0.0065    99.803  842.02
  69   0.0282     99.090  0.0064    99.812  854.35
  70   0.0315     98.900  0.0062    99.818  866.65
  71   0.0302     99.040  0.0065    99.797  878.97
  72   0.0291     99.020  0.0056    99.808  891.29
  73   0.0294     98.920  0.0064    99.813  903.60
  74   0.0292     98.970  0.0059    99.820  915.92
  75   0.0285     99.050  0.0055    99.833  928.34
  76   0.0281     99.070  0.0061    99.815  940.64
  77   0.0284     99.010  0.0055    99.850  952.95
  78   0.0301     99.000  0.0051    99.847  965.28
  79   0.0282     99.090  0.0055    99.850  977.61
  80   0.0311     99.010  0.0051    99.855  989.94
  81   0.0292     99.060  0.0052    99.850  1002.26
  82   0.0277     99.020  0.0048    99.877  1014.79
  83   0.0287     99.030  0.0052    99.850  1027.11
  84   0.0296     99.000  0.0052    99.850  1039.41
  85   0.0263     99.090  0.0051    99.853  1051.73
