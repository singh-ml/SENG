Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4940     83.240  0.4591    85.268  14.68
   2   0.0948     96.900  0.0881    97.197  27.09
   3   0.0786     97.420  0.0649    98.028  39.52
   4   0.0462     98.500  0.0562    98.200  51.96
   5   0.0523     98.210  0.0513    98.378  64.36
   6   0.0514     98.320  0.0464    98.533  76.80
   7   0.0487     98.390  0.0456    98.503  89.39
   8   0.0516     98.330  0.0408    98.702  101.82
   9   0.0831     97.300  0.0406    98.725  114.23
  10   0.0767     97.560  0.0378    98.782  126.77
  11   0.0428     98.520  0.0392    98.753  139.17
  12   0.0369     98.790  0.0355    98.875  151.58
  13   0.0400     98.730  0.0365    98.828  164.01
  14   0.0375     98.660  0.0361    98.847  176.44
  15   0.0452     98.530  0.0337    98.905  188.89
  16   0.0325     99.010  0.0336    98.930  201.33
  17   0.0336     98.920  0.0335    98.982  213.74
  18   0.0396     98.680  0.0306    99.007  226.17
  19   0.0422     98.590  0.0338    98.878  238.61
  20   0.0271     99.120  0.0314    99.005  251.07
  21   0.0475     98.520  0.0320    99.002  263.52
  22   0.0471     98.370  0.0301    99.032  275.97
  23   0.0502     98.180  0.0309    99.013  288.51
  24   0.0411     98.690  0.0307    99.005  300.92
  25   0.0644     97.980  0.0284    99.082  313.37
  26   0.0384     98.730  0.0297    99.048  325.94
  27   0.0468     98.460  0.0282    99.082  338.35
  28   0.0459     98.540  0.0318    99.013  350.76
  29   0.0391     98.650  0.0277    99.158  363.20
  30   0.0501     98.340  0.0277    99.158  375.64
  31   0.0527     98.300  0.0279    99.110  388.06
  32   0.0265     99.180  0.0264    99.190  400.49
  33   0.0459     98.700  0.0247    99.237  413.03
  34   0.0311     99.030  0.0248    99.217  425.42
  35   0.0292     99.150  0.0258    99.203  437.85
  36   0.0278     99.060  0.0237    99.242  450.37
  37   0.0262     99.110  0.0230    99.295  462.81
  38   0.0462     98.390  0.0232    99.255  475.22
  39   0.0226     99.320  0.0234    99.272  487.76
  40   0.0555     98.200  0.0225    99.317  500.18
  41   0.0301     99.010  0.0224    99.280  512.58
  42   0.0255     99.210  0.0222    99.303  525.02
  43   0.0396     98.730  0.0218    99.307  537.50
  44   0.0352     98.880  0.0188    99.430  549.93
  45   0.0369     98.620  0.0207    99.317  562.44
  46   0.0401     98.740  0.0193    99.398  574.85
  47   0.0297     99.090  0.0194    99.362  587.27
  48   0.0384     98.660  0.0171    99.462  599.70
  49   0.0451     98.540  0.0168    99.475  612.11
  50   0.0277     99.120  0.0185    99.402  624.53
  51   0.0252     99.240  0.0157    99.525  636.92
  52   0.0422     98.660  0.0146    99.555  649.48
  53   0.0328     99.020  0.0146    99.557  661.90
  54   0.0270     99.150  0.0147    99.545  674.31
  55   0.0214     99.270  0.0130    99.595  686.85
  56   0.0319     99.060  0.0126    99.612  699.27
  57   0.0244     99.200  0.0127    99.627  711.70
  58   0.0238     99.160  0.0118    99.645  724.24
  59   0.0248     99.150  0.0106    99.675  736.69
  60   0.0256     99.180  0.0111    99.663  749.11
  61   0.0351     98.970  0.0088    99.737  761.54
  62   0.0279     99.140  0.0094    99.708  773.96
  63   0.0209     99.290  0.0079    99.767  786.38
  64   0.0257     99.240  0.0074    99.773  798.79
  65   0.0397     98.780  0.0069    99.798  811.22
  66   0.0233     99.350  0.0069    99.820  823.65
  67   0.0250     99.240  0.0064    99.827  836.05
  68   0.0318     99.070  0.0057    99.852  848.57
  69   0.0266     99.200  0.0052    99.858  861.00
  70   0.0294     99.160  0.0051    99.860  873.42
  71   0.0227     99.320  0.0043    99.887  885.97
  72   0.0258     99.230  0.0042    99.898  898.40
  73   0.0276     99.200  0.0039    99.910  910.83
  74   0.0258     99.310  0.0032    99.932  923.26
  75   0.0279     99.220  0.0031    99.952  935.68
  76   0.0250     99.290  0.0032    99.925  948.12
  77   0.0261     99.290  0.0028    99.948  960.58
  78   0.0291     99.200  0.0026    99.955  973.01
  79   0.0282     99.260  0.0023    99.960  985.43
  80   0.0277     99.290  0.0027    99.945  997.87
  81   0.0278     99.260  0.0023    99.970  1010.33
  82   0.0268     99.280  0.0022    99.965  1022.76
  83   0.0293     99.250  0.0020    99.972  1035.21
  84   0.0296     99.220  0.0020    99.965  1047.88
  85   0.0273     99.300  0.0018    99.983  1060.34
