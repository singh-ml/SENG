Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.4537     38.340  2.3529    24.552  14.87
   2   0.8941     68.210  0.7593    72.132  27.27
   3   0.1839     94.810  0.2186    93.217  39.67
   4   0.0886     97.000  0.1163    96.442  52.25
   5   0.0934     97.000  0.0873    97.287  64.70
   6   0.0669     97.710  0.0742    97.715  77.17
   7   0.0769     97.370  0.0643    98.003  89.70
   8   0.0522     98.390  0.0594    98.113  102.13
   9   0.0677     97.860  0.0530    98.347  114.58
  10   0.0489     98.330  0.0515    98.442  127.03
  11   0.0728     97.820  0.0488    98.497  139.65
  12   0.0605     98.060  0.0454    98.637  152.07
  13   0.1422     95.460  0.0453    98.578  164.50
  14   0.0761     97.460  0.0446    98.593  176.92
  15   0.0401     98.670  0.0411    98.763  189.30
  16   0.0579     98.100  0.0438    98.592  201.73
  17   0.0505     98.300  0.0420    98.667  214.28
  18   0.0599     97.980  0.0399    98.753  226.67
  19   0.0429     98.550  0.0389    98.798  239.10
  20   0.0576     98.110  0.0378    98.825  251.52
  21   0.0512     98.290  0.0369    98.843  263.97
  22   0.0399     98.800  0.0370    98.770  276.40
  23   0.0438     98.580  0.0362    98.845  288.94
  24   0.0310     98.890  0.0362    98.832  301.37
  25   0.0475     98.450  0.0359    98.852  313.77
  26   0.0347     98.960  0.0339    98.943  326.30
  27   0.0569     98.270  0.0341    98.920  338.72
  28   0.0275     99.060  0.0345    98.942  351.15
  29   0.0479     98.400  0.0321    99.000  363.71
  30   0.0362     98.880  0.0334    98.918  376.13
  31   0.0389     98.690  0.0325    98.973  388.56
  32   0.0451     98.610  0.0319    98.985  400.98
  33   0.0478     98.490  0.0300    99.058  413.38
  34   0.0430     98.660  0.0290    99.063  425.78
  35   0.0343     98.920  0.0303    99.005  438.20
  36   0.0360     98.810  0.0285    99.078  450.63
  37   0.0283     99.060  0.0292    99.073  463.05
  38   0.0409     98.620  0.0265    99.148  475.47
  39   0.0356     98.800  0.0261    99.125  488.01
  40   0.0605     97.990  0.0272    99.105  500.43
  41   0.0231     99.240  0.0247    99.197  512.86
  42   0.0230     99.290  0.0253    99.193  525.39
  43   0.0431     98.680  0.0243    99.178  537.79
  44   0.0402     98.560  0.0244    99.192  550.20
  45   0.0261     99.150  0.0248    99.180  562.64
  46   0.0355     98.800  0.0229    99.238  575.04
  47   0.0326     98.950  0.0250    99.193  587.45
  48   0.0316     98.890  0.0210    99.312  599.86
  49   0.0393     98.670  0.0222    99.277  612.36
  50   0.0334     98.960  0.0208    99.297  624.77
  51   0.0314     98.930  0.0194    99.392  637.15
  52   0.0394     98.710  0.0181    99.425  649.67
  53   0.0408     98.780  0.0186    99.383  662.07
  54   0.0206     99.360  0.0169    99.453  674.49
  55   0.0222     99.300  0.0174    99.373  686.90
  56   0.0293     99.090  0.0169    99.458  699.31
  57   0.0290     99.100  0.0144    99.515  711.73
  58   0.0261     99.220  0.0157    99.467  724.16
  59   0.0241     99.230  0.0146    99.537  736.77
  60   0.0220     99.200  0.0123    99.587  749.22
  61   0.0294     99.080  0.0120    99.587  761.64
  62   0.0265     99.190  0.0123    99.590  774.19
  63   0.0257     99.160  0.0117    99.595  786.59
  64   0.0267     99.140  0.0108    99.658  798.97
  65   0.0285     99.170  0.0096    99.680  811.37
  66   0.0233     99.260  0.0084    99.717  823.77
  67   0.0249     99.220  0.0081    99.713  836.18
  68   0.0281     99.080  0.0075    99.747  848.58
  69   0.0243     99.190  0.0072    99.753  861.05
  70   0.0280     99.010  0.0071    99.765  873.44
  71   0.0252     99.170  0.0060    99.813  885.83
  72   0.0300     99.090  0.0055    99.822  898.24
  73   0.0261     99.220  0.0057    99.798  910.65
  74   0.0289     99.120  0.0047    99.857  923.19
  75   0.0257     99.230  0.0045    99.865  935.60
  76   0.0245     99.310  0.0040    99.888  948.00
  77   0.0249     99.270  0.0041    99.870  960.44
  78   0.0263     99.230  0.0036    99.885  972.84
  79   0.0254     99.200  0.0035    99.892  985.25
  80   0.0262     99.240  0.0032    99.908  997.67
  81   0.0277     99.230  0.0028    99.915  1010.20
  82   0.0297     99.170  0.0026    99.925  1022.62
  83   0.0283     99.200  0.0025    99.917  1035.02
  84   0.0271     99.230  0.0025    99.922  1047.56
  85   0.0294     99.170  0.0026    99.930  1059.97
  86   0.0266     99.250  0.0020    99.947  1072.41
  87   0.0276     99.240  0.0020    99.945  1084.82
  88   0.0292     99.160  0.0020    99.947  1097.32
  89   0.0298     99.220  0.0019    99.958  1109.73
  90   0.0297     99.220  0.0019    99.952  1122.13
