Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.2896     62.190  2.1088    44.545  14.73
   2   0.2612     91.400  0.3345    89.242  27.16
   3   0.3110     90.070  0.1620    94.905  39.63
   4   0.2173     92.930  0.1213    96.227  52.06
   5   0.1037     96.500  0.0984    96.880  64.48
   6   0.0962     96.860  0.0860    97.233  77.00
   7   0.0882     97.130  0.0785    97.490  89.41
   8   0.1054     96.630  0.0718    97.753  101.84
   9   0.1636     95.140  0.0673    97.912  114.38
  10   0.0693     97.780  0.0616    98.075  126.81
  11   0.1269     95.880  0.0600    98.127  139.21
  12   0.0579     98.040  0.0566    98.182  151.62
  13   0.0670     97.740  0.0552    98.230  164.10
  14   0.0618     97.850  0.0503    98.448  176.51
  15   0.0504     98.250  0.0507    98.457  188.99
  16   0.0546     98.170  0.0488    98.477  201.42
  17   0.0540     98.170  0.0477    98.498  213.86
  18   0.0399     98.780  0.0476    98.528  226.30
  19   0.0459     98.380  0.0463    98.520  238.89
  20   0.0488     98.340  0.0434    98.590  251.30
  21   0.0380     98.700  0.0439    98.633  263.72
  22   0.0468     98.360  0.0398    98.763  276.24
  23   0.0720     97.680  0.0406    98.780  288.65
  24   0.0612     98.040  0.0401    98.722  301.04
  25   0.0373     98.740  0.0421    98.662  313.61
  26   0.0583     98.060  0.0382    98.798  326.06
  27   0.0423     98.620  0.0381    98.758  338.50
  28   0.0313     98.930  0.0380    98.800  351.05
  29   0.0472     98.530  0.0367    98.847  363.47
  30   0.0413     98.620  0.0347    98.890  375.87
  31   0.0435     98.680  0.0354    98.883  388.29
  32   0.0405     98.630  0.0335    98.943  400.83
  33   0.0469     98.510  0.0342    98.908  413.25
  34   0.0449     98.620  0.0343    98.870  425.65
  35   0.0411     98.580  0.0334    98.973  438.03
  36   0.0338     99.060  0.0325    98.930  450.44
  37   0.0426     98.640  0.0295    99.062  462.84
  38   0.0367     98.680  0.0301    99.040  475.32
  39   0.0316     98.730  0.0301    99.018  487.71
  40   0.0347     98.970  0.0300    99.010  500.12
  41   0.0268     99.040  0.0291    99.067  512.65
  42   0.0358     98.840  0.0273    99.105  525.04
  43   0.0375     98.740  0.0269    99.130  537.45
  44   0.0283     99.140  0.0244    99.203  549.86
  45   0.0304     99.130  0.0244    99.223  562.45
  46   0.0378     98.760  0.0248    99.185  574.85
  47   0.0480     98.400  0.0236    99.252  587.26
  48   0.0297     99.080  0.0225    99.257  599.66
  49   0.0385     98.790  0.0235    99.242  612.06
  50   0.0367     98.780  0.0230    99.273  624.48
  51   0.0319     99.050  0.0206    99.320  637.00
  52   0.0284     99.060  0.0205    99.325  649.41
  53   0.0357     98.950  0.0196    99.328  661.84
  54   0.0319     99.050  0.0189    99.415  674.38
  55   0.0287     99.020  0.0185    99.390  686.77
  56   0.0249     99.170  0.0177    99.432  699.17
  57   0.0271     99.130  0.0174    99.440  711.55
  58   0.0321     98.950  0.0164    99.462  723.95
  59   0.0272     99.040  0.0152    99.525  736.37
  60   0.0272     99.150  0.0148    99.515  748.78
  61   0.0321     98.990  0.0136    99.540  761.32
  62   0.0301     99.020  0.0125    99.603  773.73
  63   0.0250     99.150  0.0136    99.568  786.13
  64   0.0234     99.210  0.0112    99.623  798.63
  65   0.0274     99.200  0.0108    99.662  811.03
  66   0.0291     99.090  0.0113    99.645  823.44
  67   0.0239     99.250  0.0098    99.700  835.98
  68   0.0327     98.950  0.0087    99.735  848.40
  69   0.0264     99.210  0.0087    99.727  860.81
  70   0.0268     99.230  0.0082    99.742  873.19
  71   0.0252     99.160  0.0068    99.788  885.71
  72   0.0288     99.180  0.0064    99.807  898.11
  73   0.0372     98.860  0.0061    99.812  910.53
  74   0.0281     99.140  0.0064    99.805  923.05
  75   0.0257     99.200  0.0054    99.820  935.45
  76   0.0260     99.180  0.0050    99.853  947.88
  77   0.0285     99.110  0.0043    99.877  960.38
  78   0.0271     99.260  0.0043    99.860  972.78
  79   0.0293     99.130  0.0039    99.883  985.20
  80   0.0287     99.160  0.0034    99.893  997.60
  81   0.0274     99.120  0.0033    99.910  1010.00
  82   0.0248     99.230  0.0034    99.910  1022.39
  83   0.0275     99.210  0.0031    99.915  1034.82
  84   0.0293     99.200  0.0026    99.935  1047.30
  85   0.0276     99.250  0.0024    99.927  1059.68
  86   0.0270     99.230  0.0027    99.927  1072.10
  87   0.0281     99.200  0.0023    99.945  1084.66
  88   0.0290     99.220  0.0023    99.942  1097.09
  89   0.0301     99.180  0.0025    99.942  1109.52
  90   0.0287     99.230  0.0021    99.955  1121.97
