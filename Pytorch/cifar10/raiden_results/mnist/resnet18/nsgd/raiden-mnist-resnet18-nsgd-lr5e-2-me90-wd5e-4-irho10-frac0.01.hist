Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2822     12.100  2.8192    11.097  14.63
   2   2.1613     15.800  2.1917    17.183  26.88
   3   1.2549     55.560  1.2879    51.225  39.30
   4   2.2300     48.330  0.6557    77.760  51.51
   5   0.5011     81.850  0.3222    89.693  63.70
   6   0.2324     93.020  0.1860    94.270  76.01
   7   0.1048     96.580  0.1334    95.873  88.21
   8   0.8138     78.190  0.1102    96.510  100.38
   9   0.1024     96.770  0.0927    97.073  112.57
  10   0.1798     93.650  0.0800    97.530  124.78
  11   0.0908     97.120  0.0775    97.570  137.02
  12   0.0636     97.940  0.0729    97.683  149.23
  13   0.1338     95.570  0.0663    97.915  161.30
  14   0.1186     96.060  0.0643    97.997  173.47
  15   0.0693     97.630  0.0603    98.125  185.67
  16   0.0644     97.910  0.0595    98.142  197.99
  17   0.0888     97.140  0.0570    98.232  210.17
  18   0.0610     97.860  0.0575    98.240  222.37
  19   0.0745     97.600  0.0540    98.310  234.66
  20   0.0483     98.260  0.0507    98.413  246.83
  21   0.0441     98.590  0.0499    98.428  259.20
  22   0.0531     98.250  0.0506    98.335  271.51
  23   0.0577     98.010  0.0477    98.475  283.88
  24   0.0607     98.020  0.0450    98.558  296.08
  25   0.0487     98.440  0.0462    98.550  308.57
  26   0.0364     98.820  0.0429    98.627  320.74
  27   0.0565     97.950  0.0445    98.593  333.13
  28   0.0618     97.940  0.0418    98.732  345.30
  29   0.0538     98.330  0.0429    98.660  357.49
  30   0.0456     98.480  0.0408    98.707  369.84
  31   0.0772     97.550  0.0402    98.643  382.22
  32   0.0626     98.200  0.0410    98.717  394.68
  33   0.0511     98.150  0.0409    98.707  406.85
  34   0.0624     98.030  0.0405    98.700  419.21
  35   0.0448     98.580  0.0373    98.815  431.50
  36   0.0442     98.620  0.0337    98.943  443.90
  37   0.0411     98.720  0.0356    98.857  456.09
  38   0.0389     98.800  0.0352    98.852  468.29
  39   0.0520     98.320  0.0336    98.905  480.67
  40   0.0482     98.680  0.0337    98.923  492.87
  41   0.0391     98.750  0.0317    98.987  505.24
  42   0.0427     98.590  0.0318    98.962  517.61
  43   0.0566     98.080  0.0295    99.043  530.02
  44   0.0308     99.030  0.0327    98.983  542.17
  45   0.0311     99.010  0.0295    99.050  554.45
  46   0.0272     99.080  0.0275    99.117  566.82
  47   0.0635     97.730  0.0281    99.110  579.20
  48   0.0317     98.990  0.0270    99.108  591.71
  49   0.0309     99.000  0.0283    99.097  603.89
  50   0.0250     99.250  0.0253    99.190  616.25
  51   0.0361     98.790  0.0236    99.198  628.61
  52   0.0383     98.730  0.0238    99.207  640.85
  53   0.0548     98.260  0.0256    99.143  653.24
  54   0.0291     99.100  0.0228    99.300  665.62
  55   0.0341     98.970  0.0213    99.330  677.98
  56   0.0288     99.000  0.0201    99.317  690.15
  57   0.0286     99.130  0.0202    99.333  702.53
  58   0.0285     99.090  0.0185    99.382  715.03
  59   0.0267     99.090  0.0184    99.388  727.21
  60   0.0316     98.930  0.0161    99.502  739.38
  61   0.0289     99.110  0.0168    99.467  751.75
  62   0.0257     99.110  0.0164    99.462  763.96
  63   0.0281     99.140  0.0161    99.443  776.30
  64   0.0266     99.150  0.0158    99.477  788.68
  65   0.0257     99.200  0.0128    99.580  801.00
  66   0.0241     99.260  0.0131    99.555  813.34
  67   0.0300     99.080  0.0132    99.545  825.70
  68   0.0303     99.130  0.0123    99.612  838.07
  69   0.0290     99.090  0.0109    99.627  850.45
  70   0.0257     99.180  0.0104    99.657  862.85
  71   0.0248     99.200  0.0104    99.670  875.28
  72   0.0217     99.310  0.0087    99.733  887.64
  73   0.0288     99.150  0.0084    99.723  900.00
  74   0.0250     99.210  0.0082    99.732  912.37
  75   0.0266     99.190  0.0076    99.770  924.75
  76   0.0279     99.180  0.0072    99.782  937.14
  77   0.0259     99.170  0.0068    99.792  949.44
  78   0.0240     99.240  0.0058    99.828  961.81
  79   0.0227     99.340  0.0054    99.842  974.20
  80   0.0266     99.200  0.0053    99.842  986.58
  81   0.0277     99.180  0.0056    99.820  998.96
  82   0.0257     99.230  0.0047    99.872  1011.33
  83   0.0245     99.300  0.0042    99.875  1023.69
  84   0.0274     99.170  0.0042    99.883  1035.97
  85   0.0267     99.190  0.0045    99.868  1048.34
  86   0.0259     99.260  0.0040    99.895  1060.69
  87   0.0269     99.180  0.0036    99.888  1073.18
  88   0.0251     99.290  0.0037    99.903  1085.54
  89   0.0277     99.180  0.0037    99.900  1097.91
  90   0.0255     99.250  0.0036    99.910  1110.28
