Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2981     10.590  2.7909    10.452  14.73
   2   2.7922     14.150  2.2559    13.608  26.88
   3   1.3174     45.340  1.6447    33.810  39.00
   4   1.2903     64.990  0.7706    71.763  51.02
   5   0.2556     92.100  0.3138    89.068  63.19
   6   0.2159     93.240  0.1713    94.968  75.15
   7   0.1247     96.190  0.1227    96.398  87.40
   8   0.1158     96.340  0.0961    97.153  99.56
   9   0.1426     95.500  0.0868    97.363  111.52
  10   0.0796     97.660  0.0789    97.605  123.64
  11   0.0822     97.380  0.0727    97.790  135.90
  12   0.0662     97.780  0.0651    98.017  148.01
  13   0.0939     97.220  0.0626    98.108  159.99
  14   0.0645     97.930  0.0586    98.188  172.24
  15   0.0517     98.160  0.0578    98.207  184.35
  16   0.0522     98.270  0.0557    98.263  196.50
  17   0.0731     97.570  0.0507    98.418  208.64
  18   0.0865     97.220  0.0486    98.480  220.80
  19   0.0608     98.110  0.0535    98.412  232.91
  20   0.0539     98.230  0.0478    98.495  245.06
  21   0.0710     97.630  0.0468    98.522  257.09
  22   0.0489     98.270  0.0451    98.617  269.02
  23   0.0465     98.610  0.0454    98.592  281.16
  24   0.0526     98.300  0.0437    98.622  293.24
  25   0.0552     98.290  0.0422    98.668  305.35
  26   0.0388     98.770  0.0426    98.650  317.49
  27   0.0347     98.770  0.0430    98.657  329.49
  28   0.0762     97.870  0.0406    98.782  341.57
  29   0.0494     98.630  0.0395    98.757  353.73
  30   0.0413     98.770  0.0390    98.760  365.88
  31   0.0392     98.790  0.0381    98.832  377.96
  32   0.0948     96.750  0.0366    98.877  390.10
  33   0.0603     98.190  0.0349    98.903  402.08
  34   0.0501     98.220  0.0367    98.863  414.36
  35   0.0366     98.670  0.0330    98.963  426.50
  36   0.0577     98.060  0.0342    98.932  438.61
  37   0.0683     97.690  0.0359    98.902  450.87
  38   0.0586     98.120  0.0300    99.032  462.80
  39   0.0320     98.930  0.0321    98.973  474.95
  40   0.0381     98.750  0.0301    99.037  487.10
  41   0.0306     98.990  0.0301    99.045  499.12
  42   0.0335     98.930  0.0307    98.997  511.23
  43   0.0254     99.060  0.0296    99.052  523.38
  44   0.0430     98.650  0.0267    99.183  535.64
  45   0.0602     98.150  0.0283    99.072  547.79
  46   0.0341     98.860  0.0263    99.130  559.76
  47   0.0333     98.850  0.0263    99.108  572.03
  48   0.0509     98.210  0.0255    99.155  584.17
  49   0.0355     98.920  0.0251    99.178  596.30
  50   0.0391     98.760  0.0233    99.223  608.28
  51   0.0301     99.050  0.0223    99.302  620.42
  52   0.0326     98.880  0.0199    99.338  632.37
  53   0.0270     99.040  0.0200    99.375  644.51
  54   0.0339     98.920  0.0205    99.385  656.76
  55   0.0353     99.020  0.0188    99.372  668.91
  56   0.0435     98.560  0.0173    99.463  681.05
  57   0.0317     99.020  0.0192    99.342  693.08
  58   0.0283     99.050  0.0171    99.408  705.01
  59   0.0299     99.040  0.0165    99.457  717.14
  60   0.0319     98.990  0.0154    99.490  729.12
  61   0.0318     98.970  0.0140    99.527  741.35
  62   0.0326     99.000  0.0137    99.537  753.47
  63   0.0369     98.860  0.0146    99.515  765.60
  64   0.0325     98.930  0.0126    99.605  777.80
  65   0.0270     99.070  0.0122    99.583  789.70
  66   0.0225     99.260  0.0101    99.663  801.65
  67   0.0266     99.150  0.0097    99.675  813.90
  68   0.0285     99.000  0.0102    99.650  825.86
  69   0.0228     99.410  0.0092    99.692  838.01
  70   0.0345     98.980  0.0084    99.722  850.15
  71   0.0325     98.990  0.0077    99.750  862.48
  72   0.0300     99.030  0.0077    99.708  874.44
  73   0.0304     99.030  0.0067    99.797  886.41
  74   0.0228     99.250  0.0070    99.777  898.43
  75   0.0295     99.110  0.0058    99.815  910.57
  76   0.0313     99.010  0.0062    99.797  922.69
  77   0.0259     99.160  0.0053    99.835  934.84
  78   0.0295     99.150  0.0053    99.825  946.96
  79   0.0239     99.280  0.0044    99.848  958.91
  80   0.0239     99.240  0.0040    99.870  971.03
  81   0.0242     99.260  0.0038    99.885  983.14
  82   0.0273     99.110  0.0036    99.883  995.26
  83   0.0267     99.150  0.0035    99.893  1007.40
  84   0.0244     99.190  0.0035    99.898  1019.63
  85   0.0278     99.110  0.0035    99.903  1031.76
  86   0.0255     99.160  0.0032    99.902  1043.89
  87   0.0275     99.110  0.0032    99.903  1055.99
  88   0.0268     99.120  0.0031    99.910  1068.13
  89   0.0280     99.080  0.0029    99.918  1080.28
  90   0.0285     99.110  0.0029    99.932  1092.43
