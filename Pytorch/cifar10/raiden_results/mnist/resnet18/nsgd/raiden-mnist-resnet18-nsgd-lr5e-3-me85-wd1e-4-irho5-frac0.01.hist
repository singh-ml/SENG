Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1545     95.050  0.4609    84.060  14.62
   2   0.0806     97.400  0.0970    96.978  27.21
   3   0.0722     97.650  0.0720    97.692  39.71
   4   0.0775     97.350  0.0571    98.185  52.23
   5   0.0705     97.800  0.0501    98.422  64.83
   6   0.0540     98.170  0.0460    98.575  77.29
   7   0.0480     98.420  0.0415    98.692  89.79
   8   0.0434     98.500  0.0393    98.762  102.28
   9   0.0356     98.790  0.0361    98.827  114.74
  10   0.0423     98.550  0.0357    98.873  127.19
  11   0.0570     98.180  0.0326    98.958  139.71
  12   0.0487     98.540  0.0320    98.935  152.17
  13   0.0407     98.670  0.0295    99.038  164.63
  14   0.0337     98.760  0.0293    99.058  177.10
  15   0.0446     98.390  0.0271    99.120  189.69
  16   0.0313     98.890  0.0254    99.173  202.16
  17   0.0294     99.040  0.0238    99.245  214.62
  18   0.0361     98.840  0.0259    99.173  227.10
  19   0.0398     98.830  0.0243    99.257  239.60
  20   0.0338     98.840  0.0226    99.307  252.11
  21   0.0276     99.060  0.0224    99.253  264.59
  22   0.0289     99.110  0.0219    99.243  277.17
  23   0.0339     98.880  0.0210    99.313  289.66
  24   0.0363     98.850  0.0192    99.380  302.17
  25   0.0357     98.880  0.0197    99.357  314.74
  26   0.0342     98.990  0.0196    99.357  327.24
  27   0.0290     99.080  0.0179    99.385  339.73
  28   0.0333     98.960  0.0176    99.413  352.22
  29   0.0260     99.200  0.0161    99.473  364.68
  30   0.0330     98.980  0.0157    99.482  377.16
  31   0.0326     99.040  0.0154    99.485  389.65
  32   0.0302     99.100  0.0145    99.542  402.13
  33   0.0339     99.020  0.0147    99.513  414.65
  34   0.0273     99.120  0.0132    99.570  427.15
  35   0.0282     99.130  0.0127    99.573  439.77
  36   0.0292     99.190  0.0132    99.558  452.24
  37   0.0297     99.090  0.0130    99.590  464.72
  38   0.0267     99.180  0.0126    99.583  477.29
  39   0.0314     99.090  0.0115    99.623  489.75
  40   0.0298     99.020  0.0118    99.622  502.22
  41   0.0274     99.130  0.0116    99.617  514.77
  42   0.0371     98.840  0.0108    99.652  527.23
  43   0.0301     99.040  0.0110    99.618  539.69
  44   0.0266     99.110  0.0096    99.673  552.30
  45   0.0292     99.110  0.0097    99.683  564.80
  46   0.0269     99.160  0.0096    99.667  577.26
  47   0.0321     99.010  0.0090    99.692  589.79
  48   0.0291     99.140  0.0088    99.718  602.25
  49   0.0302     99.130  0.0082    99.752  614.71
  50   0.0308     99.130  0.0081    99.715  627.18
  51   0.0332     99.080  0.0083    99.745  639.87
  52   0.0330     99.010  0.0073    99.758  652.32
  53   0.0301     99.140  0.0075    99.770  664.78
  54   0.0270     99.290  0.0067    99.785  677.27
  55   0.0295     99.120  0.0068    99.775  689.73
  56   0.0345     98.930  0.0068    99.763  702.19
  57   0.0301     99.160  0.0061    99.805  714.82
  58   0.0255     99.200  0.0065    99.787  727.28
  59   0.0277     99.180  0.0061    99.787  739.73
  60   0.0341     99.050  0.0058    99.792  752.34
  61   0.0306     99.130  0.0056    99.810  764.81
  62   0.0269     99.170  0.0053    99.838  777.31
  63   0.0300     99.190  0.0053    99.825  789.93
  64   0.0288     99.160  0.0049    99.848  802.37
  65   0.0277     99.100  0.0052    99.850  814.86
  66   0.0275     99.160  0.0042    99.878  827.47
  67   0.0311     99.090  0.0043    99.868  839.96
  68   0.0314     99.140  0.0042    99.853  852.44
  69   0.0277     99.260  0.0047    99.860  864.89
  70   0.0315     99.110  0.0045    99.873  877.33
  71   0.0343     98.980  0.0042    99.850  889.78
  72   0.0313     99.090  0.0046    99.842  902.26
  73   0.0250     99.280  0.0040    99.870  914.85
  74   0.0343     99.040  0.0035    99.890  927.35
  75   0.0314     99.140  0.0035    99.890  939.85
  76   0.0310     99.140  0.0034    99.895  952.46
  77   0.0320     99.100  0.0031    99.903  965.01
  78   0.0325     99.060  0.0032    99.908  977.54
  79   0.0313     99.180  0.0029    99.923  990.15
  80   0.0333     99.070  0.0032    99.890  1002.62
  81   0.0344     99.110  0.0033    99.895  1015.12
  82   0.0315     99.110  0.0029    99.915  1027.63
  83   0.0335     99.040  0.0027    99.920  1040.20
  84   0.0325     99.090  0.0027    99.915  1052.70
  85   0.0346     99.060  0.0026    99.925  1065.15
