Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1125     96.430  0.4623    83.987  14.63
   2   0.1170     96.230  0.0919    97.148  27.20
   3   0.0728     97.530  0.0723    97.702  39.66
   4   0.0606     98.080  0.0580    98.128  52.10
   5   0.0668     97.960  0.0518    98.337  64.67
   6   0.0481     98.530  0.0442    98.577  77.11
   7   0.0489     98.450  0.0409    98.680  89.55
   8   0.0582     98.030  0.0385    98.747  102.08
   9   0.0656     97.830  0.0370    98.797  114.52
  10   0.0303     99.030  0.0335    98.915  126.95
  11   0.0390     98.840  0.0336    98.932  139.39
  12   0.0304     99.030  0.0333    98.923  151.85
  13   0.0322     98.860  0.0291    99.087  164.31
  14   0.0340     98.940  0.0299    99.008  176.75
  15   0.0338     98.850  0.0288    99.035  189.24
  16   0.0370     98.660  0.0267    99.150  201.68
  17   0.0429     98.540  0.0266    99.097  214.11
  18   0.0506     98.290  0.0244    99.215  226.67
  19   0.0343     98.800  0.0228    99.248  239.12
  20   0.0320     98.830  0.0234    99.235  251.55
  21   0.0314     98.930  0.0217    99.280  264.01
  22   0.0287     99.060  0.0212    99.318  276.66
  23   0.0299     99.010  0.0209    99.302  289.10
  24   0.0371     98.790  0.0189    99.390  301.56
  25   0.0315     99.000  0.0186    99.387  314.08
  26   0.0321     98.930  0.0185    99.367  326.52
  27   0.0278     99.080  0.0170    99.458  338.98
  28   0.0316     98.950  0.0179    99.423  351.59
  29   0.0314     99.010  0.0156    99.477  364.05
  30   0.0383     98.780  0.0156    99.488  376.49
  31   0.0329     98.890  0.0156    99.468  389.04
  32   0.0293     99.090  0.0150    99.488  401.49
  33   0.0361     98.790  0.0148    99.502  413.94
  34   0.0359     98.840  0.0146    99.503  426.59
  35   0.0376     98.810  0.0123    99.590  439.04
  36   0.0251     99.110  0.0135    99.563  451.45
  37   0.0334     98.970  0.0123    99.617  463.94
  38   0.0454     98.670  0.0122    99.583  476.40
  39   0.0284     99.170  0.0115    99.617  488.86
  40   0.0284     98.980  0.0110    99.648  501.36
  41   0.0294     99.100  0.0114    99.610  513.82
  42   0.0306     99.020  0.0102    99.653  526.25
  43   0.0297     99.050  0.0093    99.703  538.69
  44   0.0317     98.980  0.0098    99.677  551.15
  45   0.0278     99.180  0.0093    99.682  563.60
  46   0.0302     99.060  0.0091    99.703  576.04
  47   0.0327     99.070  0.0089    99.705  588.51
  48   0.0294     99.100  0.0085    99.715  600.96
  49   0.0289     99.120  0.0079    99.733  613.42
  50   0.0343     98.980  0.0084    99.718  625.95
  51   0.0319     99.030  0.0078    99.717  638.38
  52   0.0277     99.140  0.0076    99.750  650.80
  53   0.0312     99.010  0.0073    99.748  663.32
  54   0.0332     98.990  0.0072    99.747  675.79
  55   0.0303     99.100  0.0071    99.757  688.25
  56   0.0340     98.990  0.0062    99.787  700.77
  57   0.0321     98.980  0.0061    99.815  713.22
  58   0.0315     99.070  0.0058    99.822  725.65
  59   0.0311     99.080  0.0062    99.792  738.11
  60   0.0323     99.040  0.0055    99.825  750.67
  61   0.0329     99.120  0.0057    99.810  763.12
  62   0.0295     99.120  0.0053    99.832  775.58
  63   0.0322     99.040  0.0049    99.840  788.03
  64   0.0325     99.000  0.0050    99.833  800.48
  65   0.0308     99.030  0.0049    99.837  812.94
  66   0.0361     98.950  0.0043    99.860  825.40
  67   0.0332     98.990  0.0048    99.845  837.85
  68   0.0340     99.060  0.0044    99.872  850.31
  69   0.0322     99.030  0.0044    99.863  862.85
  70   0.0325     99.040  0.0038    99.888  875.28
  71   0.0329     99.120  0.0037    99.887  887.73
  72   0.0328     99.020  0.0040    99.887  900.17
  73   0.0332     99.010  0.0039    99.883  912.64
  74   0.0343     99.030  0.0034    99.913  925.07
  75   0.0321     99.060  0.0035    99.892  937.53
  76   0.0378     98.940  0.0036    99.892  950.14
  77   0.0303     99.160  0.0029    99.917  962.61
  78   0.0358     98.970  0.0034    99.888  975.06
  79   0.0345     99.020  0.0033    99.885  987.67
  80   0.0362     99.030  0.0034    99.897  1000.19
  81   0.0389     98.940  0.0031    99.915  1012.63
  82   0.0360     98.960  0.0031    99.912  1025.27
  83   0.0375     98.970  0.0032    99.895  1037.72
  84   0.0350     99.050  0.0029    99.908  1050.16
  85   0.0368     98.960  0.0025    99.927  1062.73
