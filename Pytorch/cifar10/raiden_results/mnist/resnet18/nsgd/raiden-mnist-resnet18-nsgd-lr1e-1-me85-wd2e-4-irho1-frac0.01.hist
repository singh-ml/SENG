Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3633     88.800  1.0804    70.187  14.82
   2   0.2313     93.230  0.1497    95.448  27.36
   3   0.1279     95.740  0.0964    96.985  39.83
   4   0.0822     97.100  0.0814    97.383  52.28
   5   0.0567     98.190  0.0668    97.940  64.85
   6   0.0541     98.060  0.0609    98.082  77.30
   7   0.0536     98.340  0.0530    98.330  89.75
   8   0.0692     97.770  0.0518    98.347  102.35
   9   0.0561     98.280  0.0465    98.585  114.83
  10   0.0785     97.610  0.0454    98.543  127.31
  11   0.0574     98.210  0.0427    98.672  139.89
  12   0.0578     98.160  0.0399    98.730  152.37
  13   0.0438     98.410  0.0402    98.727  164.84
  14   0.0451     98.460  0.0375    98.815  177.33
  15   0.0422     98.470  0.0370    98.837  189.89
  16   0.0739     97.550  0.0366    98.807  202.37
  17   0.0601     97.970  0.0346    98.900  214.84
  18   0.0614     98.000  0.0336    98.952  227.41
  19   0.0285     99.000  0.0337    98.922  239.88
  20   0.0358     98.820  0.0322    98.943  252.33
  21   0.0394     98.670  0.0324    98.913  264.94
  22   0.0381     98.820  0.0314    98.988  277.41
  23   0.0289     99.060  0.0285    99.145  289.86
  24   0.0281     99.070  0.0294    99.110  302.36
  25   0.0299     98.980  0.0295    99.007  314.89
  26   0.0309     98.880  0.0286    99.093  327.40
  27   0.0348     98.830  0.0277    99.122  339.84
  28   0.0293     99.060  0.0260    99.197  352.30
  29   0.0501     98.340  0.0265    99.188  364.78
  30   0.0608     98.080  0.0245    99.213  377.22
  31   0.0297     99.000  0.0255    99.213  389.68
  32   0.0334     98.950  0.0237    99.233  402.27
  33   0.0289     99.020  0.0236    99.268  414.76
  34   0.0425     98.490  0.0235    99.240  427.25
  35   0.0285     99.070  0.0208    99.335  439.74
  36   0.0326     98.860  0.0229    99.262  452.30
  37   0.0348     98.910  0.0228    99.267  464.76
  38   0.0316     98.830  0.0223    99.265  477.26
  39   0.0263     99.190  0.0202    99.338  489.74
  40   0.0326     98.960  0.0207    99.353  502.21
  41   0.0296     99.040  0.0194    99.397  514.70
  42   0.0366     98.700  0.0184    99.407  527.32
  43   0.0268     99.080  0.0176    99.433  539.79
  44   0.0254     99.140  0.0172    99.418  552.25
  45   0.0344     98.830  0.0176    99.413  564.73
  46   0.0215     99.260  0.0168    99.455  577.16
  47   0.0253     99.100  0.0166    99.493  589.61
  48   0.0306     98.970  0.0167    99.447  602.17
  49   0.0211     99.280  0.0144    99.532  614.65
  50   0.0235     99.270  0.0133    99.572  627.11
  51   0.0319     99.040  0.0132    99.558  639.59
  52   0.0268     99.160  0.0121    99.622  652.19
  53   0.0243     99.210  0.0114    99.633  664.67
  54   0.0287     99.050  0.0109    99.653  677.12
  55   0.0245     99.250  0.0101    99.693  689.69
  56   0.0226     99.280  0.0107    99.673  702.17
  57   0.0278     99.110  0.0095    99.720  714.63
  58   0.0250     99.170  0.0090    99.680  727.24
  59   0.0249     99.140  0.0094    99.690  739.69
  60   0.0245     99.250  0.0075    99.767  752.17
  61   0.0262     99.060  0.0071    99.773  764.76
  62   0.0250     99.180  0.0064    99.807  777.25
  63   0.0247     99.170  0.0056    99.833  789.72
  64   0.0236     99.310  0.0051    99.835  802.20
  65   0.0266     99.190  0.0048    99.853  814.65
  66   0.0242     99.140  0.0043    99.878  827.13
  67   0.0285     99.100  0.0041    99.887  839.58
  68   0.0240     99.180  0.0040    99.877  852.18
  69   0.0250     99.240  0.0035    99.907  864.67
  70   0.0231     99.220  0.0030    99.922  877.11
  71   0.0250     99.220  0.0028    99.932  889.71
  72   0.0230     99.350  0.0027    99.925  902.20
  73   0.0305     99.060  0.0024    99.950  914.67
  74   0.0251     99.180  0.0021    99.958  927.25
  75   0.0249     99.210  0.0022    99.952  939.72
  76   0.0254     99.170  0.0021    99.957  952.21
  77   0.0244     99.190  0.0017    99.973  964.82
  78   0.0243     99.220  0.0017    99.958  977.27
  79   0.0231     99.260  0.0017    99.968  989.77
  80   0.0260     99.220  0.0017    99.970  1002.25
  81   0.0259     99.200  0.0017    99.967  1014.86
  82   0.0250     99.220  0.0015    99.973  1027.34
  83   0.0250     99.180  0.0018    99.972  1039.82
  84   0.0260     99.200  0.0014    99.978  1052.40
  85   0.0260     99.250  0.0015    99.980  1064.94
