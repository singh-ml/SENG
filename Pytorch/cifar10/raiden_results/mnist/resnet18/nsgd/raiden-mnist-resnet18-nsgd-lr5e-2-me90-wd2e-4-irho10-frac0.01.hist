Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.7832     31.170  2.6466    14.083  14.70
   2   0.6406     78.430  0.9662    66.053  26.94
   3   0.3595     88.650  0.2919    91.008  39.35
   4   0.1866     94.360  0.1752    94.632  51.90
   5   0.1595     94.920  0.1246    96.203  64.17
   6   0.0889     97.330  0.1058    96.747  76.58
   7   0.1913     94.220  0.0827    97.395  89.08
   8   0.0536     98.310  0.0708    97.812  101.30
   9   0.0873     97.010  0.0659    97.895  113.69
  10   0.0882     97.110  0.0579    98.173  126.08
  11   0.0888     97.200  0.0578    98.212  138.49
  12   0.0651     98.020  0.0527    98.362  150.88
  13   0.0517     98.340  0.0500    98.483  163.10
  14   0.0432     98.540  0.0457    98.588  175.47
  15   0.0574     97.960  0.0468    98.500  187.67
  16   0.0420     98.640  0.0415    98.667  199.88
  17   0.0466     98.660  0.0416    98.670  212.27
  18   0.0443     98.510  0.0411    98.713  224.50
  19   0.0418     98.700  0.0381    98.775  236.72
  20   0.0273     99.100  0.0371    98.875  249.20
  21   0.0460     98.410  0.0375    98.822  261.59
  22   0.0437     98.520  0.0372    98.827  273.99
  23   0.0325     99.020  0.0347    98.938  286.50
  24   0.0436     98.670  0.0350    98.852  298.87
  25   0.0555     98.120  0.0349    98.902  311.27
  26   0.0345     98.740  0.0334    98.953  323.49
  27   0.0417     98.710  0.0310    99.012  335.87
  28   0.0328     98.960  0.0277    99.105  348.25
  29   0.0384     98.760  0.0286    99.078  360.62
  30   0.0466     98.650  0.0285    99.083  372.81
  31   0.0287     99.020  0.0275    99.128  385.20
  32   0.0315     99.040  0.0284    99.087  397.61
  33   0.0365     98.850  0.0254    99.185  410.11
  34   0.0269     99.160  0.0254    99.142  422.53
  35   0.0426     98.680  0.0244    99.172  434.94
  36   0.0373     98.890  0.0241    99.210  447.48
  37   0.0322     98.900  0.0239    99.220  459.89
  38   0.0687     98.100  0.0240    99.202  472.28
  39   0.0332     98.940  0.0218    99.305  484.52
  40   0.0397     98.740  0.0207    99.348  496.92
  41   0.0359     98.870  0.0213    99.283  509.32
  42   0.0330     98.950  0.0201    99.358  521.72
  43   0.0400     98.720  0.0202    99.353  534.09
  44   0.0417     98.620  0.0194    99.392  546.49
  45   0.0297     99.070  0.0197    99.387  558.71
  46   0.0369     98.840  0.0180    99.395  571.22
  47   0.0345     98.910  0.0161    99.488  583.46
  48   0.0408     98.830  0.0156    99.517  595.87
  49   0.0342     98.860  0.0167    99.437  608.37
  50   0.0274     99.040  0.0156    99.480  620.77
  51   0.0330     98.930  0.0159    99.458  633.17
  52   0.0272     99.170  0.0142    99.507  645.58
  53   0.0267     99.180  0.0133    99.578  658.13
  54   0.0310     99.100  0.0135    99.542  670.55
  55   0.0348     98.940  0.0119    99.625  682.96
  56   0.0289     99.100  0.0118    99.592  695.43
  57   0.0246     99.190  0.0124    99.587  707.82
  58   0.0290     99.010  0.0099    99.658  720.18
  59   0.0310     99.070  0.0098    99.668  732.67
  60   0.0258     99.230  0.0092    99.693  745.06
  61   0.0261     99.200  0.0093    99.693  757.25
  62   0.0300     99.110  0.0091    99.712  769.68
  63   0.0282     99.130  0.0084    99.713  782.10
  64   0.0274     99.210  0.0075    99.762  794.48
  65   0.0277     99.190  0.0072    99.768  807.00
  66   0.0300     99.100  0.0061    99.808  819.42
  67   0.0242     99.300  0.0062    99.813  831.81
  68   0.0294     99.150  0.0058    99.812  844.26
  69   0.0256     99.180  0.0056    99.803  856.66
  70   0.0323     99.130  0.0055    99.842  868.89
  71   0.0262     99.190  0.0045    99.862  881.34
  72   0.0307     99.190  0.0049    99.848  893.90
  73   0.0285     99.200  0.0045    99.860  906.31
  74   0.0325     99.060  0.0038    99.888  918.72
  75   0.0330     99.090  0.0039    99.862  931.31
  76   0.0306     99.090  0.0039    99.878  943.70
  77   0.0301     99.100  0.0037    99.890  956.10
  78   0.0302     99.100  0.0033    99.902  968.63
  79   0.0290     99.160  0.0033    99.907  981.03
  80   0.0311     99.090  0.0029    99.917  993.42
  81   0.0297     99.110  0.0030    99.910  1005.91
  82   0.0299     99.150  0.0029    99.918  1018.32
  83   0.0305     99.160  0.0028    99.905  1030.67
  84   0.0312     99.160  0.0029    99.913  1043.18
  85   0.0299     99.190  0.0026    99.932  1055.59
  86   0.0321     99.130  0.0026    99.927  1067.80
  87   0.0313     99.130  0.0025    99.928  1080.22
  88   0.0302     99.160  0.0025    99.920  1092.62
  89   0.0307     99.180  0.0024    99.920  1104.98
  90   0.0298     99.160  0.0023    99.935  1117.38
