Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.9763     66.810  1.9934    36.233  14.52
   2   0.4318     87.570  0.4521    86.210  26.72
   3   0.2171     92.990  0.1835    94.430  38.95
   4   0.1345     95.910  0.1286    96.050  51.44
   5   0.0713     97.690  0.1060    96.825  63.77
   6   0.1812     94.250  0.0899    97.267  75.98
   7   0.0654     97.860  0.0756    97.678  88.19
   8   0.0902     97.280  0.0677    97.953  100.43
   9   0.0627     97.950  0.0624    98.063  112.82
  10   0.0694     97.630  0.0584    98.245  125.00
  11   0.0583     97.950  0.0580    98.187  137.20
  12   0.0565     98.100  0.0549    98.340  149.39
  13   0.0869     97.010  0.0475    98.458  161.57
  14   0.0386     98.700  0.0494    98.458  173.77
  15   0.0334     98.800  0.0446    98.635  186.19
  16   0.0542     98.220  0.0425    98.692  198.62
  17   0.0557     97.980  0.0433    98.675  210.84
  18   0.0513     98.380  0.0406    98.715  223.34
  19   0.0457     98.660  0.0397    98.762  235.54
  20   0.0637     98.050  0.0368    98.860  247.72
  21   0.0395     98.590  0.0374    98.798  259.94
  22   0.0409     98.660  0.0356    98.863  272.12
  23   0.0382     98.610  0.0354    98.863  284.32
  24   0.0345     98.860  0.0334    98.970  296.49
  25   0.0521     98.260  0.0343    98.948  308.69
  26   0.0466     98.380  0.0335    98.915  321.10
  27   0.0543     98.250  0.0329    98.963  333.51
  28   0.0260     99.180  0.0309    98.968  346.00
  29   0.0353     98.800  0.0277    99.113  358.21
  30   0.0352     98.780  0.0305    99.030  370.62
  31   0.0360     98.850  0.0278    99.093  382.82
  32   0.0391     98.760  0.0285    99.092  395.23
  33   0.0404     98.710  0.0267    99.163  407.66
  34   0.0460     98.490  0.0282    99.082  420.18
  35   0.0322     98.930  0.0273    99.130  432.38
  36   0.0342     98.810  0.0256    99.202  444.58
  37   0.0330     98.990  0.0255    99.162  457.09
  38   0.0342     98.840  0.0252    99.193  469.27
  39   0.0330     98.880  0.0238    99.258  481.68
  40   0.0338     98.930  0.0235    99.247  494.10
  41   0.0405     98.680  0.0236    99.243  506.51
  42   0.0342     98.910  0.0228    99.278  518.72
  43   0.0354     98.760  0.0208    99.350  530.93
  44   0.0284     99.070  0.0199    99.340  543.26
  45   0.0399     98.880  0.0202    99.332  555.46
  46   0.0303     98.990  0.0194    99.357  567.67
  47   0.0266     99.090  0.0198    99.357  580.20
  48   0.0316     98.990  0.0181    99.428  592.40
  49   0.0397     98.720  0.0173    99.425  604.59
  50   0.0305     99.070  0.0171    99.442  616.79
  51   0.0297     99.030  0.0161    99.472  629.26
  52   0.0331     99.010  0.0150    99.512  641.67
  53   0.0291     98.990  0.0158    99.440  654.08
  54   0.0233     99.240  0.0152    99.487  666.58
  55   0.0262     99.180  0.0143    99.498  678.76
  56   0.0275     99.070  0.0126    99.582  690.98
  57   0.0253     99.130  0.0124    99.593  703.48
  58   0.0309     99.000  0.0119    99.642  715.68
  59   0.0250     99.110  0.0121    99.590  727.88
  60   0.0280     99.130  0.0118    99.598  740.26
  61   0.0266     99.200  0.0106    99.642  752.67
  62   0.0256     99.130  0.0103    99.667  764.86
  63   0.0262     99.120  0.0093    99.700  777.26
  64   0.0291     99.120  0.0093    99.690  789.44
  65   0.0272     99.170  0.0084    99.748  801.81
  66   0.0256     99.160  0.0082    99.742  814.20
  67   0.0244     99.200  0.0070    99.787  826.69
  68   0.0284     99.070  0.0076    99.750  838.92
  69   0.0300     99.060  0.0067    99.768  851.12
  70   0.0280     99.090  0.0064    99.800  863.41
  71   0.0236     99.360  0.0062    99.798  875.61
  72   0.0293     99.150  0.0057    99.813  888.00
  73   0.0293     99.140  0.0057    99.812  900.40
  74   0.0273     99.180  0.0055    99.855  912.61
  75   0.0284     99.150  0.0051    99.828  925.01
  76   0.0287     99.200  0.0049    99.840  937.38
  77   0.0295     99.120  0.0041    99.870  949.68
  78   0.0295     99.180  0.0045    99.858  962.04
  79   0.0300     99.140  0.0040    99.883  974.43
  80   0.0317     99.050  0.0044    99.882  986.76
  81   0.0280     99.140  0.0040    99.880  999.15
  82   0.0301     99.100  0.0040    99.878  1011.52
  83   0.0301     99.120  0.0036    99.890  1024.01
  84   0.0308     99.070  0.0033    99.915  1036.37
  85   0.0305     99.060  0.0035    99.895  1048.55
  86   0.0297     99.160  0.0030    99.920  1060.86
  87   0.0291     99.140  0.0034    99.905  1073.27
  88   0.0297     99.120  0.0032    99.898  1085.66
  89   0.0312     99.070  0.0032    99.922  1098.09
  90   0.0308     99.050  0.0030    99.903  1110.45
