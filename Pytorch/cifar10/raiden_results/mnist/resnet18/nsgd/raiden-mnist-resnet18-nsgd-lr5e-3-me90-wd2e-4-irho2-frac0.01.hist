Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1889     93.710  0.6674    77.597  14.75
   2   0.1209     96.150  0.1345    95.792  27.40
   3   0.0649     97.950  0.0897    97.177  39.86
   4   0.0859     97.180  0.0699    97.802  52.33
   5   0.0664     97.740  0.0604    98.068  64.90
   6   0.0621     98.050  0.0530    98.332  77.38
   7   0.0651     97.790  0.0495    98.435  89.83
   8   0.0550     98.180  0.0449    98.583  102.26
   9   0.0433     98.470  0.0409    98.748  114.72
  10   0.0404     98.630  0.0393    98.673  127.17
  11   0.0488     98.380  0.0363    98.812  139.63
  12   0.0416     98.650  0.0354    98.843  152.20
  13   0.0438     98.520  0.0324    98.973  164.69
  14   0.0379     98.610  0.0319    98.967  177.12
  15   0.0424     98.620  0.0322    98.968  189.72
  16   0.0359     98.800  0.0287    99.097  202.16
  17   0.0373     98.790  0.0289    99.092  214.60
  18   0.0593     98.050  0.0280    99.058  227.08
  19   0.0397     98.810  0.0263    99.093  239.76
  20   0.0332     98.890  0.0262    99.127  252.21
  21   0.0290     99.000  0.0263    99.130  264.62
  22   0.0328     98.900  0.0233    99.255  277.28
  23   0.0356     98.770  0.0225    99.262  289.75
  24   0.0308     98.980  0.0223    99.267  302.21
  25   0.0296     98.910  0.0216    99.260  314.62
  26   0.0307     98.900  0.0218    99.267  327.09
  27   0.0300     99.040  0.0217    99.240  339.52
  28   0.0403     98.630  0.0207    99.295  351.96
  29   0.0346     98.890  0.0190    99.383  364.44
  30   0.0312     98.950  0.0187    99.388  376.91
  31   0.0316     98.920  0.0185    99.395  389.44
  32   0.0287     99.100  0.0174    99.403  401.88
  33   0.0308     98.850  0.0169    99.422  414.36
  34   0.0261     99.080  0.0169    99.455  426.82
  35   0.0362     98.820  0.0171    99.428  439.26
  36   0.0367     98.830  0.0164    99.457  451.75
  37   0.0277     99.090  0.0156    99.512  464.21
  38   0.0272     99.080  0.0151    99.528  476.69
  39   0.0277     99.100  0.0151    99.477  489.17
  40   0.0321     98.890  0.0147    99.495  501.61
  41   0.0375     98.770  0.0149    99.498  514.19
  42   0.0252     99.120  0.0126    99.608  526.64
  43   0.0305     98.950  0.0125    99.592  539.07
  44   0.0260     99.190  0.0125    99.597  551.59
  45   0.0262     99.190  0.0125    99.597  564.03
  46   0.0323     98.930  0.0117    99.615  576.48
  47   0.0281     99.060  0.0125    99.583  588.91
  48   0.0303     99.020  0.0114    99.635  601.33
  49   0.0264     99.130  0.0114    99.645  613.77
  50   0.0266     99.130  0.0105    99.635  626.20
  51   0.0267     99.100  0.0107    99.662  638.79
  52   0.0351     98.860  0.0111    99.650  651.20
  53   0.0267     99.130  0.0101    99.693  663.66
  54   0.0336     98.890  0.0090    99.695  676.23
  55   0.0305     99.050  0.0094    99.715  688.65
  56   0.0285     99.060  0.0098    99.695  701.11
  57   0.0273     99.040  0.0091    99.708  713.54
  58   0.0332     98.940  0.0084    99.752  726.00
  59   0.0302     99.100  0.0088    99.717  738.43
  60   0.0298     99.060  0.0089    99.713  750.90
  61   0.0301     99.110  0.0082    99.737  763.46
  62   0.0276     99.110  0.0084    99.715  775.90
  63   0.0310     99.040  0.0080    99.737  788.34
  64   0.0291     99.130  0.0071    99.777  800.80
  65   0.0281     99.210  0.0084    99.743  813.44
  66   0.0262     99.170  0.0076    99.762  825.87
  67   0.0329     99.030  0.0070    99.782  838.31
  68   0.0333     98.950  0.0073    99.748  850.75
  69   0.0266     99.220  0.0069    99.772  863.16
  70   0.0304     99.030  0.0063    99.810  875.60
  71   0.0287     99.070  0.0063    99.815  888.05
  72   0.0297     99.060  0.0061    99.815  900.64
  73   0.0310     99.090  0.0064    99.805  913.09
  74   0.0255     99.220  0.0056    99.825  925.49
  75   0.0335     98.930  0.0056    99.827  938.06
  76   0.0312     99.040  0.0058    99.837  950.47
  77   0.0312     99.080  0.0057    99.823  962.92
  78   0.0285     99.170  0.0054    99.833  975.50
  79   0.0287     99.110  0.0055    99.837  987.94
  80   0.0297     98.980  0.0054    99.848  1000.37
  81   0.0304     99.060  0.0057    99.828  1012.82
  82   0.0300     99.050  0.0052    99.838  1025.26
  83   0.0299     99.020  0.0047    99.852  1037.67
  84   0.0334     99.000  0.0054    99.863  1050.08
  85   0.0313     99.010  0.0045    99.888  1062.51
  86   0.0314     99.000  0.0051    99.845  1074.96
  87   0.0275     99.140  0.0049    99.855  1087.43
  88   0.0324     98.960  0.0047    99.855  1099.98
  89   0.0301     99.100  0.0049    99.850  1112.43
  90   0.0344     99.020  0.0049    99.845  1124.94
