Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1397     95.340  0.6292    78.755  14.93
   2   0.0970     96.840  0.1236    96.115  27.51
   3   0.0636     97.720  0.0831    97.373  40.09
   4   0.0981     96.780  0.0695    97.812  52.65
   5   0.0543     98.200  0.0572    98.177  65.33
   6   0.0484     98.330  0.0508    98.378  77.90
   7   0.0523     98.210  0.0478    98.482  90.48
   8   0.0484     98.270  0.0430    98.653  103.03
   9   0.0353     98.920  0.0397    98.773  115.75
  10   0.0337     98.940  0.0402    98.748  128.32
  11   0.0446     98.490  0.0361    98.800  140.90
  12   0.0397     98.740  0.0362    98.830  153.61
  13   0.0441     98.530  0.0340    98.890  166.19
  14   0.0361     98.770  0.0316    99.000  178.76
  15   0.0525     98.290  0.0308    98.970  191.42
  16   0.0362     98.890  0.0292    99.062  203.99
  17   0.0399     98.740  0.0288    99.067  216.56
  18   0.0416     98.700  0.0274    99.135  229.16
  19   0.0345     98.890  0.0263    99.123  241.84
  20   0.0361     98.810  0.0255    99.192  254.43
  21   0.0391     98.740  0.0249    99.172  267.04
  22   0.0292     98.990  0.0240    99.202  279.63
  23   0.0363     98.780  0.0236    99.230  292.45
  24   0.0334     98.950  0.0223    99.292  305.07
  25   0.0294     99.130  0.0209    99.318  317.67
  26   0.0346     98.870  0.0213    99.290  330.31
  27   0.0356     98.850  0.0209    99.288  342.90
  28   0.0357     98.810  0.0200    99.310  355.49
  29   0.0353     98.800  0.0195    99.353  368.07
  30   0.0341     99.000  0.0181    99.423  380.69
  31   0.0370     98.780  0.0177    99.395  393.26
  32   0.0305     98.910  0.0181    99.405  405.96
  33   0.0342     98.910  0.0173    99.432  418.54
  34   0.0344     98.790  0.0173    99.440  431.11
  35   0.0323     98.930  0.0156    99.487  443.80
  36   0.0310     99.090  0.0157    99.482  456.40
  37   0.0367     98.790  0.0166    99.450  468.99
  38   0.0296     98.980  0.0157    99.483  481.64
  39   0.0268     99.060  0.0140    99.543  494.22
  40   0.0298     99.070  0.0141    99.565  506.80
  41   0.0343     98.900  0.0133    99.568  519.40
  42   0.0306     99.020  0.0137    99.530  531.99
  43   0.0302     98.970  0.0127    99.612  544.59
  44   0.0348     98.930  0.0124    99.590  557.17
  45   0.0280     99.090  0.0124    99.577  569.75
  46   0.0298     99.040  0.0117    99.627  582.33
  47   0.0340     98.940  0.0115    99.650  594.90
  48   0.0298     98.950  0.0120    99.600  607.63
  49   0.0274     99.140  0.0107    99.648  620.22
  50   0.0344     98.880  0.0102    99.658  632.79
  51   0.0373     98.760  0.0101    99.675  645.54
  52   0.0270     99.100  0.0107    99.650  658.15
  53   0.0309     98.980  0.0100    99.670  670.76
  54   0.0327     98.900  0.0096    99.687  683.45
  55   0.0269     99.110  0.0090    99.682  696.08
  56   0.0329     98.860  0.0092    99.690  708.69
  57   0.0303     98.910  0.0084    99.753  721.30
  58   0.0301     99.010  0.0082    99.745  733.92
  59   0.0292     99.070  0.0087    99.705  746.50
  60   0.0298     98.960  0.0078    99.763  759.27
  61   0.0282     99.020  0.0079    99.773  771.85
  62   0.0346     98.970  0.0080    99.738  784.46
  63   0.0335     98.830  0.0076    99.773  797.09
  64   0.0319     98.990  0.0076    99.768  809.65
  65   0.0314     99.010  0.0077    99.737  822.25
  66   0.0331     98.820  0.0071    99.757  834.84
  67   0.0340     98.960  0.0065    99.802  847.54
  68   0.0341     98.950  0.0066    99.802  860.12
  69   0.0349     98.970  0.0067    99.772  872.69
  70   0.0311     99.020  0.0062    99.827  885.27
  71   0.0290     99.070  0.0062    99.820  897.87
  72   0.0312     99.030  0.0068    99.780  910.43
  73   0.0297     99.050  0.0063    99.805  923.03
  74   0.0337     98.980  0.0060    99.823  935.64
  75   0.0282     99.070  0.0061    99.810  948.25
  76   0.0284     99.050  0.0058    99.822  960.97
  77   0.0305     99.020  0.0052    99.852  973.56
  78   0.0314     98.980  0.0055    99.832  986.19
  79   0.0293     99.090  0.0056    99.832  998.81
  80   0.0309     98.970  0.0053    99.832  1011.51
  81   0.0341     98.960  0.0051    99.855  1024.10
  82   0.0318     99.020  0.0048    99.840  1036.72
  83   0.0320     99.040  0.0049    99.848  1049.49
  84   0.0339     98.970  0.0047    99.890  1062.08
  85   0.0329     99.040  0.0052    99.830  1074.67
  86   0.0333     98.950  0.0046    99.870  1087.35
  87   0.0292     99.100  0.0046    99.865  1099.92
  88   0.0351     98.860  0.0046    99.872  1112.53
  89   0.0314     99.080  0.0046    99.867  1125.25
  90   0.0336     98.980  0.0045    99.860  1137.85
