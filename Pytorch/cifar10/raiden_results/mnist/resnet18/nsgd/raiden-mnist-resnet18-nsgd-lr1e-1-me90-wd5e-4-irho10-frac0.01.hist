Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.3778     54.590  2.0007    38.532  14.79
   2   1.7803     41.430  0.6163    77.795  27.17
   3   0.2661     92.040  0.3526    89.338  39.62
   4   0.1491     95.280  0.2353    93.040  51.79
   5   0.2504     91.310  0.1564    95.315  64.11
   6   0.0776     97.620  0.1150    96.630  76.39
   7   0.2777     91.170  0.1023    96.905  88.52
   8   0.3969     87.030  0.0871    97.413  100.87
   9   0.0992     97.040  0.0796    97.542  113.21
  10   0.0990     97.080  0.0822    97.487  125.55
  11   0.1085     96.620  0.0770    97.642  137.91
  12   0.0985     96.850  0.0718    97.808  150.26
  13   0.0726     97.880  0.0659    98.000  162.39
  14   0.0773     97.680  0.0658    98.000  174.53
  15   0.0679     97.650  0.0642    98.060  186.89
  16   0.0516     98.380  0.0602    98.102  199.46
  17   0.0966     97.020  0.0566    98.242  211.79
  18   0.1223     96.200  0.0614    98.183  224.10
  19   0.0669     97.910  0.0556    98.297  236.43
  20   0.0693     97.850  0.0563    98.268  248.76
  21   0.0785     97.440  0.0536    98.317  261.08
  22   0.1121     96.330  0.0514    98.455  273.54
  23   0.0524     98.350  0.0544    98.403  285.65
  24   0.1892     93.930  0.0514    98.442  297.82
  25   0.1379     95.880  0.0484    98.492  310.02
  26   0.0459     98.470  0.0500    98.527  322.16
  27   0.0528     98.220  0.0498    98.467  334.48
  28   0.0586     97.950  0.0468    98.525  346.81
  29   0.0390     98.670  0.0446    98.647  359.23
  30   0.0596     98.080  0.0446    98.628  371.56
  31   0.0622     97.980  0.0455    98.632  383.72
  32   0.0450     98.560  0.0465    98.573  396.04
  33   0.1069     96.450  0.0444    98.590  408.37
  34   0.0355     98.830  0.0405    98.752  420.50
  35   0.0664     97.880  0.0413    98.720  432.95
  36   0.0430     98.450  0.0413    98.693  445.29
  37   0.0462     98.530  0.0435    98.650  457.61
  38   0.0424     98.800  0.0383    98.860  469.90
  39   0.0759     97.470  0.0393    98.830  482.23
  40   0.0438     98.660  0.0374    98.807  494.55
  41   0.0410     98.680  0.0421    98.663  506.90
  42   0.0448     98.550  0.0363    98.860  519.06
  43   0.0380     98.860  0.0351    98.903  531.40
  44   0.0360     98.790  0.0337    98.935  543.60
  45   0.0596     98.050  0.0337    98.927  556.05
  46   0.0408     98.710  0.0328    98.982  568.14
  47   0.0395     98.640  0.0348    98.895  580.30
  48   0.0259     99.100  0.0303    99.027  592.74
  49   0.0390     98.780  0.0310    99.048  605.07
  50   0.0376     98.680  0.0286    99.092  617.41
  51   0.0259     99.130  0.0286    99.118  629.57
  52   0.0323     98.910  0.0276    99.095  641.89
  53   0.0400     98.750  0.0272    99.127  653.99
  54   0.0302     99.060  0.0254    99.202  666.29
  55   0.0321     98.930  0.0250    99.153  678.76
  56   0.0513     98.340  0.0253    99.165  690.91
  57   0.0304     98.980  0.0246    99.183  703.06
  58   0.0312     99.010  0.0222    99.265  715.32
  59   0.0413     98.760  0.0216    99.293  727.66
  60   0.0257     99.050  0.0207    99.327  740.01
  61   0.0318     98.850  0.0203    99.317  752.45
  62   0.0311     98.830  0.0196    99.360  764.62
  63   0.0291     99.050  0.0194    99.382  776.80
  64   0.0289     99.040  0.0170    99.445  788.94
  65   0.0231     99.210  0.0172    99.437  801.08
  66   0.0296     99.060  0.0170    99.442  813.38
  67   0.0217     99.320  0.0142    99.552  825.54
  68   0.0241     99.150  0.0133    99.563  837.79
  69   0.0309     98.980  0.0121    99.600  850.09
  70   0.0307     99.050  0.0124    99.607  862.27
  71   0.0193     99.350  0.0110    99.630  874.42
  72   0.0254     99.190  0.0104    99.642  886.59
  73   0.0210     99.280  0.0092    99.703  898.91
  74   0.0217     99.280  0.0091    99.712  911.19
  75   0.0249     99.170  0.0079    99.755  923.38
  76   0.0234     99.270  0.0071    99.775  935.72
  77   0.0215     99.360  0.0076    99.755  948.11
  78   0.0242     99.220  0.0057    99.800  960.44
  79   0.0269     99.120  0.0054    99.832  972.60
  80   0.0207     99.340  0.0048    99.857  984.76
  81   0.0252     99.200  0.0047    99.843  997.09
  82   0.0230     99.270  0.0040    99.892  1009.24
  83   0.0223     99.280  0.0041    99.868  1021.41
  84   0.0220     99.260  0.0037    99.880  1033.73
  85   0.0253     99.160  0.0040    99.873  1045.95
  86   0.0249     99.200  0.0038    99.887  1058.25
  87   0.0268     99.140  0.0034    99.893  1070.58
  88   0.0256     99.160  0.0034    99.905  1082.71
  89   0.0249     99.180  0.0032    99.905  1095.03
  90   0.0250     99.170  0.0031    99.913  1107.18
