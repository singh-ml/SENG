Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2665     91.450  0.3816    86.908  14.68
   2   0.1344     95.320  0.0916    97.102  27.08
   3   0.0833     97.400  0.0661    97.942  39.40
   4   0.0656     97.930  0.0582    98.195  51.71
   5   0.0472     98.480  0.0513    98.355  64.15
   6   0.0486     98.470  0.0429    98.690  76.50
   7   0.0382     98.740  0.0409    98.680  88.81
   8   0.0379     98.710  0.0359    98.872  101.26
   9   0.0535     98.440  0.0344    98.892  113.57
  10   0.0392     98.860  0.0342    98.932  125.85
  11   0.0258     99.170  0.0312    99.000  138.14
  12   0.0365     98.800  0.0308    99.030  150.66
  13   0.0374     98.870  0.0300    99.030  162.96
  14   0.0310     99.080  0.0287    99.102  175.25
  15   0.0276     99.160  0.0270    99.117  187.63
  16   0.0256     99.160  0.0253    99.128  199.91
  17   0.0445     98.670  0.0244    99.207  212.22
  18   0.0346     98.920  0.0236    99.220  224.65
  19   0.0369     98.840  0.0217    99.275  236.95
  20   0.0316     99.090  0.0212    99.330  249.23
  21   0.0271     99.040  0.0210    99.280  261.52
  22   0.0415     98.720  0.0214    99.285  273.82
  23   0.0285     99.100  0.0197    99.320  286.15
  24   0.0405     98.890  0.0201    99.315  298.46
  25   0.0319     98.890  0.0190    99.367  310.81
  26   0.0226     99.330  0.0183    99.397  323.14
  27   0.0283     99.070  0.0171    99.427  335.44
  28   0.0323     98.950  0.0173    99.433  347.87
  29   0.0277     99.100  0.0165    99.445  360.17
  30   0.0255     99.120  0.0161    99.458  372.49
  31   0.0247     99.130  0.0148    99.512  384.81
  32   0.0285     99.120  0.0145    99.508  397.12
  33   0.0305     99.090  0.0152    99.497  409.43
  34   0.0306     98.980  0.0143    99.533  421.73
  35   0.0255     99.110  0.0127    99.547  434.04
  36   0.0285     99.030  0.0130    99.558  446.32
  37   0.0324     99.060  0.0120    99.568  458.62
  38   0.0258     99.140  0.0112    99.630  471.00
  39   0.0206     99.320  0.0114    99.630  483.31
  40   0.0279     99.140  0.0102    99.633  495.61
  41   0.0377     98.940  0.0102    99.637  508.03
  42   0.0284     99.090  0.0087    99.717  520.32
  43   0.0250     99.240  0.0088    99.702  532.63
  44   0.0315     99.060  0.0091    99.692  545.01
  45   0.0237     99.310  0.0088    99.687  557.31
  46   0.0280     99.260  0.0082    99.742  569.62
  47   0.0297     99.190  0.0080    99.728  581.90
  48   0.0291     99.210  0.0072    99.755  594.22
  49   0.0251     99.240  0.0072    99.773  606.53
  50   0.0281     99.180  0.0066    99.780  618.80
  51   0.0311     99.060  0.0062    99.785  631.08
  52   0.0297     99.180  0.0067    99.783  643.37
  53   0.0257     99.300  0.0059    99.787  655.68
  54   0.0258     99.310  0.0060    99.808  668.11
  55   0.0278     99.250  0.0056    99.833  680.42
  56   0.0313     99.110  0.0058    99.788  692.74
  57   0.0241     99.240  0.0047    99.848  705.04
  58   0.0250     99.260  0.0045    99.843  717.45
  59   0.0259     99.200  0.0046    99.848  729.76
  60   0.0246     99.230  0.0044    99.858  742.05
  61   0.0256     99.240  0.0043    99.858  754.45
  62   0.0235     99.320  0.0040    99.880  766.74
  63   0.0241     99.230  0.0039    99.873  779.04
  64   0.0263     99.160  0.0035    99.877  791.43
  65   0.0247     99.240  0.0035    99.887  803.73
  66   0.0291     99.180  0.0038    99.882  816.02
  67   0.0303     99.210  0.0033    99.890  828.41
  68   0.0268     99.210  0.0030    99.900  840.69
  69   0.0279     99.250  0.0032    99.907  852.96
  70   0.0268     99.270  0.0033    99.877  865.26
  71   0.0280     99.220  0.0029    99.913  877.58
  72   0.0283     99.180  0.0027    99.912  889.87
  73   0.0265     99.240  0.0024    99.937  902.17
  74   0.0275     99.190  0.0027    99.922  914.45
  75   0.0273     99.200  0.0023    99.930  926.74
  76   0.0307     99.110  0.0022    99.943  939.03
  77   0.0289     99.140  0.0024    99.942  951.44
  78   0.0289     99.220  0.0023    99.938  963.74
  79   0.0303     99.190  0.0022    99.942  976.04
  80   0.0278     99.220  0.0024    99.922  988.46
  81   0.0304     99.170  0.0020    99.952  1000.76
  82   0.0271     99.250  0.0021    99.933  1013.05
  83   0.0307     99.110  0.0021    99.952  1025.36
  84   0.0272     99.230  0.0020    99.948  1037.65
  85   0.0307     99.190  0.0020    99.942  1049.95
