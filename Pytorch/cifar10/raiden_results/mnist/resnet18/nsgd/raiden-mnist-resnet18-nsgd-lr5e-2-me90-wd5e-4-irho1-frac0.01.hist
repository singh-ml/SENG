Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1053     96.600  0.4460    85.520  14.84
   2   0.0906     96.900  0.0881    97.255  27.22
   3   0.1729     94.530  0.0653    97.972  39.85
   4   0.0730     97.770  0.0564    98.205  52.19
   5   0.0880     97.180  0.0505    98.387  64.51
   6   0.0669     97.800  0.0464    98.538  76.94
   7   0.1021     96.710  0.0428    98.668  89.27
   8   0.0542     98.280  0.0412    98.693  101.60
   9   0.0406     98.780  0.0387    98.792  114.03
  10   0.0408     98.550  0.0385    98.795  126.35
  11   0.0930     96.940  0.0380    98.798  138.70
  12   0.0538     98.210  0.0395    98.743  151.17
  13   0.0733     97.630  0.0363    98.845  163.49
  14   0.0336     98.780  0.0363    98.858  175.83
  15   0.0419     98.640  0.0350    98.912  188.20
  16   0.0520     98.220  0.0346    98.948  200.57
  17   0.0478     98.430  0.0332    98.965  212.91
  18   0.0570     98.240  0.0338    98.883  225.28
  19   0.0288     99.050  0.0316    99.010  237.62
  20   0.0683     97.830  0.0333    98.965  249.96
  21   0.0486     98.370  0.0318    99.012  262.32
  22   0.0408     98.630  0.0314    99.003  274.79
  23   0.0750     97.470  0.0297    99.018  287.13
  24   0.0539     98.220  0.0321    99.032  299.47
  25   0.0700     97.670  0.0300    99.082  311.83
  26   0.0316     98.960  0.0305    99.037  324.21
  27   0.0423     98.600  0.0277    99.133  336.53
  28   0.0534     98.230  0.0291    99.095  348.89
  29   0.0373     98.760  0.0298    99.098  361.22
  30   0.0372     98.780  0.0264    99.165  373.57
  31   0.0531     98.390  0.0269    99.147  385.90
  32   0.0296     98.980  0.0281    99.142  398.24
  33   0.0275     99.150  0.0263    99.197  410.55
  34   0.0394     98.740  0.0269    99.130  422.87
  35   0.0287     99.120  0.0254    99.185  435.35
  36   0.0275     99.160  0.0238    99.250  447.67
  37   0.0302     98.960  0.0250    99.220  460.01
  38   0.0340     98.890  0.0239    99.275  472.46
  39   0.0343     98.920  0.0237    99.285  484.84
  40   0.0359     98.840  0.0238    99.250  497.19
  41   0.0234     99.220  0.0241    99.230  509.55
  42   0.0343     98.970  0.0214    99.343  521.93
  43   0.0410     98.650  0.0216    99.337  534.24
  44   0.0247     99.190  0.0216    99.332  546.57
  45   0.0320     98.880  0.0225    99.270  558.91
  46   0.0395     98.710  0.0200    99.380  571.27
  47   0.0289     98.970  0.0199    99.388  583.62
  48   0.0360     98.870  0.0188    99.400  596.01
  49   0.0456     98.520  0.0194    99.378  608.29
  50   0.0263     99.140  0.0191    99.415  620.61
  51   0.0309     99.070  0.0184    99.428  633.06
  52   0.0292     99.050  0.0183    99.412  645.41
  53   0.0257     99.180  0.0172    99.497  657.77
  54   0.0281     99.170  0.0169    99.463  670.12
  55   0.0306     99.090  0.0162    99.510  682.48
  56   0.0320     98.950  0.0150    99.543  694.82
  57   0.0218     99.350  0.0145    99.562  707.17
  58   0.0407     98.680  0.0144    99.543  719.62
  59   0.0277     99.050  0.0140    99.577  731.95
  60   0.0281     99.080  0.0116    99.673  744.31
  61   0.0230     99.280  0.0116    99.648  756.74
  62   0.0288     99.020  0.0117    99.625  769.06
  63   0.0241     99.170  0.0096    99.728  781.39
  64   0.0260     99.170  0.0104    99.698  793.70
  65   0.0285     99.140  0.0082    99.773  806.03
  66   0.0276     99.050  0.0091    99.727  818.35
  67   0.0199     99.380  0.0080    99.772  830.69
  68   0.0271     99.110  0.0072    99.802  843.03
  69   0.0303     99.120  0.0065    99.810  855.35
  70   0.0225     99.230  0.0071    99.795  867.68
  71   0.0255     99.210  0.0054    99.865  880.14
  72   0.0245     99.260  0.0054    99.850  892.47
  73   0.0268     99.210  0.0053    99.862  904.81
  74   0.0266     99.130  0.0043    99.908  917.15
  75   0.0294     99.130  0.0042    99.902  929.47
  76   0.0278     99.120  0.0044    99.887  941.79
  77   0.0257     99.200  0.0038    99.907  954.13
  78   0.0271     99.160  0.0033    99.925  966.50
  79   0.0282     99.200  0.0031    99.937  978.84
  80   0.0254     99.240  0.0028    99.953  991.16
  81   0.0253     99.250  0.0024    99.965  1003.63
  82   0.0269     99.190  0.0024    99.957  1015.95
  83   0.0281     99.160  0.0023    99.970  1028.26
  84   0.0239     99.260  0.0023    99.962  1040.72
  85   0.0282     99.200  0.0023    99.958  1053.04
  86   0.0289     99.190  0.0023    99.967  1065.37
  87   0.0276     99.230  0.0019    99.980  1077.69
  88   0.0287     99.220  0.0018    99.988  1090.02
  89   0.0288     99.270  0.0018    99.982  1102.35
  90   0.0297     99.250  0.0017    99.985  1114.68
