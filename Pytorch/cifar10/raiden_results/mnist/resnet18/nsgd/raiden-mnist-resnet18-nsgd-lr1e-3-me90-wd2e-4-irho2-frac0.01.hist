Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5162     86.020  1.4397    53.482  14.61
   2   0.3375     88.830  0.3780    89.077  27.06
   3   0.1931     94.000  0.2284    93.155  39.58
   4   0.1332     95.730  0.1709    94.745  51.98
   5   0.1061     96.600  0.1344    95.887  64.40
   6   0.1176     96.210  0.1146    96.498  76.88
   7   0.0937     97.030  0.0995    96.923  89.29
   8   0.0761     97.560  0.0904    97.240  101.69
   9   0.0635     97.950  0.0819    97.420  114.09
  10   0.0777     97.550  0.0744    97.695  126.48
  11   0.0620     98.100  0.0693    97.827  138.88
  12   0.0856     97.170  0.0654    97.958  151.39
  13   0.0578     98.240  0.0608    98.047  163.84
  14   0.0526     98.350  0.0579    98.240  176.28
  15   0.0614     98.020  0.0560    98.240  188.70
  16   0.0552     98.280  0.0529    98.327  201.10
  17   0.0531     98.090  0.0499    98.470  213.46
  18   0.0412     98.630  0.0487    98.455  225.85
  19   0.0468     98.420  0.0478    98.525  238.39
  20   0.0706     97.760  0.0447    98.583  250.79
  21   0.0495     98.490  0.0441    98.607  263.21
  22   0.0433     98.610  0.0418    98.717  275.73
  23   0.0430     98.620  0.0409    98.695  288.14
  24   0.0371     98.740  0.0397    98.727  300.55
  25   0.0494     98.390  0.0389    98.815  313.08
  26   0.0434     98.570  0.0371    98.815  325.51
  27   0.0545     98.350  0.0360    98.905  337.89
  28   0.0357     98.880  0.0358    98.847  350.29
  29   0.0467     98.520  0.0352    98.873  362.83
  30   0.0433     98.650  0.0340    98.940  375.23
  31   0.0359     98.820  0.0320    99.010  387.70
  32   0.0402     98.760  0.0325    98.985  400.10
  33   0.0365     98.610  0.0315    98.970  412.48
  34   0.0378     98.700  0.0314    98.963  424.90
  35   0.0420     98.680  0.0301    99.078  437.30
  36   0.0396     98.740  0.0292    99.070  449.71
  37   0.0335     98.950  0.0290    99.088  462.11
  38   0.0357     98.900  0.0300    99.092  474.58
  39   0.0336     98.880  0.0276    99.168  486.96
  40   0.0381     98.780  0.0289    99.078  499.37
  41   0.0419     98.530  0.0277    99.122  511.77
  42   0.0424     98.600  0.0272    99.142  524.21
  43   0.0340     98.920  0.0268    99.115  536.62
  44   0.0374     98.690  0.0256    99.173  549.01
  45   0.0350     98.870  0.0258    99.147  561.53
  46   0.0312     98.890  0.0253    99.198  573.93
  47   0.0437     98.630  0.0251    99.178  586.35
  48   0.0328     98.830  0.0233    99.272  598.77
  49   0.0403     98.630  0.0230    99.265  611.16
  50   0.0397     98.800  0.0232    99.255  623.54
  51   0.0364     98.730  0.0234    99.230  635.95
  52   0.0416     98.660  0.0220    99.297  648.55
  53   0.0377     98.720  0.0226    99.282  660.94
  54   0.0358     98.860  0.0227    99.245  673.38
  55   0.0369     98.710  0.0213    99.332  685.76
  56   0.0298     99.020  0.0217    99.275  698.17
  57   0.0355     98.750  0.0213    99.328  710.58
  58   0.0356     98.770  0.0208    99.312  722.99
  59   0.0381     98.710  0.0210    99.357  735.41
  60   0.0333     98.870  0.0201    99.340  747.80
  61   0.0299     98.940  0.0207    99.360  760.20
  62   0.0298     98.980  0.0205    99.297  772.61
  63   0.0328     98.850  0.0192    99.367  785.02
  64   0.0309     98.960  0.0192    99.368  797.41
  65   0.0316     98.870  0.0190    99.357  809.94
  66   0.0334     98.960  0.0191    99.387  822.35
  67   0.0419     98.710  0.0185    99.382  834.74
  68   0.0372     98.810  0.0194    99.358  847.14
  69   0.0335     98.820  0.0179    99.422  859.68
  70   0.0300     98.970  0.0179    99.463  872.11
  71   0.0371     98.720  0.0167    99.457  884.50
  72   0.0321     98.990  0.0176    99.395  896.93
  73   0.0280     99.010  0.0167    99.437  909.33
  74   0.0386     98.790  0.0166    99.463  921.74
  75   0.0352     98.810  0.0167    99.433  934.14
  76   0.0360     98.790  0.0157    99.488  946.63
  77   0.0395     98.680  0.0161    99.472  959.04
  78   0.0323     98.940  0.0161    99.475  971.43
  79   0.0313     98.980  0.0163    99.462  983.94
  80   0.0334     98.920  0.0156    99.485  996.34
  81   0.0287     99.130  0.0158    99.480  1008.77
  82   0.0325     98.890  0.0151    99.503  1021.25
  83   0.0322     98.930  0.0153    99.530  1033.62
  84   0.0387     98.810  0.0152    99.527  1046.02
  85   0.0282     99.100  0.0145    99.522  1058.45
  86   0.0357     98.810  0.0143    99.567  1070.85
  87   0.0383     98.700  0.0145    99.518  1083.25
  88   0.0400     98.720  0.0144    99.507  1095.68
  89   0.0284     98.980  0.0139    99.542  1108.09
  90   0.0360     98.850  0.0144    99.538  1120.51
