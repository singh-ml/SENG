Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5901     83.450  1.4417    52.770  14.61
   2   0.3023     90.570  0.3945    88.275  26.95
   3   0.2127     93.440  0.2369    92.917  39.40
   4   0.1603     95.140  0.1740    94.688  51.74
   5   0.1263     96.260  0.1381    95.757  64.07
   6   0.1049     96.740  0.1166    96.475  76.50
   7   0.1311     96.120  0.1019    96.845  88.86
   8   0.0974     97.060  0.0912    97.202  101.19
   9   0.0829     97.250  0.0822    97.432  113.54
  10   0.0811     97.290  0.0754    97.720  125.90
  11   0.0924     97.250  0.0700    97.863  138.22
  12   0.0743     97.600  0.0645    97.977  150.58
  13   0.0706     97.920  0.0621    98.073  163.05
  14   0.0581     98.130  0.0580    98.200  175.39
  15   0.0614     98.040  0.0563    98.267  187.74
  16   0.0578     98.170  0.0534    98.338  200.21
  17   0.0589     98.140  0.0514    98.372  212.55
  18   0.0529     98.290  0.0486    98.502  224.94
  19   0.0522     98.270  0.0466    98.500  237.39
  20   0.0550     98.230  0.0461    98.557  249.73
  21   0.0500     98.360  0.0448    98.607  262.10
  22   0.0532     98.370  0.0429    98.627  274.44
  23   0.0466     98.420  0.0418    98.650  286.81
  24   0.0502     98.350  0.0413    98.708  299.18
  25   0.0470     98.510  0.0391    98.780  311.55
  26   0.0406     98.680  0.0382    98.793  324.01
  27   0.0577     98.390  0.0364    98.848  336.38
  28   0.0507     98.450  0.0358    98.847  348.72
  29   0.0442     98.500  0.0352    98.863  361.10
  30   0.0408     98.600  0.0343    98.942  373.57
  31   0.0404     98.730  0.0333    98.985  385.93
  32   0.0450     98.530  0.0327    98.945  398.27
  33   0.0396     98.740  0.0323    99.010  410.61
  34   0.0377     98.690  0.0307    99.028  423.16
  35   0.0516     98.450  0.0309    99.007  435.50
  36   0.0432     98.560  0.0300    99.033  447.86
  37   0.0390     98.700  0.0297    99.068  460.32
  38   0.0412     98.700  0.0288    99.068  472.67
  39   0.0395     98.780  0.0280    99.110  484.99
  40   0.0351     98.910  0.0274    99.128  497.42
  41   0.0339     98.920  0.0263    99.160  509.78
  42   0.0469     98.510  0.0266    99.120  522.14
  43   0.0378     98.660  0.0278    99.133  534.48
  44   0.0346     98.860  0.0262    99.175  546.96
  45   0.0409     98.670  0.0252    99.162  559.32
  46   0.0362     98.780  0.0250    99.172  571.64
  47   0.0433     98.550  0.0251    99.175  583.98
  48   0.0384     98.860  0.0240    99.240  596.54
  49   0.0405     98.580  0.0237    99.233  608.90
  50   0.0341     98.970  0.0232    99.240  621.28
  51   0.0380     98.780  0.0237    99.243  633.67
  52   0.0314     98.990  0.0223    99.280  646.02
  53   0.0409     98.650  0.0221    99.287  658.34
  54   0.0321     98.940  0.0229    99.240  670.71
  55   0.0383     98.780  0.0222    99.307  683.02
  56   0.0305     99.010  0.0213    99.268  695.36
  57   0.0341     98.890  0.0211    99.283  707.81
  58   0.0338     98.900  0.0207    99.340  720.16
  59   0.0400     98.800  0.0216    99.280  732.51
  60   0.0343     98.890  0.0210    99.310  744.96
  61   0.0347     98.920  0.0205    99.357  757.31
  62   0.0340     98.890  0.0192    99.368  769.67
  63   0.0349     98.950  0.0193    99.362  782.04
  64   0.0347     99.010  0.0186    99.422  794.39
  65   0.0360     98.840  0.0179    99.410  806.70
  66   0.0386     98.790  0.0189    99.378  819.03
  67   0.0359     98.830  0.0185    99.390  831.49
  68   0.0325     98.960  0.0177    99.418  843.85
  69   0.0354     98.790  0.0176    99.422  856.18
  70   0.0345     99.040  0.0169    99.435  868.63
  71   0.0368     98.920  0.0172    99.440  880.97
  72   0.0392     98.760  0.0170    99.457  893.32
  73   0.0387     98.780  0.0177    99.435  905.68
  74   0.0371     98.710  0.0154    99.527  918.02
  75   0.0391     98.720  0.0164    99.473  930.37
  76   0.0394     98.660  0.0176    99.387  942.71
  77   0.0370     98.830  0.0164    99.470  955.05
  78   0.0343     98.900  0.0152    99.513  967.38
  79   0.0351     98.900  0.0165    99.452  979.73
  80   0.0384     98.740  0.0160    99.517  992.21
  81   0.0355     98.830  0.0152    99.485  1004.54
  82   0.0371     98.760  0.0143    99.528  1016.90
  83   0.0330     98.990  0.0156    99.482  1029.36
  84   0.0363     98.910  0.0149    99.490  1041.70
  85   0.0362     98.890  0.0153    99.492  1054.05
  86   0.0397     98.730  0.0152    99.513  1066.56
  87   0.0346     98.870  0.0141    99.533  1078.88
  88   0.0428     98.580  0.0146    99.505  1091.25
  89   0.0344     98.950  0.0132    99.583  1103.60
  90   0.0354     98.830  0.0145    99.515  1116.05
