Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.7929     76.150  0.6877    76.585  14.72
   2   0.1585     95.130  0.1355    95.742  27.18
   3   0.1312     95.840  0.0896    97.190  39.63
   4   0.1210     96.040  0.0708    97.732  52.12
   5   0.0700     97.710  0.0603    98.090  64.54
   6   0.0548     98.390  0.0542    98.277  76.94
   7   0.0592     98.170  0.0500    98.423  89.48
   8   0.0510     98.340  0.0460    98.570  101.91
   9   0.0584     98.250  0.0424    98.637  114.33
  10   0.0459     98.460  0.0394    98.728  126.76
  11   0.0433     98.430  0.0383    98.782  139.40
  12   0.0488     98.370  0.0359    98.898  151.81
  13   0.0431     98.630  0.0339    98.912  164.20
  14   0.0544     98.230  0.0335    98.875  176.69
  15   0.0424     98.650  0.0311    98.987  189.12
  16   0.0546     98.330  0.0307    99.033  201.51
  17   0.0351     98.780  0.0306    99.043  214.00
  18   0.0376     98.730  0.0284    99.060  226.40
  19   0.0417     98.630  0.0278    99.092  238.82
  20   0.0363     98.870  0.0263    99.120  251.34
  21   0.0334     98.810  0.0259    99.137  263.78
  22   0.0430     98.520  0.0242    99.223  276.20
  23   0.0343     98.750  0.0241    99.192  288.59
  24   0.0406     98.720  0.0239    99.218  300.98
  25   0.0383     98.720  0.0234    99.237  313.41
  26   0.0410     98.690  0.0223    99.267  325.82
  27   0.0299     98.940  0.0220    99.298  338.24
  28   0.0292     99.060  0.0220    99.263  350.63
  29   0.0330     98.910  0.0197    99.355  363.05
  30   0.0352     98.900  0.0206    99.312  375.57
  31   0.0346     98.870  0.0196    99.345  387.99
  32   0.0412     98.650  0.0190    99.373  400.41
  33   0.0328     98.840  0.0186    99.380  412.85
  34   0.0258     99.120  0.0194    99.325  425.24
  35   0.0292     98.980  0.0177    99.405  437.63
  36   0.0333     98.890  0.0177    99.458  450.16
  37   0.0305     99.060  0.0168    99.443  462.58
  38   0.0304     98.950  0.0166    99.440  474.98
  39   0.0385     98.820  0.0163    99.477  487.40
  40   0.0307     98.970  0.0174    99.415  499.83
  41   0.0287     99.050  0.0164    99.443  512.28
  42   0.0449     98.500  0.0159    99.480  524.70
  43   0.0351     98.930  0.0157    99.487  537.27
  44   0.0338     98.810  0.0157    99.483  549.70
  45   0.0405     98.710  0.0157    99.463  562.11
  46   0.0263     99.140  0.0148    99.477  574.63
  47   0.0308     99.020  0.0142    99.523  587.06
  48   0.0279     99.130  0.0135    99.508  599.47
  49   0.0236     99.240  0.0142    99.512  611.90
  50   0.0295     99.000  0.0145    99.497  624.33
  51   0.0317     99.000  0.0132    99.555  636.75
  52   0.0338     98.880  0.0126    99.577  649.17
  53   0.0348     98.870  0.0124    99.590  661.62
  54   0.0279     99.150  0.0120    99.610  674.04
  55   0.0324     98.960  0.0122    99.608  686.46
  56   0.0340     98.950  0.0123    99.560  698.98
  57   0.0278     99.130  0.0117    99.612  711.41
  58   0.0340     98.930  0.0121    99.597  723.84
  59   0.0393     98.870  0.0112    99.625  736.28
  60   0.0308     98.960  0.0126    99.598  748.84
  61   0.0377     98.860  0.0105    99.675  761.28
  62   0.0250     99.230  0.0096    99.668  773.75
  63   0.0437     98.740  0.0106    99.658  786.17
  64   0.0297     98.960  0.0113    99.617  798.60
  65   0.0297     99.090  0.0102    99.678  811.01
  66   0.0420     98.760  0.0106    99.620  823.53
  67   0.0328     98.990  0.0108    99.632  835.95
  68   0.0330     98.940  0.0105    99.643  848.38
  69   0.0324     99.100  0.0095    99.675  860.79
  70   0.0379     98.860  0.0096    99.672  873.43
  71   0.0310     99.010  0.0095    99.710  885.84
  72   0.0297     99.070  0.0099    99.663  898.26
  73   0.0366     98.930  0.0096    99.670  910.77
  74   0.0369     98.880  0.0097    99.670  923.17
  75   0.0338     98.890  0.0093    99.660  935.57
  76   0.0320     98.970  0.0087    99.700  947.98
  77   0.0330     99.030  0.0092    99.682  960.38
  78   0.0310     99.060  0.0087    99.708  972.80
  79   0.0360     99.010  0.0085    99.712  985.23
  80   0.0349     98.980  0.0076    99.750  997.76
  81   0.0329     98.950  0.0083    99.732  1010.17
  82   0.0339     98.900  0.0076    99.737  1022.60
  83   0.0387     98.790  0.0077    99.723  1035.03
  84   0.0299     99.120  0.0071    99.762  1047.45
  85   0.0341     98.910  0.0079    99.748  1059.85
  86   0.0381     98.970  0.0068    99.757  1072.27
  87   0.0313     99.070  0.0073    99.753  1084.83
  88   0.0467     98.620  0.0082    99.705  1097.24
  89   0.0402     98.910  0.0071    99.762  1109.65
  90   0.0456     98.730  0.0079    99.730  1122.17
