Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3497     88.090  0.6573    77.605  14.81
   2   0.0903     97.090  0.1255    96.168  27.31
   3   0.0738     97.670  0.0843    97.390  39.78
   4   0.0788     97.370  0.0707    97.808  52.36
   5   0.0610     98.000  0.0608    98.035  64.84
   6   0.0570     98.240  0.0526    98.340  77.29
   7   0.0526     98.290  0.0479    98.473  89.87
   8   0.0592     98.110  0.0446    98.570  102.33
   9   0.0650     97.970  0.0420    98.643  114.78
  10   0.0526     98.310  0.0392    98.768  127.34
  11   0.0656     98.050  0.0378    98.812  139.81
  12   0.0403     98.710  0.0360    98.822  152.26
  13   0.0452     98.600  0.0340    98.870  164.75
  14   0.0448     98.580  0.0322    98.965  177.24
  15   0.0334     98.880  0.0325    98.940  189.71
  16   0.0440     98.630  0.0301    99.010  202.16
  17   0.0426     98.580  0.0290    99.062  214.61
  18   0.0431     98.550  0.0294    99.020  227.10
  19   0.0352     98.890  0.0277    99.067  239.57
  20   0.0566     98.100  0.0267    99.128  252.17
  21   0.0578     98.120  0.0268    99.132  264.64
  22   0.0368     98.850  0.0240    99.212  277.11
  23   0.0444     98.540  0.0246    99.197  289.67
  24   0.0473     98.290  0.0234    99.232  302.13
  25   0.0505     98.230  0.0235    99.207  314.60
  26   0.0321     98.990  0.0217    99.277  327.09
  27   0.0313     99.010  0.0213    99.315  339.54
  28   0.0358     98.900  0.0210    99.315  352.00
  29   0.0397     98.870  0.0206    99.327  364.45
  30   0.0321     98.900  0.0201    99.345  377.04
  31   0.0249     99.130  0.0190    99.348  389.50
  32   0.0328     99.010  0.0205    99.347  401.97
  33   0.0456     98.480  0.0186    99.370  414.57
  34   0.0353     98.790  0.0185    99.388  427.02
  35   0.0250     99.150  0.0180    99.390  439.50
  36   0.0344     98.840  0.0177    99.383  452.10
  37   0.0369     98.820  0.0178    99.397  464.56
  38   0.0301     99.000  0.0175    99.413  477.04
  39   0.0372     98.700  0.0162    99.463  489.61
  40   0.0296     99.200  0.0150    99.498  502.07
  41   0.0355     98.880  0.0154    99.468  514.53
  42   0.0358     98.920  0.0153    99.493  527.01
  43   0.0398     98.710  0.0153    99.480  539.51
  44   0.0311     99.020  0.0144    99.525  551.99
  45   0.0335     98.980  0.0157    99.457  564.52
  46   0.0341     98.990  0.0142    99.525  577.16
  47   0.0309     98.990  0.0135    99.548  589.63
  48   0.0338     98.860  0.0138    99.547  602.09
  49   0.0338     98.930  0.0130    99.583  614.68
  50   0.0637     98.050  0.0144    99.512  627.16
  51   0.0264     99.140  0.0126    99.552  639.64
  52   0.0359     98.840  0.0122    99.578  652.28
  53   0.0329     98.980  0.0138    99.528  664.75
  54   0.0338     99.040  0.0120    99.592  677.22
  55   0.0365     98.960  0.0118    99.627  689.71
  56   0.0360     98.920  0.0112    99.633  702.14
  57   0.0334     98.990  0.0116    99.597  714.61
  58   0.0396     98.690  0.0120    99.592  727.21
  59   0.0276     99.060  0.0114    99.605  739.72
  60   0.0335     98.910  0.0108    99.647  752.21
  61   0.0311     99.000  0.0115    99.612  764.71
  62   0.0364     98.900  0.0105    99.650  777.23
  63   0.0361     98.850  0.0091    99.707  789.68
  64   0.0312     99.040  0.0109    99.610  802.15
  65   0.0359     98.830  0.0110    99.620  814.76
  66   0.0411     98.810  0.0096    99.690  827.24
  67   0.0369     99.010  0.0103    99.637  839.71
  68   0.0435     98.870  0.0106    99.627  852.31
  69   0.0437     98.680  0.0099    99.650  864.77
  70   0.0382     98.940  0.0088    99.715  877.26
  71   0.0345     98.990  0.0093    99.677  889.74
  72   0.0356     98.890  0.0095    99.690  902.24
  73   0.0361     99.010  0.0095    99.672  914.75
  74   0.0278     99.120  0.0087    99.705  927.28
  75   0.0339     99.020  0.0090    99.677  939.83
  76   0.0406     98.940  0.0097    99.662  952.33
  77   0.0306     99.030  0.0077    99.708  964.86
  78   0.0393     98.790  0.0089    99.685  977.41
  79   0.0316     99.120  0.0083    99.710  990.00
  80   0.0349     98.900  0.0072    99.752  1002.50
  81   0.0432     98.820  0.0073    99.740  1014.97
  82   0.0322     99.050  0.0084    99.720  1027.52
  83   0.0422     98.800  0.0075    99.752  1039.98
  84   0.0273     99.150  0.0075    99.765  1052.43
  85   0.0265     99.160  0.0073    99.757  1064.91
  86   0.0282     99.120  0.0067    99.788  1077.51
  87   0.0401     98.910  0.0072    99.757  1090.05
  88   0.0404     98.810  0.0081    99.722  1102.54
  89   0.0305     99.090  0.0073    99.738  1114.98
  90   0.0323     99.050  0.0073    99.743  1127.45
