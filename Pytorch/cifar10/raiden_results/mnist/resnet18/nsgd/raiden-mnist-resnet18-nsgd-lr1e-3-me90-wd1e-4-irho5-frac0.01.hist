Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2573     92.110  0.9005    70.217  14.89
   2   0.1476     95.580  0.1890    94.177  27.44
   3   0.1257     96.120  0.1221    96.282  39.99
   4   0.0797     97.450  0.0947    97.062  52.63
   5   0.0844     97.230  0.0786    97.557  65.16
   6   0.0594     98.150  0.0682    97.793  77.70
   7   0.0600     98.050  0.0602    98.120  90.39
   8   0.0532     98.320  0.0561    98.233  102.95
   9   0.0453     98.480  0.0506    98.398  115.49
  10   0.0537     98.310  0.0473    98.500  128.19
  11   0.0920     96.780  0.0453    98.533  140.75
  12   0.0601     98.040  0.0428    98.627  153.32
  13   0.0481     98.250  0.0398    98.745  165.90
  14   0.0467     98.380  0.0394    98.740  178.43
  15   0.0421     98.620  0.0370    98.800  190.97
  16   0.0432     98.570  0.0350    98.883  203.50
  17   0.0359     98.840  0.0340    98.935  216.17
  18   0.0471     98.600  0.0346    98.912  228.71
  19   0.0419     98.610  0.0315    98.978  241.26
  20   0.0487     98.410  0.0307    99.008  253.80
  21   0.0357     98.850  0.0293    99.053  266.35
  22   0.0383     98.790  0.0294    99.040  278.90
  23   0.0463     98.640  0.0291    99.053  291.52
  24   0.0371     98.720  0.0273    99.117  304.07
  25   0.0376     98.800  0.0263    99.160  316.62
  26   0.0413     98.750  0.0271    99.100  329.17
  27   0.0415     98.650  0.0252    99.178  341.74
  28   0.0357     98.850  0.0256    99.148  354.28
  29   0.0393     98.740  0.0231    99.240  366.94
  30   0.0339     98.950  0.0243    99.237  379.51
  31   0.0320     98.950  0.0222    99.255  392.07
  32   0.0431     98.570  0.0233    99.228  404.59
  33   0.0290     99.010  0.0218    99.320  417.33
  34   0.0327     98.990  0.0214    99.273  429.88
  35   0.0304     99.040  0.0205    99.308  442.46
  36   0.0340     98.830  0.0207    99.342  455.02
  37   0.0324     98.930  0.0210    99.277  467.59
  38   0.0352     98.920  0.0212    99.335  480.17
  39   0.0318     98.900  0.0195    99.345  492.88
  40   0.0337     98.930  0.0192    99.375  505.44
  41   0.0425     98.670  0.0182    99.418  518.01
  42   0.0357     98.720  0.0184    99.377  530.69
  43   0.0312     99.030  0.0184    99.372  543.24
  44   0.0399     98.780  0.0176    99.368  555.80
  45   0.0322     99.010  0.0179    99.405  568.48
  46   0.0281     99.080  0.0163    99.442  581.05
  47   0.0402     98.720  0.0178    99.427  593.60
  48   0.0312     98.990  0.0172    99.407  606.19
  49   0.0375     98.790  0.0157    99.483  618.75
  50   0.0363     98.880  0.0154    99.493  631.31
  51   0.0279     99.030  0.0155    99.480  643.87
  52   0.0316     98.840  0.0152    99.515  656.42
  53   0.0411     98.630  0.0159    99.483  668.96
  54   0.0285     99.030  0.0142    99.533  681.50
  55   0.0367     98.890  0.0144    99.515  694.15
  56   0.0339     98.930  0.0144    99.537  706.72
  57   0.0283     99.040  0.0148    99.513  719.26
  58   0.0352     98.820  0.0137    99.513  731.94
  59   0.0336     98.940  0.0138    99.513  744.49
  60   0.0375     98.800  0.0134    99.548  757.07
  61   0.0366     98.810  0.0134    99.580  769.83
  62   0.0269     99.160  0.0125    99.587  782.40
  63   0.0294     99.090  0.0127    99.575  794.92
  64   0.0312     99.030  0.0124    99.610  807.51
  65   0.0321     99.040  0.0127    99.580  820.07
  66   0.0312     98.980  0.0117    99.590  832.64
  67   0.0353     98.860  0.0123    99.575  845.20
  68   0.0314     98.840  0.0113    99.637  857.73
  69   0.0374     98.910  0.0123    99.590  870.30
  70   0.0383     98.740  0.0115    99.598  882.85
  71   0.0400     98.800  0.0113    99.632  895.41
  72   0.0392     98.710  0.0118    99.617  908.01
  73   0.0369     98.790  0.0116    99.598  920.63
  74   0.0314     98.970  0.0103    99.648  933.16
  75   0.0334     98.940  0.0115    99.608  945.81
  76   0.0282     99.020  0.0104    99.662  958.35
  77   0.0273     99.180  0.0111    99.627  970.91
  78   0.0443     98.540  0.0100    99.682  983.44
  79   0.0306     99.010  0.0093    99.693  996.01
  80   0.0325     98.940  0.0104    99.657  1008.61
  81   0.0292     99.130  0.0097    99.675  1021.16
  82   0.0349     99.000  0.0089    99.708  1033.82
  83   0.0316     99.060  0.0093    99.652  1046.41
  84   0.0410     98.740  0.0097    99.692  1058.98
  85   0.0352     98.990  0.0090    99.697  1071.54
  86   0.0313     99.090  0.0106    99.628  1084.33
  87   0.0417     98.660  0.0093    99.690  1096.87
  88   0.0319     98.910  0.0095    99.662  1109.53
  89   0.0286     99.130  0.0089    99.730  1122.08
  90   0.0356     99.010  0.0080    99.745  1134.64
