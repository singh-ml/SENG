Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3276     90.050  0.8960    70.048  14.51
   2   0.1365     95.600  0.1950    93.950  26.78
   3   0.1358     95.520  0.1243    96.207  39.20
   4   0.0769     97.630  0.0942    97.078  51.49
   5   0.0672     97.960  0.0784    97.545  63.78
   6   0.0754     97.540  0.0683    97.835  76.08
   7   0.0536     98.210  0.0596    98.110  88.36
   8   0.0633     98.110  0.0555    98.270  100.63
   9   0.0567     98.230  0.0495    98.522  113.03
  10   0.0942     96.770  0.0469    98.503  125.35
  11   0.0448     98.500  0.0443    98.582  137.62
  12   0.0523     98.320  0.0420    98.617  149.91
  13   0.0552     98.060  0.0394    98.710  162.37
  14   0.0423     98.620  0.0384    98.805  174.66
  15   0.0489     98.330  0.0372    98.868  186.95
  16   0.0412     98.640  0.0357    98.857  199.34
  17   0.0444     98.580  0.0346    98.908  211.65
  18   0.0425     98.550  0.0324    98.912  223.96
  19   0.0471     98.520  0.0332    98.918  236.26
  20   0.0360     98.810  0.0305    99.025  248.57
  21   0.0369     98.760  0.0301    99.015  260.84
  22   0.0424     98.710  0.0280    99.095  273.10
  23   0.0324     98.940  0.0276    99.142  285.39
  24   0.0408     98.700  0.0277    99.113  297.68
  25   0.0355     98.740  0.0268    99.103  309.97
  26   0.0370     98.840  0.0247    99.215  322.40
  27   0.0370     98.890  0.0251    99.195  334.71
  28   0.0378     98.710  0.0238    99.205  346.99
  29   0.0375     98.740  0.0245    99.215  359.26
  30   0.0403     98.690  0.0247    99.198  371.75
  31   0.0364     98.990  0.0237    99.227  384.03
  32   0.0387     98.750  0.0216    99.305  396.30
  33   0.0408     98.740  0.0206    99.367  408.61
  34   0.0348     98.870  0.0199    99.355  420.90
  35   0.0349     98.690  0.0210    99.310  433.17
  36   0.0330     98.890  0.0201    99.333  445.57
  37   0.0364     98.800  0.0196    99.395  457.84
  38   0.0412     98.570  0.0197    99.355  470.11
  39   0.0308     98.910  0.0196    99.330  482.41
  40   0.0295     99.030  0.0182    99.387  494.70
  41   0.0330     98.850  0.0181    99.393  507.00
  42   0.0400     98.720  0.0184    99.347  519.30
  43   0.0370     98.860  0.0171    99.407  531.69
  44   0.0305     99.020  0.0179    99.385  543.97
  45   0.0317     98.880  0.0179    99.422  556.23
  46   0.0322     98.900  0.0165    99.445  568.64
  47   0.0326     98.970  0.0167    99.438  580.95
  48   0.0357     98.850  0.0165    99.455  593.23
  49   0.0346     98.890  0.0163    99.457  605.66
  50   0.0425     98.650  0.0164    99.430  617.94
  51   0.0353     98.830  0.0154    99.475  630.23
  52   0.0364     98.840  0.0148    99.520  642.52
  53   0.0289     98.980  0.0151    99.508  654.84
  54   0.0429     98.580  0.0140    99.532  667.14
  55   0.0309     99.010  0.0153    99.488  679.44
  56   0.0377     98.830  0.0149    99.497  691.72
  57   0.0328     98.930  0.0140    99.553  704.00
  58   0.0354     98.920  0.0132    99.550  716.28
  59   0.0290     99.110  0.0133    99.552  728.68
  60   0.0268     99.230  0.0135    99.547  740.98
  61   0.0369     98.990  0.0142    99.520  753.29
  62   0.0319     99.030  0.0127    99.585  765.70
  63   0.0324     98.900  0.0117    99.620  777.97
  64   0.0346     98.980  0.0124    99.602  790.23
  65   0.0294     99.040  0.0127    99.558  802.64
  66   0.0370     98.850  0.0124    99.587  814.94
  67   0.0346     98.930  0.0118    99.562  827.21
  68   0.0319     99.020  0.0122    99.580  839.53
  69   0.0449     98.730  0.0113    99.615  851.84
  70   0.0417     98.720  0.0116    99.625  864.14
  71   0.0385     98.770  0.0124    99.585  876.44
  72   0.0349     98.910  0.0110    99.617  888.70
  73   0.0386     98.700  0.0111    99.628  901.04
  74   0.0281     99.090  0.0105    99.633  913.39
  75   0.0334     98.860  0.0096    99.712  925.87
  76   0.0319     98.960  0.0116    99.602  938.16
  77   0.0392     98.860  0.0109    99.622  950.46
  78   0.0355     98.890  0.0108    99.637  962.84
  79   0.0351     98.970  0.0095    99.675  975.15
  80   0.0353     98.970  0.0090    99.705  987.48
  81   0.0269     99.200  0.0098    99.682  999.76
  82   0.0269     99.150  0.0084    99.735  1012.17
  83   0.0357     98.870  0.0089    99.705  1024.45
  84   0.0389     98.830  0.0101    99.648  1036.71
  85   0.0244     99.230  0.0094    99.668  1049.17
  86   0.0354     98.960  0.0087    99.723  1061.43
  87   0.0275     99.020  0.0102    99.650  1073.72
  88   0.0286     99.120  0.0085    99.705  1086.06
  89   0.0381     98.880  0.0093    99.655  1098.38
  90   0.0413     98.930  0.0080    99.740  1110.66
