Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3729     88.800  0.9427    68.595  14.65
   2   0.1605     94.840  0.1948    94.027  27.01
   3   0.1005     96.930  0.1228    96.242  39.52
   4   0.0753     97.550  0.0946    97.047  51.87
   5   0.0860     97.280  0.0769    97.633  64.18
   6   0.0607     98.030  0.0666    97.922  76.53
   7   0.0542     98.210  0.0605    98.132  88.89
   8   0.0624     97.950  0.0548    98.252  101.28
   9   0.0554     98.140  0.0500    98.447  113.77
  10   0.0502     98.160  0.0469    98.498  126.15
  11   0.0544     98.260  0.0452    98.580  138.48
  12   0.0490     98.220  0.0424    98.675  150.82
  13   0.0460     98.480  0.0400    98.733  163.23
  14   0.0498     98.410  0.0385    98.752  175.62
  15   0.0428     98.560  0.0376    98.748  187.98
  16   0.0461     98.570  0.0355    98.847  200.37
  17   0.0414     98.620  0.0340    98.892  212.72
  18   0.0392     98.740  0.0332    98.930  225.10
  19   0.0489     98.360  0.0320    99.015  237.62
  20   0.0463     98.570  0.0316    98.947  249.98
  21   0.0408     98.520  0.0305    99.055  262.35
  22   0.0371     98.740  0.0295    99.060  274.81
  23   0.0460     98.450  0.0281    99.055  287.17
  24   0.0401     98.650  0.0284    99.085  299.55
  25   0.0349     98.790  0.0272    99.102  312.00
  26   0.0430     98.530  0.0249    99.217  324.38
  27   0.0411     98.620  0.0258    99.138  336.78
  28   0.0388     98.850  0.0243    99.207  349.17
  29   0.0351     98.950  0.0252    99.213  361.66
  30   0.0356     98.790  0.0238    99.228  374.00
  31   0.0278     99.100  0.0226    99.228  386.33
  32   0.0350     98.800  0.0222    99.285  398.69
  33   0.0392     98.740  0.0224    99.285  411.07
  34   0.0449     98.470  0.0203    99.340  423.41
  35   0.0303     99.050  0.0204    99.335  435.78
  36   0.0339     98.910  0.0203    99.347  448.24
  37   0.0359     98.800  0.0200    99.348  460.61
  38   0.0369     98.800  0.0202    99.342  472.97
  39   0.0317     98.970  0.0191    99.370  485.32
  40   0.0336     98.980  0.0193    99.338  497.64
  41   0.0354     98.960  0.0182    99.412  510.01
  42   0.0421     98.500  0.0178    99.403  522.41
  43   0.0339     98.980  0.0179    99.380  534.90
  44   0.0430     98.570  0.0180    99.385  547.28
  45   0.0325     98.980  0.0179    99.400  559.65
  46   0.0342     98.960  0.0162    99.490  572.00
  47   0.0318     98.990  0.0175    99.415  584.46
  48   0.0324     98.930  0.0168    99.430  596.82
  49   0.0349     98.830  0.0164    99.478  609.17
  50   0.0393     98.730  0.0166    99.438  621.70
  51   0.0311     99.000  0.0154    99.487  634.07
  52   0.0378     98.880  0.0150    99.452  646.41
  53   0.0264     99.200  0.0159    99.475  658.78
  54   0.0456     98.530  0.0153    99.477  671.12
  55   0.0332     99.030  0.0142    99.510  683.48
  56   0.0441     98.640  0.0141    99.512  695.85
  57   0.0342     98.940  0.0139    99.520  708.25
  58   0.0376     98.820  0.0146    99.472  720.61
  59   0.0300     99.050  0.0129    99.572  732.98
  60   0.0382     98.770  0.0124    99.560  745.47
  61   0.0466     98.570  0.0124    99.585  757.82
  62   0.0386     98.850  0.0128    99.550  770.19
  63   0.0328     98.990  0.0127    99.582  782.69
  64   0.0281     99.090  0.0125    99.550  795.05
  65   0.0332     99.020  0.0129    99.517  807.43
  66   0.0329     99.040  0.0120    99.592  819.90
  67   0.0392     98.890  0.0119    99.595  832.23
  68   0.0343     98.990  0.0117    99.628  844.57
  69   0.0366     99.020  0.0121    99.597  856.91
  70   0.0349     98.990  0.0120    99.588  869.25
  71   0.0312     99.000  0.0117    99.617  881.57
  72   0.0351     98.940  0.0113    99.607  893.95
  73   0.0396     98.810  0.0106    99.650  906.37
  74   0.0363     98.880  0.0109    99.615  918.72
  75   0.0341     98.950  0.0107    99.612  931.04
  76   0.0396     98.800  0.0102    99.673  943.49
  77   0.0316     98.990  0.0095    99.677  955.83
  78   0.0357     98.920  0.0097    99.700  968.16
  79   0.0352     98.930  0.0098    99.695  980.60
  80   0.0341     98.970  0.0088    99.710  992.96
  81   0.0323     99.040  0.0098    99.682  1005.33
  82   0.0403     98.860  0.0094    99.698  1017.66
  83   0.0336     98.960  0.0105    99.648  1030.12
  84   0.0300     99.110  0.0092    99.710  1042.47
  85   0.0334     99.030  0.0088    99.698  1054.82
  86   0.0365     98.970  0.0088    99.713  1067.29
  87   0.0406     98.820  0.0084    99.710  1079.63
  88   0.0345     99.050  0.0085    99.730  1091.99
  89   0.0417     98.780  0.0096    99.695  1104.49
  90   0.0348     99.000  0.0091    99.672  1116.84
