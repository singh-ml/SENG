Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5936     77.510  0.9328    68.822  14.60
   2   0.1957     94.130  0.1921    94.102  27.05
   3   0.1785     94.390  0.1211    96.248  39.65
   4   0.0869     97.180  0.0925    97.127  52.12
   5   0.0818     97.490  0.0771    97.623  64.56
   6   0.0607     97.880  0.0674    97.813  77.08
   7   0.0552     98.250  0.0609    98.065  89.49
   8   0.0526     98.360  0.0552    98.287  101.90
   9   0.1124     96.310  0.0512    98.378  114.41
  10   0.0505     98.370  0.0483    98.483  126.85
  11   0.0396     98.660  0.0453    98.597  139.26
  12   0.0401     98.750  0.0426    98.662  151.67
  13   0.0593     98.160  0.0409    98.727  164.10
  14   0.0365     98.710  0.0396    98.757  176.54
  15   0.0519     98.330  0.0367    98.812  188.93
  16   0.0457     98.580  0.0349    98.902  201.46
  17   0.0368     98.790  0.0345    98.850  213.89
  18   0.0455     98.440  0.0334    98.910  226.28
  19   0.0378     98.750  0.0328    98.948  238.77
  20   0.0369     98.800  0.0310    99.010  251.18
  21   0.0381     98.720  0.0306    99.003  263.61
  22   0.0413     98.600  0.0292    99.090  276.05
  23   0.0362     98.900  0.0283    99.097  288.68
  24   0.0407     98.710  0.0276    99.093  301.08
  25   0.0360     98.740  0.0264    99.173  313.51
  26   0.0336     98.820  0.0270    99.143  326.15
  27   0.0428     98.730  0.0250    99.172  338.54
  28   0.0357     98.790  0.0248    99.202  350.96
  29   0.0433     98.590  0.0239    99.238  363.36
  30   0.0360     98.760  0.0241    99.212  375.78
  31   0.0351     98.860  0.0234    99.228  388.21
  32   0.0313     99.000  0.0230    99.268  400.60
  33   0.0309     98.950  0.0219    99.288  413.00
  34   0.0371     98.670  0.0225    99.257  425.41
  35   0.0305     99.030  0.0222    99.228  437.92
  36   0.0350     98.810  0.0213    99.268  450.32
  37   0.0384     98.730  0.0202    99.313  462.76
  38   0.0439     98.590  0.0198    99.345  475.15
  39   0.0359     98.800  0.0199    99.322  487.59
  40   0.0349     98.810  0.0184    99.372  499.99
  41   0.0369     98.790  0.0189    99.373  512.41
  42   0.0366     98.770  0.0185    99.385  524.93
  43   0.0321     98.970  0.0185    99.425  537.33
  44   0.0289     99.070  0.0183    99.418  549.72
  45   0.0331     98.880  0.0170    99.458  562.25
  46   0.0307     99.090  0.0177    99.402  574.68
  47   0.0363     98.740  0.0171    99.440  587.10
  48   0.0376     98.890  0.0162    99.450  599.64
  49   0.0351     98.960  0.0162    99.477  612.02
  50   0.0359     98.910  0.0161    99.477  624.44
  51   0.0356     98.890  0.0162    99.457  636.85
  52   0.0377     98.900  0.0163    99.465  649.27
  53   0.0416     98.610  0.0151    99.477  661.69
  54   0.0307     99.060  0.0143    99.525  674.11
  55   0.0329     98.930  0.0146    99.523  686.64
  56   0.0334     98.930  0.0147    99.510  699.02
  57   0.0384     98.820  0.0148    99.545  711.43
  58   0.0317     98.920  0.0136    99.553  723.98
  59   0.0383     98.880  0.0131    99.578  736.40
  60   0.0325     98.920  0.0130    99.600  748.80
  61   0.0341     98.820  0.0141    99.555  761.22
  62   0.0355     98.790  0.0137    99.550  773.80
  63   0.0365     98.880  0.0130    99.563  786.20
  64   0.0302     99.090  0.0129    99.568  798.61
  65   0.0331     98.880  0.0139    99.542  811.14
  66   0.0366     98.700  0.0124    99.600  823.55
  67   0.0384     98.880  0.0127    99.558  835.97
  68   0.0306     98.990  0.0115    99.610  848.36
  69   0.0333     99.020  0.0126    99.580  860.90
  70   0.0312     99.060  0.0119    99.655  873.28
  71   0.0395     98.770  0.0115    99.592  885.69
  72   0.0248     99.190  0.0116    99.605  898.12
  73   0.0317     99.000  0.0109    99.622  910.63
  74   0.0259     99.130  0.0111    99.627  923.04
  75   0.0370     98.900  0.0120    99.585  935.44
  76   0.0262     99.090  0.0103    99.637  947.95
  77   0.0345     98.900  0.0093    99.698  960.37
  78   0.0272     99.090  0.0098    99.690  972.78
  79   0.0338     98.890  0.0100    99.672  985.20
  80   0.0279     99.100  0.0092    99.692  997.62
  81   0.0245     99.130  0.0091    99.717  1010.03
  82   0.0291     99.030  0.0100    99.660  1022.45
  83   0.0375     98.860  0.0110    99.600  1034.86
  84   0.0322     98.930  0.0100    99.680  1047.28
  85   0.0302     99.090  0.0091    99.698  1059.68
  86   0.0270     99.120  0.0097    99.672  1072.21
  87   0.0295     99.090  0.0096    99.665  1084.57
  88   0.0312     98.920  0.0087    99.692  1097.00
  89   0.0264     99.170  0.0092    99.735  1109.52
  90   0.0319     99.040  0.0093    99.695  1121.94
