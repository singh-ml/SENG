Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2253     92.680  0.6605    77.600  14.51
   2   0.0912     97.030  0.1328    95.800  27.07
   3   0.0825     97.180  0.0851    97.305  39.39
   4   0.0710     97.720  0.0699    97.783  51.72
   5   0.1146     96.450  0.0583    98.197  64.06
   6   0.0549     98.230  0.0531    98.315  76.37
   7   0.0474     98.480  0.0478    98.455  88.68
   8   0.0456     98.390  0.0454    98.588  101.08
   9   0.0372     98.780  0.0407    98.672  113.39
  10   0.0527     98.330  0.0388    98.770  125.69
  11   0.0670     97.770  0.0369    98.823  138.16
  12   0.0479     98.380  0.0354    98.822  150.46
  13   0.0354     98.820  0.0347    98.857  162.77
  14   0.0359     98.820  0.0323    98.975  175.16
  15   0.0339     98.840  0.0321    98.972  187.50
  16   0.0403     98.680  0.0292    99.045  199.80
  17   0.0435     98.520  0.0284    99.097  212.10
  18   0.0321     98.880  0.0289    99.073  224.44
  19   0.0403     98.730  0.0272    99.130  236.76
  20   0.0404     98.570  0.0266    99.107  249.07
  21   0.0365     98.840  0.0248    99.205  261.50
  22   0.0399     98.610  0.0246    99.177  273.81
  23   0.0280     99.070  0.0248    99.218  286.13
  24   0.0459     98.490  0.0239    99.222  298.55
  25   0.0327     98.910  0.0228    99.263  310.85
  26   0.0304     98.970  0.0222    99.265  323.13
  27   0.0314     98.950  0.0233    99.252  335.53
  28   0.0299     99.060  0.0207    99.345  347.80
  29   0.0291     98.900  0.0200    99.377  360.13
  30   0.0345     98.940  0.0198    99.303  372.44
  31   0.0381     98.790  0.0196    99.372  384.74
  32   0.0392     98.750  0.0190    99.368  397.06
  33   0.0301     98.960  0.0181    99.385  409.34
  34   0.0248     99.180  0.0184    99.410  421.65
  35   0.0461     98.680  0.0192    99.365  434.16
  36   0.0353     98.970  0.0176    99.442  446.47
  37   0.0352     98.820  0.0190    99.345  458.75
  38   0.0365     98.850  0.0164    99.468  471.20
  39   0.0324     98.940  0.0165    99.447  483.48
  40   0.0286     99.140  0.0162    99.458  495.80
  41   0.0410     98.660  0.0157    99.465  508.09
  42   0.0283     99.130  0.0144    99.520  520.40
  43   0.0317     98.940  0.0155    99.485  532.71
  44   0.0393     98.720  0.0148    99.492  545.06
  45   0.0355     98.850  0.0148    99.512  557.54
  46   0.0365     98.940  0.0157    99.473  569.85
  47   0.0396     98.870  0.0141    99.528  582.14
  48   0.0309     98.970  0.0148    99.482  594.44
  49   0.0331     98.930  0.0144    99.530  606.83
  50   0.0310     99.060  0.0128    99.550  619.14
  51   0.0346     98.800  0.0133    99.567  631.42
  52   0.0389     98.670  0.0123    99.582  643.86
  53   0.0320     99.000  0.0122    99.582  656.17
  54   0.0331     99.000  0.0123    99.585  668.47
  55   0.0329     98.960  0.0120    99.610  680.78
  56   0.0453     98.660  0.0116    99.640  693.07
  57   0.0448     98.530  0.0123    99.590  705.38
  58   0.0326     99.050  0.0116    99.613  717.68
  59   0.0401     98.770  0.0111    99.652  730.15
  60   0.0338     99.010  0.0107    99.638  742.44
  61   0.0340     98.930  0.0111    99.615  754.74
  62   0.0386     98.880  0.0112    99.623  767.18
  63   0.0303     99.030  0.0112    99.635  779.49
  64   0.0318     99.050  0.0102    99.670  791.81
  65   0.0340     99.040  0.0103    99.623  804.20
  66   0.0365     98.890  0.0097    99.688  816.49
  67   0.0393     98.900  0.0089    99.687  828.80
  68   0.0310     99.050  0.0089    99.700  841.21
  69   0.0392     98.920  0.0100    99.657  853.52
  70   0.0321     98.970  0.0087    99.710  865.84
  71   0.0498     98.530  0.0090    99.675  878.16
  72   0.0406     98.890  0.0085    99.700  890.47
  73   0.0395     98.820  0.0095    99.677  902.79
  74   0.0312     99.060  0.0092    99.697  915.10
  75   0.0357     98.970  0.0093    99.675  927.53
  76   0.0402     98.880  0.0086    99.702  939.86
  77   0.0381     98.910  0.0088    99.687  952.15
  78   0.0402     98.870  0.0082    99.718  964.57
  79   0.0416     98.770  0.0075    99.745  976.89
  80   0.0365     98.850  0.0088    99.680  989.17
  81   0.0348     99.000  0.0078    99.733  1001.52
  82   0.0401     98.740  0.0079    99.725  1013.83
  83   0.0420     98.770  0.0070    99.763  1026.14
  84   0.0460     98.710  0.0080    99.722  1038.45
  85   0.0414     98.820  0.0083    99.698  1050.88
  86   0.0343     98.950  0.0075    99.742  1063.19
  87   0.0349     98.950  0.0068    99.743  1075.48
  88   0.0315     99.060  0.0070    99.757  1087.93
  89   0.0487     98.600  0.0080    99.713  1100.23
  90   0.0455     98.670  0.0080    99.737  1112.55
