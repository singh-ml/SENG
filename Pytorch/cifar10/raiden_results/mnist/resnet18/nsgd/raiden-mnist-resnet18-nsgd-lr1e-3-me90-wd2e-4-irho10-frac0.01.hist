Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4516     85.960  0.6583    77.448  14.41
   2   0.1097     96.320  0.1261    96.130  26.63
   3   0.0705     97.750  0.0838    97.323  38.86
   4   0.0847     97.100  0.0686    97.842  51.10
   5   0.0863     97.170  0.0577    98.215  63.43
   6   0.0778     97.400  0.0520    98.345  75.65
   7   0.0506     98.380  0.0481    98.445  87.87
   8   0.0713     97.760  0.0443    98.588  100.22
   9   0.0429     98.570  0.0412    98.712  112.45
  10   0.0471     98.380  0.0380    98.790  124.69
  11   0.0435     98.670  0.0357    98.833  136.92
  12   0.0432     98.530  0.0357    98.853  149.13
  13   0.0438     98.530  0.0337    98.933  161.34
  14   0.0442     98.520  0.0323    98.952  173.57
  15   0.0503     98.380  0.0303    98.990  185.95
  16   0.0404     98.770  0.0306    99.043  198.20
  17   0.0416     98.610  0.0287    99.058  210.43
  18   0.0430     98.480  0.0270    99.102  222.79
  19   0.0324     98.910  0.0262    99.168  235.03
  20   0.0310     98.880  0.0259    99.168  247.25
  21   0.0377     98.810  0.0261    99.147  259.48
  22   0.0331     98.950  0.0245    99.208  271.91
  23   0.0329     98.930  0.0232    99.262  284.14
  24   0.0542     98.200  0.0229    99.250  296.40
  25   0.0464     98.580  0.0226    99.263  308.66
  26   0.0343     99.050  0.0228    99.255  320.86
  27   0.0383     98.730  0.0201    99.312  333.05
  28   0.0397     98.700  0.0214    99.272  345.32
  29   0.0352     98.940  0.0198    99.350  357.59
  30   0.0358     98.940  0.0198    99.363  369.81
  31   0.0373     98.920  0.0194    99.382  382.17
  32   0.0402     98.800  0.0197    99.365  394.39
  33   0.0395     98.760  0.0175    99.427  406.62
  34   0.0484     98.440  0.0185    99.400  418.86
  35   0.0317     99.020  0.0179    99.402  431.21
  36   0.0334     98.900  0.0170    99.432  443.43
  37   0.0359     98.880  0.0160    99.453  455.66
  38   0.0336     99.010  0.0166    99.468  467.89
  39   0.0326     99.010  0.0168    99.433  480.12
  40   0.0314     99.090  0.0153    99.497  492.35
  41   0.0350     98.970  0.0152    99.503  504.57
  42   0.0360     98.870  0.0140    99.520  516.83
  43   0.0296     99.050  0.0146    99.512  529.08
  44   0.0387     98.830  0.0156    99.463  541.41
  45   0.0286     99.110  0.0149    99.502  553.64
  46   0.0369     98.990  0.0132    99.562  565.85
  47   0.0295     99.170  0.0135    99.575  578.07
  48   0.0337     99.010  0.0142    99.508  590.45
  49   0.0327     98.990  0.0135    99.530  602.68
  50   0.0380     98.880  0.0129    99.560  614.89
  51   0.0401     98.880  0.0130    99.553  627.17
  52   0.0338     98.950  0.0121    99.590  639.39
  53   0.0311     99.070  0.0122    99.603  651.63
  54   0.0353     98.970  0.0122    99.565  664.00
  55   0.0279     99.120  0.0123    99.565  676.23
  56   0.0324     99.100  0.0123    99.568  688.47
  57   0.0344     98.970  0.0118    99.578  700.69
  58   0.0305     99.030  0.0106    99.620  712.93
  59   0.0329     98.990  0.0104    99.648  725.18
  60   0.0373     98.860  0.0104    99.653  737.41
  61   0.0288     99.170  0.0117    99.597  749.78
  62   0.0375     98.860  0.0102    99.682  761.98
  63   0.0338     98.980  0.0110    99.602  774.21
  64   0.0398     98.800  0.0094    99.698  786.57
  65   0.0408     98.830  0.0102    99.658  798.79
  66   0.0433     98.650  0.0098    99.660  811.02
  67   0.0338     99.070  0.0099    99.683  823.27
  68   0.0314     99.000  0.0096    99.687  835.54
  69   0.0339     98.960  0.0090    99.710  847.77
  70   0.0392     98.940  0.0086    99.728  860.00
  71   0.0380     98.990  0.0081    99.730  872.42
  72   0.0341     99.040  0.0084    99.715  884.70
  73   0.0288     99.140  0.0091    99.673  896.92
  74   0.0382     98.940  0.0092    99.667  909.29
  75   0.0422     98.860  0.0091    99.698  921.56
  76   0.0365     99.010  0.0091    99.708  933.75
  77   0.0345     99.010  0.0084    99.708  946.14
  78   0.0335     99.020  0.0075    99.755  958.37
  79   0.0331     99.040  0.0082    99.718  970.59
  80   0.0373     98.880  0.0083    99.692  982.83
  81   0.0364     98.990  0.0078    99.727  995.18
  82   0.0352     99.010  0.0086    99.695  1007.44
  83   0.0410     98.980  0.0080    99.727  1019.69
  84   0.0419     98.930  0.0078    99.737  1032.05
  85   0.0352     98.920  0.0066    99.777  1044.29
  86   0.0364     99.040  0.0075    99.750  1056.53
  87   0.0339     99.100  0.0066    99.782  1068.75
  88   0.0415     98.920  0.0068    99.757  1081.01
  89   0.0373     98.920  0.0067    99.767  1093.23
  90   0.0420     98.900  0.0071    99.742  1105.45
