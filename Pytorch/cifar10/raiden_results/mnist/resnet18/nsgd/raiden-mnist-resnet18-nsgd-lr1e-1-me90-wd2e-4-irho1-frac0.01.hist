Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4353     85.890  1.4473    53.870  14.57
   2   0.1369     95.200  0.1701    94.760  26.96
   3   0.1009     96.380  0.0908    97.113  39.41
   4   0.0746     97.360  0.0767    97.590  51.71
   5   0.1341     95.910  0.0603    98.113  64.06
   6   0.0623     97.980  0.0567    98.245  76.42
   7   0.0609     97.980  0.0485    98.438  88.76
   8   0.0850     97.100  0.0486    98.487  101.07
   9   0.0540     98.130  0.0470    98.503  113.34
  10   0.0508     98.340  0.0427    98.583  125.65
  11   0.1256     95.690  0.0404    98.708  137.97
  12   0.0851     97.410  0.0391    98.770  150.26
  13   0.0395     98.510  0.0381    98.760  162.64
  14   0.0501     98.440  0.0366    98.860  174.94
  15   0.0834     97.200  0.0352    98.895  187.22
  16   0.0635     97.860  0.0352    98.887  199.64
  17   0.0871     97.170  0.0357    98.923  211.94
  18   0.0370     98.860  0.0337    98.947  224.21
  19   0.0360     98.740  0.0316    98.988  236.52
  20   0.0619     98.010  0.0331    98.913  248.82
  21   0.0580     98.110  0.0327    98.895  261.13
  22   0.0365     98.780  0.0295    99.077  273.44
  23   0.0366     98.760  0.0310    99.042  285.89
  24   0.0295     99.060  0.0302    99.040  298.19
  25   0.0587     98.000  0.0295    99.093  310.50
  26   0.0326     98.940  0.0300    99.022  322.94
  27   0.0271     99.160  0.0276    99.107  335.25
  28   0.0335     98.910  0.0268    99.142  347.55
  29   0.0292     99.070  0.0281    99.118  359.83
  30   0.0286     99.220  0.0285    99.060  372.20
  31   0.0345     98.990  0.0270    99.127  384.49
  32   0.0333     98.960  0.0259    99.155  396.78
  33   0.0265     99.190  0.0241    99.255  409.16
  34   0.0438     98.540  0.0251    99.185  421.44
  35   0.0346     98.830  0.0232    99.267  433.74
  36   0.0300     99.060  0.0244    99.183  446.16
  37   0.0265     99.110  0.0252    99.190  458.44
  38   0.0330     98.980  0.0222    99.305  470.74
  39   0.0314     98.990  0.0224    99.273  483.22
  40   0.0252     99.230  0.0230    99.222  495.50
  41   0.0358     98.780  0.0199    99.353  507.80
  42   0.0257     99.150  0.0196    99.417  520.08
  43   0.0324     98.920  0.0194    99.357  532.53
  44   0.0293     99.060  0.0204    99.333  544.84
  45   0.0312     99.050  0.0192    99.372  557.12
  46   0.0311     98.950  0.0198    99.360  569.58
  47   0.0276     99.070  0.0173    99.465  581.86
  48   0.0324     98.930  0.0198    99.357  594.19
  49   0.0266     99.100  0.0173    99.460  606.58
  50   0.0304     98.960  0.0165    99.460  618.89
  51   0.0287     99.020  0.0161    99.462  631.19
  52   0.0323     99.000  0.0148    99.505  643.50
  53   0.0321     99.040  0.0134    99.560  655.83
  54   0.0395     98.750  0.0128    99.570  668.12
  55   0.0215     99.180  0.0139    99.565  680.43
  56   0.0219     99.300  0.0128    99.608  692.86
  57   0.0403     98.760  0.0118    99.622  705.15
  58   0.0340     98.880  0.0120    99.618  717.44
  59   0.0282     99.140  0.0110    99.630  729.87
  60   0.0317     99.130  0.0106    99.640  742.16
  61   0.0229     99.280  0.0096    99.690  754.45
  62   0.0249     99.240  0.0091    99.705  766.76
  63   0.0214     99.280  0.0086    99.717  779.06
  64   0.0284     99.150  0.0084    99.738  791.35
  65   0.0314     99.090  0.0079    99.753  803.74
  66   0.0241     99.300  0.0073    99.760  816.06
  67   0.0227     99.340  0.0064    99.795  828.36
  68   0.0256     99.240  0.0058    99.820  840.63
  69   0.0235     99.320  0.0053    99.842  852.91
  70   0.0239     99.290  0.0049    99.845  865.21
  71   0.0231     99.290  0.0051    99.838  877.53
  72   0.0291     99.130  0.0040    99.892  890.01
  73   0.0243     99.250  0.0035    99.913  902.33
  74   0.0251     99.290  0.0036    99.907  914.62
  75   0.0252     99.310  0.0031    99.918  927.06
  76   0.0279     99.200  0.0034    99.922  939.31
  77   0.0271     99.240  0.0024    99.945  951.60
  78   0.0311     99.130  0.0025    99.923  963.88
  79   0.0253     99.310  0.0020    99.958  976.32
  80   0.0275     99.270  0.0019    99.967  988.62
  81   0.0287     99.220  0.0020    99.945  1000.95
  82   0.0325     99.150  0.0020    99.950  1013.34
  83   0.0275     99.160  0.0018    99.952  1025.64
  84   0.0292     99.170  0.0016    99.967  1037.95
  85   0.0267     99.200  0.0016    99.968  1050.36
  86   0.0297     99.170  0.0014    99.977  1062.67
  87   0.0298     99.160  0.0014    99.982  1074.95
  88   0.0293     99.140  0.0014    99.975  1087.24
  89   0.0285     99.200  0.0016    99.973  1099.65
  90   0.0286     99.200  0.0014    99.972  1111.97
