Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5591     83.400  1.4153    53.953  14.70
   2   0.2728     91.380  0.3975    88.013  27.25
   3   0.1738     94.400  0.2331    93.017  39.73
   4   0.1580     95.100  0.1709    94.818  52.15
   5   0.1074     96.520  0.1390    95.715  64.60
   6   0.1231     96.070  0.1165    96.373  77.27
   7   0.0882     97.220  0.1019    96.857  89.70
   8   0.0844     97.400  0.0896    97.287  102.29
   9   0.0706     97.750  0.0818    97.520  114.76
  10   0.0776     97.590  0.0746    97.747  127.20
  11   0.0671     97.920  0.0681    97.895  139.67
  12   0.0635     98.040  0.0636    98.038  152.13
  13   0.0797     97.330  0.0616    98.098  164.56
  14   0.0536     98.170  0.0566    98.258  177.01
  15   0.0532     98.310  0.0545    98.285  189.54
  16   0.0530     98.280  0.0507    98.440  201.98
  17   0.0564     98.030  0.0498    98.422  214.44
  18   0.0500     98.300  0.0468    98.547  226.99
  19   0.0525     98.330  0.0446    98.607  239.42
  20   0.0489     98.410  0.0437    98.615  251.87
  21   0.0489     98.460  0.0425    98.645  264.29
  22   0.0431     98.540  0.0408    98.737  276.76
  23   0.0436     98.530  0.0389    98.813  289.23
  24   0.0407     98.660  0.0389    98.745  301.70
  25   0.0366     98.740  0.0380    98.790  314.14
  26   0.0442     98.620  0.0365    98.858  326.58
  27   0.0406     98.680  0.0346    98.880  339.01
  28   0.0419     98.540  0.0344    98.888  351.58
  29   0.0386     98.700  0.0332    98.968  364.02
  30   0.0372     98.750  0.0328    98.960  376.43
  31   0.0415     98.760  0.0328    98.952  389.03
  32   0.0387     98.680  0.0311    99.025  401.48
  33   0.0392     98.660  0.0301    99.052  413.90
  34   0.0364     98.740  0.0300    99.042  426.50
  35   0.0379     98.790  0.0302    99.025  438.94
  36   0.0419     98.560  0.0283    99.108  451.39
  37   0.0390     98.810  0.0288    99.088  464.03
  38   0.0424     98.490  0.0285    99.108  476.47
  39   0.0403     98.640  0.0277    99.117  488.91
  40   0.0375     98.760  0.0275    99.152  501.47
  41   0.0390     98.740  0.0258    99.152  513.93
  42   0.0395     98.700  0.0264    99.112  526.36
  43   0.0373     98.760  0.0239    99.245  538.93
  44   0.0340     98.890  0.0256    99.178  551.39
  45   0.0449     98.530  0.0245    99.193  563.83
  46   0.0367     98.760  0.0241    99.245  576.40
  47   0.0365     98.780  0.0244    99.208  588.84
  48   0.0392     98.650  0.0229    99.273  601.31
  49   0.0412     98.680  0.0226    99.312  613.75
  50   0.0396     98.670  0.0230    99.245  626.41
  51   0.0337     98.880  0.0230    99.297  638.85
  52   0.0375     98.740  0.0224    99.287  651.32
  53   0.0313     98.970  0.0216    99.293  663.89
  54   0.0382     98.640  0.0218    99.313  676.35
  55   0.0348     98.850  0.0211    99.315  688.80
  56   0.0333     98.910  0.0204    99.345  701.35
  57   0.0346     98.790  0.0190    99.372  713.78
  58   0.0435     98.530  0.0203    99.312  726.24
  59   0.0309     99.000  0.0204    99.307  738.82
  60   0.0320     98.870  0.0188    99.370  751.25
  61   0.0271     99.070  0.0197    99.345  763.68
  62   0.0368     98.730  0.0189    99.373  776.24
  63   0.0330     98.850  0.0188    99.387  788.69
  64   0.0332     98.810  0.0186    99.372  801.12
  65   0.0328     98.860  0.0184    99.373  813.58
  66   0.0326     98.890  0.0171    99.427  826.00
  67   0.0284     99.060  0.0175    99.463  838.43
  68   0.0299     99.060  0.0177    99.412  850.85
  69   0.0321     98.910  0.0166    99.462  863.37
  70   0.0357     98.710  0.0168    99.452  875.81
  71   0.0310     98.900  0.0168    99.435  888.25
  72   0.0335     98.960  0.0167    99.467  900.79
  73   0.0307     98.990  0.0167    99.457  913.22
  74   0.0292     99.030  0.0161    99.487  925.65
  75   0.0339     98.660  0.0159    99.450  938.21
  76   0.0299     99.060  0.0164    99.467  950.67
  77   0.0340     98.870  0.0146    99.552  963.13
  78   0.0337     98.890  0.0165    99.443  975.69
  79   0.0303     98.910  0.0148    99.498  988.15
  80   0.0313     98.920  0.0157    99.485  1000.58
  81   0.0412     98.630  0.0142    99.550  1013.04
  82   0.0336     98.860  0.0144    99.562  1025.47
  83   0.0361     98.750  0.0147    99.508  1037.99
  84   0.0321     98.840  0.0132    99.585  1050.43
  85   0.0276     99.050  0.0144    99.517  1062.96
