Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2670     91.550  0.9241    69.242  14.83
   2   0.1666     94.760  0.1942    93.997  27.22
   3   0.0984     96.850  0.1239    96.213  39.56
   4   0.1112     96.540  0.0944    97.060  52.12
   5   0.0809     97.520  0.0774    97.603  64.54
   6   0.0740     97.700  0.0670    97.913  76.92
   7   0.0634     97.980  0.0605    98.102  89.28
   8   0.0466     98.460  0.0562    98.198  101.64
   9   0.0595     98.060  0.0520    98.325  114.02
  10   0.0700     97.750  0.0469    98.498  126.37
  11   0.0396     98.700  0.0459    98.517  138.71
  12   0.0639     98.010  0.0423    98.623  151.07
  13   0.0449     98.550  0.0425    98.655  163.46
  14   0.0478     98.400  0.0382    98.777  175.85
  15   0.0453     98.540  0.0365    98.833  188.35
  16   0.0476     98.430  0.0359    98.872  200.68
  17   0.0441     98.520  0.0338    98.927  213.08
  18   0.0420     98.480  0.0327    98.938  225.44
  19   0.0403     98.660  0.0321    99.003  237.81
  20   0.0371     98.790  0.0309    99.043  250.19
  21   0.0379     98.690  0.0294    99.057  262.57
  22   0.0405     98.630  0.0293    99.028  274.99
  23   0.0397     98.700  0.0280    99.080  287.41
  24   0.0412     98.690  0.0269    99.147  299.81
  25   0.0432     98.540  0.0267    99.143  312.21
  26   0.0377     98.830  0.0250    99.192  324.55
  27   0.0342     98.930  0.0251    99.138  336.92
  28   0.0345     98.860  0.0235    99.237  349.29
  29   0.0382     98.730  0.0237    99.237  361.67
  30   0.0444     98.570  0.0227    99.228  374.04
  31   0.0324     98.850  0.0232    99.293  386.42
  32   0.0438     98.550  0.0217    99.267  398.92
  33   0.0351     98.960  0.0214    99.310  411.29
  34   0.0361     98.860  0.0215    99.293  423.67
  35   0.0382     98.760  0.0203    99.323  436.04
  36   0.0299     99.040  0.0199    99.327  448.48
  37   0.0347     98.900  0.0189    99.365  460.88
  38   0.0302     99.050  0.0189    99.345  473.26
  39   0.0291     99.100  0.0186    99.352  485.81
  40   0.0293     98.950  0.0179    99.425  498.20
  41   0.0360     98.830  0.0181    99.438  510.56
  42   0.0374     98.800  0.0167    99.457  523.01
  43   0.0343     98.880  0.0171    99.465  535.37
  44   0.0337     98.950  0.0167    99.450  547.72
  45   0.0320     98.970  0.0160    99.457  560.23
  46   0.0335     98.830  0.0157    99.503  572.60
  47   0.0301     99.030  0.0155    99.467  584.97
  48   0.0329     98.860  0.0150    99.505  597.35
  49   0.0285     99.050  0.0153    99.490  609.84
  50   0.0280     99.120  0.0142    99.550  622.20
  51   0.0327     98.970  0.0140    99.543  634.52
  52   0.0331     98.980  0.0144    99.560  647.07
  53   0.0317     99.010  0.0132    99.572  659.45
  54   0.0314     98.960  0.0135    99.568  671.79
  55   0.0285     99.060  0.0133    99.590  684.35
  56   0.0298     99.020  0.0126    99.587  696.71
  57   0.0335     98.970  0.0123    99.587  709.10
  58   0.0272     99.100  0.0127    99.578  721.47
  59   0.0311     98.910  0.0126    99.607  733.86
  60   0.0316     98.940  0.0121    99.603  746.25
  61   0.0259     99.010  0.0122    99.612  758.62
  62   0.0287     99.060  0.0115    99.638  770.98
  63   0.0284     99.040  0.0109    99.665  783.36
  64   0.0287     99.040  0.0112    99.657  795.71
  65   0.0303     99.000  0.0106    99.675  808.19
  66   0.0283     99.060  0.0107    99.657  820.56
  67   0.0284     99.050  0.0105    99.670  832.90
  68   0.0282     99.030  0.0104    99.667  845.35
  69   0.0289     99.020  0.0101    99.663  857.71
  70   0.0310     98.950  0.0099    99.698  870.08
  71   0.0312     98.960  0.0103    99.647  882.57
  72   0.0296     99.010  0.0090    99.717  894.92
  73   0.0299     98.940  0.0096    99.717  907.30
  74   0.0271     99.050  0.0092    99.723  919.66
  75   0.0310     98.960  0.0096    99.685  932.16
  76   0.0312     98.930  0.0088    99.722  944.50
  77   0.0295     98.940  0.0087    99.735  956.86
  78   0.0314     98.850  0.0088    99.743  969.34
  79   0.0305     98.900  0.0090    99.727  981.70
  80   0.0270     99.060  0.0085    99.755  994.09
  81   0.0306     98.920  0.0083    99.738  1006.62
  82   0.0292     98.920  0.0088    99.735  1019.01
  83   0.0270     99.070  0.0086    99.742  1031.36
  84   0.0283     99.040  0.0089    99.723  1043.83
  85   0.0311     98.980  0.0083    99.755  1056.22
  86   0.0309     98.950  0.0081    99.763  1068.59
  87   0.0307     98.950  0.0080    99.777  1080.95
  88   0.0275     99.050  0.0079    99.768  1093.39
  89   0.0305     98.950  0.0077    99.763  1105.74
  90   0.0277     99.130  0.0081    99.718  1118.10
