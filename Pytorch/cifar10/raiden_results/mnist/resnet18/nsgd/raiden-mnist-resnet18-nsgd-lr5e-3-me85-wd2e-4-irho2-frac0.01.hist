Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3201     89.690  0.6536    77.818  14.76
   2   0.1874     93.630  0.1291    95.998  27.39
   3   0.1395     95.490  0.0857    97.393  39.98
   4   0.0705     97.510  0.0693    97.828  52.56
   5   0.0499     98.270  0.0604    98.093  65.13
   6   0.1068     96.380  0.0512    98.308  77.69
   7   0.0574     98.150  0.0476    98.498  90.28
   8   0.0506     98.360  0.0448    98.615  102.87
   9   0.0535     98.340  0.0403    98.753  115.53
  10   0.0439     98.400  0.0390    98.752  128.11
  11   0.0615     98.150  0.0346    98.927  140.70
  12   0.0335     98.750  0.0355    98.827  153.40
  13   0.0526     98.260  0.0337    98.918  166.01
  14   0.0414     98.530  0.0322    98.970  178.59
  15   0.0509     98.350  0.0314    98.983  191.26
  16   0.0475     98.470  0.0287    99.048  203.87
  17   0.0335     98.850  0.0269    99.130  216.44
  18   0.0419     98.690  0.0279    99.090  229.02
  19   0.0435     98.540  0.0264    99.163  241.57
  20   0.0315     98.960  0.0252    99.163  254.18
  21   0.0440     98.550  0.0238    99.207  266.72
  22   0.0333     98.780  0.0238    99.208  279.31
  23   0.0358     98.780  0.0228    99.242  291.88
  24   0.0320     98.900  0.0233    99.257  304.43
  25   0.0461     98.520  0.0220    99.288  317.16
  26   0.0291     99.050  0.0208    99.318  329.72
  27   0.0274     98.990  0.0219    99.253  342.31
  28   0.0305     99.020  0.0195    99.382  355.06
  29   0.0292     99.100  0.0186    99.382  367.62
  30   0.0277     99.030  0.0190    99.367  380.24
  31   0.0300     98.980  0.0187    99.398  392.94
  32   0.0413     98.580  0.0184    99.410  405.53
  33   0.0245     99.180  0.0180    99.395  418.12
  34   0.0336     98.810  0.0165    99.413  430.71
  35   0.0381     98.650  0.0161    99.478  443.32
  36   0.0264     99.200  0.0162    99.495  455.91
  37   0.0308     98.960  0.0152    99.518  468.59
  38   0.0349     98.800  0.0150    99.495  481.19
  39   0.0275     99.150  0.0153    99.495  493.74
  40   0.0325     98.790  0.0145    99.500  506.47
  41   0.0335     98.920  0.0136    99.560  519.05
  42   0.0245     99.190  0.0126    99.590  531.67
  43   0.0256     99.120  0.0125    99.598  544.35
  44   0.0269     99.140  0.0118    99.622  556.93
  45   0.0240     99.020  0.0128    99.583  569.51
  46   0.0277     99.120  0.0112    99.630  582.04
  47   0.0322     98.860  0.0119    99.610  594.62
  48   0.0241     99.180  0.0111    99.618  607.20
  49   0.0284     99.120  0.0113    99.623  619.79
  50   0.0358     98.790  0.0103    99.670  632.37
  51   0.0304     98.930  0.0110    99.647  644.93
  52   0.0287     98.990  0.0104    99.670  657.51
  53   0.0300     98.980  0.0096    99.697  670.24
  54   0.0250     99.090  0.0098    99.705  682.84
  55   0.0329     98.910  0.0097    99.683  695.42
  56   0.0330     98.860  0.0089    99.698  708.10
  57   0.0271     99.100  0.0084    99.745  720.71
  58   0.0295     99.040  0.0089    99.712  733.29
  59   0.0321     99.030  0.0087    99.713  746.01
  60   0.0245     99.150  0.0083    99.747  758.61
  61   0.0308     99.010  0.0079    99.747  771.20
  62   0.0254     99.130  0.0082    99.763  783.90
  63   0.0259     99.170  0.0075    99.762  796.48
  64   0.0297     98.910  0.0079    99.763  809.07
  65   0.0289     99.010  0.0082    99.752  821.79
  66   0.0318     99.050  0.0072    99.787  834.38
  67   0.0241     99.220  0.0072    99.785  846.98
  68   0.0276     99.100  0.0066    99.802  859.58
  69   0.0275     99.110  0.0066    99.807  872.17
  70   0.0265     99.110  0.0062    99.800  884.76
  71   0.0296     99.030  0.0063    99.797  897.34
  72   0.0284     99.040  0.0066    99.798  909.91
  73   0.0319     98.980  0.0059    99.812  922.49
  74   0.0303     99.000  0.0061    99.825  935.11
  75   0.0282     99.060  0.0062    99.800  947.90
  76   0.0294     98.990  0.0062    99.812  960.48
  77   0.0261     99.130  0.0061    99.800  973.06
  78   0.0293     98.980  0.0058    99.825  985.75
  79   0.0290     98.980  0.0057    99.810  998.38
  80   0.0292     99.020  0.0057    99.810  1011.02
  81   0.0323     98.960  0.0055    99.825  1023.76
  82   0.0290     99.060  0.0053    99.827  1036.38
  83   0.0286     98.980  0.0054    99.842  1049.00
  84   0.0291     99.010  0.0055    99.830  1061.67
  85   0.0313     98.970  0.0056    99.820  1074.26
