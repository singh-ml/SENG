Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.4654     49.330  2.4256    23.548  15.00
   2   0.8774     74.180  0.7423    73.413  27.56
   3   0.2001     93.260  0.2294    92.793  40.11
   4   0.1926     93.830  0.1375    95.758  52.74
   5   0.0972     96.930  0.1041    96.737  65.31
   6   0.1317     95.880  0.0873    97.312  77.87
   7   0.0879     97.190  0.0754    97.547  90.61
   8   0.0883     97.290  0.0664    97.955  103.19
   9   0.0500     98.480  0.0564    98.217  115.76
  10   0.0911     96.990  0.0547    98.290  128.42
  11   0.1117     96.320  0.0542    98.297  140.98
  12   0.0945     96.660  0.0493    98.445  153.54
  13   0.0418     98.640  0.0482    98.457  166.14
  14   0.0753     97.530  0.0476    98.503  178.88
  15   0.0670     97.820  0.0446    98.553  191.43
  16   0.0577     98.060  0.0421    98.675  204.00
  17   0.0513     98.420  0.0422    98.648  216.53
  18   0.0705     97.680  0.0404    98.702  229.05
  19   0.0428     98.660  0.0383    98.805  241.61
  20   0.0422     98.620  0.0376    98.757  254.26
  21   0.0440     98.430  0.0396    98.708  266.77
  22   0.0460     98.420  0.0369    98.817  279.31
  23   0.0528     98.320  0.0368    98.817  291.88
  24   0.0507     98.330  0.0350    98.872  304.42
  25   0.0418     98.790  0.0344    98.887  316.96
  26   0.0389     98.770  0.0338    98.922  329.63
  27   0.0535     98.240  0.0346    98.903  342.20
  28   0.0687     97.790  0.0312    99.020  354.78
  29   0.0433     98.620  0.0322    98.958  367.40
  30   0.0531     98.450  0.0312    98.997  379.89
  31   0.0634     98.170  0.0309    99.022  392.46
  32   0.0488     98.370  0.0301    99.040  405.11
  33   0.0469     98.590  0.0294    99.045  417.68
  34   0.0335     98.940  0.0290    99.067  430.23
  35   0.0341     98.900  0.0255    99.187  442.76
  36   0.0512     98.400  0.0283    99.105  455.31
  37   0.0318     99.040  0.0275    99.117  467.85
  38   0.0330     98.890  0.0259    99.167  480.40
  39   0.0528     98.220  0.0271    99.097  492.94
  40   0.0392     98.730  0.0242    99.242  505.48
  41   0.0318     99.060  0.0240    99.187  518.01
  42   0.0522     98.260  0.0266    99.118  530.67
  43   0.0371     98.820  0.0223    99.328  543.24
  44   0.0383     98.800  0.0209    99.352  555.83
  45   0.0336     98.900  0.0224    99.278  568.49
  46   0.0415     98.760  0.0193    99.358  581.06
  47   0.0244     99.270  0.0218    99.297  593.59
  48   0.0398     98.740  0.0194    99.358  606.14
  49   0.0274     99.180  0.0197    99.340  618.70
  50   0.0317     98.930  0.0196    99.370  631.24
  51   0.0288     99.060  0.0163    99.420  643.79
  52   0.0367     98.770  0.0172    99.448  656.36
  53   0.0344     98.930  0.0172    99.460  668.92
  54   0.0347     98.880  0.0155    99.502  681.45
  55   0.0285     99.160  0.0161    99.468  694.01
  56   0.0349     98.810  0.0143    99.530  706.55
  57   0.0300     99.040  0.0148    99.493  719.09
  58   0.0297     99.080  0.0139    99.560  731.72
  59   0.0299     99.010  0.0116    99.650  744.29
  60   0.0284     99.130  0.0112    99.645  756.85
  61   0.0300     99.000  0.0112    99.658  769.50
  62   0.0371     98.860  0.0115    99.633  782.05
  63   0.0305     99.080  0.0097    99.683  794.62
  64   0.0303     99.010  0.0095    99.708  807.21
  65   0.0341     99.020  0.0091    99.713  819.77
  66   0.0289     99.060  0.0084    99.722  832.33
  67   0.0307     99.130  0.0073    99.773  844.87
  68   0.0265     99.200  0.0076    99.775  857.52
  69   0.0310     99.040  0.0070    99.795  870.07
  70   0.0291     99.140  0.0061    99.810  882.64
  71   0.0272     99.160  0.0059    99.807  895.33
  72   0.0290     99.080  0.0056    99.830  907.86
  73   0.0330     99.030  0.0051    99.855  920.41
  74   0.0346     99.020  0.0047    99.862  932.97
  75   0.0335     99.030  0.0042    99.880  945.54
  76   0.0314     99.080  0.0034    99.902  958.08
  77   0.0332     99.120  0.0034    99.902  970.72
  78   0.0316     99.050  0.0034    99.905  983.23
  79   0.0330     99.070  0.0031    99.918  995.75
  80   0.0325     99.100  0.0029    99.925  1008.39
  81   0.0318     99.090  0.0027    99.933  1020.95
  82   0.0322     99.020  0.0024    99.938  1033.53
  83   0.0350     99.000  0.0025    99.948  1046.15
  84   0.0340     99.030  0.0025    99.932  1058.70
  85   0.0340     99.030  0.0026    99.922  1071.26
  86   0.0325     99.070  0.0020    99.953  1083.84
  87   0.0328     99.080  0.0021    99.955  1096.38
  88   0.0335     99.060  0.0021    99.948  1108.91
  89   0.0340     99.090  0.0020    99.948  1121.44
  90   0.0326     99.070  0.0020    99.963  1133.98
