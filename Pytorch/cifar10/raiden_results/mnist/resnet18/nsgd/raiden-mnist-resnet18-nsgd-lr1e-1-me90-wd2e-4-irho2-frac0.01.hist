Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.4858     50.100  2.2292    28.717  14.48
   2   0.5881     81.190  0.4349    85.495  26.99
   3   0.1980     93.630  0.1963    94.000  39.30
   4   0.1704     94.500  0.1262    96.107  51.65
   5   0.1613     94.920  0.0978    96.923  63.98
   6   0.0847     97.150  0.0839    97.340  76.47
   7   0.0873     96.960  0.0729    97.643  88.82
   8   0.0979     96.780  0.0647    97.895  101.15
   9   0.0626     97.880  0.0607    98.112  113.60
  10   0.0717     97.660  0.0566    98.213  125.94
  11   0.0918     97.000  0.0536    98.327  138.30
  12   0.0692     97.770  0.0517    98.378  150.75
  13   0.0668     97.890  0.0492    98.450  163.06
  14   0.0742     97.680  0.0478    98.555  175.44
  15   0.0649     97.770  0.0459    98.563  187.82
  16   0.0510     98.320  0.0406    98.710  200.15
  17   0.0477     98.330  0.0417    98.658  212.51
  18   0.0401     98.740  0.0394    98.768  224.86
  19   0.0978     96.760  0.0395    98.725  237.28
  20   0.0341     98.870  0.0393    98.737  249.59
  21   0.0430     98.510  0.0384    98.790  261.98
  22   0.0372     98.830  0.0375    98.852  274.33
  23   0.0395     98.720  0.0361    98.855  286.89
  24   0.0477     98.460  0.0341    98.953  299.23
  25   0.0445     98.540  0.0337    98.905  311.59
  26   0.0381     98.690  0.0340    98.938  323.94
  27   0.0438     98.590  0.0340    98.883  336.34
  28   0.0424     98.410  0.0314    99.013  348.70
  29   0.0698     97.900  0.0321    99.020  361.06
  30   0.0301     99.040  0.0315    98.988  373.42
  31   0.0252     99.090  0.0305    98.965  385.78
  32   0.0292     99.040  0.0289    99.082  398.13
  33   0.0360     98.800  0.0298    99.035  410.47
  34   0.0305     99.030  0.0267    99.107  422.81
  35   0.0320     98.960  0.0282    99.092  435.21
  36   0.0313     99.040  0.0269    99.130  447.57
  37   0.0266     99.070  0.0256    99.172  459.91
  38   0.0267     99.130  0.0265    99.158  472.22
  39   0.0497     98.330  0.0251    99.173  484.59
  40   0.0301     99.010  0.0254    99.170  496.90
  41   0.0335     98.790  0.0241    99.203  509.22
  42   0.0414     98.580  0.0235    99.225  521.67
  43   0.0331     98.880  0.0229    99.245  534.03
  44   0.0293     99.120  0.0216    99.272  546.35
  45   0.0312     98.970  0.0224    99.245  558.77
  46   0.0327     98.870  0.0206    99.340  571.10
  47   0.0293     98.990  0.0200    99.313  583.46
  48   0.0414     98.630  0.0192    99.352  595.79
  49   0.0295     99.040  0.0182    99.398  608.36
  50   0.0237     99.100  0.0185    99.395  620.72
  51   0.0261     99.050  0.0182    99.383  633.17
  52   0.0413     98.410  0.0153    99.500  645.48
  53   0.0232     99.130  0.0168    99.482  657.81
  54   0.0253     99.180  0.0155    99.473  670.15
  55   0.0336     98.960  0.0145    99.530  682.56
  56   0.0249     99.250  0.0140    99.563  694.91
  57   0.0259     99.160  0.0138    99.540  707.25
  58   0.0281     99.110  0.0128    99.582  719.60
  59   0.0199     99.320  0.0130    99.580  731.92
  60   0.0262     99.130  0.0110    99.637  744.27
  61   0.0282     98.950  0.0102    99.648  756.74
  62   0.0256     99.150  0.0101    99.673  769.08
  63   0.0282     99.090  0.0089    99.702  781.40
  64   0.0222     99.240  0.0090    99.725  793.87
  65   0.0277     99.150  0.0083    99.738  806.22
  66   0.0261     99.150  0.0076    99.760  818.57
  67   0.0367     98.960  0.0072    99.755  830.91
  68   0.0268     99.120  0.0065    99.795  843.26
  69   0.0301     99.080  0.0063    99.810  855.58
  70   0.0290     99.050  0.0060    99.797  867.93
  71   0.0246     99.230  0.0054    99.832  880.33
  72   0.0284     99.060  0.0047    99.852  892.71
  73   0.0245     99.240  0.0046    99.855  905.07
  74   0.0270     99.150  0.0037    99.883  917.53
  75   0.0283     99.060  0.0034    99.905  929.85
  76   0.0266     99.120  0.0034    99.898  942.18
  77   0.0246     99.170  0.0034    99.912  954.48
  78   0.0287     99.150  0.0032    99.902  966.81
  79   0.0261     99.240  0.0026    99.925  979.14
  80   0.0273     99.230  0.0023    99.943  991.42
  81   0.0278     99.150  0.0024    99.940  1003.74
  82   0.0274     99.210  0.0021    99.952  1016.07
  83   0.0280     99.140  0.0022    99.955  1028.45
  84   0.0259     99.250  0.0019    99.957  1040.88
  85   0.0272     99.210  0.0020    99.955  1053.20
  86   0.0287     99.150  0.0019    99.958  1065.53
  87   0.0285     99.190  0.0018    99.962  1077.96
  88   0.0274     99.210  0.0016    99.970  1090.32
  89   0.0280     99.180  0.0018    99.955  1102.66
  90   0.0286     99.200  0.0018    99.965  1114.98
