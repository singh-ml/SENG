Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   3.4648     32.490  2.3604    27.968  14.65
   2   0.2975     90.450  0.4599    85.522  27.02
   3   0.1720     94.830  0.1576    95.120  39.45
   4   0.1535     95.300  0.1117    96.627  51.86
   5   0.0624     98.030  0.0903    97.287  64.29
   6   0.0460     98.460  0.0787    97.623  76.68
   7   0.0862     97.040  0.0672    97.940  89.11
   8   0.0567     98.230  0.0600    98.092  101.64
   9   0.0558     98.210  0.0551    98.297  114.03
  10   0.0641     97.790  0.0513    98.405  126.40
  11   0.0588     98.120  0.0504    98.428  138.91
  12   0.0473     98.370  0.0456    98.590  151.27
  13   0.0619     98.140  0.0422    98.655  163.68
  14   0.0721     97.830  0.0410    98.725  176.14
  15   0.0419     98.700  0.0389    98.795  188.56
  16   0.0466     98.440  0.0399    98.717  200.98
  17   0.0402     98.690  0.0352    98.872  213.36
  18   0.0314     99.020  0.0362    98.790  225.77
  19   0.0475     98.400  0.0341    98.920  238.16
  20   0.0369     98.850  0.0336    98.947  250.55
  21   0.0364     98.710  0.0319    98.957  263.06
  22   0.0385     98.780  0.0303    99.048  275.44
  23   0.0383     98.820  0.0317    98.958  287.82
  24   0.0415     98.720  0.0292    99.048  300.32
  25   0.0275     99.170  0.0291    99.090  312.71
  26   0.0388     98.840  0.0283    99.087  325.08
  27   0.0719     97.800  0.0269    99.133  337.46
  28   0.0435     98.650  0.0256    99.175  350.06
  29   0.0447     98.550  0.0253    99.173  362.45
  30   0.0354     98.940  0.0249    99.207  374.95
  31   0.0447     98.700  0.0241    99.180  387.35
  32   0.0393     98.720  0.0237    99.240  399.74
  33   0.0403     98.800  0.0234    99.240  412.13
  34   0.0337     98.930  0.0215    99.260  424.52
  35   0.0280     99.070  0.0224    99.288  436.90
  36   0.0377     98.860  0.0209    99.300  449.30
  37   0.0341     99.020  0.0217    99.313  461.75
  38   0.0247     99.110  0.0211    99.290  474.14
  39   0.0332     98.910  0.0189    99.392  486.53
  40   0.0351     98.890  0.0185    99.402  499.03
  41   0.0236     99.220  0.0179    99.397  511.41
  42   0.0311     99.030  0.0184    99.400  523.81
  43   0.0294     99.070  0.0165    99.457  536.19
  44   0.0321     98.940  0.0167    99.408  548.77
  45   0.0289     99.130  0.0164    99.457  561.16
  46   0.0337     98.900  0.0156    99.465  573.53
  47   0.0229     99.300  0.0151    99.465  585.91
  48   0.0290     99.100  0.0149    99.512  598.29
  49   0.0316     99.000  0.0147    99.525  610.64
  50   0.0306     98.980  0.0125    99.567  623.13
  51   0.0366     98.940  0.0120    99.588  635.52
  52   0.0295     99.140  0.0131    99.550  647.90
  53   0.0328     99.020  0.0121    99.612  660.37
  54   0.0280     99.150  0.0106    99.663  672.76
  55   0.0254     99.170  0.0118    99.612  685.17
  56   0.0276     99.060  0.0105    99.623  697.54
  57   0.0272     99.110  0.0105    99.598  709.91
  58   0.0340     99.000  0.0092    99.697  722.30
  59   0.0248     99.260  0.0087    99.718  734.68
  60   0.0294     99.140  0.0086    99.720  747.16
  61   0.0301     99.120  0.0076    99.762  759.53
  62   0.0270     99.210  0.0078    99.745  771.90
  63   0.0278     99.170  0.0069    99.760  784.38
  64   0.0268     99.240  0.0071    99.755  796.77
  65   0.0268     99.070  0.0064    99.778  809.20
  66   0.0332     99.090  0.0060    99.808  821.59
  67   0.0329     99.110  0.0058    99.802  834.19
  68   0.0285     99.230  0.0051    99.843  846.55
  69   0.0285     99.220  0.0044    99.857  858.91
  70   0.0284     99.210  0.0047    99.852  871.29
  71   0.0259     99.310  0.0043    99.875  883.66
  72   0.0327     99.050  0.0039    99.872  896.06
  73   0.0271     99.190  0.0034    99.895  908.57
  74   0.0269     99.230  0.0035    99.887  920.94
  75   0.0295     99.110  0.0034    99.890  933.32
  76   0.0286     99.210  0.0030    99.915  945.83
  77   0.0318     99.130  0.0031    99.910  958.22
  78   0.0293     99.080  0.0030    99.920  970.59
  79   0.0282     99.200  0.0026    99.928  982.97
  80   0.0288     99.200  0.0026    99.925  995.33
  81   0.0302     99.180  0.0022    99.938  1007.71
  82   0.0287     99.220  0.0022    99.940  1020.21
  83   0.0287     99.170  0.0021    99.952  1032.61
  84   0.0302     99.170  0.0024    99.928  1044.97
  85   0.0291     99.190  0.0023    99.932  1057.37
  86   0.0301     99.200  0.0023    99.940  1069.96
  87   0.0305     99.160  0.0019    99.957  1082.38
  88   0.0297     99.220  0.0019    99.943  1094.77
  89   0.0298     99.170  0.0020    99.945  1107.30
  90   0.0308     99.150  0.0019    99.948  1119.66
