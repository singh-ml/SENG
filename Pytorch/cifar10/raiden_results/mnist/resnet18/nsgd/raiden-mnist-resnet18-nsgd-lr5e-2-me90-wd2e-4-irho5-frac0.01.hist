Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.1385     44.780  2.0851    34.612  14.77
   2   0.3123     89.840  0.3584    88.368  27.35
   3   0.2166     93.250  0.1671    94.732  39.86
   4   0.1170     96.000  0.1159    96.353  52.42
   5   0.0823     97.430  0.0946    97.063  64.95
   6   0.1889     93.950  0.0809    97.468  77.62
   7   0.2287     93.100  0.0695    97.872  90.19
   8   0.1011     97.000  0.0649    97.908  102.75
   9   0.0526     98.380  0.0573    98.185  115.43
  10   0.0625     97.850  0.0564    98.220  127.97
  11   0.0643     97.780  0.0510    98.402  140.51
  12   0.0757     97.510  0.0505    98.402  153.16
  13   0.0384     98.790  0.0456    98.578  165.74
  14   0.0490     98.260  0.0440    98.607  178.29
  15   0.0571     98.080  0.0417    98.612  190.95
  16   0.0442     98.480  0.0405    98.705  203.52
  17   0.0708     97.630  0.0383    98.768  216.08
  18   0.0363     98.760  0.0375    98.775  228.74
  19   0.0368     98.800  0.0352    98.850  241.32
  20   0.0424     98.650  0.0330    98.940  253.89
  21   0.0427     98.570  0.0339    98.930  266.46
  22   0.0412     98.570  0.0322    98.927  279.03
  23   0.0435     98.340  0.0315    98.957  291.59
  24   0.0313     98.940  0.0298    98.998  304.15
  25   0.0450     98.470  0.0317    99.015  316.71
  26   0.0415     98.650  0.0303    99.030  329.30
  27   0.0313     98.920  0.0268    99.188  341.83
  28   0.0374     98.670  0.0270    99.108  354.48
  29   0.0545     98.380  0.0270    99.092  367.04
  30   0.0300     98.980  0.0252    99.205  379.61
  31   0.0311     99.020  0.0255    99.148  392.29
  32   0.0320     98.870  0.0248    99.145  404.83
  33   0.0394     98.660  0.0230    99.223  417.40
  34   0.0410     98.690  0.0234    99.245  429.96
  35   0.0324     98.930  0.0237    99.213  442.51
  36   0.0378     98.670  0.0215    99.343  455.05
  37   0.0398     98.710  0.0231    99.257  467.71
  38   0.0316     98.940  0.0205    99.345  480.25
  39   0.0337     98.890  0.0209    99.300  492.82
  40   0.0348     98.810  0.0178    99.398  505.37
  41   0.0363     98.810  0.0182    99.395  517.91
  42   0.0308     99.040  0.0189    99.373  530.47
  43   0.0389     98.800  0.0178    99.425  543.04
  44   0.0372     98.830  0.0176    99.402  555.73
  45   0.0312     98.970  0.0170    99.410  568.27
  46   0.0328     98.960  0.0162    99.422  580.81
  47   0.0294     99.050  0.0161    99.458  593.47
  48   0.0339     98.880  0.0150    99.512  606.00
  49   0.0273     99.090  0.0140    99.525  618.54
  50   0.0300     99.080  0.0135    99.545  631.09
  51   0.0371     98.910  0.0133    99.577  643.77
  52   0.0293     99.020  0.0123    99.608  656.33
  53   0.0318     99.010  0.0125    99.588  668.91
  54   0.0264     99.100  0.0128    99.572  681.47
  55   0.0255     99.170  0.0109    99.662  694.00
  56   0.0282     99.050  0.0109    99.643  706.55
  57   0.0299     99.010  0.0095    99.650  719.21
  58   0.0270     99.060  0.0104    99.650  731.73
  59   0.0246     99.190  0.0091    99.692  744.25
  60   0.0266     99.100  0.0092    99.688  756.88
  61   0.0252     99.130  0.0085    99.700  769.41
  62   0.0261     99.190  0.0084    99.720  781.97
  63   0.0288     99.030  0.0082    99.743  794.69
  64   0.0297     98.980  0.0070    99.800  807.24
  65   0.0296     99.050  0.0079    99.752  819.83
  66   0.0231     99.250  0.0066    99.792  832.52
  67   0.0274     99.110  0.0061    99.813  845.09
  68   0.0270     99.150  0.0056    99.832  857.64
  69   0.0243     99.170  0.0054    99.847  870.27
  70   0.0274     99.180  0.0052    99.828  882.82
  71   0.0282     99.140  0.0046    99.857  895.36
  72   0.0262     99.110  0.0045    99.860  908.00
  73   0.0252     99.190  0.0042    99.880  920.54
  74   0.0261     99.150  0.0043    99.888  933.06
  75   0.0238     99.240  0.0035    99.892  945.57
  76   0.0267     99.080  0.0036    99.897  958.08
  77   0.0281     99.110  0.0038    99.878  970.61
  78   0.0273     99.140  0.0033    99.895  983.14
  79   0.0269     99.170  0.0036    99.892  995.67
  80   0.0291     99.080  0.0034    99.893  1008.22
  81   0.0281     99.090  0.0034    99.897  1020.77
  82   0.0271     99.070  0.0029    99.918  1033.42
  83   0.0277     99.080  0.0027    99.927  1045.97
  84   0.0291     99.060  0.0029    99.923  1058.53
  85   0.0260     99.100  0.0029    99.912  1071.20
  86   0.0286     99.090  0.0027    99.935  1083.72
  87   0.0289     99.070  0.0025    99.933  1096.23
  88   0.0289     99.070  0.0025    99.938  1108.91
  89   0.0285     99.080  0.0025    99.950  1121.43
  90   0.0302     99.030  0.0026    99.933  1133.94
