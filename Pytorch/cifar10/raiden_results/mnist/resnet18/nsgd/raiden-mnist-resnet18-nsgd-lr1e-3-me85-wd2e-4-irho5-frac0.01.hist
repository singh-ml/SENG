Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2450     92.570  0.9232    69.345  14.75
   2   0.1821     94.370  0.1942    94.035  27.16
   3   0.0938     96.840  0.1238    96.168  39.58
   4   0.0918     97.080  0.0963    97.047  51.95
   5   0.0970     96.910  0.0795    97.540  64.29
   6   0.0586     98.180  0.0684    97.887  76.64
   7   0.0753     97.520  0.0620    98.037  89.03
   8   0.0532     98.260  0.0571    98.205  101.38
   9   0.0548     98.220  0.0515    98.372  113.72
  10   0.0637     97.990  0.0460    98.562  126.07
  11   0.0482     98.370  0.0446    98.597  138.43
  12   0.0614     98.070  0.0417    98.660  150.75
  13   0.0441     98.610  0.0405    98.760  163.23
  14   0.0434     98.660  0.0390    98.717  175.57
  15   0.0532     98.240  0.0363    98.813  187.98
  16   0.0332     98.840  0.0360    98.845  200.43
  17   0.0436     98.480  0.0348    98.882  212.75
  18   0.0415     98.630  0.0331    98.952  225.13
  19   0.0471     98.370  0.0311    98.985  237.51
  20   0.0405     98.600  0.0293    99.093  249.87
  21   0.0422     98.620  0.0288    99.048  262.25
  22   0.0397     98.650  0.0283    99.113  274.60
  23   0.0381     98.770  0.0298    99.057  287.08
  24   0.0318     98.930  0.0264    99.122  299.43
  25   0.0343     98.810  0.0259    99.153  311.78
  26   0.0311     99.000  0.0256    99.167  324.25
  27   0.0311     99.080  0.0249    99.243  336.59
  28   0.0400     98.780  0.0248    99.185  348.98
  29   0.0369     98.890  0.0247    99.187  361.41
  30   0.0398     98.700  0.0232    99.203  373.76
  31   0.0363     98.950  0.0234    99.198  386.12
  32   0.0472     98.470  0.0213    99.293  398.48
  33   0.0356     98.980  0.0220    99.283  410.99
  34   0.0305     99.010  0.0219    99.303  423.38
  35   0.0369     98.750  0.0206    99.322  435.73
  36   0.0321     98.860  0.0205    99.308  448.36
  37   0.0378     98.710  0.0197    99.373  460.76
  38   0.0342     98.870  0.0204    99.293  473.16
  39   0.0302     98.970  0.0196    99.327  485.75
  40   0.0324     98.900  0.0183    99.392  498.13
  41   0.0304     98.970  0.0190    99.405  510.48
  42   0.0328     99.050  0.0173    99.450  523.02
  43   0.0379     98.800  0.0170    99.447  535.37
  44   0.0393     98.800  0.0178    99.422  547.74
  45   0.0332     98.950  0.0173    99.440  560.21
  46   0.0385     98.740  0.0162    99.433  572.58
  47   0.0423     98.750  0.0173    99.398  584.91
  48   0.0286     99.170  0.0166    99.442  597.41
  49   0.0380     98.830  0.0151    99.503  609.76
  50   0.0421     98.700  0.0161    99.455  622.14
  51   0.0309     99.000  0.0154    99.502  634.47
  52   0.0341     98.920  0.0155    99.480  646.90
  53   0.0404     98.680  0.0155    99.503  659.25
  54   0.0325     98.990  0.0153    99.500  671.62
  55   0.0330     98.960  0.0155    99.467  683.99
  56   0.0337     98.920  0.0134    99.558  696.32
  57   0.0392     98.840  0.0144    99.488  708.69
  58   0.0297     99.020  0.0134    99.527  721.25
  59   0.0330     98.950  0.0140    99.543  733.60
  60   0.0534     98.500  0.0133    99.567  745.98
  61   0.0313     98.990  0.0130    99.568  758.47
  62   0.0405     98.750  0.0134    99.555  770.84
  63   0.0357     98.900  0.0126    99.592  783.19
  64   0.0294     99.100  0.0130    99.593  795.69
  65   0.0385     98.920  0.0119    99.628  808.05
  66   0.0310     99.130  0.0112    99.632  820.39
  67   0.0304     99.110  0.0119    99.620  832.76
  68   0.0363     98.920  0.0111    99.655  845.12
  69   0.0310     99.030  0.0124    99.583  857.45
  70   0.0412     98.780  0.0113    99.628  869.81
  71   0.0352     98.930  0.0121    99.605  882.15
  72   0.0356     98.820  0.0099    99.688  894.51
  73   0.0292     99.070  0.0104    99.655  906.86
  74   0.0357     98.930  0.0106    99.647  919.32
  75   0.0424     98.740  0.0102    99.655  931.65
  76   0.0329     99.060  0.0104    99.643  944.01
  77   0.0358     99.010  0.0101    99.667  956.48
  78   0.0354     98.970  0.0104    99.663  968.84
  79   0.0354     98.830  0.0100    99.678  981.14
  80   0.0287     99.150  0.0100    99.673  993.63
  81   0.0396     98.800  0.0095    99.697  1005.98
  82   0.0327     99.090  0.0096    99.673  1018.33
  83   0.0322     99.030  0.0099    99.658  1030.71
  84   0.0350     98.920  0.0091    99.687  1043.27
  85   0.0337     99.050  0.0084    99.708  1055.71
