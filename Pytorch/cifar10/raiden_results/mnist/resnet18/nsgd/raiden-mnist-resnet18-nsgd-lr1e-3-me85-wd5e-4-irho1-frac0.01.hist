Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7850115072 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.3299     63.510  1.8485    37.753  19.62
   2   0.4924     85.410  0.8369    77.725  32.61
   3   0.2985     91.220  0.4068    88.045  45.48
   4   0.2232     93.350  0.2955    91.138  58.34
   5   0.2233     93.260  0.2393    92.905  71.22
   6   0.1639     94.880  0.1979    94.015  84.29
   7   0.1524     95.080  0.1686    94.993  97.21
   8   0.1528     95.130  0.1484    95.490  110.09
   9   0.1149     96.350  0.1337    95.903  122.97
  10   0.1031     96.860  0.1207    96.293  135.88
  11   0.0882     97.280  0.1098    96.645  148.80
  12   0.0881     97.180  0.1020    96.847  161.84
  13   0.1086     96.690  0.0959    97.122  174.72
  14   0.1059     96.760  0.0878    97.322  187.60
  15   0.0781     97.580  0.0838    97.485  200.50
  16   0.0968     97.130  0.0812    97.512  213.50
  17   0.0754     97.630  0.0753    97.687  226.42
  18   0.0824     97.270  0.0728    97.763  239.33
  19   0.0629     98.110  0.0696    97.850  252.36
  20   0.0976     96.810  0.0657    97.967  265.26
  21   0.0577     98.270  0.0637    98.005  278.16
  22   0.0594     98.170  0.0616    98.102  291.20
  23   0.0557     98.250  0.0610    98.135  304.11
  24   0.0547     98.310  0.0571    98.250  317.01
  25   0.0635     97.990  0.0560    98.298  330.04
  26   0.0514     98.450  0.0534    98.308  342.93
  27   0.0526     98.310  0.0524    98.327  355.82
  28   0.0541     98.200  0.0521    98.365  368.72
  29   0.0524     98.340  0.0503    98.428  381.61
  30   0.0548     98.310  0.0497    98.425  394.51
  31   0.0560     98.210  0.0490    98.463  407.41
  32   0.0488     98.410  0.0475    98.520  420.29
  33   0.0494     98.490  0.0472    98.538  433.22
  34   0.0488     98.520  0.0463    98.547  446.13
  35   0.0544     98.360  0.0441    98.648  459.09
  36   0.0438     98.630  0.0437    98.598  472.00
  37   0.0494     98.440  0.0423    98.692  484.89
  38   0.0583     98.110  0.0427    98.667  497.80
  39   0.0501     98.400  0.0403    98.712  510.74
  40   0.0424     98.550  0.0403    98.757  523.62
  41   0.0471     98.440  0.0398    98.768  536.65
  42   0.0413     98.700  0.0391    98.778  549.57
  43   0.0401     98.690  0.0380    98.783  562.46
  44   0.0456     98.430  0.0373    98.832  575.46
  45   0.0424     98.710  0.0363    98.868  588.37
  46   0.0421     98.670  0.0362    98.893  601.27
  47   0.0398     98.660  0.0356    98.908  614.29
  48   0.0410     98.680  0.0348    98.893  627.20
  49   0.0464     98.380  0.0353    98.903  640.14
  50   0.0526     98.270  0.0335    99.023  653.13
  51   0.0398     98.660  0.0330    98.960  666.03
  52   0.0449     98.470  0.0328    98.962  678.98
  53   0.0537     98.190  0.0322    98.977  691.88
  54   0.0389     98.670  0.0329    98.960  704.98
  55   0.0433     98.520  0.0331    98.940  717.90
  56   0.0374     98.660  0.0316    99.025  730.90
  57   0.0374     98.630  0.0301    99.068  743.80
  58   0.0425     98.500  0.0305    99.055  756.69
  59   0.0401     98.620  0.0301    99.058  769.72
  60   0.0456     98.470  0.0300    99.042  782.62
  61   0.0395     98.630  0.0296    99.020  795.53
  62   0.0386     98.650  0.0301    99.030  808.47
  63   0.0395     98.630  0.0295    99.060  821.37
  64   0.0435     98.570  0.0277    99.148  834.26
  65   0.0410     98.510  0.0282    99.075  847.16
  66   0.0425     98.530  0.0276    99.132  860.09
  67   0.0379     98.680  0.0275    99.103  872.97
  68   0.0350     98.750  0.0261    99.177  885.87
  69   0.0367     98.740  0.0268    99.147  898.88
  70   0.0369     98.760  0.0263    99.150  911.77
  71   0.0379     98.590  0.0266    99.185  924.70
  72   0.0428     98.510  0.0258    99.180  937.70
  73   0.0390     98.590  0.0259    99.175  950.58
  74   0.0351     98.730  0.0253    99.200  963.47
  75   0.0363     98.630  0.0250    99.203  976.47
  76   0.0378     98.730  0.0249    99.233  989.35
  77   0.0375     98.650  0.0240    99.210  1002.26
  78   0.0384     98.680  0.0249    99.205  1015.26
  79   0.0382     98.690  0.0235    99.210  1028.16
  80   0.0382     98.630  0.0232    99.250  1041.06
  81   0.0436     98.530  0.0242    99.252  1054.06
  82   0.0368     98.680  0.0235    99.238  1066.98
  83   0.0349     98.820  0.0233    99.227  1079.89
  84   0.0349     98.690  0.0229    99.285  1092.79
  85   0.0365     98.700  0.0218    99.307  1105.70
