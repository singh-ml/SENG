Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2934     91.160  0.4554    85.595  14.68
   2   0.0771     97.420  0.0910    97.178  27.21
   3   0.0925     97.080  0.0645    97.980  39.58
   4   0.0777     97.630  0.0557    98.245  51.94
   5   0.0786     97.270  0.0500    98.422  64.29
   6   0.0735     97.350  0.0445    98.622  76.86
   7   0.0530     98.190  0.0437    98.652  89.20
   8   0.0422     98.560  0.0405    98.702  101.71
   9   0.0615     98.000  0.0360    98.843  114.07
  10   0.0443     98.510  0.0344    98.887  126.44
  11   0.0414     98.760  0.0316    98.988  138.80
  12   0.0353     98.870  0.0301    99.065  151.28
  13   0.0350     98.900  0.0287    99.078  163.63
  14   0.0309     99.020  0.0282    99.057  175.98
  15   0.0563     98.200  0.0278    99.115  188.41
  16   0.0346     98.810  0.0260    99.133  200.76
  17   0.0395     98.870  0.0242    99.192  213.06
  18   0.0340     98.810  0.0243    99.222  225.51
  19   0.0528     98.330  0.0245    99.220  237.83
  20   0.0394     98.780  0.0231    99.252  250.18
  21   0.0403     98.770  0.0220    99.303  262.53
  22   0.0399     98.720  0.0203    99.320  275.01
  23   0.0323     98.890  0.0206    99.355  287.33
  24   0.0348     98.850  0.0200    99.328  299.66
  25   0.0307     98.860  0.0191    99.378  312.13
  26   0.0306     99.070  0.0190    99.368  324.44
  27   0.0405     98.660  0.0174    99.437  336.76
  28   0.0299     99.070  0.0163    99.443  349.20
  29   0.0333     98.900  0.0162    99.480  361.55
  30   0.0284     99.080  0.0173    99.423  373.89
  31   0.0265     99.160  0.0152    99.517  386.36
  32   0.0304     99.020  0.0150    99.480  398.72
  33   0.0284     99.040  0.0147    99.488  411.08
  34   0.0297     99.140  0.0153    99.458  423.53
  35   0.0261     99.110  0.0130    99.565  435.87
  36   0.0279     99.180  0.0128    99.553  448.24
  37   0.0261     99.180  0.0131    99.553  460.68
  38   0.0308     99.080  0.0118    99.602  473.00
  39   0.0287     99.060  0.0123    99.607  485.33
  40   0.0250     99.170  0.0112    99.608  497.69
  41   0.0366     98.920  0.0103    99.645  510.18
  42   0.0370     98.880  0.0115    99.632  522.53
  43   0.0313     99.070  0.0105    99.657  534.88
  44   0.0345     98.950  0.0103    99.630  547.32
  45   0.0281     99.150  0.0096    99.693  559.66
  46   0.0319     99.110  0.0101    99.652  572.00
  47   0.0293     99.130  0.0098    99.647  584.48
  48   0.0277     99.210  0.0093    99.680  596.84
  49   0.0293     99.110  0.0079    99.723  609.18
  50   0.0312     99.020  0.0078    99.737  621.51
  51   0.0274     99.130  0.0074    99.757  633.84
  52   0.0251     99.250  0.0071    99.767  646.19
  53   0.0307     99.140  0.0070    99.770  658.53
  54   0.0297     99.160  0.0062    99.787  670.89
  55   0.0322     99.070  0.0059    99.805  683.24
  56   0.0332     98.980  0.0065    99.760  695.59
  57   0.0270     99.130  0.0067    99.777  708.09
  58   0.0308     99.070  0.0055    99.825  720.43
  59   0.0306     99.020  0.0056    99.818  732.77
  60   0.0330     99.090  0.0052    99.838  745.24
  61   0.0284     99.160  0.0054    99.815  757.57
  62   0.0274     99.270  0.0047    99.843  769.89
  63   0.0275     99.190  0.0049    99.840  782.35
  64   0.0347     98.980  0.0048    99.833  794.68
  65   0.0296     99.150  0.0045    99.855  807.06
  66   0.0305     99.120  0.0039    99.868  819.38
  67   0.0364     99.070  0.0048    99.845  831.69
  68   0.0324     99.110  0.0037    99.877  844.01
  69   0.0304     99.140  0.0038    99.872  856.36
  70   0.0335     99.050  0.0034    99.892  868.69
  71   0.0362     99.030  0.0035    99.890  881.05
  72   0.0310     99.160  0.0034    99.900  893.38
  73   0.0320     99.150  0.0033    99.900  905.82
  74   0.0324     99.180  0.0031    99.898  918.17
  75   0.0363     99.070  0.0028    99.903  930.49
  76   0.0308     99.150  0.0029    99.908  942.94
  77   0.0327     99.150  0.0032    99.913  955.25
  78   0.0360     99.070  0.0027    99.932  967.58
  79   0.0315     99.140  0.0025    99.932  980.04
  80   0.0329     99.120  0.0027    99.920  992.39
  81   0.0295     99.180  0.0027    99.908  1004.72
  82   0.0317     99.140  0.0027    99.912  1017.10
  83   0.0279     99.260  0.0023    99.935  1029.61
  84   0.0319     99.180  0.0023    99.920  1042.01
  85   0.0341     99.160  0.0021    99.953  1054.41
