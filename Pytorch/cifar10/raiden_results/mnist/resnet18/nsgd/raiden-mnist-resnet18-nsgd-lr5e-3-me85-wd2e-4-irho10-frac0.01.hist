Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1749     94.540  0.4304    86.047  14.59
   2   0.0854     97.280  0.0876    97.203  26.95
   3   0.0644     97.980  0.0641    97.995  39.45
   4   0.0693     97.780  0.0546    98.220  51.86
   5   0.0583     98.060  0.0518    98.348  64.26
   6   0.0547     98.050  0.0443    98.580  76.62
   7   0.0644     97.870  0.0398    98.693  89.06
   8   0.0581     98.110  0.0397    98.770  101.38
   9   0.0307     98.940  0.0372    98.813  113.71
  10   0.0492     98.400  0.0340    98.918  126.06
  11   0.0353     98.940  0.0317    98.982  138.37
  12   0.0256     99.210  0.0299    99.007  150.70
  13   0.0346     98.800  0.0297    99.053  163.01
  14   0.0316     98.980  0.0306    98.995  175.33
  15   0.0396     98.770  0.0258    99.165  187.66
  16   0.0425     98.610  0.0263    99.123  200.00
  17   0.0325     98.960  0.0240    99.215  212.33
  18   0.0479     98.560  0.0250    99.168  224.64
  19   0.0387     98.730  0.0249    99.187  236.95
  20   0.0336     98.950  0.0225    99.267  249.40
  21   0.0330     99.060  0.0214    99.275  261.74
  22   0.0390     98.800  0.0204    99.347  274.08
  23   0.0301     99.070  0.0193    99.345  286.43
  24   0.0415     98.690  0.0187    99.383  298.76
  25   0.0423     98.680  0.0177    99.412  311.09
  26   0.0299     99.030  0.0167    99.455  323.51
  27   0.0275     99.170  0.0171    99.405  335.82
  28   0.0386     98.890  0.0169    99.408  348.17
  29   0.0383     98.820  0.0178    99.390  360.47
  30   0.0330     99.000  0.0156    99.507  372.80
  31   0.0299     99.120  0.0149    99.517  385.10
  32   0.0412     98.670  0.0135    99.517  397.42
  33   0.0295     99.040  0.0143    99.532  409.89
  34   0.0246     99.180  0.0138    99.527  422.23
  35   0.0238     99.190  0.0126    99.578  434.55
  36   0.0277     99.050  0.0119    99.607  446.99
  37   0.0254     99.210  0.0122    99.583  459.31
  38   0.0320     99.020  0.0125    99.572  471.65
  39   0.0279     99.060  0.0115    99.575  483.97
  40   0.0333     99.050  0.0112    99.622  496.31
  41   0.0258     99.070  0.0110    99.615  508.64
  42   0.0267     99.070  0.0104    99.637  520.97
  43   0.0356     98.830  0.0094    99.692  533.43
  44   0.0296     99.170  0.0092    99.687  545.74
  45   0.0280     99.050  0.0089    99.718  558.06
  46   0.0266     99.210  0.0089    99.703  570.51
  47   0.0294     99.200  0.0081    99.717  582.86
  48   0.0285     99.130  0.0084    99.698  595.19
  49   0.0271     99.270  0.0085    99.737  607.50
  50   0.0280     99.150  0.0076    99.742  619.82
  51   0.0291     99.120  0.0074    99.752  632.16
  52   0.0270     99.060  0.0070    99.763  644.45
  53   0.0294     99.170  0.0072    99.755  656.76
  54   0.0358     98.960  0.0063    99.822  669.07
  55   0.0316     99.040  0.0054    99.830  681.39
  56   0.0396     98.880  0.0054    99.822  693.74
  57   0.0276     99.100  0.0056    99.815  706.07
  58   0.0299     99.180  0.0050    99.832  718.38
  59   0.0382     98.880  0.0045    99.850  730.81
  60   0.0296     99.100  0.0046    99.850  743.15
  61   0.0318     99.100  0.0043    99.860  755.48
  62   0.0332     99.000  0.0043    99.855  767.82
  63   0.0327     99.080  0.0035    99.885  780.37
  64   0.0316     99.070  0.0039    99.887  792.68
  65   0.0366     99.000  0.0041    99.867  805.02
  66   0.0353     99.020  0.0038    99.875  817.56
  67   0.0315     99.100  0.0034    99.887  829.89
  68   0.0317     99.090  0.0037    99.888  842.22
  69   0.0286     99.160  0.0032    99.892  854.74
  70   0.0354     99.000  0.0033    99.903  867.09
  71   0.0318     99.110  0.0031    99.900  879.44
  72   0.0330     99.110  0.0029    99.925  891.86
  73   0.0347     99.010  0.0029    99.912  904.17
  74   0.0373     99.020  0.0026    99.920  916.49
  75   0.0331     99.040  0.0027    99.913  928.85
  76   0.0354     99.050  0.0027    99.912  941.16
  77   0.0300     99.190  0.0026    99.917  953.51
  78   0.0330     99.030  0.0022    99.942  965.86
  79   0.0297     99.140  0.0025    99.928  978.20
  80   0.0401     98.890  0.0022    99.935  990.53
  81   0.0343     99.080  0.0026    99.918  1002.87
  82   0.0338     99.130  0.0021    99.943  1015.21
  83   0.0372     99.000  0.0021    99.932  1027.55
  84   0.0372     98.980  0.0022    99.923  1039.87
  85   0.0346     99.120  0.0022    99.927  1052.32
