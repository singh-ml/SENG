Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2959     90.460  0.3953    86.508  14.75
   2   0.0762     97.650  0.0889    97.148  27.49
   3   0.0913     97.250  0.0681    97.835  40.06
   4   0.0714     97.900  0.0559    98.232  52.59
   5   0.0577     98.080  0.0519    98.367  65.29
   6   0.0442     98.500  0.0458    98.583  77.87
   7   0.0506     98.390  0.0411    98.728  90.44
   8   0.0548     98.180  0.0395    98.748  103.04
   9   0.0529     98.360  0.0352    98.905  115.83
  10   0.0523     98.350  0.0341    98.885  128.39
  11   0.0397     98.740  0.0325    98.903  140.93
  12   0.0448     98.590  0.0317    99.013  153.47
  13   0.0371     98.860  0.0302    99.050  166.04
  14   0.0514     98.270  0.0282    99.078  178.65
  15   0.0486     98.320  0.0266    99.187  191.24
  16   0.0483     98.530  0.0261    99.140  203.79
  17   0.0374     98.800  0.0265    99.143  216.37
  18   0.0294     98.930  0.0256    99.150  229.17
  19   0.0315     98.860  0.0237    99.215  241.71
  20   0.0355     98.970  0.0231    99.218  254.27
  21   0.0332     98.930  0.0222    99.252  266.96
  22   0.0451     98.540  0.0211    99.273  279.54
  23   0.0418     98.630  0.0212    99.297  292.11
  24   0.0320     98.870  0.0190    99.378  304.84
  25   0.0338     98.940  0.0199    99.338  317.42
  26   0.0300     99.130  0.0166    99.457  329.99
  27   0.0339     99.010  0.0182    99.398  342.54
  28   0.0298     98.990  0.0160    99.467  355.14
  29   0.0459     98.580  0.0162    99.440  367.68
  30   0.0278     99.120  0.0162    99.433  380.25
  31   0.0376     98.850  0.0157    99.452  392.78
  32   0.0393     98.790  0.0139    99.523  405.37
  33   0.0254     99.250  0.0152    99.497  417.95
  34   0.0300     99.070  0.0142    99.542  430.53
  35   0.0391     98.890  0.0134    99.555  443.09
  36   0.0329     98.990  0.0126    99.563  455.66
  37   0.0305     99.080  0.0130    99.547  468.33
  38   0.0302     99.100  0.0120    99.563  480.90
  39   0.0295     99.140  0.0120    99.610  493.47
  40   0.0376     98.880  0.0115    99.602  506.16
  41   0.0274     99.130  0.0119    99.588  518.75
  42   0.0269     99.160  0.0099    99.672  531.34
  43   0.0268     99.100  0.0104    99.632  544.04
  44   0.0265     99.180  0.0097    99.658  556.60
  45   0.0323     99.080  0.0091    99.700  569.19
  46   0.0308     99.120  0.0088    99.727  581.78
  47   0.0288     99.160  0.0078    99.728  594.49
  48   0.0325     99.060  0.0077    99.735  607.05
  49   0.0325     98.890  0.0085    99.718  619.65
  50   0.0290     99.060  0.0079    99.728  632.30
  51   0.0296     99.040  0.0074    99.733  644.88
  52   0.0331     99.050  0.0070    99.762  657.50
  53   0.0309     99.080  0.0069    99.758  670.07
  54   0.0285     99.120  0.0066    99.795  682.78
  55   0.0310     99.040  0.0056    99.810  695.35
  56   0.0315     99.120  0.0054    99.830  707.93
  57   0.0288     99.200  0.0053    99.823  720.47
  58   0.0243     99.300  0.0049    99.840  733.17
  59   0.0264     99.280  0.0054    99.797  745.74
  60   0.0339     99.030  0.0046    99.850  758.31
  61   0.0330     99.080  0.0045    99.858  771.00
  62   0.0301     99.200  0.0042    99.868  783.55
  63   0.0292     99.180  0.0043    99.858  796.12
  64   0.0314     99.180  0.0041    99.882  808.84
  65   0.0347     99.040  0.0039    99.882  821.40
  66   0.0336     99.060  0.0036    99.877  833.98
  67   0.0330     99.120  0.0037    99.882  846.64
  68   0.0376     99.040  0.0034    99.897  859.17
  69   0.0350     99.110  0.0035    99.878  871.73
  70   0.0338     99.150  0.0034    99.902  884.27
  71   0.0320     99.190  0.0031    99.895  896.90
  72   0.0355     99.090  0.0028    99.908  909.48
  73   0.0399     99.060  0.0028    99.915  922.02
  74   0.0333     99.160  0.0025    99.913  934.61
  75   0.0346     99.140  0.0020    99.955  947.25
  76   0.0351     99.100  0.0026    99.930  959.88
  77   0.0375     99.070  0.0023    99.935  972.57
  78   0.0349     99.140  0.0023    99.932  985.17
  79   0.0371     99.080  0.0023    99.928  997.77
  80   0.0360     99.120  0.0023    99.938  1010.47
  81   0.0363     99.120  0.0020    99.950  1023.04
  82   0.0363     99.060  0.0019    99.958  1035.64
  83   0.0359     99.110  0.0019    99.958  1048.24
  84   0.0376     99.090  0.0017    99.960  1060.97
  85   0.0368     99.090  0.0016    99.958  1073.53
  86   0.0381     99.060  0.0019    99.938  1086.09
  87   0.0370     99.120  0.0015    99.965  1098.68
  88   0.0388     99.070  0.0018    99.945  1111.25
  89   0.0373     99.120  0.0017    99.957  1123.82
  90   0.0374     99.080  0.0016    99.967  1136.42
