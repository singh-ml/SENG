Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2100     92.810  0.4372    85.510  14.52
   2   0.0667     97.970  0.0898    97.165  26.93
   3   0.0845     97.020  0.0660    97.833  39.32
   4   0.0706     97.740  0.0573    98.168  51.71
   5   0.0473     98.350  0.0504    98.423  64.26
   6   0.0757     97.570  0.0448    98.568  76.66
   7   0.0492     98.530  0.0416    98.728  89.06
   8   0.0451     98.440  0.0403    98.725  101.45
   9   0.0401     98.710  0.0367    98.873  113.84
  10   0.0460     98.550  0.0348    98.877  126.23
  11   0.0383     98.670  0.0332    98.958  138.62
  12   0.0297     99.060  0.0325    98.948  151.03
  13   0.0394     98.700  0.0294    99.070  163.42
  14   0.0392     98.730  0.0281    99.068  175.83
  15   0.0328     98.860  0.0282    99.108  188.23
  16   0.0355     98.900  0.0263    99.143  200.64
  17   0.0324     98.880  0.0250    99.185  213.11
  18   0.0322     98.950  0.0250    99.173  225.64
  19   0.0404     98.760  0.0245    99.170  238.04
  20   0.0350     98.840  0.0227    99.233  250.44
  21   0.0358     98.870  0.0217    99.280  262.95
  22   0.0458     98.650  0.0205    99.313  275.35
  23   0.0306     98.970  0.0206    99.338  287.72
  24   0.0306     98.950  0.0206    99.317  300.14
  25   0.0235     99.200  0.0189    99.382  312.55
  26   0.0363     98.840  0.0189    99.388  324.96
  27   0.0363     98.790  0.0175    99.433  337.37
  28   0.0401     98.680  0.0172    99.437  349.91
  29   0.0412     98.780  0.0170    99.450  362.34
  30   0.0409     98.660  0.0168    99.458  374.76
  31   0.0313     99.000  0.0156    99.485  387.30
  32   0.0294     99.020  0.0161    99.482  399.67
  33   0.0241     99.290  0.0155    99.475  412.08
  34   0.0344     98.930  0.0138    99.520  424.57
  35   0.0285     99.080  0.0138    99.547  436.98
  36   0.0358     98.840  0.0127    99.568  449.40
  37   0.0313     99.050  0.0124    99.582  461.79
  38   0.0324     98.980  0.0131    99.543  474.29
  39   0.0271     99.190  0.0119    99.610  486.70
  40   0.0276     99.230  0.0127    99.573  499.10
  41   0.0353     98.910  0.0110    99.638  511.52
  42   0.0312     99.100  0.0107    99.657  523.91
  43   0.0247     99.280  0.0102    99.648  536.27
  44   0.0311     99.080  0.0095    99.693  548.81
  45   0.0233     99.200  0.0101    99.668  561.20
  46   0.0268     99.190  0.0083    99.725  573.63
  47   0.0269     99.200  0.0093    99.670  586.15
  48   0.0355     98.900  0.0090    99.700  598.56
  49   0.0326     99.040  0.0074    99.758  610.96
  50   0.0257     99.180  0.0074    99.750  623.49
  51   0.0269     99.100  0.0075    99.750  635.89
  52   0.0340     98.880  0.0068    99.763  648.29
  53   0.0317     99.050  0.0066    99.787  660.69
  54   0.0280     99.090  0.0069    99.773  673.09
  55   0.0256     99.200  0.0067    99.797  685.49
  56   0.0297     99.090  0.0058    99.817  697.85
  57   0.0252     99.230  0.0059    99.808  710.37
  58   0.0290     99.150  0.0057    99.820  722.77
  59   0.0291     99.090  0.0049    99.835  735.19
  60   0.0302     99.190  0.0051    99.838  747.72
  61   0.0319     99.140  0.0053    99.820  760.11
  62   0.0302     99.150  0.0047    99.848  772.50
  63   0.0329     99.080  0.0042    99.877  784.92
  64   0.0300     99.180  0.0041    99.865  797.31
  65   0.0281     99.170  0.0041    99.862  809.69
  66   0.0307     99.070  0.0036    99.903  822.09
  67   0.0268     99.190  0.0040    99.867  834.52
  68   0.0272     99.270  0.0031    99.918  846.92
  69   0.0310     99.070  0.0029    99.927  859.30
  70   0.0309     99.140  0.0031    99.910  871.82
  71   0.0290     99.220  0.0025    99.917  884.20
  72   0.0302     99.110  0.0027    99.918  896.60
  73   0.0288     99.220  0.0028    99.923  909.12
  74   0.0288     99.200  0.0025    99.937  921.51
  75   0.0273     99.280  0.0025    99.928  933.87
  76   0.0324     99.170  0.0024    99.917  946.27
  77   0.0285     99.250  0.0020    99.942  958.69
  78   0.0317     99.210  0.0021    99.950  971.08
  79   0.0294     99.240  0.0022    99.942  983.47
  80   0.0308     99.180  0.0020    99.953  996.06
  81   0.0329     99.140  0.0021    99.932  1008.46
  82   0.0319     99.190  0.0018    99.957  1020.85
  83   0.0317     99.230  0.0018    99.960  1033.37
  84   0.0276     99.320  0.0018    99.947  1045.78
  85   0.0305     99.220  0.0018    99.955  1058.18
  86   0.0322     99.180  0.0017    99.945  1070.72
  87   0.0318     99.150  0.0018    99.948  1083.10
  88   0.0292     99.160  0.0016    99.950  1095.55
  89   0.0324     99.170  0.0017    99.953  1108.05
  90   0.0339     99.140  0.0017    99.957  1120.39
