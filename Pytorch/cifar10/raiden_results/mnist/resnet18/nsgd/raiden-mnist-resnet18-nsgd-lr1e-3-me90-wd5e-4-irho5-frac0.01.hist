Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4324     85.090  0.9390    68.517  14.68
   2   0.1284     95.940  0.1980    93.993  27.16
   3   0.1122     96.360  0.1210    96.353  39.75
   4   0.1015     96.830  0.0926    97.105  52.23
   5   0.0896     97.020  0.0766    97.607  64.69
   6   0.0692     97.900  0.0664    97.905  77.31
   7   0.0610     97.990  0.0590    98.145  89.73
   8   0.0563     98.190  0.0539    98.275  102.21
   9   0.0571     98.160  0.0507    98.335  114.78
  10   0.0666     97.830  0.0469    98.527  127.26
  11   0.0415     98.720  0.0446    98.575  139.69
  12   0.0491     98.540  0.0421    98.707  152.12
  13   0.0460     98.510  0.0400    98.702  164.55
  14   0.0499     98.430  0.0377    98.827  177.02
  15   0.0471     98.470  0.0354    98.900  189.48
  16   0.0481     98.510  0.0353    98.882  201.95
  17   0.0390     98.720  0.0348    98.902  214.41
  18   0.0514     98.340  0.0331    98.920  226.86
  19   0.0369     98.790  0.0307    99.055  239.43
  20   0.0378     98.730  0.0301    99.038  251.86
  21   0.0563     98.300  0.0295    99.038  264.33
  22   0.0402     98.730  0.0287    99.095  276.89
  23   0.0417     98.680  0.0272    99.118  289.36
  24   0.0420     98.660  0.0276    99.115  301.83
  25   0.0440     98.580  0.0253    99.168  314.30
  26   0.0267     99.090  0.0264    99.175  326.74
  27   0.0354     98.860  0.0262    99.162  339.20
  28   0.0407     98.780  0.0249    99.163  351.65
  29   0.0296     98.970  0.0240    99.242  364.23
  30   0.0403     98.770  0.0237    99.203  376.69
  31   0.0362     98.880  0.0235    99.232  389.14
  32   0.0369     98.900  0.0218    99.315  401.72
  33   0.0344     98.900  0.0213    99.307  414.18
  34   0.0362     98.920  0.0204    99.297  426.63
  35   0.0450     98.550  0.0206    99.325  439.24
  36   0.0423     98.650  0.0216    99.318  451.71
  37   0.0400     98.680  0.0209    99.313  464.14
  38   0.0354     98.980  0.0206    99.282  476.75
  39   0.0383     98.750  0.0183    99.418  489.17
  40   0.0319     98.950  0.0191    99.390  501.63
  41   0.0320     98.990  0.0182    99.397  514.08
  42   0.0303     99.090  0.0183    99.422  526.52
  43   0.0351     98.820  0.0181    99.378  539.00
  44   0.0340     98.920  0.0177    99.408  551.50
  45   0.0399     98.710  0.0175    99.428  564.09
  46   0.0273     99.040  0.0173    99.433  576.56
  47   0.0284     99.020  0.0156    99.468  589.02
  48   0.0374     98.830  0.0159    99.512  601.58
  49   0.0297     99.060  0.0154    99.488  614.03
  50   0.0368     98.720  0.0155    99.495  626.50
  51   0.0319     98.980  0.0151    99.507  639.11
  52   0.0351     98.860  0.0152    99.495  651.54
  53   0.0359     98.790  0.0135    99.562  663.99
  54   0.0319     98.960  0.0142    99.505  676.56
  55   0.0337     98.920  0.0150    99.490  689.02
  56   0.0312     99.000  0.0154    99.507  701.47
  57   0.0339     98.950  0.0140    99.537  714.05
  58   0.0340     98.850  0.0139    99.542  726.51
  59   0.0345     98.900  0.0133    99.567  738.96
  60   0.0308     99.060  0.0123    99.585  751.42
  61   0.0340     98.930  0.0138    99.545  763.89
  62   0.0465     98.660  0.0128    99.558  776.38
  63   0.0358     98.860  0.0132    99.540  788.82
  64   0.0337     98.980  0.0132    99.582  801.40
  65   0.0364     98.990  0.0122    99.597  813.88
  66   0.0365     98.930  0.0127    99.587  826.36
  67   0.0340     98.890  0.0113    99.643  838.94
  68   0.0395     98.830  0.0119    99.605  851.40
  69   0.0389     98.810  0.0116    99.630  863.87
  70   0.0313     98.950  0.0116    99.595  876.36
  71   0.0343     98.840  0.0113    99.612  888.85
  72   0.0372     98.720  0.0123    99.603  901.33
  73   0.0274     99.080  0.0104    99.663  913.84
  74   0.0264     99.090  0.0113    99.647  926.42
  75   0.0314     99.070  0.0101    99.665  938.86
  76   0.0437     98.590  0.0106    99.620  951.36
  77   0.0322     98.940  0.0099    99.663  963.87
  78   0.0247     99.230  0.0093    99.687  976.45
  79   0.0347     98.840  0.0103    99.667  988.93
  80   0.0376     98.980  0.0102    99.670  1001.39
  81   0.0256     99.150  0.0098    99.682  1013.98
  82   0.0343     98.980  0.0096    99.662  1026.43
  83   0.0294     99.050  0.0093    99.695  1038.89
  84   0.0318     99.040  0.0089    99.697  1051.35
  85   0.0320     99.040  0.0092    99.705  1063.95
  86   0.0449     98.610  0.0093    99.695  1076.38
  87   0.0297     99.090  0.0093    99.690  1088.86
  88   0.0356     98.840  0.0092    99.692  1101.33
  89   0.0356     98.850  0.0086    99.692  1114.03
  90   0.0373     98.760  0.0078    99.742  1126.54
