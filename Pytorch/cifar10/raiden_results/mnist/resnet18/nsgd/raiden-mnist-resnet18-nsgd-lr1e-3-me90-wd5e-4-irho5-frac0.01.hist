Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3278     89.050  0.9137    69.497  14.62
   2   0.1517     95.200  0.1940    94.008  27.09
   3   0.0995     96.840  0.1194    96.298  39.49
   4   0.0652     98.000  0.0895    97.222  51.97
   5   0.0824     97.340  0.0747    97.683  64.35
   6   0.0663     97.880  0.0656    97.968  76.74
   7   0.0702     97.710  0.0578    98.207  89.25
   8   0.0699     97.690  0.0552    98.315  101.62
   9   0.0602     98.170  0.0501    98.413  113.98
  10   0.0593     98.030  0.0464    98.508  126.36
  11   0.0390     98.720  0.0427    98.650  138.85
  12   0.0466     98.430  0.0409    98.733  151.24
  13   0.0486     98.480  0.0398    98.708  163.61
  14   0.0457     98.660  0.0363    98.825  176.04
  15   0.0372     98.670  0.0359    98.855  188.39
  16   0.0555     98.200  0.0345    98.867  200.74
  17   0.0426     98.620  0.0338    98.905  213.18
  18   0.0407     98.700  0.0324    98.972  225.54
  19   0.0423     98.580  0.0312    99.010  237.91
  20   0.0364     98.870  0.0294    99.083  250.34
  21   0.0368     98.740  0.0296    99.058  262.69
  22   0.0338     98.870  0.0288    99.052  275.03
  23   0.0380     98.820  0.0283    99.073  287.36
  24   0.0394     98.860  0.0262    99.170  299.73
  25   0.0357     98.670  0.0258    99.188  312.12
  26   0.0383     98.780  0.0251    99.205  324.45
  27   0.0387     98.730  0.0252    99.162  336.81
  28   0.0420     98.700  0.0243    99.215  349.17
  29   0.0386     98.720  0.0232    99.260  361.53
  30   0.0325     98.970  0.0236    99.237  374.00
  31   0.0457     98.410  0.0231    99.245  386.35
  32   0.0399     98.680  0.0227    99.290  398.74
  33   0.0325     98.910  0.0220    99.293  411.09
  34   0.0372     98.820  0.0216    99.278  423.60
  35   0.0414     98.650  0.0209    99.298  435.95
  36   0.0369     98.780  0.0205    99.332  448.42
  37   0.0366     98.670  0.0209    99.322  460.81
  38   0.0352     98.820  0.0194    99.387  473.16
  39   0.0342     98.890  0.0201    99.363  485.52
  40   0.0387     98.640  0.0194    99.352  497.88
  41   0.0315     98.930  0.0178    99.408  510.23
  42   0.0322     98.840  0.0180    99.405  522.61
  43   0.0346     98.840  0.0189    99.378  535.08
  44   0.0318     99.010  0.0181    99.390  547.44
  45   0.0301     98.980  0.0169    99.448  559.79
  46   0.0300     99.080  0.0171    99.437  572.26
  47   0.0371     98.960  0.0161    99.487  584.61
  48   0.0363     98.880  0.0164    99.477  597.01
  49   0.0310     98.950  0.0166    99.462  609.37
  50   0.0331     98.820  0.0169    99.440  621.74
  51   0.0313     98.890  0.0162    99.485  634.11
  52   0.0312     98.910  0.0148    99.528  646.47
  53   0.0310     99.030  0.0144    99.488  658.82
  54   0.0401     98.770  0.0136    99.543  671.19
  55   0.0287     99.030  0.0141    99.523  683.56
  56   0.0264     99.210  0.0144    99.507  696.05
  57   0.0341     98.870  0.0134    99.585  708.42
  58   0.0342     98.990  0.0136    99.562  720.78
  59   0.0280     99.010  0.0134    99.555  733.14
  60   0.0289     99.050  0.0131    99.542  745.53
  61   0.0307     99.070  0.0117    99.620  757.89
  62   0.0342     98.810  0.0124    99.568  770.26
  63   0.0306     99.050  0.0137    99.537  782.63
  64   0.0339     98.880  0.0125    99.607  794.99
  65   0.0258     99.150  0.0123    99.588  807.35
  66   0.0294     99.090  0.0113    99.615  819.72
  67   0.0376     98.790  0.0119    99.587  832.09
  68   0.0343     98.950  0.0116    99.600  844.46
  69   0.0354     98.960  0.0113    99.613  856.81
  70   0.0366     98.810  0.0109    99.633  869.18
  71   0.0388     98.870  0.0109    99.603  881.54
  72   0.0278     99.150  0.0107    99.647  893.90
  73   0.0348     98.940  0.0107    99.658  906.28
  74   0.0392     98.770  0.0110    99.643  918.66
  75   0.0300     99.070  0.0106    99.637  931.03
  76   0.0357     98.900  0.0108    99.643  943.41
  77   0.0300     99.120  0.0107    99.658  955.88
  78   0.0311     99.020  0.0098    99.657  968.26
  79   0.0385     98.780  0.0096    99.703  980.62
  80   0.0287     99.150  0.0098    99.680  992.95
  81   0.0365     98.860  0.0096    99.692  1005.51
  82   0.0307     99.040  0.0090    99.702  1017.87
  83   0.0476     98.520  0.0090    99.705  1030.25
  84   0.0307     98.970  0.0088    99.718  1042.69
  85   0.0368     99.050  0.0093    99.688  1055.05
  86   0.0414     98.770  0.0086    99.712  1067.42
  87   0.0324     99.030  0.0093    99.690  1079.89
  88   0.0362     98.980  0.0094    99.677  1092.23
  89   0.0313     99.030  0.0085    99.730  1104.62
  90   0.0304     99.150  0.0080    99.732  1117.08
