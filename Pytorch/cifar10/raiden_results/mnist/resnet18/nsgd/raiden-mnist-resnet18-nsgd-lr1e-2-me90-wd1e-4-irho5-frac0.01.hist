Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2993     89.820  0.4556    85.198  14.76
   2   0.2232     92.900  0.0884    97.198  27.45
   3   0.0670     97.840  0.0659    97.923  40.00
   4   0.0962     96.720  0.0569    98.170  52.55
   5   0.0429     98.440  0.0506    98.412  65.13
   6   0.0427     98.500  0.0453    98.585  77.88
   7   0.0399     98.660  0.0411    98.672  90.45
   8   0.0349     98.960  0.0401    98.737  103.03
   9   0.0616     98.010  0.0369    98.820  115.58
  10   0.0361     98.690  0.0332    98.952  128.14
  11   0.0305     98.980  0.0325    98.977  140.68
  12   0.0357     98.770  0.0305    99.020  153.23
  13   0.0482     98.400  0.0312    98.970  165.78
  14   0.0300     99.030  0.0295    99.072  178.34
  15   0.0414     98.640  0.0282    99.103  190.85
  16   0.0302     98.990  0.0272    99.118  203.38
  17   0.0553     98.110  0.0237    99.227  215.91
  18   0.0346     99.000  0.0241    99.218  228.54
  19   0.0255     99.210  0.0236    99.197  241.08
  20   0.0384     98.840  0.0233    99.227  253.63
  21   0.0299     99.050  0.0214    99.288  266.29
  22   0.0248     99.190  0.0218    99.323  278.83
  23   0.0335     98.890  0.0205    99.333  291.37
  24   0.0328     98.940  0.0207    99.315  304.03
  25   0.0334     98.920  0.0192    99.337  316.57
  26   0.0438     98.670  0.0183    99.373  329.10
  27   0.0256     99.260  0.0172    99.427  341.63
  28   0.0299     98.920  0.0176    99.428  354.35
  29   0.0324     99.030  0.0163    99.432  366.87
  30   0.0343     99.010  0.0159    99.463  379.37
  31   0.0256     99.210  0.0160    99.442  392.03
  32   0.0296     99.110  0.0146    99.510  404.56
  33   0.0299     99.050  0.0139    99.552  417.09
  34   0.0291     99.090  0.0142    99.530  429.75
  35   0.0281     99.110  0.0142    99.533  442.25
  36   0.0441     98.680  0.0129    99.562  454.84
  37   0.0276     99.150  0.0128    99.587  467.47
  38   0.0246     99.320  0.0119    99.615  480.00
  39   0.0286     99.220  0.0109    99.627  492.54
  40   0.0331     98.970  0.0113    99.658  505.18
  41   0.0321     99.110  0.0110    99.637  517.72
  42   0.0285     99.210  0.0109    99.617  530.20
  43   0.0292     99.160  0.0094    99.663  542.74
  44   0.0309     99.110  0.0100    99.655  555.24
  45   0.0273     99.240  0.0096    99.678  567.81
  46   0.0325     98.960  0.0086    99.705  580.34
  47   0.0261     99.220  0.0084    99.712  592.92
  48   0.0276     99.200  0.0088    99.695  605.44
  49   0.0268     99.230  0.0084    99.723  617.99
  50   0.0312     99.240  0.0076    99.760  630.67
  51   0.0328     99.080  0.0075    99.743  643.22
  52   0.0278     99.210  0.0067    99.778  655.76
  53   0.0281     99.080  0.0073    99.757  668.42
  54   0.0270     99.240  0.0063    99.797  680.98
  55   0.0307     99.060  0.0055    99.808  693.53
  56   0.0270     99.240  0.0058    99.805  706.06
  57   0.0253     99.230  0.0052    99.832  718.60
  58   0.0260     99.310  0.0053    99.825  731.17
  59   0.0294     99.160  0.0055    99.797  743.71
  60   0.0263     99.290  0.0052    99.852  756.47
  61   0.0277     99.170  0.0043    99.860  769.02
  62   0.0346     98.970  0.0044    99.862  781.55
  63   0.0297     99.180  0.0050    99.832  794.06
  64   0.0275     99.240  0.0044    99.858  806.59
  65   0.0324     99.080  0.0041    99.868  819.10
  66   0.0309     99.140  0.0038    99.888  831.64
  67   0.0311     99.130  0.0040    99.868  844.18
  68   0.0286     99.230  0.0035    99.897  856.73
  69   0.0309     99.120  0.0034    99.892  869.37
  70   0.0301     99.080  0.0031    99.907  881.88
  71   0.0287     99.110  0.0029    99.920  894.38
  72   0.0320     99.120  0.0030    99.908  906.97
  73   0.0337     99.000  0.0030    99.917  919.51
  74   0.0342     99.060  0.0028    99.907  932.02
  75   0.0310     99.110  0.0027    99.920  944.56
  76   0.0315     99.110  0.0023    99.928  957.31
  77   0.0308     99.090  0.0026    99.932  969.87
  78   0.0304     99.110  0.0024    99.930  982.53
  79   0.0300     99.160  0.0022    99.947  995.13
  80   0.0292     99.270  0.0022    99.932  1007.72
  81   0.0325     99.170  0.0020    99.945  1020.28
  82   0.0316     99.170  0.0025    99.930  1033.04
  83   0.0313     99.200  0.0021    99.953  1045.61
  84   0.0315     99.130  0.0021    99.950  1058.18
  85   0.0333     99.070  0.0018    99.950  1070.82
  86   0.0316     99.070  0.0022    99.947  1083.37
  87   0.0352     99.010  0.0022    99.930  1095.92
  88   0.0320     99.160  0.0020    99.942  1108.58
  89   0.0357     99.060  0.0021    99.940  1121.16
  90   0.0325     99.100  0.0019    99.953  1133.71
