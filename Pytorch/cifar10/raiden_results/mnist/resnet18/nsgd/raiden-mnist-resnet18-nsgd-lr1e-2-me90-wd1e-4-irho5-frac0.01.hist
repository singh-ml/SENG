Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1520     95.110  0.4231    85.830  14.70
   2   0.3159     91.110  0.0891    97.163  27.22
   3   0.1050     96.740  0.0677    97.855  39.72
   4   0.0640     97.860  0.0567    98.247  52.24
   5   0.0619     98.000  0.0459    98.597  64.75
   6   0.0547     98.420  0.0466    98.605  77.26
   7   0.0672     97.700  0.0431    98.578  89.84
   8   0.0571     98.080  0.0387    98.742  102.32
   9   0.0326     99.000  0.0356    98.832  114.86
  10   0.0391     98.700  0.0340    98.963  127.36
  11   0.0472     98.470  0.0329    98.915  140.08
  12   0.0510     98.580  0.0313    98.940  152.59
  13   0.0413     98.610  0.0313    98.995  165.13
  14   0.0322     98.980  0.0279    99.117  177.79
  15   0.0475     98.520  0.0266    99.148  190.32
  16   0.0451     98.510  0.0272    99.103  202.80
  17   0.0546     98.360  0.0259    99.185  215.47
  18   0.0402     98.670  0.0251    99.187  227.96
  19   0.0353     98.730  0.0240    99.210  240.46
  20   0.0343     98.810  0.0225    99.277  253.05
  21   0.0350     98.810  0.0217    99.283  265.57
  22   0.0198     99.350  0.0213    99.300  278.08
  23   0.0400     98.650  0.0192    99.345  290.71
  24   0.0445     98.690  0.0205    99.303  303.22
  25   0.0374     98.850  0.0196    99.353  315.74
  26   0.0419     98.830  0.0181    99.430  328.26
  27   0.0382     98.740  0.0179    99.392  340.91
  28   0.0347     98.960  0.0167    99.428  353.42
  29   0.0255     99.090  0.0168    99.458  365.97
  30   0.0424     98.730  0.0165    99.430  378.63
  31   0.0308     98.960  0.0158    99.450  391.14
  32   0.0324     98.940  0.0144    99.495  403.68
  33   0.0243     99.200  0.0141    99.518  416.29
  34   0.0306     99.020  0.0137    99.530  428.81
  35   0.0307     99.080  0.0141    99.537  441.31
  36   0.0261     99.170  0.0134    99.557  453.93
  37   0.0227     99.270  0.0123    99.612  466.43
  38   0.0334     98.850  0.0117    99.618  478.97
  39   0.0327     98.960  0.0116    99.608  491.58
  40   0.0345     98.960  0.0107    99.658  504.12
  41   0.0298     99.050  0.0112    99.585  516.65
  42   0.0295     99.120  0.0113    99.637  529.19
  43   0.0373     98.880  0.0097    99.633  541.73
  44   0.0351     98.970  0.0094    99.668  554.24
  45   0.0279     99.170  0.0100    99.640  566.75
  46   0.0295     99.100  0.0087    99.715  579.32
  47   0.0226     99.290  0.0088    99.692  591.82
  48   0.0335     98.950  0.0075    99.742  604.31
  49   0.0376     98.810  0.0084    99.685  616.88
  50   0.0358     98.940  0.0069    99.775  629.42
  51   0.0356     99.030  0.0067    99.782  641.95
  52   0.0289     99.140  0.0073    99.772  654.58
  53   0.0295     99.140  0.0067    99.762  667.10
  54   0.0303     99.100  0.0064    99.772  679.61
  55   0.0290     99.170  0.0064    99.788  692.15
  56   0.0322     99.020  0.0058    99.813  704.69
  57   0.0294     99.100  0.0060    99.800  717.19
  58   0.0282     99.150  0.0051    99.842  729.77
  59   0.0326     99.150  0.0054    99.813  742.45
  60   0.0308     99.160  0.0049    99.845  754.98
  61   0.0288     99.130  0.0047    99.853  767.50
  62   0.0307     99.120  0.0044    99.858  780.15
  63   0.0289     99.120  0.0046    99.853  792.72
  64   0.0294     99.150  0.0037    99.898  805.24
  65   0.0304     99.120  0.0038    99.885  817.88
  66   0.0329     99.050  0.0043    99.855  830.45
  67   0.0301     99.200  0.0035    99.880  842.99
  68   0.0292     99.190  0.0037    99.883  855.60
  69   0.0300     99.130  0.0040    99.853  868.15
  70   0.0264     99.260  0.0031    99.905  880.68
  71   0.0336     99.050  0.0033    99.903  893.21
  72   0.0367     99.010  0.0029    99.897  905.89
  73   0.0333     99.080  0.0026    99.933  918.40
  74   0.0325     99.060  0.0030    99.915  930.99
  75   0.0352     99.040  0.0027    99.912  943.50
  76   0.0313     99.110  0.0023    99.938  955.99
  77   0.0330     99.090  0.0024    99.942  968.52
  78   0.0322     99.150  0.0024    99.908  981.06
  79   0.0330     99.090  0.0022    99.945  993.59
  80   0.0364     99.000  0.0025    99.927  1006.11
  81   0.0345     99.040  0.0021    99.943  1018.77
  82   0.0334     99.040  0.0023    99.932  1031.31
  83   0.0306     99.140  0.0023    99.928  1043.89
  84   0.0315     99.150  0.0019    99.943  1056.58
  85   0.0329     99.040  0.0020    99.940  1069.12
  86   0.0317     99.120  0.0023    99.923  1081.68
  87   0.0346     99.050  0.0019    99.958  1094.25
  88   0.0339     99.130  0.0021    99.943  1106.76
  89   0.0324     99.120  0.0020    99.950  1119.26
  90   0.0301     99.190  0.0020    99.938  1131.79
