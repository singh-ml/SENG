Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1298     96.120  0.5020    82.562  14.86
   2   0.1297     95.800  0.0974    96.932  27.57
   3   0.0854     97.410  0.0708    97.748  40.26
   4   0.0480     98.450  0.0587    98.132  52.81
   5   0.0883     96.970  0.0518    98.387  65.37
   6   0.0554     98.250  0.0481    98.472  78.04
   7   0.0461     98.510  0.0451    98.500  90.60
   8   0.0425     98.540  0.0399    98.707  103.18
   9   0.0452     98.510  0.0385    98.770  115.87
  10   0.0469     98.590  0.0352    98.888  128.42
  11   0.0588     98.030  0.0337    98.908  140.96
  12   0.0445     98.440  0.0335    98.900  153.60
  13   0.0486     98.470  0.0317    98.965  166.17
  14   0.0569     97.980  0.0282    99.053  178.73
  15   0.0372     98.900  0.0266    99.098  191.27
  16   0.0492     98.520  0.0279    99.083  203.95
  17   0.0455     98.520  0.0278    99.088  216.52
  18   0.0340     98.960  0.0255    99.140  229.10
  19   0.0330     98.960  0.0243    99.177  241.79
  20   0.0366     98.720  0.0236    99.250  254.34
  21   0.0424     98.600  0.0238    99.223  266.91
  22   0.0378     98.710  0.0218    99.258  279.60
  23   0.0329     98.960  0.0224    99.283  292.16
  24   0.0451     98.540  0.0226    99.273  304.73
  25   0.0334     98.940  0.0211    99.265  317.39
  26   0.0416     98.610  0.0209    99.330  329.97
  27   0.0271     99.080  0.0198    99.338  342.53
  28   0.0231     99.270  0.0174    99.420  355.09
  29   0.0270     99.130  0.0189    99.387  367.65
  30   0.0296     99.010  0.0168    99.448  380.25
  31   0.0359     98.810  0.0169    99.445  392.81
  32   0.0315     98.920  0.0166    99.472  405.37
  33   0.0247     99.230  0.0160    99.483  417.92
  34   0.0319     99.020  0.0164    99.463  430.48
  35   0.0307     99.020  0.0151    99.523  443.17
  36   0.0329     98.940  0.0156    99.507  455.73
  37   0.0334     98.880  0.0158    99.460  468.29
  38   0.0242     99.170  0.0145    99.497  480.97
  39   0.0318     98.930  0.0139    99.547  493.55
  40   0.0299     99.100  0.0118    99.603  506.11
  41   0.0270     99.100  0.0118    99.603  518.80
  42   0.0284     99.020  0.0114    99.638  531.36
  43   0.0296     98.960  0.0121    99.605  543.94
  44   0.0314     98.990  0.0118    99.605  556.51
  45   0.0342     98.950  0.0100    99.677  569.08
  46   0.0374     98.900  0.0105    99.682  581.64
  47   0.0287     99.100  0.0099    99.697  594.22
  48   0.0275     99.170  0.0096    99.735  606.87
  49   0.0268     99.090  0.0092    99.702  619.44
  50   0.0241     99.160  0.0087    99.735  632.01
  51   0.0239     99.260  0.0087    99.730  644.68
  52   0.0256     99.210  0.0082    99.738  657.21
  53   0.0288     99.100  0.0078    99.753  669.77
  54   0.0301     99.030  0.0078    99.768  682.34
  55   0.0292     99.110  0.0072    99.782  695.00
  56   0.0274     99.010  0.0071    99.782  707.58
  57   0.0335     98.930  0.0068    99.787  720.14
  58   0.0277     99.130  0.0065    99.808  732.68
  59   0.0283     99.210  0.0063    99.817  745.41
  60   0.0233     99.230  0.0065    99.785  757.99
  61   0.0327     99.010  0.0061    99.822  770.56
  62   0.0291     99.140  0.0060    99.825  783.23
  63   0.0263     99.170  0.0051    99.863  795.81
  64   0.0247     99.290  0.0051    99.858  808.37
  65   0.0256     99.200  0.0052    99.847  820.94
  66   0.0328     98.940  0.0046    99.875  833.49
  67   0.0282     99.070  0.0043    99.883  846.07
  68   0.0314     99.040  0.0042    99.880  858.65
  69   0.0281     99.090  0.0041    99.882  871.33
  70   0.0262     99.130  0.0040    99.898  883.88
  71   0.0249     99.180  0.0041    99.882  896.45
  72   0.0290     99.080  0.0037    99.907  909.18
  73   0.0258     99.180  0.0036    99.900  921.74
  74   0.0278     99.110  0.0036    99.922  934.31
  75   0.0300     99.120  0.0033    99.922  946.97
  76   0.0290     99.130  0.0032    99.920  959.55
  77   0.0282     99.170  0.0033    99.920  972.10
  78   0.0261     99.250  0.0032    99.912  984.76
  79   0.0263     99.170  0.0032    99.913  997.29
  80   0.0251     99.210  0.0034    99.920  1009.86
  81   0.0292     99.140  0.0029    99.935  1022.40
  82   0.0272     99.140  0.0026    99.937  1034.97
  83   0.0298     99.130  0.0029    99.927  1047.50
  84   0.0287     99.120  0.0028    99.933  1060.13
  85   0.0312     99.090  0.0027    99.933  1072.69
