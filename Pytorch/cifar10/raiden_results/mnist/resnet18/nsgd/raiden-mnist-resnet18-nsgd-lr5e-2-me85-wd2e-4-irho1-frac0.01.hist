Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1204     96.170  0.4321    85.588  14.70
   2   0.0797     97.320  0.0913    97.127  27.13
   3   0.0709     97.790  0.0663    97.948  39.50
   4   0.0737     97.670  0.0572    98.212  51.88
   5   0.0466     98.480  0.0505    98.410  64.24
   6   0.0473     98.460  0.0470    98.500  76.61
   7   0.0486     98.350  0.0422    98.650  88.97
   8   0.0453     98.550  0.0378    98.780  101.31
   9   0.0463     98.620  0.0382    98.767  113.69
  10   0.0579     98.140  0.0363    98.840  126.14
  11   0.0617     98.030  0.0341    98.903  138.54
  12   0.0721     97.660  0.0323    98.955  150.86
  13   0.0338     98.910  0.0324    98.947  163.20
  14   0.0401     98.680  0.0310    98.990  175.55
  15   0.0408     98.820  0.0301    98.987  187.86
  16   0.0500     98.380  0.0281    99.072  200.17
  17   0.0361     98.870  0.0265    99.112  212.64
  18   0.0449     98.530  0.0277    99.117  224.98
  19   0.0412     98.720  0.0256    99.172  237.32
  20   0.0350     98.870  0.0248    99.177  249.75
  21   0.0526     98.210  0.0239    99.230  262.05
  22   0.0412     98.690  0.0252    99.205  274.39
  23   0.0348     98.940  0.0230    99.277  286.70
  24   0.0353     98.770  0.0223    99.257  299.05
  25   0.0359     98.830  0.0227    99.258  311.37
  26   0.0409     98.700  0.0225    99.273  323.70
  27   0.0337     98.940  0.0209    99.320  336.15
  28   0.0303     99.010  0.0205    99.317  348.49
  29   0.0398     98.630  0.0191    99.345  360.82
  30   0.0302     99.010  0.0204    99.293  373.27
  31   0.0282     99.070  0.0196    99.338  385.57
  32   0.0328     98.850  0.0182    99.395  397.88
  33   0.0337     98.980  0.0172    99.435  410.23
  34   0.0347     98.800  0.0176    99.422  422.60
  35   0.0369     98.860  0.0180    99.392  434.93
  36   0.0317     98.990  0.0162    99.473  447.26
  37   0.0373     98.830  0.0155    99.488  459.59
  38   0.0243     99.160  0.0157    99.480  472.01
  39   0.0364     98.910  0.0140    99.543  484.34
  40   0.0300     99.120  0.0145    99.512  496.68
  41   0.0354     98.800  0.0142    99.518  508.99
  42   0.0328     98.970  0.0134    99.582  521.31
  43   0.0405     98.750  0.0134    99.547  533.65
  44   0.0266     99.120  0.0130    99.592  546.01
  45   0.0331     98.900  0.0126    99.598  558.35
  46   0.0285     99.150  0.0114    99.637  570.69
  47   0.0265     99.260  0.0109    99.650  583.02
  48   0.0262     99.150  0.0101    99.702  595.44
  49   0.0306     99.000  0.0090    99.695  607.77
  50   0.0268     99.220  0.0098    99.705  620.09
  51   0.0323     99.100  0.0090    99.690  632.45
  52   0.0382     98.940  0.0083    99.728  644.77
  53   0.0275     99.230  0.0083    99.742  657.10
  54   0.0280     99.150  0.0080    99.735  669.56
  55   0.0271     99.210  0.0080    99.753  681.87
  56   0.0272     99.210  0.0066    99.807  694.22
  57   0.0263     99.260  0.0060    99.818  706.55
  58   0.0321     99.040  0.0065    99.805  719.03
  59   0.0270     99.210  0.0057    99.827  731.38
  60   0.0274     99.200  0.0051    99.840  743.71
  61   0.0259     99.280  0.0052    99.848  756.17
  62   0.0251     99.290  0.0050    99.848  768.52
  63   0.0251     99.250  0.0047    99.862  780.85
  64   0.0282     99.150  0.0041    99.868  793.32
  65   0.0241     99.190  0.0039    99.893  805.66
  66   0.0275     99.210  0.0040    99.902  817.99
  67   0.0288     99.160  0.0034    99.917  830.44
  68   0.0269     99.160  0.0031    99.928  842.78
  69   0.0256     99.190  0.0028    99.938  855.06
  70   0.0282     99.130  0.0027    99.942  867.41
  71   0.0311     99.090  0.0029    99.937  879.74
  72   0.0266     99.200  0.0027    99.922  892.05
  73   0.0285     99.160  0.0025    99.935  904.36
  74   0.0306     99.080  0.0022    99.960  916.82
  75   0.0286     99.170  0.0026    99.940  929.17
  76   0.0291     99.150  0.0021    99.955  941.50
  77   0.0270     99.160  0.0020    99.968  953.82
  78   0.0287     99.140  0.0020    99.962  966.16
  79   0.0298     99.120  0.0018    99.968  978.50
  80   0.0302     99.120  0.0019    99.965  990.81
  81   0.0311     99.060  0.0018    99.972  1003.15
  82   0.0294     99.130  0.0020    99.953  1015.50
  83   0.0295     99.100  0.0018    99.962  1027.80
  84   0.0299     99.120  0.0017    99.973  1040.14
  85   0.0286     99.120  0.0018    99.965  1052.43
