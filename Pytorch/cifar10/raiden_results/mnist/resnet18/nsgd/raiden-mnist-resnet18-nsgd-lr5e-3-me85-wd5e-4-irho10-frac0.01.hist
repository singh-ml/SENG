Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7850115072 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.8382     83.280  0.4577    85.365  19.71
   2   0.2715     91.600  0.0912    97.123  32.83
   3   0.0786     97.270  0.0675    97.893  45.83
   4   0.1052     96.560  0.0583    98.157  58.83
   5   0.0661     97.880  0.0517    98.420  71.80
   6   0.0458     98.420  0.0463    98.587  84.90
   7   0.0573     98.160  0.0421    98.683  97.88
   8   0.0716     97.650  0.0407    98.713  110.85
   9   0.0371     98.760  0.0372    98.848  123.86
  10   0.0502     98.390  0.0349    98.868  136.88
  11   0.0338     98.900  0.0320    98.957  149.91
  12   0.0358     98.780  0.0307    99.015  163.02
  13   0.0352     98.940  0.0309    99.002  176.04
  14   0.0693     97.820  0.0284    99.077  189.00
  15   0.0380     98.710  0.0281    99.082  202.00
  16   0.0387     98.730  0.0266    99.095  215.01
  17   0.0477     98.500  0.0258    99.125  228.02
  18   0.0395     98.750  0.0262    99.152  241.01
  19   0.0310     98.970  0.0238    99.202  254.19
  20   0.0511     98.240  0.0219    99.300  267.19
  21   0.0367     98.830  0.0219    99.273  280.21
  22   0.0486     98.320  0.0214    99.285  293.30
  23   0.0419     98.710  0.0218    99.295  306.32
  24   0.0267     99.110  0.0204    99.327  319.33
  25   0.0239     99.190  0.0193    99.367  332.46
  26   0.0313     99.080  0.0188    99.362  345.46
  27   0.0291     99.110  0.0185    99.365  358.44
  28   0.0312     98.950  0.0180    99.418  371.57
  29   0.0380     98.890  0.0162    99.450  384.57
  30   0.0303     99.010  0.0182    99.395  397.59
  31   0.0289     98.990  0.0147    99.520  410.72
  32   0.0345     98.770  0.0149    99.477  423.72
  33   0.0277     99.040  0.0143    99.542  436.73
  34   0.0234     99.130  0.0150    99.490  449.85
  35   0.0301     99.000  0.0142    99.545  462.84
  36   0.0333     98.970  0.0134    99.553  475.87
  37   0.0256     99.150  0.0129    99.558  489.00
  38   0.0260     99.100  0.0128    99.568  502.02
  39   0.0232     99.160  0.0127    99.572  515.01
  40   0.0289     99.020  0.0119    99.597  528.04
  41   0.0242     99.220  0.0112    99.635  541.08
  42   0.0227     99.350  0.0093    99.667  554.08
  43   0.0355     98.960  0.0101    99.675  567.12
  44   0.0286     99.090  0.0101    99.667  580.13
  45   0.0236     99.290  0.0098    99.673  593.15
  46   0.0315     99.070  0.0086    99.683  606.16
  47   0.0251     99.330  0.0085    99.697  619.17
  48   0.0291     99.120  0.0087    99.725  632.15
  49   0.0368     98.900  0.0089    99.680  645.16
  50   0.0261     99.260  0.0085    99.710  658.19
  51   0.0308     99.200  0.0076    99.765  671.21
  52   0.0271     99.140  0.0071    99.767  684.23
  53   0.0290     99.130  0.0076    99.743  697.30
  54   0.0319     99.100  0.0076    99.737  710.33
  55   0.0252     99.250  0.0066    99.767  723.34
  56   0.0331     98.980  0.0066    99.785  736.30
  57   0.0311     99.110  0.0065    99.785  749.34
  58   0.0283     99.250  0.0062    99.783  762.37
  59   0.0260     99.260  0.0050    99.835  775.37
  60   0.0319     99.120  0.0051    99.832  788.40
  61   0.0357     98.940  0.0047    99.847  801.41
  62   0.0306     99.170  0.0051    99.838  814.42
  63   0.0284     99.250  0.0044    99.863  827.44
  64   0.0340     98.990  0.0043    99.852  840.48
  65   0.0295     99.140  0.0042    99.850  853.62
  66   0.0328     99.080  0.0042    99.873  866.66
  67   0.0298     99.170  0.0039    99.882  879.68
  68   0.0299     99.140  0.0039    99.880  892.83
  69   0.0279     99.220  0.0041    99.863  905.86
  70   0.0321     99.060  0.0034    99.890  918.85
  71   0.0283     99.210  0.0034    99.888  931.95
  72   0.0298     99.150  0.0038    99.875  944.96
  73   0.0322     99.110  0.0034    99.890  957.98
  74   0.0316     99.190  0.0030    99.895  971.08
  75   0.0314     99.150  0.0028    99.915  984.07
  76   0.0289     99.140  0.0030    99.912  997.10
  77   0.0333     99.140  0.0034    99.895  1010.21
  78   0.0326     99.100  0.0029    99.905  1023.23
  79   0.0284     99.220  0.0022    99.928  1036.25
  80   0.0263     99.230  0.0023    99.927  1049.38
  81   0.0309     99.100  0.0022    99.950  1062.43
  82   0.0318     99.200  0.0026    99.925  1075.46
  83   0.0332     99.060  0.0023    99.937  1088.45
  84   0.0341     99.140  0.0024    99.922  1101.50
  85   0.0302     99.200  0.0023    99.935  1114.61
