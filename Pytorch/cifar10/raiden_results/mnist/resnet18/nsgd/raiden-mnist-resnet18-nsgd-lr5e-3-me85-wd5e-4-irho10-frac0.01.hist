Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1451     95.640  0.4512    85.313  14.62
   2   0.0633     97.820  0.0898    97.212  26.96
   3   0.0741     97.740  0.0657    97.895  39.30
   4   0.0517     98.350  0.0564    98.250  51.66
   5   0.0580     98.050  0.0489    98.437  63.99
   6   0.0362     98.790  0.0443    98.565  76.32
   7   0.0483     98.240  0.0411    98.682  88.72
   8   0.0296     99.020  0.0379    98.803  101.02
   9   0.0598     98.080  0.0368    98.813  113.37
  10   0.0355     98.950  0.0334    98.913  125.70
  11   0.0386     98.640  0.0322    98.967  138.01
  12   0.0284     99.140  0.0320    98.970  150.35
  13   0.0442     98.560  0.0304    98.977  162.69
  14   0.0264     99.110  0.0293    99.057  175.13
  15   0.0275     99.060  0.0276    99.080  187.46
  16   0.0443     98.450  0.0275    99.097  199.79
  17   0.0411     98.790  0.0249    99.160  212.27
  18   0.0383     98.720  0.0258    99.150  224.60
  19   0.0367     98.860  0.0235    99.207  236.92
  20   0.0312     98.970  0.0216    99.272  249.28
  21   0.0290     99.110  0.0225    99.223  261.77
  22   0.0270     99.070  0.0224    99.227  274.09
  23   0.0342     98.850  0.0207    99.312  286.42
  24   0.0241     99.120  0.0200    99.333  298.75
  25   0.0239     99.160  0.0200    99.332  311.06
  26   0.0230     99.160  0.0181    99.442  323.42
  27   0.0330     98.820  0.0193    99.382  335.88
  28   0.0333     98.980  0.0169    99.453  348.21
  29   0.0326     98.970  0.0161    99.462  360.54
  30   0.0267     99.170  0.0162    99.468  373.01
  31   0.0241     99.180  0.0150    99.507  385.35
  32   0.0252     99.200  0.0149    99.488  397.70
  33   0.0251     99.110  0.0143    99.518  410.13
  34   0.0246     99.240  0.0150    99.503  422.45
  35   0.0281     99.080  0.0138    99.503  434.81
  36   0.0289     99.010  0.0137    99.550  447.19
  37   0.0301     99.020  0.0140    99.515  459.61
  38   0.0305     98.940  0.0122    99.600  471.95
  39   0.0280     99.020  0.0119    99.612  484.30
  40   0.0283     99.120  0.0128    99.568  496.75
  41   0.0252     99.210  0.0109    99.625  509.09
  42   0.0285     98.990  0.0103    99.658  521.41
  43   0.0353     98.960  0.0108    99.642  533.84
  44   0.0385     98.780  0.0097    99.642  546.18
  45   0.0260     99.100  0.0087    99.722  558.50
  46   0.0262     99.180  0.0101    99.630  570.84
  47   0.0372     98.830  0.0089    99.712  583.21
  48   0.0254     99.110  0.0094    99.657  595.54
  49   0.0240     99.150  0.0083    99.730  607.90
  50   0.0238     99.260  0.0083    99.720  620.21
  51   0.0283     99.140  0.0073    99.757  632.57
  52   0.0276     99.060  0.0078    99.725  644.92
  53   0.0297     99.030  0.0071    99.780  657.36
  54   0.0365     98.930  0.0077    99.738  669.70
  55   0.0286     99.110  0.0065    99.782  682.05
  56   0.0307     99.070  0.0061    99.805  694.49
  57   0.0301     99.090  0.0060    99.805  706.83
  58   0.0272     99.220  0.0061    99.805  719.17
  59   0.0325     99.110  0.0059    99.822  731.52
  60   0.0283     99.110  0.0058    99.803  743.97
  61   0.0314     99.050  0.0048    99.843  756.30
  62   0.0310     99.080  0.0050    99.838  768.67
  63   0.0270     99.170  0.0048    99.860  781.13
  64   0.0299     99.130  0.0045    99.848  793.46
  65   0.0333     99.040  0.0044    99.858  805.80
  66   0.0261     99.230  0.0040    99.882  818.24
  67   0.0305     99.070  0.0043    99.868  830.58
  68   0.0294     99.060  0.0035    99.900  842.90
  69   0.0303     99.070  0.0032    99.910  855.24
  70   0.0285     99.170  0.0039    99.877  867.81
  71   0.0289     99.200  0.0033    99.897  880.17
  72   0.0298     99.100  0.0035    99.900  892.50
  73   0.0329     98.990  0.0034    99.893  904.83
  74   0.0297     99.130  0.0033    99.893  917.13
  75   0.0297     99.130  0.0031    99.902  929.46
  76   0.0323     99.090  0.0029    99.912  941.91
  77   0.0327     99.150  0.0022    99.935  954.24
  78   0.0312     99.120  0.0029    99.908  966.60
  79   0.0333     99.100  0.0027    99.928  979.10
  80   0.0347     99.120  0.0027    99.915  991.43
  81   0.0316     99.070  0.0025    99.918  1003.78
  82   0.0319     99.090  0.0023    99.932  1016.24
  83   0.0318     99.040  0.0025    99.937  1028.55
  84   0.0324     99.130  0.0023    99.932  1040.89
  85   0.0361     99.030  0.0020    99.955  1053.27
