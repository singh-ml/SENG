Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.1239     62.760  1.9461    38.400  14.67
   2   0.2206     93.250  0.2937    90.428  27.19
   3   0.0918     97.000  0.1429    95.585  39.85
   4   0.0740     97.620  0.1032    96.848  52.43
   5   0.0630     97.860  0.0828    97.387  64.95
   6   0.0848     97.460  0.0700    97.895  77.53
   7   0.0817     97.620  0.0639    98.050  90.05
   8   0.0446     98.250  0.0591    98.155  102.58
   9   0.0506     98.190  0.0540    98.315  115.09
  10   0.0471     98.400  0.0519    98.332  127.60
  11   0.0644     97.700  0.0494    98.455  140.11
  12   0.0491     98.310  0.0445    98.603  152.64
  13   0.0444     98.380  0.0415    98.645  165.18
  14   0.0431     98.520  0.0418    98.678  177.71
  15   0.0467     98.310  0.0390    98.752  190.25
  16   0.0449     98.390  0.0371    98.763  202.79
  17   0.0468     98.520  0.0357    98.837  215.31
  18   0.0546     98.190  0.0356    98.893  227.82
  19   0.0323     98.930  0.0328    98.987  240.42
  20   0.0483     98.390  0.0321    98.998  252.96
  21   0.0399     98.740  0.0314    98.970  265.50
  22   0.0434     98.510  0.0283    99.125  278.16
  23   0.0348     98.870  0.0283    99.075  290.66
  24   0.0481     98.520  0.0276    99.107  303.19
  25   0.0408     98.670  0.0268    99.123  315.73
  26   0.0410     98.690  0.0280    99.115  328.24
  27   0.0368     98.800  0.0246    99.210  340.75
  28   0.0330     98.920  0.0249    99.160  353.27
  29   0.0299     99.120  0.0238    99.215  365.87
  30   0.0401     98.710  0.0232    99.238  378.40
  31   0.0296     99.030  0.0232    99.208  390.94
  32   0.0289     99.040  0.0217    99.300  403.56
  33   0.0296     99.100  0.0215    99.323  416.07
  34   0.0361     98.810  0.0199    99.353  428.56
  35   0.0293     99.000  0.0191    99.355  441.18
  36   0.0383     98.750  0.0188    99.377  453.66
  37   0.0386     98.780  0.0181    99.388  466.18
  38   0.0300     99.060  0.0182    99.380  478.79
  39   0.0308     99.100  0.0171    99.442  491.30
  40   0.0340     98.960  0.0158    99.455  503.82
  41   0.0238     99.220  0.0167    99.423  516.37
  42   0.0340     98.970  0.0158    99.497  528.88
  43   0.0271     99.140  0.0152    99.517  541.40
  44   0.0312     99.020  0.0146    99.503  553.94
  45   0.0239     99.250  0.0133    99.538  566.43
  46   0.0274     99.130  0.0138    99.552  578.93
  47   0.0376     98.870  0.0133    99.570  591.46
  48   0.0249     99.210  0.0122    99.590  604.08
  49   0.0238     99.280  0.0116    99.612  616.60
  50   0.0289     99.060  0.0107    99.647  629.12
  51   0.0323     98.880  0.0112    99.642  641.76
  52   0.0245     99.250  0.0109    99.653  654.26
  53   0.0312     98.890  0.0102    99.657  666.77
  54   0.0298     99.060  0.0098    99.682  679.30
  55   0.0358     98.790  0.0092    99.703  691.82
  56   0.0293     99.040  0.0088    99.720  704.34
  57   0.0274     99.100  0.0086    99.725  717.00
  58   0.0300     99.130  0.0082    99.732  729.50
  59   0.0291     99.140  0.0079    99.753  742.03
  60   0.0247     99.220  0.0072    99.770  754.69
  61   0.0291     98.990  0.0071    99.775  767.19
  62   0.0266     99.190  0.0067    99.777  779.75
  63   0.0277     99.200  0.0062    99.803  792.26
  64   0.0281     99.090  0.0063    99.785  804.79
  65   0.0271     99.150  0.0060    99.813  817.31
  66   0.0277     99.150  0.0062    99.812  829.84
  67   0.0284     99.040  0.0056    99.828  842.43
  68   0.0295     99.050  0.0051    99.843  854.91
  69   0.0294     99.160  0.0050    99.845  867.43
  70   0.0278     99.090  0.0049    99.867  879.97
  71   0.0303     99.050  0.0045    99.890  892.52
  72   0.0292     99.040  0.0048    99.855  905.05
  73   0.0308     99.060  0.0045    99.872  917.73
  74   0.0297     99.100  0.0046    99.863  930.29
  75   0.0320     99.010  0.0045    99.873  942.87
  76   0.0299     99.100  0.0046    99.865  955.50
  77   0.0295     99.060  0.0041    99.875  968.08
  78   0.0300     99.050  0.0041    99.878  980.60
  79   0.0288     99.150  0.0039    99.902  993.12
  80   0.0294     99.050  0.0038    99.892  1005.64
  81   0.0295     99.080  0.0037    99.890  1018.17
  82   0.0298     99.090  0.0040    99.878  1030.80
  83   0.0294     99.060  0.0038    99.895  1043.34
  84   0.0298     99.060  0.0037    99.912  1055.87
  85   0.0301     99.090  0.0034    99.920  1068.39
