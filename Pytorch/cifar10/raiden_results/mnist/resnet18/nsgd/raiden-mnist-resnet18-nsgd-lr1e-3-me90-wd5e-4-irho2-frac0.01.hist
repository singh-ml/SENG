Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5520     82.960  1.4831    51.328  14.84
   2   0.3078     89.440  0.3921    88.430  27.43
   3   0.2497     92.230  0.2377    92.733  40.04
   4   0.1277     95.870  0.1785    94.533  52.61
   5   0.1213     96.360  0.1419    95.698  65.34
   6   0.1048     96.560  0.1198    96.370  77.91
   7   0.0877     97.340  0.1048    96.800  90.47
   8   0.0783     97.490  0.0907    97.273  103.06
   9   0.0737     97.650  0.0823    97.407  115.62
  10   0.0648     98.090  0.0760    97.627  128.19
  11   0.0654     97.880  0.0702    97.877  140.76
  12   0.0651     97.930  0.0640    97.970  153.34
  13   0.0670     97.860  0.0601    98.127  165.92
  14   0.0609     98.040  0.0560    98.257  178.62
  15   0.0568     98.060  0.0533    98.298  191.20
  16   0.0557     98.220  0.0515    98.368  203.79
  17   0.0514     98.370  0.0495    98.478  216.45
  18   0.0492     98.390  0.0468    98.520  229.02
  19   0.0493     98.400  0.0453    98.600  241.62
  20   0.0537     98.280  0.0437    98.618  254.20
  21   0.0478     98.550  0.0422    98.672  266.80
  22   0.0564     98.130  0.0411    98.702  279.36
  23   0.0554     98.280  0.0392    98.765  291.92
  24   0.0427     98.630  0.0384    98.785  304.58
  25   0.0528     98.230  0.0377    98.842  317.19
  26   0.0408     98.730  0.0358    98.852  329.76
  27   0.0422     98.660  0.0355    98.838  342.45
  28   0.0417     98.680  0.0353    98.875  355.01
  29   0.0408     98.680  0.0337    98.913  367.58
  30   0.0384     98.800  0.0341    98.928  380.26
  31   0.0399     98.730  0.0317    99.023  392.86
  32   0.0403     98.660  0.0318    99.003  405.40
  33   0.0411     98.740  0.0321    99.000  418.09
  34   0.0455     98.540  0.0306    99.028  430.67
  35   0.0458     98.550  0.0290    99.067  443.24
  36   0.0448     98.460  0.0295    99.082  455.84
  37   0.0471     98.480  0.0293    99.048  468.41
  38   0.0394     98.640  0.0294    99.095  481.05
  39   0.0374     98.690  0.0278    99.085  493.59
  40   0.0439     98.600  0.0268    99.163  506.19
  41   0.0347     98.890  0.0271    99.150  518.79
  42   0.0399     98.750  0.0259    99.132  531.37
  43   0.0406     98.670  0.0246    99.190  544.10
  44   0.0395     98.720  0.0255    99.187  556.69
  45   0.0392     98.680  0.0251    99.185  569.28
  46   0.0401     98.700  0.0239    99.237  581.86
  47   0.0356     98.780  0.0237    99.245  594.44
  48   0.0407     98.690  0.0233    99.250  607.04
  49   0.0425     98.540  0.0227    99.250  619.70
  50   0.0405     98.650  0.0226    99.298  632.28
  51   0.0412     98.570  0.0218    99.322  644.86
  52   0.0334     98.940  0.0220    99.303  657.60
  53   0.0330     98.950  0.0225    99.267  670.18
  54   0.0383     98.720  0.0208    99.312  682.77
  55   0.0369     98.740  0.0209    99.313  695.44
  56   0.0403     98.590  0.0214    99.293  708.00
  57   0.0382     98.740  0.0205    99.307  720.60
  58   0.0443     98.490  0.0205    99.322  733.19
  59   0.0390     98.720  0.0206    99.325  745.79
  60   0.0382     98.800  0.0200    99.347  758.37
  61   0.0318     98.970  0.0194    99.372  770.94
  62   0.0347     98.880  0.0201    99.325  783.52
  63   0.0345     98.920  0.0182    99.383  796.11
  64   0.0342     98.830  0.0187    99.393  808.68
  65   0.0380     98.820  0.0193    99.392  821.42
  66   0.0342     98.810  0.0173    99.427  834.03
  67   0.0413     98.670  0.0177    99.437  846.62
  68   0.0385     98.660  0.0176    99.433  859.19
  69   0.0389     98.750  0.0169    99.470  871.86
  70   0.0353     98.770  0.0183    99.413  884.44
  71   0.0463     98.490  0.0167    99.475  897.01
  72   0.0322     98.950  0.0167    99.460  909.62
  73   0.0356     98.820  0.0170    99.445  922.20
  74   0.0408     98.620  0.0163    99.457  934.79
  75   0.0400     98.840  0.0165    99.483  947.37
  76   0.0347     98.850  0.0157    99.483  959.97
  77   0.0304     99.060  0.0148    99.528  972.58
  78   0.0304     99.010  0.0164    99.460  985.13
  79   0.0315     98.930  0.0151    99.515  997.73
  80   0.0325     98.900  0.0147    99.515  1010.45
  81   0.0300     99.060  0.0145    99.490  1023.02
  82   0.0319     98.970  0.0146    99.515  1035.61
  83   0.0504     98.400  0.0143    99.545  1048.38
  84   0.0361     98.830  0.0146    99.513  1061.03
  85   0.0415     98.570  0.0148    99.513  1073.66
  86   0.0346     98.900  0.0141    99.567  1086.30
  87   0.0309     99.000  0.0140    99.555  1098.88
  88   0.0329     98.980  0.0139    99.548  1111.47
  89   0.0339     98.890  0.0140    99.520  1124.17
  90   0.0341     98.900  0.0134    99.582  1136.75
