Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2878     91.180  1.1093    66.985  14.62
   2   0.0862     97.350  0.1349    95.883  27.14
   3   0.1797     94.910  0.0859    97.370  39.74
   4   0.0966     96.700  0.0661    97.945  52.27
   5   0.0700     97.620  0.0604    98.115  64.80
   6   0.0453     98.520  0.0524    98.367  77.45
   7   0.0456     98.400  0.0490    98.487  89.96
   8   0.0542     98.200  0.0475    98.495  102.51
   9   0.0563     98.160  0.0451    98.582  115.13
  10   0.0445     98.550  0.0420    98.655  127.70
  11   0.0411     98.730  0.0421    98.617  140.25
  12   0.1061     96.770  0.0415    98.737  152.78
  13   0.0327     98.860  0.0400    98.748  165.32
  14   0.0796     97.470  0.0386    98.752  177.85
  15   0.0393     98.780  0.0362    98.873  190.36
  16   0.0924     97.270  0.0369    98.813  202.90
  17   0.0460     98.660  0.0349    98.895  215.44
  18   0.0432     98.540  0.0345    98.912  227.95
  19   0.0767     97.460  0.0333    98.945  240.62
  20   0.0299     99.060  0.0335    98.937  253.14
  21   0.0421     98.550  0.0344    98.942  265.70
  22   0.0538     98.240  0.0310    99.048  278.34
  23   0.0329     98.920  0.0316    99.030  290.89
  24   0.0410     98.510  0.0308    99.022  303.41
  25   0.0637     97.860  0.0334    98.928  316.10
  26   0.0440     98.620  0.0310    99.022  328.63
  27   0.0564     97.990  0.0315    98.962  341.17
  28   0.0353     98.890  0.0293    99.087  353.79
  29   0.0404     98.750  0.0286    99.100  366.30
  30   0.0357     98.870  0.0288    99.110  378.81
  31   0.0407     98.710  0.0272    99.128  391.32
  32   0.0339     98.810  0.0270    99.127  403.97
  33   0.0336     98.850  0.0268    99.177  416.49
  34   0.0333     98.890  0.0271    99.155  429.02
  35   0.0439     98.630  0.0252    99.220  441.59
  36   0.0351     98.820  0.0269    99.122  454.13
  37   0.0306     98.930  0.0258    99.183  466.65
  38   0.0256     99.160  0.0228    99.267  479.37
  39   0.0319     99.060  0.0247    99.237  491.89
  40   0.0345     98.880  0.0216    99.310  504.41
  41   0.0360     98.820  0.0221    99.305  517.08
  42   0.0370     98.750  0.0238    99.242  529.61
  43   0.0327     98.910  0.0201    99.370  542.14
  44   0.0290     99.110  0.0203    99.355  554.75
  45   0.0219     99.330  0.0199    99.383  567.30
  46   0.0286     99.040  0.0180    99.457  579.83
  47   0.0465     98.550  0.0203    99.342  592.47
  48   0.0372     98.680  0.0177    99.437  605.01
  49   0.0282     99.100  0.0171    99.455  617.53
  50   0.0333     99.030  0.0164    99.492  630.19
  51   0.0297     99.020  0.0153    99.502  642.73
  52   0.0259     99.070  0.0166    99.452  655.28
  53   0.0360     98.910  0.0162    99.462  667.94
  54   0.0344     98.960  0.0142    99.547  680.50
  55   0.0225     99.250  0.0138    99.538  693.02
  56   0.0275     99.130  0.0131    99.582  705.55
  57   0.0259     99.150  0.0108    99.660  718.08
  58   0.0202     99.220  0.0108    99.645  730.61
  59   0.0264     99.120  0.0113    99.650  743.14
  60   0.0250     99.190  0.0100    99.683  755.77
  61   0.0252     99.130  0.0094    99.710  768.32
  62   0.0280     99.150  0.0081    99.738  780.85
  63   0.0268     99.080  0.0071    99.783  793.48
  64   0.0257     99.190  0.0068    99.782  806.03
  65   0.0249     99.080  0.0067    99.792  818.56
  66   0.0239     99.210  0.0062    99.823  831.10
  67   0.0237     99.260  0.0058    99.838  843.77
  68   0.0248     99.230  0.0049    99.860  856.30
  69   0.0222     99.370  0.0048    99.872  868.96
  70   0.0264     99.200  0.0042    99.873  881.49
  71   0.0229     99.300  0.0040    99.893  894.02
  72   0.0251     99.270  0.0038    99.890  906.54
  73   0.0242     99.340  0.0032    99.923  919.07
  74   0.0272     99.230  0.0026    99.938  931.61
  75   0.0289     99.240  0.0027    99.932  944.12
  76   0.0267     99.200  0.0025    99.945  956.65
  77   0.0230     99.330  0.0024    99.947  969.22
  78   0.0237     99.260  0.0020    99.962  981.77
  79   0.0241     99.310  0.0019    99.968  994.33
  80   0.0281     99.200  0.0017    99.972  1006.89
  81   0.0244     99.310  0.0018    99.958  1019.44
  82   0.0239     99.320  0.0016    99.973  1032.21
  83   0.0282     99.270  0.0014    99.975  1044.80
  84   0.0267     99.300  0.0016    99.970  1057.34
  85   0.0269     99.260  0.0013    99.990  1070.05
