Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1805     93.580  0.4386    85.283  15.10
   2   0.1112     96.580  0.0922    97.085  27.56
   3   0.0764     97.400  0.0656    97.955  40.01
   4   0.0645     98.030  0.0575    98.170  52.41
   5   0.0623     98.060  0.0492    98.483  64.81
   6   0.0759     97.660  0.0453    98.618  77.25
   7   0.0494     98.450  0.0420    98.632  89.64
   8   0.0358     98.890  0.0388    98.727  102.02
   9   0.0338     98.840  0.0357    98.843  114.41
  10   0.0363     98.780  0.0335    98.923  126.91
  11   0.0492     98.380  0.0326    98.985  139.33
  12   0.0349     98.870  0.0300    99.020  151.72
  13   0.0363     98.870  0.0321    98.973  164.20
  14   0.0344     98.820  0.0296    99.053  176.59
  15   0.0418     98.530  0.0281    99.065  188.98
  16   0.0266     99.140  0.0271    99.093  201.40
  17   0.0450     98.560  0.0251    99.195  213.80
  18   0.0321     98.980  0.0255    99.148  226.17
  19   0.0293     99.070  0.0235    99.252  238.61
  20   0.0259     99.210  0.0250    99.180  251.02
  21   0.0285     99.030  0.0231    99.227  263.42
  22   0.0433     98.660  0.0215    99.260  275.85
  23   0.0194     99.340  0.0213    99.298  288.27
  24   0.0335     98.930  0.0216    99.283  300.66
  25   0.0285     99.110  0.0208    99.320  313.09
  26   0.0289     99.180  0.0193    99.377  325.59
  27   0.0336     98.830  0.0198    99.373  338.01
  28   0.0359     98.890  0.0186    99.390  350.43
  29   0.0285     99.040  0.0187    99.367  362.89
  30   0.0280     99.050  0.0168    99.452  375.30
  31   0.0322     98.850  0.0159    99.455  387.71
  32   0.0253     99.190  0.0160    99.470  400.13
  33   0.0282     99.090  0.0155    99.470  412.54
  34   0.0307     99.030  0.0146    99.518  424.97
  35   0.0420     98.670  0.0143    99.522  437.37
  36   0.0321     98.950  0.0146    99.502  449.78
  37   0.0315     99.110  0.0137    99.552  462.21
  38   0.0302     98.980  0.0130    99.578  474.62
  39   0.0407     98.660  0.0123    99.595  487.13
  40   0.0250     99.190  0.0124    99.570  499.55
  41   0.0291     99.040  0.0116    99.593  511.98
  42   0.0241     99.230  0.0108    99.653  524.50
  43   0.0367     98.910  0.0098    99.678  536.92
  44   0.0221     99.280  0.0098    99.675  549.36
  45   0.0274     99.030  0.0100    99.637  561.78
  46   0.0297     99.010  0.0100    99.672  574.19
  47   0.0286     99.020  0.0089    99.698  586.61
  48   0.0311     98.840  0.0082    99.740  599.00
  49   0.0334     99.040  0.0079    99.745  611.57
  50   0.0270     99.200  0.0075    99.742  623.99
  51   0.0311     98.960  0.0071    99.747  636.40
  52   0.0366     98.820  0.0073    99.738  648.80
  53   0.0244     99.160  0.0078    99.738  661.43
  54   0.0248     99.070  0.0061    99.798  673.84
  55   0.0252     99.200  0.0064    99.810  686.25
  56   0.0213     99.270  0.0062    99.805  698.65
  57   0.0307     99.070  0.0053    99.823  711.27
  58   0.0272     99.050  0.0059    99.815  723.70
  59   0.0240     99.250  0.0054    99.833  736.11
  60   0.0246     99.290  0.0052    99.837  748.64
  61   0.0253     99.170  0.0043    99.857  761.04
  62   0.0264     99.210  0.0043    99.857  773.45
  63   0.0278     99.140  0.0041    99.885  785.86
  64   0.0239     99.260  0.0038    99.880  798.42
  65   0.0270     99.160  0.0038    99.883  810.82
  66   0.0252     99.240  0.0037    99.890  823.17
  67   0.0279     99.210  0.0037    99.888  835.70
  68   0.0267     99.150  0.0031    99.918  848.09
  69   0.0300     99.170  0.0032    99.902  860.50
  70   0.0301     99.090  0.0028    99.930  872.91
  71   0.0314     99.090  0.0029    99.917  885.56
  72   0.0306     99.120  0.0029    99.925  897.97
  73   0.0316     99.150  0.0025    99.938  910.48
  74   0.0305     99.100  0.0023    99.947  922.88
  75   0.0294     99.160  0.0023    99.933  935.30
  76   0.0345     99.080  0.0021    99.945  947.71
  77   0.0302     99.130  0.0024    99.942  960.12
  78   0.0303     99.200  0.0021    99.947  972.55
  79   0.0324     99.090  0.0019    99.958  984.96
  80   0.0327     99.040  0.0021    99.957  997.37
  81   0.0307     99.160  0.0020    99.955  1009.78
  82   0.0333     99.050  0.0018    99.962  1022.20
  83   0.0317     99.090  0.0018    99.960  1034.68
  84   0.0292     99.150  0.0020    99.957  1047.11
  85   0.0300     99.130  0.0017    99.970  1059.53
