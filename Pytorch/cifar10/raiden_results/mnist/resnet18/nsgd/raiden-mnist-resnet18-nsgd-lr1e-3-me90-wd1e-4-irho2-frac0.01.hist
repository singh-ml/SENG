Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5380     84.580  1.4515    53.475  14.87
   2   0.3495     88.990  0.4027    88.023  27.61
   3   0.1815     94.400  0.2342    92.990  40.34
   4   0.1310     95.920  0.1684    94.873  52.98
   5   0.1539     95.030  0.1373    95.827  65.66
   6   0.0983     96.840  0.1149    96.468  78.31
   7   0.0871     97.220  0.1001    96.930  90.97
   8   0.0757     97.570  0.0901    97.178  103.60
   9   0.1268     95.900  0.0808    97.542  116.23
  10   0.0663     97.990  0.0750    97.667  128.87
  11   0.0649     97.780  0.0700    97.853  141.52
  12   0.0550     98.340  0.0666    97.975  154.14
  13   0.0630     97.990  0.0614    98.075  166.92
  14   0.0532     98.300  0.0585    98.137  179.53
  15   0.0633     97.870  0.0565    98.272  192.17
  16   0.0687     97.800  0.0542    98.282  204.92
  17   0.0529     98.390  0.0519    98.353  217.55
  18   0.0507     98.340  0.0503    98.445  230.19
  19   0.0454     98.430  0.0470    98.510  242.84
  20   0.0504     98.360  0.0456    98.545  255.66
  21   0.0471     98.420  0.0453    98.558  268.28
  22   0.0447     98.450  0.0441    98.587  280.93
  23   0.0415     98.620  0.0417    98.658  293.79
  24   0.0471     98.400  0.0422    98.670  306.45
  25   0.0418     98.630  0.0390    98.745  319.15
  26   0.0422     98.560  0.0394    98.788  331.78
  27   0.0395     98.720  0.0369    98.852  344.40
  28   0.0455     98.440  0.0370    98.820  357.03
  29   0.0403     98.620  0.0366    98.803  369.75
  30   0.0436     98.450  0.0354    98.855  382.36
  31   0.0396     98.710  0.0339    98.940  395.00
  32   0.0464     98.630  0.0347    98.890  407.59
  33   0.0422     98.670  0.0320    99.013  420.24
  34   0.0431     98.600  0.0330    98.953  432.90
  35   0.0442     98.630  0.0317    99.015  445.64
  36   0.0341     98.850  0.0301    99.012  458.27
  37   0.0397     98.700  0.0310    98.983  470.90
  38   0.0348     98.740  0.0305    99.010  483.53
  39   0.0412     98.620  0.0291    99.063  496.17
  40   0.0405     98.640  0.0279    99.147  508.82
  41   0.0416     98.540  0.0271    99.145  521.44
  42   0.0455     98.520  0.0277    99.090  534.08
  43   0.0394     98.690  0.0279    99.125  546.71
  44   0.0345     98.900  0.0269    99.117  559.35
  45   0.0343     98.810  0.0262    99.148  572.12
  46   0.0339     98.830  0.0265    99.183  584.76
  47   0.0433     98.600  0.0252    99.168  597.40
  48   0.0409     98.720  0.0251    99.168  610.04
  49   0.0344     98.910  0.0235    99.230  622.70
  50   0.0340     98.820  0.0244    99.205  635.35
  51   0.0418     98.680  0.0247    99.212  648.08
  52   0.0352     98.910  0.0240    99.208  660.71
  53   0.0335     98.920  0.0240    99.197  673.34
  54   0.0362     98.780  0.0220    99.293  686.08
  55   0.0425     98.740  0.0224    99.260  698.72
  56   0.0418     98.570  0.0216    99.295  711.35
  57   0.0379     98.750  0.0222    99.292  724.09
  58   0.0317     98.920  0.0213    99.320  736.73
  59   0.0367     98.700  0.0212    99.315  749.35
  60   0.0363     98.840  0.0224    99.250  761.98
  61   0.0336     98.960  0.0196    99.353  774.61
  62   0.0307     99.060  0.0202    99.345  787.25
  63   0.0410     98.610  0.0201    99.327  799.92
  64   0.0394     98.700  0.0199    99.380  812.56
  65   0.0375     98.810  0.0187    99.412  825.20
  66   0.0360     98.820  0.0183    99.443  837.86
  67   0.0351     98.880  0.0190    99.370  850.61
  68   0.0306     98.950  0.0191    99.375  863.24
  69   0.0359     98.840  0.0180    99.412  875.89
  70   0.0311     99.130  0.0189    99.362  888.61
  71   0.0332     98.860  0.0183    99.403  901.22
  72   0.0433     98.710  0.0184    99.382  913.83
  73   0.0322     98.870  0.0167    99.443  926.58
  74   0.0354     98.810  0.0180    99.387  939.21
  75   0.0351     98.880  0.0167    99.443  951.83
  76   0.0349     98.980  0.0171    99.427  964.56
  77   0.0304     98.960  0.0162    99.467  977.22
  78   0.0354     98.840  0.0165    99.482  989.85
  79   0.0297     99.100  0.0158    99.465  1002.50
  80   0.0371     98.960  0.0160    99.470  1015.10
  81   0.0313     98.970  0.0155    99.482  1027.74
  82   0.0376     98.800  0.0155    99.490  1040.38
  83   0.0337     98.930  0.0151    99.505  1053.06
  84   0.0337     99.000  0.0157    99.502  1065.72
  85   0.0252     99.110  0.0150    99.498  1078.38
  86   0.0411     98.800  0.0152    99.503  1091.15
  87   0.0296     99.070  0.0148    99.507  1103.77
  88   0.0373     98.770  0.0151    99.487  1116.42
  89   0.0352     98.880  0.0153    99.480  1129.06
  90   0.0403     98.750  0.0146    99.530  1141.76
