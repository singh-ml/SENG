Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.3085     66.620  1.8362    37.917  14.55
   2   0.5029     85.160  0.8290    77.807  26.92
   3   0.3197     89.950  0.3930    88.590  39.29
   4   0.2366     92.540  0.2878    91.533  51.66
   5   0.2827     90.750  0.2346    92.963  63.98
   6   0.1817     94.340  0.1993    93.960  76.32
   7   0.1453     95.600  0.1745    94.660  88.63
   8   0.1462     95.550  0.1572    95.175  100.95
   9   0.1212     96.310  0.1425    95.640  113.25
  10   0.1155     96.480  0.1283    96.087  125.59
  11   0.1069     96.630  0.1185    96.398  137.92
  12   0.1019     96.950  0.1096    96.670  150.23
  13   0.0944     97.000  0.1035    96.820  162.65
  14   0.1050     96.700  0.0971    96.990  174.97
  15   0.0811     97.370  0.0900    97.282  187.31
  16   0.0769     97.600  0.0855    97.410  199.66
  17   0.0890     97.040  0.0808    97.532  212.05
  18   0.0694     97.830  0.0776    97.665  224.40
  19   0.0666     97.850  0.0730    97.717  236.71
  20   0.0647     97.890  0.0701    97.835  249.07
  21   0.0760     97.600  0.0673    97.942  261.36
  22   0.0678     97.730  0.0638    98.083  273.68
  23   0.0632     98.040  0.0624    98.052  286.12
  24   0.0660     97.840  0.0608    98.145  298.48
  25   0.0582     98.190  0.0590    98.120  310.82
  26   0.0562     98.190  0.0570    98.262  323.29
  27   0.0611     98.030  0.0550    98.302  335.59
  28   0.0519     98.350  0.0524    98.390  347.94
  29   0.0599     97.990  0.0515    98.380  360.37
  30   0.0551     98.240  0.0505    98.427  372.71
  31   0.0455     98.550  0.0499    98.445  385.07
  32   0.0518     98.310  0.0486    98.470  397.43
  33   0.0500     98.360  0.0475    98.572  409.76
  34   0.0505     98.440  0.0467    98.597  422.08
  35   0.0526     98.280  0.0455    98.602  434.41
  36   0.0440     98.620  0.0448    98.628  446.73
  37   0.0502     98.340  0.0428    98.618  459.01
  38   0.0455     98.470  0.0423    98.660  471.30
  39   0.0511     98.480  0.0417    98.735  483.62
  40   0.0482     98.450  0.0417    98.697  496.06
  41   0.0448     98.460  0.0397    98.800  508.38
  42   0.0427     98.490  0.0396    98.760  520.70
  43   0.0432     98.570  0.0391    98.763  533.04
  44   0.0442     98.600  0.0383    98.790  545.34
  45   0.0488     98.390  0.0379    98.823  557.68
  46   0.0489     98.390  0.0366    98.838  570.01
  47   0.0440     98.470  0.0356    98.873  582.46
  48   0.0444     98.530  0.0354    98.852  594.77
  49   0.0436     98.420  0.0352    98.930  607.10
  50   0.0413     98.690  0.0349    98.913  619.41
  51   0.0393     98.730  0.0336    98.982  631.86
  52   0.0359     98.840  0.0327    98.965  644.19
  53   0.0438     98.540  0.0333    98.940  656.51
  54   0.0375     98.710  0.0334    98.950  668.97
  55   0.0421     98.590  0.0329    98.948  681.30
  56   0.0460     98.480  0.0318    99.002  693.64
  57   0.0518     98.260  0.0316    99.023  705.97
  58   0.0380     98.690  0.0313    99.008  718.27
  59   0.0431     98.570  0.0300    99.060  730.59
  60   0.0417     98.640  0.0305    99.025  742.90
  61   0.0443     98.510  0.0307    99.028  755.23
  62   0.0398     98.730  0.0297    99.043  767.57
  63   0.0340     98.820  0.0298    99.090  779.89
  64   0.0355     98.870  0.0286    99.108  792.35
  65   0.0377     98.670  0.0293    99.053  804.68
  66   0.0397     98.710  0.0274    99.122  817.01
  67   0.0411     98.570  0.0285    99.130  829.48
  68   0.0368     98.730  0.0280    99.102  841.80
  69   0.0390     98.700  0.0280    99.117  854.09
  70   0.0361     98.730  0.0276    99.142  866.38
  71   0.0426     98.420  0.0264    99.145  878.70
  72   0.0429     98.610  0.0268    99.150  891.00
  73   0.0349     98.830  0.0261    99.200  903.33
  74   0.0427     98.510  0.0264    99.188  915.80
  75   0.0380     98.710  0.0262    99.170  928.12
  76   0.0338     98.830  0.0250    99.198  940.47
  77   0.0428     98.600  0.0254    99.183  952.91
  78   0.0339     98.890  0.0252    99.148  965.28
  79   0.0327     98.870  0.0250    99.182  977.60
  80   0.0402     98.580  0.0244    99.240  989.94
  81   0.0355     98.730  0.0233    99.245  1002.51
  82   0.0337     98.910  0.0232    99.263  1014.82
  83   0.0355     98.780  0.0236    99.270  1027.14
  84   0.0355     98.730  0.0233    99.235  1039.47
  85   0.0387     98.620  0.0234    99.243  1051.79
  86   0.0420     98.470  0.0233    99.307  1064.09
  87   0.0334     98.890  0.0221    99.302  1076.53
  88   0.0380     98.770  0.0222    99.293  1088.84
  89   0.0373     98.620  0.0220    99.278  1101.18
  90   0.0336     98.810  0.0225    99.295  1113.62
