Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4162     86.570  0.8946    76.027  14.54
   2   0.1090     96.710  0.1216    96.232  27.07
   3   0.0853     97.300  0.0818    97.388  39.51
   4   0.0851     97.250  0.0700    97.860  51.95
   5   0.0716     97.640  0.0627    98.002  64.37
   6   0.0634     97.700  0.0556    98.237  76.95
   7   0.0504     98.550  0.0527    98.338  89.36
   8   0.0717     97.790  0.0527    98.352  101.75
   9   0.0671     97.770  0.0533    98.340  114.30
  10   0.0459     98.560  0.0514    98.413  126.71
  11   0.1098     96.470  0.0478    98.537  139.14
  12   0.0673     97.800  0.0487    98.475  151.70
  13   0.0840     97.390  0.0466    98.573  164.11
  14   0.0402     98.730  0.0466    98.592  176.54
  15   0.0604     98.170  0.0459    98.582  189.08
  16   0.1027     97.100  0.0464    98.518  201.48
  17   0.0353     98.940  0.0477    98.532  213.93
  18   0.4813     85.410  0.0458    98.608  226.36
  19   0.0718     97.770  0.0424    98.688  239.00
  20   0.0301     99.050  0.0458    98.547  251.41
  21   0.0498     98.310  0.0453    98.575  263.82
  22   0.0456     98.640  0.0420    98.732  276.21
  23   0.0709     97.490  0.0452    98.623  288.60
  24   0.0474     98.310  0.0437    98.615  301.00
  25   0.0525     98.180  0.0402    98.725  313.53
  26   0.0387     98.840  0.0430    98.735  325.89
  27   0.0437     98.510  0.0418    98.707  338.25
  28   0.0943     96.950  0.0421    98.695  350.79
  29   0.0683     97.930  0.0408    98.693  363.17
  30   0.0428     98.600  0.0388    98.810  375.55
  31   0.0503     98.290  0.0399    98.770  387.97
  32   0.0457     98.590  0.0357    98.883  400.39
  33   0.0427     98.670  0.0366    98.893  412.79
  34   0.0544     98.310  0.0389    98.817  425.20
  35   0.0303     99.010  0.0364    98.878  437.61
  36   0.0446     98.560  0.0369    98.868  450.03
  37   0.0364     98.850  0.0347    98.972  462.42
  38   0.0360     98.910  0.0360    98.843  474.95
  39   0.0438     98.530  0.0337    98.947  487.35
  40   0.0738     97.670  0.0354    98.887  499.73
  41   0.0754     97.530  0.0311    99.028  512.24
  42   0.0438     98.540  0.0324    99.013  524.66
  43   0.0562     98.160  0.0324    98.962  537.09
  44   0.0302     99.040  0.0309    99.053  549.49
  45   0.0413     98.720  0.0306    99.067  561.86
  46   0.0442     98.590  0.0304    99.055  574.30
  47   0.0404     98.650  0.0293    99.108  586.71
  48   0.0597     98.160  0.0278    99.167  599.26
  49   0.0294     99.000  0.0297    99.092  611.69
  50   0.0463     98.530  0.0248    99.232  624.09
  51   0.0350     98.860  0.0252    99.257  636.64
  52   0.0409     98.700  0.0253    99.187  649.03
  53   0.0271     99.050  0.0249    99.237  661.47
  54   0.0306     99.000  0.0228    99.313  674.02
  55   0.0354     98.870  0.0230    99.348  686.45
  56   0.0379     98.860  0.0225    99.288  698.85
  57   0.0336     98.850  0.0217    99.308  711.26
  58   0.0367     98.750  0.0218    99.368  723.65
  59   0.0255     99.160  0.0200    99.408  736.05
  60   0.0263     99.280  0.0182    99.435  748.45
  61   0.0271     99.040  0.0195    99.400  760.89
  62   0.0211     99.330  0.0180    99.445  773.30
  63   0.0323     98.990  0.0163    99.522  785.72
  64   0.0271     99.070  0.0159    99.477  798.22
  65   0.0255     99.230  0.0139    99.567  810.67
  66   0.0247     99.120  0.0142    99.588  823.09
  67   0.0346     98.900  0.0135    99.620  835.58
  68   0.0269     99.140  0.0123    99.620  848.00
  69   0.0235     99.270  0.0122    99.625  860.39
  70   0.0344     98.890  0.0100    99.725  872.81
  71   0.0268     99.130  0.0104    99.700  885.18
  72   0.0244     99.280  0.0097    99.722  897.57
  73   0.0264     99.070  0.0083    99.758  909.98
  74   0.0256     99.170  0.0083    99.782  922.42
  75   0.0276     99.120  0.0080    99.780  934.83
  76   0.0256     99.170  0.0071    99.792  947.28
  77   0.0243     99.240  0.0065    99.852  959.83
  78   0.0225     99.290  0.0062    99.837  972.24
  79   0.0239     99.240  0.0054    99.853  984.62
  80   0.0245     99.220  0.0050    99.877  997.05
  81   0.0234     99.240  0.0044    99.888  1009.68
  82   0.0248     99.260  0.0039    99.913  1022.09
  83   0.0233     99.270  0.0038    99.907  1034.64
  84   0.0263     99.210  0.0038    99.927  1047.05
  85   0.0284     99.130  0.0033    99.937  1059.44
  86   0.0260     99.260  0.0033    99.940  1071.84
  87   0.0270     99.200  0.0033    99.940  1084.26
  88   0.0278     99.130  0.0030    99.935  1096.66
  89   0.0276     99.220  0.0031    99.937  1109.09
  90   0.0266     99.220  0.0028    99.952  1121.60
