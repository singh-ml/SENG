Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1158     96.190  0.4663    83.937  14.76
   2   0.1423     95.400  0.0894    97.167  27.08
   3   0.0781     97.530  0.0697    97.798  39.40
   4   0.0711     97.680  0.0575    98.142  51.72
   5   0.0544     98.310  0.0513    98.395  64.02
   6   0.0657     97.950  0.0450    98.577  76.34
   7   0.0442     98.640  0.0416    98.693  88.65
   8   0.0550     98.350  0.0394    98.705  100.95
   9   0.0635     98.070  0.0363    98.882  113.26
  10   0.0489     98.490  0.0338    98.938  125.55
  11   0.0384     98.870  0.0339    98.863  137.99
  12   0.0312     98.920  0.0319    98.925  150.30
  13   0.0417     98.600  0.0303    98.993  162.63
  14   0.0402     98.670  0.0279    99.100  174.95
  15   0.0351     98.920  0.0272    99.090  187.27
  16   0.0411     98.630  0.0261    99.177  199.59
  17   0.0276     99.040  0.0250    99.182  211.91
  18   0.0414     98.610  0.0249    99.190  224.39
  19   0.0345     98.900  0.0245    99.190  236.71
  20   0.0347     98.850  0.0221    99.297  249.07
  21   0.0361     98.930  0.0224    99.280  261.57
  22   0.0314     98.980  0.0202    99.322  273.88
  23   0.0272     99.080  0.0206    99.295  286.18
  24   0.0287     98.990  0.0205    99.290  298.61
  25   0.0357     98.860  0.0194    99.347  310.91
  26   0.0231     99.200  0.0182    99.402  323.22
  27   0.0257     99.220  0.0181    99.388  335.51
  28   0.0340     98.830  0.0172    99.423  347.83
  29   0.0391     98.850  0.0165    99.452  360.14
  30   0.0232     99.230  0.0162    99.457  372.45
  31   0.0309     98.930  0.0152    99.462  384.97
  32   0.0286     99.150  0.0153    99.488  397.27
  33   0.0305     98.970  0.0163    99.467  409.58
  34   0.0349     98.830  0.0139    99.532  421.88
  35   0.0331     98.900  0.0151    99.480  434.20
  36   0.0300     99.060  0.0140    99.538  446.52
  37   0.0333     98.940  0.0135    99.557  458.83
  38   0.0253     99.160  0.0117    99.613  471.38
  39   0.0319     98.940  0.0118    99.612  483.68
  40   0.0301     98.980  0.0118    99.593  495.97
  41   0.0256     99.100  0.0114    99.607  508.31
  42   0.0273     99.100  0.0110    99.658  520.60
  43   0.0338     99.000  0.0110    99.613  532.92
  44   0.0312     98.910  0.0111    99.630  545.31
  45   0.0269     99.050  0.0104    99.640  557.60
  46   0.0321     99.040  0.0095    99.700  569.90
  47   0.0286     99.060  0.0095    99.698  582.33
  48   0.0294     99.020  0.0090    99.680  594.63
  49   0.0265     99.140  0.0090    99.695  606.93
  50   0.0358     98.980  0.0088    99.672  619.33
  51   0.0258     99.180  0.0084    99.720  631.66
  52   0.0308     99.060  0.0079    99.743  643.95
  53   0.0341     98.940  0.0083    99.717  656.26
  54   0.0342     98.980  0.0082    99.715  668.57
  55   0.0318     99.050  0.0072    99.778  680.85
  56   0.0305     99.190  0.0065    99.797  693.16
  57   0.0292     99.120  0.0068    99.772  705.48
  58   0.0371     98.880  0.0064    99.778  717.80
  59   0.0275     99.230  0.0065    99.768  730.10
  60   0.0324     98.990  0.0059    99.807  742.51
  61   0.0334     98.940  0.0059    99.808  754.81
  62   0.0305     99.030  0.0056    99.817  767.12
  63   0.0313     99.110  0.0052    99.840  779.54
  64   0.0278     99.140  0.0057    99.805  791.86
  65   0.0293     99.170  0.0057    99.820  804.15
  66   0.0299     99.150  0.0047    99.840  816.43
  67   0.0302     99.060  0.0048    99.855  828.74
  68   0.0267     99.190  0.0043    99.880  841.05
  69   0.0302     99.120  0.0046    99.850  853.36
  70   0.0286     99.130  0.0041    99.868  865.78
  71   0.0299     99.140  0.0043    99.865  878.08
  72   0.0286     99.240  0.0041    99.882  890.38
  73   0.0324     99.120  0.0039    99.902  902.81
  74   0.0296     99.180  0.0038    99.877  915.14
  75   0.0324     99.040  0.0038    99.885  927.43
  76   0.0322     99.120  0.0035    99.888  939.84
  77   0.0302     99.230  0.0036    99.895  952.16
  78   0.0339     99.080  0.0031    99.902  964.43
  79   0.0286     99.170  0.0036    99.895  976.74
  80   0.0301     99.190  0.0034    99.887  989.18
  81   0.0270     99.210  0.0034    99.897  1001.48
  82   0.0308     99.220  0.0031    99.910  1013.82
  83   0.0332     99.130  0.0031    99.897  1026.25
  84   0.0292     99.260  0.0030    99.912  1038.55
  85   0.0315     99.100  0.0030    99.910  1050.84
  86   0.0312     99.150  0.0026    99.932  1063.27
  87   0.0309     99.210  0.0026    99.907  1075.60
  88   0.0311     99.170  0.0026    99.943  1087.92
  89   0.0402     98.990  0.0026    99.932  1100.33
  90   0.0306     99.180  0.0025    99.928  1112.70
