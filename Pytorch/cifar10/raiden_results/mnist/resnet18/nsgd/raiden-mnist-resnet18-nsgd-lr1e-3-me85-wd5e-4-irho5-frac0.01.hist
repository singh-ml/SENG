Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7850115072 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3007     89.550  0.9244    69.418  19.65
   2   0.1656     94.490  0.2059    93.768  32.79
   3   0.1091     96.300  0.1271    96.035  45.81
   4   0.1339     95.500  0.0960    97.093  58.84
   5   0.1120     96.410  0.0797    97.538  71.89
   6   0.0807     97.420  0.0694    97.823  85.04
   7   0.0595     98.120  0.0590    98.147  98.08
   8   0.0798     97.540  0.0553    98.342  111.11
   9   0.0548     98.290  0.0506    98.380  124.12
  10   0.0560     98.190  0.0479    98.500  137.14
  11   0.0518     98.290  0.0454    98.502  150.19
  12   0.0528     98.240  0.0419    98.667  163.31
  13   0.0437     98.560  0.0403    98.732  176.32
  14   0.0425     98.590  0.0378    98.803  189.34
  15   0.0451     98.580  0.0366    98.822  202.35
  16   0.0424     98.540  0.0350    98.855  215.38
  17   0.0448     98.400  0.0327    98.947  228.40
  18   0.0537     98.180  0.0324    98.973  241.45
  19   0.0384     98.770  0.0316    99.010  254.47
  20   0.0422     98.670  0.0309    98.992  267.50
  21   0.0465     98.500  0.0297    99.070  280.52
  22   0.0437     98.550  0.0288    99.017  293.60
  23   0.0395     98.730  0.0272    99.163  306.62
  24   0.0310     98.980  0.0267    99.137  319.66
  25   0.0395     98.570  0.0263    99.157  332.85
  26   0.0455     98.590  0.0266    99.135  345.90
  27   0.0410     98.800  0.0254    99.167  358.93
  28   0.0357     98.800  0.0243    99.185  372.04
  29   0.0331     98.990  0.0241    99.218  385.06
  30   0.0385     98.690  0.0232    99.233  398.10
  31   0.0390     98.740  0.0228    99.228  411.21
  32   0.0335     98.850  0.0234    99.217  424.23
  33   0.0430     98.620  0.0218    99.320  437.27
  34   0.0301     99.050  0.0216    99.278  450.36
  35   0.0439     98.510  0.0209    99.313  463.33
  36   0.0300     99.040  0.0190    99.373  476.35
  37   0.0326     98.920  0.0197    99.380  489.45
  38   0.0289     98.930  0.0200    99.357  502.43
  39   0.0372     98.860  0.0188    99.375  515.46
  40   0.0316     98.990  0.0187    99.383  528.55
  41   0.0328     98.940  0.0182    99.395  541.58
  42   0.0340     98.900  0.0179    99.402  554.60
  43   0.0268     99.080  0.0178    99.408  567.69
  44   0.0345     98.820  0.0172    99.445  580.74
  45   0.0334     98.950  0.0177    99.420  593.76
  46   0.0348     98.870  0.0171    99.463  606.80
  47   0.0324     98.850  0.0170    99.458  619.83
  48   0.0351     98.810  0.0159    99.490  632.87
  49   0.0363     98.780  0.0155    99.480  645.86
  50   0.0319     98.880  0.0155    99.495  658.87
  51   0.0389     98.800  0.0158    99.485  671.90
  52   0.0360     98.740  0.0151    99.472  684.94
  53   0.0279     99.220  0.0147    99.503  697.99
  54   0.0247     99.230  0.0150    99.517  711.02
  55   0.0321     98.960  0.0147    99.523  724.06
  56   0.0380     98.770  0.0146    99.502  737.08
  57   0.0305     99.060  0.0136    99.573  750.09
  58   0.0349     98.930  0.0139    99.548  763.12
  59   0.0467     98.640  0.0126    99.587  776.15
  60   0.0337     99.000  0.0137    99.540  789.20
  61   0.0406     98.680  0.0141    99.547  802.26
  62   0.0380     98.850  0.0132    99.563  815.28
  63   0.0304     99.070  0.0131    99.560  828.34
  64   0.0336     98.840  0.0127    99.580  841.37
  65   0.0304     99.020  0.0127    99.623  854.38
  66   0.0328     98.910  0.0116    99.607  867.40
  67   0.0395     98.890  0.0118    99.600  880.43
  68   0.0404     98.720  0.0121    99.597  893.54
  69   0.0346     99.030  0.0109    99.652  906.56
  70   0.0263     99.120  0.0110    99.620  919.58
  71   0.0402     98.670  0.0116    99.613  932.75
  72   0.0346     98.870  0.0106    99.652  945.76
  73   0.0344     98.970  0.0121    99.587  958.79
  74   0.0410     98.770  0.0102    99.670  971.90
  75   0.0380     98.780  0.0110    99.648  984.91
  76   0.0311     99.130  0.0106    99.640  997.92
  77   0.0309     99.040  0.0106    99.637  1011.05
  78   0.0284     99.160  0.0107    99.655  1024.08
  79   0.0330     98.980  0.0098    99.670  1037.13
  80   0.0272     99.190  0.0091    99.688  1050.25
  81   0.0321     99.030  0.0094    99.682  1063.31
  82   0.0349     98.880  0.0104    99.678  1076.32
  83   0.0294     99.080  0.0094    99.663  1089.35
  84   0.0293     99.090  0.0097    99.712  1102.50
  85   0.0341     98.850  0.0087    99.710  1115.62
