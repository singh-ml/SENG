Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4046     86.990  1.0475    72.290  14.89
   2   0.2548     92.270  0.1415    95.620  27.36
   3   0.1066     96.520  0.0911    97.118  39.77
   4   0.1731     94.690  0.0755    97.618  52.36
   5   0.0625     98.020  0.0671    97.970  64.71
   6   0.0595     98.160  0.0599    98.125  77.08
   7   0.1183     96.200  0.0561    98.225  89.55
   8   0.1278     95.310  0.0562    98.222  101.88
   9   0.0693     97.610  0.0518    98.392  114.23
  10   0.0504     98.270  0.0504    98.455  126.67
  11   0.0537     98.440  0.0504    98.435  139.02
  12   0.0988     96.720  0.0493    98.470  151.36
  13   0.0756     97.500  0.0468    98.530  163.71
  14   0.2066     93.750  0.0500    98.457  176.16
  15   0.1594     94.940  0.0464    98.560  188.47
  16   0.0481     98.520  0.0470    98.533  200.85
  17   0.0477     98.420  0.0454    98.578  213.31
  18   0.0610     98.050  0.0421    98.753  225.66
  19   0.0603     98.020  0.0450    98.593  238.02
  20   0.0372     98.890  0.0458    98.568  250.48
  21   0.0648     97.950  0.0445    98.642  262.84
  22   0.0647     97.990  0.0449    98.617  275.18
  23   0.0511     98.310  0.0414    98.708  287.63
  24   0.0440     98.590  0.0429    98.722  299.94
  25   0.0557     98.170  0.0417    98.715  312.32
  26   0.0449     98.560  0.0408    98.757  324.66
  27   0.0792     97.610  0.0405    98.763  336.99
  28   0.0452     98.520  0.0410    98.725  349.34
  29   0.0396     98.820  0.0387    98.858  361.66
  30   0.0525     98.390  0.0365    98.818  374.08
  31   0.0428     98.630  0.0390    98.803  386.40
  32   0.0355     98.970  0.0369    98.828  398.74
  33   0.0386     98.770  0.0360    98.890  411.21
  34   0.0469     98.450  0.0359    98.922  423.59
  35   0.0428     98.620  0.0325    99.022  435.93
  36   0.0431     98.570  0.0358    98.877  448.37
  37   0.0357     98.790  0.0342    98.943  460.72
  38   0.0536     98.420  0.0336    98.973  473.08
  39   0.0596     98.040  0.0331    98.970  485.53
  40   0.0417     98.650  0.0317    99.038  497.89
  41   0.0387     98.740  0.0316    98.997  510.25
  42   0.0446     98.570  0.0309    99.035  522.60
  43   0.0378     98.840  0.0294    99.137  535.11
  44   0.0337     98.940  0.0275    99.180  547.46
  45   0.0376     98.850  0.0286    99.110  559.81
  46   0.0447     98.520  0.0265    99.162  572.31
  47   0.0492     98.390  0.0295    99.062  584.66
  48   0.0468     98.370  0.0252    99.195  597.00
  49   0.0286     99.060  0.0251    99.245  609.36
  50   0.0434     98.500  0.0244    99.220  621.72
  51   0.0360     98.810  0.0238    99.282  634.05
  52   0.0334     98.990  0.0235    99.240  646.41
  53   0.0371     98.820  0.0217    99.313  658.75
  54   0.0395     98.790  0.0212    99.345  671.10
  55   0.0334     98.930  0.0208    99.347  683.44
  56   0.0304     99.000  0.0197    99.382  695.85
  57   0.0314     99.110  0.0186    99.398  708.19
  58   0.0333     98.950  0.0173    99.488  720.53
  59   0.0374     98.920  0.0164    99.503  733.04
  60   0.0324     98.880  0.0168    99.465  745.40
  61   0.0317     98.960  0.0156    99.502  757.73
  62   0.0244     99.240  0.0135    99.565  770.06
  63   0.0309     99.100  0.0128    99.602  782.49
  64   0.0268     99.180  0.0114    99.692  794.81
  65   0.0269     99.150  0.0107    99.662  807.15
  66   0.0251     99.190  0.0110    99.675  819.59
  67   0.0295     99.090  0.0097    99.718  831.93
  68   0.0299     99.190  0.0081    99.770  844.27
  69   0.0291     99.160  0.0083    99.750  856.74
  70   0.0254     99.260  0.0077    99.788  869.10
  71   0.0243     99.260  0.0064    99.825  881.42
  72   0.0309     99.140  0.0059    99.853  893.76
  73   0.0270     99.220  0.0062    99.843  906.08
  74   0.0298     99.190  0.0054    99.857  918.40
  75   0.0264     99.250  0.0044    99.892  930.75
  76   0.0336     99.070  0.0045    99.900  943.10
  77   0.0264     99.250  0.0038    99.918  955.44
  78   0.0288     99.220  0.0037    99.922  967.79
  79   0.0298     99.170  0.0032    99.943  980.20
  80   0.0318     99.140  0.0032    99.937  992.52
  81   0.0282     99.210  0.0033    99.942  1004.88
  82   0.0288     99.200  0.0029    99.952  1017.29
  83   0.0297     99.180  0.0028    99.950  1029.64
  84   0.0307     99.190  0.0025    99.962  1042.01
  85   0.0291     99.180  0.0028    99.948  1054.48
