Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1019     96.660  0.4236    85.763  14.52
   2   0.0856     97.230  0.0857    97.327  26.89
   3   0.0701     97.640  0.0654    97.918  39.43
   4   0.0684     97.810  0.0560    98.237  51.86
   5   0.0770     97.830  0.0479    98.458  64.26
   6   0.0425     98.620  0.0429    98.623  76.69
   7   0.0572     97.960  0.0428    98.622  89.31
   8   0.0534     98.310  0.0377    98.808  101.69
   9   0.0437     98.560  0.0385    98.805  114.08
  10   0.0451     98.510  0.0348    98.912  126.54
  11   0.0436     98.520  0.0332    98.938  138.94
  12   0.0329     98.950  0.0304    99.015  151.35
  13   0.0261     99.050  0.0277    99.127  163.74
  14   0.0387     98.620  0.0281    99.068  176.23
  15   0.0371     98.940  0.0262    99.150  188.61
  16   0.0441     98.610  0.0269    99.127  200.99
  17   0.0252     99.170  0.0248    99.197  213.39
  18   0.0369     98.850  0.0238    99.222  225.81
  19   0.0327     98.920  0.0240    99.202  238.22
  20   0.0374     98.900  0.0233    99.238  250.60
  21   0.0392     98.920  0.0211    99.273  263.04
  22   0.0385     98.770  0.0220    99.257  275.46
  23   0.0377     98.880  0.0205    99.332  287.89
  24   0.0279     99.200  0.0197    99.383  300.28
  25   0.0328     98.910  0.0194    99.345  312.76
  26   0.0324     98.950  0.0193    99.372  325.19
  27   0.0326     98.960  0.0167    99.447  337.61
  28   0.0292     99.100  0.0168    99.462  350.00
  29   0.0274     99.130  0.0158    99.487  362.36
  30   0.0375     98.950  0.0162    99.480  374.79
  31   0.0272     99.060  0.0151    99.495  387.31
  32   0.0306     99.070  0.0159    99.465  399.70
  33   0.0364     98.930  0.0154    99.500  412.08
  34   0.0366     98.850  0.0144    99.542  424.45
  35   0.0261     99.170  0.0134    99.537  436.80
  36   0.0261     99.060  0.0132    99.562  449.17
  37   0.0302     99.040  0.0129    99.560  461.57
  38   0.0341     99.040  0.0121    99.593  474.05
  39   0.0294     99.020  0.0116    99.610  486.46
  40   0.0313     98.970  0.0111    99.600  498.85
  41   0.0271     99.120  0.0115    99.597  511.34
  42   0.0313     98.950  0.0104    99.670  523.71
  43   0.0418     98.820  0.0108    99.615  536.09
  44   0.0329     98.930  0.0096    99.690  548.60
  45   0.0295     99.140  0.0095    99.657  560.98
  46   0.0288     99.090  0.0088    99.692  573.34
  47   0.0336     99.010  0.0076    99.740  585.74
  48   0.0302     99.090  0.0075    99.760  598.14
  49   0.0302     99.170  0.0080    99.702  610.53
  50   0.0274     99.170  0.0080    99.748  622.88
  51   0.0388     98.960  0.0078    99.730  635.26
  52   0.0323     99.030  0.0078    99.743  647.66
  53   0.0306     99.070  0.0063    99.797  660.03
  54   0.0271     99.220  0.0065    99.782  672.43
  55   0.0305     99.030  0.0064    99.803  684.84
  56   0.0335     99.010  0.0066    99.780  697.25
  57   0.0288     99.080  0.0063    99.780  709.75
  58   0.0306     99.110  0.0054    99.817  722.15
  59   0.0331     99.000  0.0052    99.837  734.54
  60   0.0319     99.130  0.0048    99.847  747.00
  61   0.0331     99.080  0.0048    99.843  759.41
  62   0.0274     99.170  0.0050    99.825  771.81
  63   0.0294     99.140  0.0044    99.852  784.17
  64   0.0296     99.020  0.0042    99.868  796.57
  65   0.0296     99.080  0.0039    99.880  808.97
  66   0.0335     99.100  0.0040    99.867  821.36
  67   0.0345     99.070  0.0034    99.887  833.87
  68   0.0258     99.210  0.0036    99.877  846.26
  69   0.0304     99.160  0.0036    99.882  858.62
  70   0.0332     99.100  0.0030    99.910  871.13
  71   0.0326     99.090  0.0028    99.907  883.52
  72   0.0303     99.220  0.0030    99.900  895.91
  73   0.0336     99.060  0.0029    99.918  908.30
  74   0.0303     99.180  0.0034    99.885  920.86
  75   0.0306     99.130  0.0027    99.908  933.26
  76   0.0322     99.150  0.0028    99.900  945.64
  77   0.0345     99.140  0.0030    99.895  958.00
  78   0.0340     99.100  0.0025    99.923  970.40
  79   0.0359     99.090  0.0023    99.918  982.79
  80   0.0357     99.020  0.0021    99.937  995.33
  81   0.0320     99.160  0.0022    99.945  1007.71
  82   0.0352     99.150  0.0021    99.943  1020.10
  83   0.0367     99.140  0.0022    99.937  1032.60
  84   0.0374     99.080  0.0023    99.920  1045.00
  85   0.0342     99.130  0.0019    99.938  1057.36
  86   0.0359     99.110  0.0020    99.937  1069.76
  87   0.0386     99.080  0.0022    99.928  1082.13
  88   0.0350     99.110  0.0019    99.948  1094.49
  89   0.0377     99.080  0.0017    99.948  1106.89
  90   0.0345     99.130  0.0017    99.948  1119.29
