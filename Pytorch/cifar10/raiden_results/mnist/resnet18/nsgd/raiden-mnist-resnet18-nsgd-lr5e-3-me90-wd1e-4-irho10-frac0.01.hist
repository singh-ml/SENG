Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1035     96.750  0.4062    85.978  14.61
   2   0.0929     97.120  0.0872    97.268  27.10
   3   0.0925     97.290  0.0630    98.072  39.45
   4   0.0485     98.460  0.0564    98.262  51.80
   5   0.0503     98.320  0.0493    98.368  64.20
   6   0.0393     98.780  0.0465    98.470  76.58
   7   0.0459     98.490  0.0431    98.617  88.93
   8   0.0384     98.790  0.0381    98.748  101.27
   9   0.0595     98.280  0.0365    98.813  113.62
  10   0.0276     99.050  0.0344    98.885  126.01
  11   0.0427     98.500  0.0316    99.018  138.37
  12   0.0357     98.780  0.0309    99.000  150.84
  13   0.0355     98.810  0.0303    99.033  163.17
  14   0.0321     98.910  0.0286    99.063  175.51
  15   0.0368     98.820  0.0266    99.147  187.93
  16   0.0394     98.840  0.0263    99.153  200.31
  17   0.0318     98.880  0.0261    99.147  212.64
  18   0.0352     98.790  0.0242    99.240  225.00
  19   0.0245     99.160  0.0244    99.210  237.35
  20   0.0330     98.930  0.0218    99.292  249.72
  21   0.0276     99.090  0.0236    99.245  262.06
  22   0.0313     98.920  0.0213    99.302  274.43
  23   0.0257     99.140  0.0197    99.353  286.78
  24   0.0270     99.170  0.0196    99.358  299.15
  25   0.0304     98.960  0.0184    99.380  311.60
  26   0.0250     99.230  0.0194    99.355  323.97
  27   0.0256     99.070  0.0170    99.425  336.28
  28   0.0259     99.170  0.0175    99.398  348.65
  29   0.0263     99.110  0.0161    99.492  360.96
  30   0.0312     99.060  0.0154    99.463  373.33
  31   0.0390     98.840  0.0153    99.453  385.79
  32   0.0304     99.080  0.0149    99.483  398.15
  33   0.0311     99.020  0.0137    99.530  410.50
  34   0.0382     98.720  0.0139    99.530  422.84
  35   0.0302     99.080  0.0130    99.550  435.39
  36   0.0321     99.010  0.0128    99.540  447.73
  37   0.0259     99.190  0.0129    99.555  460.09
  38   0.0332     99.050  0.0117    99.593  472.55
  39   0.0241     99.180  0.0133    99.580  484.92
  40   0.0247     99.240  0.0118    99.607  497.27
  41   0.0278     99.180  0.0106    99.620  509.61
  42   0.0298     99.020  0.0103    99.642  521.98
  43   0.0315     99.030  0.0109    99.635  534.31
  44   0.0276     99.130  0.0098    99.657  546.66
  45   0.0317     99.110  0.0092    99.703  559.04
  46   0.0294     99.150  0.0086    99.697  571.39
  47   0.0293     99.120  0.0096    99.648  583.74
  48   0.0284     99.110  0.0085    99.712  596.09
  49   0.0374     98.950  0.0084    99.735  608.44
  50   0.0328     99.050  0.0081    99.758  620.79
  51   0.0269     99.200  0.0081    99.748  633.25
  52   0.0298     99.120  0.0079    99.730  645.61
  53   0.0251     99.240  0.0073    99.772  657.96
  54   0.0275     99.100  0.0067    99.755  670.35
  55   0.0292     99.170  0.0067    99.765  682.78
  56   0.0255     99.360  0.0057    99.807  695.16
  57   0.0361     99.000  0.0062    99.788  707.55
  58   0.0309     99.060  0.0059    99.800  719.92
  59   0.0314     99.120  0.0053    99.793  732.26
  60   0.0344     99.030  0.0055    99.803  744.61
  61   0.0320     99.030  0.0047    99.848  757.05
  62   0.0270     99.180  0.0056    99.805  769.40
  63   0.0360     98.990  0.0041    99.860  781.78
  64   0.0318     99.060  0.0047    99.845  794.21
  65   0.0375     98.950  0.0043    99.852  806.57
  66   0.0385     98.920  0.0040    99.845  818.92
  67   0.0304     99.160  0.0043    99.835  831.37
  68   0.0383     99.010  0.0045    99.837  843.72
  69   0.0316     99.170  0.0039    99.872  856.09
  70   0.0398     98.910  0.0040    99.878  868.44
  71   0.0313     99.120  0.0034    99.885  880.99
  72   0.0326     99.090  0.0031    99.895  893.35
  73   0.0323     99.090  0.0028    99.910  905.73
  74   0.0326     99.080  0.0034    99.857  918.06
  75   0.0358     99.060  0.0029    99.910  930.41
  76   0.0326     99.130  0.0028    99.913  942.77
  77   0.0308     99.170  0.0029    99.903  955.22
  78   0.0313     99.180  0.0029    99.905  967.59
  79   0.0342     99.070  0.0027    99.895  979.95
  80   0.0372     98.930  0.0025    99.923  992.28
  81   0.0384     99.070  0.0025    99.930  1004.63
  82   0.0326     99.080  0.0028    99.920  1016.99
  83   0.0347     99.080  0.0024    99.923  1029.36
  84   0.0363     98.920  0.0022    99.938  1041.72
  85   0.0369     98.980  0.0024    99.923  1054.10
  86   0.0309     99.080  0.0021    99.938  1066.45
  87   0.0354     99.030  0.0019    99.948  1078.82
  88   0.0384     98.960  0.0019    99.947  1091.17
  89   0.0377     98.990  0.0021    99.935  1103.51
  90   0.0350     99.010  0.0019    99.932  1115.85
