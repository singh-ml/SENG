Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3454     89.920  0.4292    85.688  14.83
   2   0.0745     97.630  0.0900    97.172  27.12
   3   0.1009     96.910  0.0670    97.942  39.38
   4   0.0714     97.680  0.0597    98.142  51.71
   5   0.0665     97.740  0.0522    98.385  64.02
   6   0.0527     98.340  0.0446    98.628  76.31
   7   0.0406     98.730  0.0412    98.663  88.71
   8   0.0346     98.750  0.0401    98.727  101.06
   9   0.0451     98.610  0.0385    98.737  113.33
  10   0.0757     97.630  0.0365    98.802  125.75
  11   0.0522     98.410  0.0323    98.970  138.03
  12   0.0400     98.700  0.0330    98.943  150.32
  13   0.0380     98.730  0.0306    99.033  162.72
  14   0.0386     98.850  0.0294    99.083  175.01
  15   0.0386     98.710  0.0286    99.048  187.26
  16   0.0397     98.500  0.0281    99.123  199.67
  17   0.0353     98.760  0.0267    99.133  211.96
  18   0.0423     98.590  0.0254    99.210  224.25
  19   0.0442     98.700  0.0250    99.168  236.50
  20   0.0244     99.200  0.0244    99.217  248.77
  21   0.0356     98.880  0.0240    99.238  261.06
  22   0.0355     98.910  0.0224    99.307  273.34
  23   0.0360     98.880  0.0220    99.275  285.73
  24   0.0313     98.940  0.0219    99.295  298.01
  25   0.0386     98.720  0.0201    99.322  310.39
  26   0.0325     99.010  0.0209    99.298  322.85
  27   0.0294     99.110  0.0197    99.338  335.11
  28   0.0395     98.740  0.0185    99.367  347.38
  29   0.0302     98.990  0.0179    99.405  359.69
  30   0.0408     98.790  0.0172    99.422  371.96
  31   0.0343     98.840  0.0163    99.463  384.26
  32   0.0293     99.020  0.0157    99.480  396.55
  33   0.0375     98.910  0.0162    99.458  409.04
  34   0.0339     99.040  0.0152    99.475  421.33
  35   0.0412     98.640  0.0145    99.505  433.62
  36   0.0278     99.140  0.0156    99.465  446.02
  37   0.0311     99.000  0.0142    99.528  458.30
  38   0.0299     99.100  0.0139    99.558  470.61
  39   0.0244     99.190  0.0122    99.610  482.91
  40   0.0280     99.170  0.0132    99.558  495.17
  41   0.0356     98.990  0.0124    99.573  507.52
  42   0.0356     98.860  0.0125    99.578  519.81
  43   0.0316     99.060  0.0102    99.657  532.22
  44   0.0272     99.130  0.0112    99.620  544.51
  45   0.0320     99.030  0.0109    99.640  556.79
  46   0.0232     99.270  0.0097    99.662  569.22
  47   0.0280     99.160  0.0098    99.672  581.50
  48   0.0252     99.200  0.0089    99.685  593.79
  49   0.0272     99.090  0.0094    99.670  606.18
  50   0.0304     99.160  0.0082    99.720  618.47
  51   0.0325     99.020  0.0085    99.712  630.76
  52   0.0281     99.130  0.0072    99.772  643.05
  53   0.0284     99.200  0.0069    99.782  655.32
  54   0.0345     99.010  0.0069    99.790  667.59
  55   0.0239     99.210  0.0070    99.773  679.88
  56   0.0255     99.310  0.0063    99.800  692.25
  57   0.0356     98.950  0.0058    99.832  704.54
  58   0.0283     99.130  0.0064    99.787  716.84
  59   0.0261     99.160  0.0056    99.833  729.23
  60   0.0301     99.080  0.0054    99.808  741.51
  61   0.0292     99.170  0.0044    99.867  753.76
  62   0.0319     99.080  0.0045    99.875  766.03
  63   0.0325     99.050  0.0044    99.862  778.30
  64   0.0311     99.170  0.0039    99.890  790.59
  65   0.0296     99.160  0.0038    99.888  802.87
  66   0.0303     99.160  0.0037    99.908  815.24
  67   0.0286     99.240  0.0032    99.907  827.52
  68   0.0287     99.200  0.0030    99.915  839.80
  69   0.0284     99.190  0.0031    99.915  852.18
  70   0.0277     99.200  0.0028    99.933  864.46
  71   0.0311     99.050  0.0028    99.928  876.75
  72   0.0276     99.190  0.0026    99.927  889.14
  73   0.0278     99.250  0.0026    99.928  901.45
  74   0.0312     99.190  0.0024    99.940  913.74
  75   0.0297     99.170  0.0025    99.918  926.02
  76   0.0297     99.140  0.0022    99.955  938.30
  77   0.0300     99.200  0.0024    99.938  950.60
  78   0.0290     99.170  0.0020    99.962  962.89
  79   0.0295     99.180  0.0021    99.945  975.27
  80   0.0292     99.220  0.0019    99.963  987.58
  81   0.0321     99.100  0.0020    99.957  999.86
  82   0.0294     99.220  0.0021    99.950  1012.27
  83   0.0297     99.180  0.0019    99.945  1024.55
  84   0.0311     99.100  0.0019    99.963  1036.84
  85   0.0292     99.150  0.0019    99.955  1049.11
  86   0.0304     99.150  0.0019    99.958  1061.41
  87   0.0305     99.100  0.0017    99.973  1073.73
  88   0.0307     99.120  0.0017    99.960  1086.01
  89   0.0308     99.090  0.0018    99.968  1098.46
  90   0.0308     99.120  0.0016    99.973  1110.76
