Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2873     90.810  0.8871    70.663  14.49
   2   0.1578     94.870  0.1905    94.205  26.85
   3   0.1073     96.640  0.1228    96.222  39.31
   4   0.1168     96.040  0.0915    97.205  51.67
   5   0.0882     97.150  0.0765    97.608  64.00
   6   0.0635     97.990  0.0675    97.917  76.49
   7   0.0782     97.500  0.0595    98.180  88.86
   8   0.0461     98.430  0.0545    98.345  101.17
   9   0.0533     98.230  0.0509    98.437  113.56
  10   0.0539     98.230  0.0475    98.520  125.88
  11   0.0618     97.810  0.0446    98.602  138.23
  12   0.0498     98.370  0.0432    98.637  150.73
  13   0.0460     98.570  0.0402    98.717  163.08
  14   0.0391     98.650  0.0384    98.792  175.41
  15   0.0421     98.570  0.0378    98.785  187.75
  16   0.0460     98.490  0.0349    98.883  200.07
  17   0.0311     98.880  0.0348    98.917  212.42
  18   0.0507     98.300  0.0339    98.937  224.76
  19   0.0489     98.500  0.0323    98.987  237.18
  20   0.0351     98.830  0.0306    99.015  249.52
  21   0.0359     98.730  0.0314    98.963  261.84
  22   0.0451     98.480  0.0300    99.040  274.27
  23   0.0413     98.570  0.0294    99.090  286.61
  24   0.0446     98.490  0.0278    99.120  298.94
  25   0.0382     98.730  0.0269    99.132  311.29
  26   0.0387     98.630  0.0273    99.105  323.70
  27   0.0337     98.910  0.0256    99.155  336.03
  28   0.0408     98.560  0.0251    99.185  348.38
  29   0.0380     98.720  0.0245    99.225  360.76
  30   0.0382     98.650  0.0242    99.220  373.11
  31   0.0378     98.770  0.0237    99.253  385.45
  32   0.0332     98.990  0.0235    99.228  397.79
  33   0.0281     99.170  0.0219    99.262  410.15
  34   0.0360     98.810  0.0220    99.307  422.50
  35   0.0324     98.940  0.0205    99.332  434.81
  36   0.0335     98.810  0.0207    99.323  447.15
  37   0.0356     98.730  0.0202    99.338  459.48
  38   0.0387     98.720  0.0198    99.350  471.89
  39   0.0393     98.780  0.0192    99.372  484.24
  40   0.0329     98.950  0.0191    99.373  496.59
  41   0.0469     98.500  0.0184    99.385  508.97
  42   0.0322     98.920  0.0193    99.363  521.43
  43   0.0338     98.910  0.0184    99.383  533.78
  44   0.0371     98.730  0.0177    99.438  546.14
  45   0.0369     98.850  0.0181    99.408  558.59
  46   0.0327     98.980  0.0177    99.395  570.92
  47   0.0417     98.620  0.0169    99.428  583.26
  48   0.0340     98.960  0.0161    99.465  595.67
  49   0.0387     98.780  0.0164    99.460  607.99
  50   0.0371     98.800  0.0165    99.455  620.29
  51   0.0281     99.140  0.0152    99.508  632.76
  52   0.0339     98.880  0.0151    99.513  645.10
  53   0.0362     98.750  0.0147    99.527  657.43
  54   0.0307     98.980  0.0149    99.478  669.77
  55   0.0366     98.750  0.0153    99.475  682.09
  56   0.0317     98.930  0.0146    99.518  694.41
  57   0.0384     98.800  0.0145    99.513  706.74
  58   0.0372     98.850  0.0132    99.535  719.15
  59   0.0355     98.850  0.0133    99.562  731.49
  60   0.0426     98.540  0.0136    99.522  743.83
  61   0.0309     98.990  0.0130    99.587  756.24
  62   0.0298     99.050  0.0142    99.520  768.58
  63   0.0313     98.960  0.0133    99.570  780.87
  64   0.0321     98.940  0.0123    99.587  793.29
  65   0.0319     98.960  0.0123    99.637  805.62
  66   0.0358     98.980  0.0131    99.552  817.94
  67   0.0411     98.730  0.0129    99.588  830.27
  68   0.0337     99.020  0.0123    99.610  842.57
  69   0.0320     98.990  0.0125    99.582  854.90
  70   0.0340     98.890  0.0121    99.603  867.23
  71   0.0339     98.960  0.0111    99.618  879.56
  72   0.0388     98.870  0.0111    99.618  891.88
  73   0.0333     99.010  0.0107    99.648  904.21
  74   0.0259     99.190  0.0107    99.650  916.63
  75   0.0378     98.870  0.0099    99.695  928.96
  76   0.0308     98.990  0.0101    99.633  941.30
  77   0.0439     98.690  0.0104    99.665  953.61
  78   0.0317     99.060  0.0104    99.663  965.92
  79   0.0350     98.910  0.0103    99.625  978.27
  80   0.0375     98.910  0.0103    99.668  990.58
  81   0.0371     98.940  0.0094    99.682  1003.00
  82   0.0301     99.030  0.0102    99.650  1015.33
  83   0.0363     98.820  0.0098    99.657  1027.66
  84   0.0301     99.090  0.0095    99.712  1040.09
  85   0.0285     99.120  0.0086    99.702  1052.44
