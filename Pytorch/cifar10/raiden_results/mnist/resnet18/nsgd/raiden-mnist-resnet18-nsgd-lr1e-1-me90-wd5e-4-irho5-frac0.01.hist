Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2846     12.920  2.8337    11.367  14.66
   2   0.5687     79.700  1.3319    50.230  27.16
   3   0.4726     83.950  0.3884    86.918  39.59
   4   0.4592     85.030  0.2136    93.462  52.13
   5   0.1868     94.140  0.1364    95.730  64.47
   6   0.0811     97.410  0.1082    96.693  76.94
   7   0.0912     97.150  0.0927    97.078  89.28
   8   0.1353     95.580  0.0816    97.403  101.79
   9   0.0922     97.200  0.0762    97.678  114.22
  10   0.1738     94.610  0.0756    97.732  126.55
  11   0.0649     98.090  0.0659    97.925  138.89
  12   0.1224     96.170  0.0662    97.942  151.20
  13   0.0879     97.130  0.0673    97.890  163.71
  14   0.0724     97.600  0.0606    98.097  176.23
  15   0.1248     96.220  0.0600    98.180  188.73
  16   0.0894     96.990  0.0627    98.045  201.05
  17   0.1478     95.220  0.0553    98.285  213.55
  18   0.0472     98.470  0.0576    98.178  226.05
  19   0.0995     96.480  0.0551    98.212  238.68
  20   0.0511     98.340  0.0537    98.342  251.21
  21   0.0413     98.650  0.0545    98.308  263.57
  22   0.1228     95.900  0.0551    98.288  276.19
  23   0.1336     95.550  0.0526    98.377  288.51
  24   0.1234     95.980  0.0514    98.422  301.02
  25   0.0408     98.620  0.0508    98.415  313.35
  26   0.0772     97.570  0.0476    98.520  325.85
  27   0.0500     98.470  0.0478    98.470  338.37
  28   0.0457     98.340  0.0471    98.545  350.90
  29   0.1022     97.040  0.0485    98.473  363.48
  30   0.0380     98.610  0.0450    98.600  375.99
  31   0.0484     98.340  0.0432    98.648  388.48
  32   0.0474     98.510  0.0421    98.675  401.09
  33   0.0677     97.770  0.0431    98.670  413.45
  34   0.0697     97.520  0.0429    98.642  425.94
  35   0.0741     97.590  0.0452    98.595  438.57
  36   0.0482     98.410  0.0399    98.772  451.09
  37   0.0931     96.840  0.0390    98.803  463.62
  38   0.0425     98.540  0.0404    98.750  476.19
  39   0.0507     98.290  0.0386    98.767  488.56
  40   0.0434     98.670  0.0353    98.888  501.07
  41   0.0559     98.200  0.0369    98.862  513.59
  42   0.0327     98.950  0.0363    98.868  526.07
  43   0.0484     98.410  0.0353    98.865  538.58
  44   0.0631     98.080  0.0344    98.905  551.11
  45   0.0327     98.830  0.0343    98.872  563.63
  46   0.0359     98.850  0.0328    98.977  576.14
  47   0.0339     98.950  0.0340    98.918  588.66
  48   0.0520     98.300  0.0305    99.033  601.14
  49   0.0422     98.650  0.0335    98.893  613.67
  50   0.0523     98.350  0.0281    99.107  626.19
  51   0.0276     99.110  0.0296    99.023  638.73
  52   0.0319     98.960  0.0293    99.068  651.44
  53   0.0455     98.380  0.0266    99.170  663.94
  54   0.0333     98.900  0.0268    99.158  676.57
  55   0.0233     99.200  0.0266    99.137  689.06
  56   0.0345     98.820  0.0248    99.225  701.39
  57   0.0375     98.780  0.0239    99.188  713.90
  58   0.3479     89.290  0.0233    99.218  726.42
  59   0.0356     98.790  0.0220    99.320  738.77
  60   0.0225     99.170  0.0202    99.333  751.30
  61   0.0360     98.840  0.0208    99.330  763.92
  62   0.0222     99.280  0.0200    99.347  776.42
  63   0.0288     98.960  0.0182    99.403  788.76
  64   0.0316     98.900  0.0177    99.428  801.41
  65   0.0392     98.780  0.0168    99.447  813.74
  66   0.0230     99.280  0.0163    99.465  826.26
  67   0.0349     98.900  0.0158    99.482  838.96
  68   0.0225     99.240  0.0142    99.578  851.48
  69   0.0294     99.100  0.0138    99.545  863.86
  70   0.0231     99.280  0.0125    99.603  876.37
  71   0.0252     99.160  0.0113    99.630  888.95
  72   0.0312     99.030  0.0102    99.678  901.47
  73   0.0266     99.080  0.0099    99.680  913.97
  74   0.0226     99.200  0.0090    99.728  926.56
  75   0.0259     99.100  0.0080    99.748  939.07
  76   0.0215     99.230  0.0076    99.762  951.59
  77   0.0237     99.220  0.0070    99.783  964.07
  78   0.0225     99.270  0.0065    99.795  976.58
  79   0.0223     99.250  0.0059    99.815  988.94
  80   0.0229     99.210  0.0056    99.825  1001.59
  81   0.0270     99.090  0.0048    99.857  1014.10
  82   0.0258     99.180  0.0048    99.878  1026.64
  83   0.0252     99.180  0.0046    99.862  1039.02
  84   0.0228     99.280  0.0042    99.880  1051.41
  85   0.0246     99.210  0.0039    99.885  1063.75
  86   0.0242     99.190  0.0038    99.902  1076.26
  87   0.0263     99.220  0.0035    99.905  1088.81
  88   0.0262     99.170  0.0032    99.920  1101.33
  89   0.0248     99.220  0.0030    99.933  1113.68
  90   0.0246     99.250  0.0028    99.930  1126.31
