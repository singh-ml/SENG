Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.6631     77.820  1.6196    51.527  14.84
   2   0.2199     93.010  0.2156    93.250  27.67
   3   0.1787     93.730  0.1201    96.273  40.28
   4   0.1057     96.360  0.0936    97.088  52.91
   5   0.1522     95.120  0.0771    97.567  65.52
   6   0.0833     97.240  0.0732    97.705  78.11
   7   0.1159     96.140  0.0658    97.900  90.69
   8   0.0518     98.250  0.0618    98.083  103.25
   9   0.0822     97.290  0.0603    98.070  115.82
  10   0.0648     97.840  0.0563    98.228  128.42
  11   0.2610     91.250  0.0546    98.310  141.23
  12   0.0764     97.510  0.0559    98.247  153.79
  13   0.0808     97.320  0.0534    98.335  166.37
  14   0.0765     97.640  0.0516    98.327  178.95
  15   0.0459     98.580  0.0487    98.458  191.53
  16   0.1016     96.710  0.0494    98.450  204.10
  17   0.1014     96.670  0.0491    98.475  216.79
  18   0.0732     97.700  0.0494    98.447  229.35
  19   0.0643     97.850  0.0482    98.538  241.94
  20   0.0671     97.700  0.0462    98.570  254.63
  21   0.0482     98.570  0.0478    98.478  267.26
  22   0.0620     97.900  0.0459    98.523  279.85
  23   0.0411     98.700  0.0420    98.660  292.58
  24   0.0451     98.370  0.0460    98.605  305.16
  25   0.0320     99.090  0.0432    98.683  317.74
  26   0.1114     96.430  0.0422    98.713  330.45
  27   0.0559     98.310  0.0422    98.690  343.05
  28   0.1909     94.380  0.0442    98.645  355.61
  29   0.0550     98.180  0.0399    98.737  368.20
  30   0.0682     97.860  0.0420    98.678  380.97
  31   0.0432     98.650  0.0418    98.707  393.54
  32   0.0609     98.220  0.0396    98.820  406.13
  33   0.0428     98.660  0.0375    98.812  418.69
  34   0.0658     97.890  0.0375    98.870  431.27
  35   0.0410     98.640  0.0393    98.707  443.85
  36   0.0456     98.420  0.0374    98.843  456.41
  37   0.0540     98.270  0.0367    98.838  469.03
  38   0.0447     98.590  0.0343    98.913  481.59
  39   0.0653     97.810  0.0361    98.818  494.27
  40   0.0582     98.100  0.0350    98.923  506.85
  41   0.1426     95.380  0.0317    99.018  519.45
  42   0.0307     98.970  0.0337    98.912  532.15
  43   0.0551     98.300  0.0338    98.928  544.73
  44   0.0390     98.720  0.0303    99.045  557.30
  45   0.0414     98.520  0.0295    99.065  569.87
  46   0.0252     99.180  0.0302    99.050  582.43
  47   0.0416     98.830  0.0293    99.070  595.00
  48   0.0295     99.020  0.0295    99.077  607.57
  49   0.0319     98.940  0.0290    99.062  620.28
  50   0.0308     98.980  0.0271    99.132  632.88
  51   0.0546     98.250  0.0254    99.173  645.45
  52   0.0588     98.120  0.0242    99.223  658.16
  53   0.0361     98.870  0.0246    99.197  670.71
  54   0.0285     99.100  0.0238    99.242  683.30
  55   0.0371     98.760  0.0225    99.303  695.89
  56   0.0343     98.830  0.0218    99.310  708.46
  57   0.0353     98.690  0.0230    99.275  721.03
  58   0.0252     99.140  0.0217    99.287  733.74
  59   0.0339     98.940  0.0210    99.325  746.32
  60   0.0359     98.700  0.0184    99.405  758.92
  61   0.0283     98.990  0.0180    99.433  771.53
  62   0.0278     99.010  0.0173    99.445  784.10
  63   0.0296     98.950  0.0164    99.498  796.69
  64   0.0283     99.040  0.0159    99.498  809.37
  65   0.0284     99.160  0.0144    99.553  821.96
  66   0.0275     99.100  0.0125    99.603  834.53
  67   0.0247     99.250  0.0130    99.577  847.13
  68   0.0284     98.980  0.0124    99.613  859.71
  69   0.0232     99.200  0.0130    99.577  872.31
  70   0.0250     99.240  0.0092    99.715  884.89
  71   0.0275     99.070  0.0094    99.698  897.45
  72   0.0232     99.230  0.0092    99.702  910.04
  73   0.0221     99.240  0.0087    99.720  922.63
  74   0.0260     99.090  0.0072    99.790  935.25
  75   0.0291     99.070  0.0070    99.765  947.84
  76   0.0225     99.320  0.0067    99.802  960.46
  77   0.0207     99.300  0.0057    99.822  973.32
  78   0.0274     99.070  0.0048    99.877  985.93
  79   0.0249     99.180  0.0049    99.855  998.47
  80   0.0271     99.090  0.0040    99.888  1011.20
  81   0.0239     99.180  0.0035    99.915  1023.80
  82   0.0274     99.130  0.0032    99.932  1036.41
  83   0.0267     99.100  0.0030    99.923  1049.11
  84   0.0277     99.130  0.0028    99.940  1061.71
  85   0.0271     99.190  0.0027    99.933  1074.32
  86   0.0271     99.180  0.0023    99.957  1087.03
  87   0.0266     99.220  0.0023    99.943  1099.65
  88   0.0275     99.210  0.0023    99.960  1112.25
  89   0.0256     99.280  0.0021    99.955  1124.84
  90   0.0272     99.220  0.0022    99.960  1137.44
