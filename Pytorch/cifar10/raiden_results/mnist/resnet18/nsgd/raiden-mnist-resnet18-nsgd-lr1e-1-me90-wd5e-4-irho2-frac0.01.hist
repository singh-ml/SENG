Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.7663     31.780  2.5166    20.802  14.74
   2   0.2826     90.770  0.5737    81.370  27.32
   3   0.1523     95.440  0.1927    94.057  39.99
   4   0.1737     94.430  0.1223    96.168  52.58
   5   0.0676     97.800  0.0960    96.998  65.16
   6   0.0898     97.050  0.0837    97.370  77.74
   7   0.1974     93.900  0.0725    97.742  90.31
   8   0.0660     97.830  0.0659    97.905  102.91
   9   0.6347     79.740  0.0627    98.033  115.60
  10   0.0394     98.700  0.0586    98.172  128.23
  11   0.2213     92.620  0.0544    98.265  140.79
  12   0.0602     98.200  0.0521    98.403  153.36
  13   0.0622     98.040  0.0529    98.317  165.96
  14   0.0917     97.120  0.0525    98.403  178.54
  15   0.0363     98.770  0.0518    98.383  191.13
  16   0.0560     98.240  0.0502    98.508  203.71
  17   0.0553     98.100  0.0497    98.435  216.27
  18   0.0850     97.180  0.0482    98.508  228.82
  19   0.0918     97.070  0.0504    98.412  241.50
  20   0.0865     97.110  0.0491    98.447  254.07
  21   0.0954     96.930  0.0448    98.622  266.65
  22   0.0636     97.850  0.0455    98.592  279.33
  23   0.0438     98.620  0.0463    98.550  291.92
  24   0.0492     98.430  0.0451    98.588  304.47
  25   1.6325     65.000  0.0427    98.672  317.17
  26   0.0799     97.430  0.0458    98.567  329.77
  27   0.0792     97.400  0.0418    98.717  342.38
  28   0.1108     96.410  0.0432    98.620  354.96
  29   0.0321     98.970  0.0434    98.667  367.66
  30   1.9708     54.070  0.0411    98.765  380.20
  31   0.0426     98.660  0.0404    98.727  392.77
  32   1.8132     60.470  0.0379    98.805  405.47
  33   0.0444     98.580  0.0396    98.757  418.06
  34   0.0514     98.400  0.0406    98.717  430.64
  35   0.0648     97.930  0.0396    98.727  443.29
  36   0.0438     98.550  0.0362    98.847  455.85
  37   0.0413     98.570  0.0345    98.922  468.42
  38   0.0434     98.640  0.0373    98.833  481.14
  39   0.0523     98.450  0.0348    98.882  493.74
  40   0.0299     99.020  0.0335    98.958  506.32
  41   0.0480     98.480  0.0342    98.990  519.01
  42   0.0392     98.880  0.0343    98.892  531.58
  43   0.0354     98.820  0.0321    98.987  544.19
  44   0.0500     98.400  0.0315    99.047  556.80
  45   0.0312     98.960  0.0308    99.040  569.39
  46   0.0508     98.450  0.0299    99.063  581.98
  47   0.0297     98.960  0.0307    99.037  594.57
  48   0.0341     98.950  0.0295    99.085  607.16
  49   0.0306     99.110  0.0280    99.175  619.75
  50   0.0510     98.430  0.0278    99.098  632.34
  51   4.2235     45.460  0.0272    99.192  645.09
  52   0.0217     99.210  0.0273    99.127  657.65
  53   0.0330     98.860  0.0271    99.137  670.23
  54   0.0327     98.980  0.0252    99.175  682.93
  55   0.0300     98.990  0.0240    99.260  695.53
  56   0.0267     99.070  0.0214    99.355  708.09
  57   0.0249     99.220  0.0229    99.255  720.68
  58   0.0226     99.230  0.0205    99.328  733.28
  59   0.0329     98.800  0.0196    99.387  745.84
  60   0.0350     98.920  0.0210    99.323  758.47
  61   0.0308     98.940  0.0187    99.430  771.18
  62   0.0282     98.980  0.0181    99.397  783.79
  63   0.0287     99.010  0.0181    99.398  796.37
  64   0.0237     99.170  0.0162    99.515  809.09
  65   0.0242     99.180  0.0155    99.507  821.71
  66   0.0282     99.050  0.0141    99.567  834.27
  67   0.0275     99.150  0.0131    99.582  846.98
  68   0.0199     99.290  0.0129    99.603  859.58
  69   0.0248     99.240  0.0117    99.633  872.17
  70   0.0289     99.060  0.0117    99.622  884.86
  71   0.0243     99.220  0.0113    99.627  897.44
  72   0.0259     99.200  0.0108    99.645  910.02
  73   0.0253     99.150  0.0092    99.710  922.72
  74   0.0211     99.340  0.0087    99.738  935.29
  75   0.0263     99.180  0.0074    99.777  947.88
  76   0.0232     99.220  0.0067    99.778  960.43
  77   0.0237     99.290  0.0061    99.805  973.23
  78   0.0286     99.110  0.0057    99.825  985.85
  79   0.0216     99.300  0.0055    99.837  998.43
  80   0.0229     99.270  0.0048    99.875  1011.06
  81   0.0249     99.240  0.0047    99.865  1023.65
  82   0.0249     99.220  0.0047    99.858  1036.24
  83   0.0251     99.300  0.0037    99.893  1048.89
  84   0.0262     99.240  0.0035    99.900  1061.52
  85   0.0260     99.260  0.0036    99.902  1074.09
  86   0.0254     99.290  0.0030    99.925  1086.79
  87   0.0255     99.310  0.0030    99.933  1099.35
  88   0.0269     99.320  0.0030    99.933  1111.96
  89   0.0272     99.300  0.0030    99.930  1124.63
  90   0.0253     99.320  0.0025    99.938  1137.20
