Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7850115072 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2657     92.080  0.8971    70.430  19.61
   2   0.1621     94.780  0.1949    94.127  32.69
   3   0.1074     96.630  0.1248    96.132  45.56
   4   0.0780     97.470  0.0941    97.162  58.51
   5   0.0823     97.230  0.0777    97.568  71.40
   6   0.0658     97.890  0.0673    97.948  84.45
   7   0.0683     97.750  0.0609    98.065  97.38
   8   0.0603     97.970  0.0562    98.215  110.33
   9   0.0541     98.210  0.0509    98.387  123.23
  10   0.0496     98.360  0.0466    98.535  136.17
  11   0.0727     97.830  0.0450    98.587  149.08
  12   0.0558     98.120  0.0417    98.695  162.12
  13   0.0442     98.600  0.0399    98.772  175.05
  14   0.0460     98.620  0.0385    98.762  187.97
  15   0.0447     98.630  0.0366    98.863  200.92
  16   0.0430     98.560  0.0350    98.858  213.83
  17   0.0457     98.410  0.0347    98.905  226.76
  18   0.0455     98.430  0.0321    98.985  239.69
  19   0.0465     98.420  0.0319    98.988  252.73
  20   0.0421     98.750  0.0314    98.983  265.62
  21   0.0387     98.680  0.0294    99.092  278.56
  22   0.0373     98.730  0.0293    99.057  291.59
  23   0.0427     98.520  0.0267    99.112  304.52
  24   0.0348     98.870  0.0267    99.153  317.44
  25   0.0338     98.780  0.0266    99.183  330.48
  26   0.0280     98.960  0.0255    99.200  343.41
  27   0.0364     98.740  0.0246    99.197  356.33
  28   0.0303     98.990  0.0248    99.192  369.25
  29   0.0315     98.830  0.0242    99.177  382.13
  30   0.0482     98.370  0.0228    99.240  395.05
  31   0.0314     98.990  0.0219    99.303  407.97
  32   0.0359     98.760  0.0209    99.330  420.89
  33   0.0367     98.850  0.0204    99.358  433.83
  34   0.0352     98.860  0.0213    99.325  446.75
  35   0.0304     98.890  0.0198    99.347  459.67
  36   0.0347     98.770  0.0193    99.408  472.56
  37   0.0340     98.830  0.0180    99.425  485.48
  38   0.0317     98.960  0.0187    99.388  498.42
  39   0.0369     98.690  0.0187    99.413  511.35
  40   0.0323     98.940  0.0181    99.407  524.31
  41   0.0327     98.950  0.0166    99.498  537.36
  42   0.0282     99.090  0.0170    99.445  550.27
  43   0.0333     98.880  0.0169    99.428  563.20
  44   0.0310     98.920  0.0155    99.513  576.21
  45   0.0288     98.980  0.0161    99.475  589.13
  46   0.0377     98.760  0.0151    99.527  602.07
  47   0.0311     99.030  0.0143    99.548  615.09
  48   0.0307     98.940  0.0151    99.520  627.98
  49   0.0330     98.860  0.0150    99.510  640.88
  50   0.0329     98.800  0.0140    99.563  653.87
  51   0.0290     99.000  0.0136    99.560  666.75
  52   0.0259     99.150  0.0133    99.588  679.71
  53   0.0261     99.130  0.0128    99.590  692.71
  54   0.0309     98.900  0.0129    99.608  705.62
  55   0.0364     98.890  0.0126    99.600  718.55
  56   0.0246     99.120  0.0121    99.618  731.54
  57   0.0343     98.890  0.0123    99.640  744.47
  58   0.0288     99.140  0.0117    99.648  757.37
  59   0.0296     99.080  0.0117    99.623  770.40
  60   0.0263     99.090  0.0118    99.628  783.33
  61   0.0282     99.050  0.0113    99.633  796.22
  62   0.0252     99.160  0.0109    99.660  809.22
  63   0.0265     99.090  0.0105    99.693  822.11
  64   0.0283     99.030  0.0104    99.688  835.02
  65   0.0267     99.100  0.0106    99.695  847.90
  66   0.0293     98.960  0.0102    99.697  861.01
  67   0.0281     99.030  0.0102    99.718  873.94
  68   0.0284     99.040  0.0098    99.708  886.86
  69   0.0263     99.160  0.0093    99.753  899.90
  70   0.0297     99.050  0.0092    99.723  912.80
  71   0.0260     99.140  0.0090    99.762  925.71
  72   0.0277     99.080  0.0095    99.728  938.63
  73   0.0282     99.050  0.0086    99.747  951.51
  74   0.0289     99.060  0.0092    99.737  964.41
  75   0.0258     99.150  0.0084    99.765  977.43
  76   0.0284     99.070  0.0087    99.727  990.35
  77   0.0277     99.070  0.0087    99.750  1003.23
  78   0.0257     99.120  0.0085    99.740  1016.24
  79   0.0262     99.140  0.0081    99.778  1029.18
  80   0.0251     99.210  0.0079    99.785  1042.10
  81   0.0245     99.160  0.0080    99.772  1055.16
  82   0.0278     99.100  0.0076    99.783  1068.06
  83   0.0262     99.140  0.0074    99.782  1080.96
  84   0.0262     99.130  0.0079    99.777  1093.84
  85   0.0303     98.920  0.0077    99.770  1106.78
