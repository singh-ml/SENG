Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2486     91.340  0.6660    77.212  14.78
   2   0.0958     96.840  0.1284    96.068  27.18
   3   0.1002     96.630  0.0847    97.320  39.54
   4   0.0666     97.910  0.0703    97.807  51.91
   5   0.0620     97.920  0.0587    98.143  64.29
   6   0.0616     98.170  0.0522    98.318  76.67
   7   0.0583     98.100  0.0482    98.447  89.04
   8   0.0519     98.480  0.0445    98.540  101.43
   9   0.0471     98.470  0.0416    98.707  113.80
  10   0.0561     98.090  0.0382    98.812  126.17
  11   0.0396     98.720  0.0371    98.832  138.62
  12   0.0459     98.560  0.0346    98.892  151.00
  13   0.0430     98.560  0.0330    98.947  163.36
  14   0.0368     98.880  0.0307    99.025  175.75
  15   0.0428     98.560  0.0302    99.047  188.25
  16   0.0375     98.810  0.0293    99.055  200.73
  17   0.0362     98.770  0.0280    99.080  213.12
  18   0.0430     98.640  0.0268    99.150  225.68
  19   0.0427     98.690  0.0246    99.215  238.07
  20   0.0428     98.520  0.0251    99.223  250.44
  21   0.0464     98.420  0.0247    99.190  262.92
  22   0.0355     98.860  0.0234    99.217  275.30
  23   0.0372     98.800  0.0223    99.257  287.71
  24   0.0318     98.910  0.0218    99.297  300.11
  25   0.0336     98.970  0.0223    99.267  312.51
  26   0.0381     98.690  0.0208    99.317  324.87
  27   0.0265     99.060  0.0200    99.330  337.24
  28   0.0396     98.720  0.0183    99.405  349.71
  29   0.0393     98.790  0.0191    99.382  362.10
  30   0.0293     99.100  0.0182    99.395  374.47
  31   0.0400     98.810  0.0182    99.405  387.02
  32   0.0291     99.070  0.0195    99.363  399.41
  33   0.0321     98.980  0.0163    99.450  411.78
  34   0.0346     98.860  0.0165    99.432  424.17
  35   0.0287     99.060  0.0164    99.475  436.69
  36   0.0397     98.720  0.0147    99.505  449.06
  37   0.0318     98.910  0.0151    99.517  461.42
  38   0.0332     98.970  0.0144    99.507  474.01
  39   0.0283     99.110  0.0147    99.502  486.36
  40   0.0401     98.730  0.0132    99.588  498.75
  41   0.0340     98.970  0.0129    99.580  511.21
  42   0.0275     99.120  0.0133    99.553  523.58
  43   0.0337     98.900  0.0132    99.543  535.97
  44   0.0337     98.880  0.0134    99.555  548.45
  45   0.0349     98.880  0.0128    99.575  560.82
  46   0.0331     98.970  0.0119    99.612  573.21
  47   0.0312     98.880  0.0123    99.607  585.70
  48   0.0317     98.950  0.0110    99.633  598.10
  49   0.0302     99.000  0.0102    99.708  610.48
  50   0.0297     99.040  0.0101    99.697  622.86
  51   0.0387     98.810  0.0111    99.630  635.22
  52   0.0332     98.880  0.0103    99.662  647.61
  53   0.0395     98.750  0.0091    99.712  660.02
  54   0.0290     99.050  0.0101    99.648  672.41
  55   0.0245     99.200  0.0094    99.702  684.80
  56   0.0324     98.930  0.0090    99.713  697.17
  57   0.0320     98.960  0.0088    99.707  709.68
  58   0.0280     99.150  0.0090    99.698  722.06
  59   0.0293     99.070  0.0084    99.752  734.44
  60   0.0340     98.960  0.0072    99.773  746.92
  61   0.0325     99.000  0.0079    99.767  759.30
  62   0.0296     99.070  0.0075    99.747  771.69
  63   0.0352     98.960  0.0083    99.745  784.17
  64   0.0311     99.100  0.0074    99.748  796.53
  65   0.0335     98.910  0.0067    99.787  808.86
  66   0.0331     98.940  0.0065    99.802  821.23
  67   0.0341     98.910  0.0070    99.790  833.74
  68   0.0320     98.940  0.0067    99.793  846.12
  69   0.0340     98.920  0.0071    99.780  858.49
  70   0.0293     99.080  0.0069    99.793  870.97
  71   0.0302     98.970  0.0065    99.773  883.33
  72   0.0293     99.020  0.0063    99.783  895.70
  73   0.0286     99.090  0.0063    99.823  908.19
  74   0.0285     99.150  0.0059    99.803  920.57
  75   0.0342     98.940  0.0058    99.817  932.95
  76   0.0322     98.950  0.0054    99.832  945.45
  77   0.0271     99.160  0.0055    99.825  957.83
  78   0.0313     99.000  0.0051    99.843  970.22
  79   0.0325     99.030  0.0052    99.855  982.60
  80   0.0331     98.980  0.0048    99.870  995.08
  81   0.0313     99.040  0.0048    99.860  1007.47
  82   0.0331     99.010  0.0049    99.845  1019.85
  83   0.0306     99.030  0.0051    99.848  1032.36
  84   0.0296     99.060  0.0047    99.868  1044.73
  85   0.0343     98.880  0.0049    99.852  1057.08
  86   0.0307     99.070  0.0046    99.848  1069.52
  87   0.0340     98.910  0.0049    99.847  1081.90
  88   0.0355     98.890  0.0044    99.857  1094.28
  89   0.0284     99.080  0.0045    99.863  1106.63
  90   0.0317     99.060  0.0043    99.877  1118.99
