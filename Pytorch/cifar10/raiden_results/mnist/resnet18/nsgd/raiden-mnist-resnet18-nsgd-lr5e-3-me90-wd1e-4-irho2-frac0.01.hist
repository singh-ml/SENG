Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3612     89.680  0.6567    77.520  14.61
   2   0.0939     96.870  0.1324    95.933  26.99
   3   0.0819     97.460  0.0874    97.295  39.32
   4   0.0833     97.360  0.0706    97.802  51.68
   5   0.0709     97.660  0.0598    98.133  64.08
   6   0.0551     98.160  0.0546    98.252  76.45
   7   0.0602     98.160  0.0494    98.427  88.83
   8   0.0513     98.380  0.0461    98.532  101.33
   9   0.0436     98.550  0.0424    98.665  113.70
  10   0.0403     98.740  0.0390    98.757  126.08
  11   0.0468     98.520  0.0370    98.782  138.45
  12   0.0478     98.430  0.0367    98.817  150.82
  13   0.0359     98.760  0.0343    98.902  163.21
  14   0.0373     98.860  0.0331    98.932  175.60
  15   0.0347     98.960  0.0312    99.008  188.14
  16   0.0357     98.800  0.0304    98.975  200.51
  17   0.0398     98.790  0.0295    99.058  212.92
  18   0.0411     98.680  0.0275    99.138  225.43
  19   0.0345     98.810  0.0277    99.092  237.82
  20   0.0336     98.820  0.0270    99.130  250.18
  21   0.0311     98.890  0.0255    99.160  262.79
  22   0.0271     99.060  0.0248    99.178  275.15
  23   0.0303     98.970  0.0234    99.210  287.54
  24   0.0347     98.830  0.0242    99.193  299.90
  25   0.0302     99.040  0.0224    99.208  312.36
  26   0.0317     98.950  0.0217    99.248  324.75
  27   0.0326     98.930  0.0216    99.283  337.25
  28   0.0318     99.010  0.0209    99.323  349.60
  29   0.0367     98.730  0.0203    99.328  361.95
  30   0.0289     99.020  0.0197    99.338  374.32
  31   0.0344     98.930  0.0180    99.408  386.68
  32   0.0257     99.130  0.0170    99.415  399.05
  33   0.0329     98.900  0.0176    99.397  411.39
  34   0.0232     99.230  0.0180    99.423  423.88
  35   0.0266     99.160  0.0166    99.442  436.27
  36   0.0239     99.170  0.0164    99.468  448.61
  37   0.0336     98.870  0.0151    99.487  460.98
  38   0.0279     99.110  0.0160    99.480  473.44
  39   0.0300     99.010  0.0152    99.512  485.80
  40   0.0338     98.960  0.0148    99.538  498.13
  41   0.0277     99.150  0.0144    99.523  510.49
  42   0.0255     99.190  0.0142    99.527  522.85
  43   0.0305     99.020  0.0133    99.562  535.25
  44   0.0275     99.050  0.0132    99.577  547.64
  45   0.0271     99.100  0.0131    99.562  559.99
  46   0.0310     99.000  0.0129    99.550  572.37
  47   0.0272     99.150  0.0119    99.607  584.86
  48   0.0333     98.890  0.0120    99.588  597.19
  49   0.0317     99.000  0.0114    99.612  609.57
  50   0.0323     98.990  0.0111    99.648  621.95
  51   0.0265     99.190  0.0106    99.632  634.38
  52   0.0257     99.130  0.0112    99.642  646.72
  53   0.0274     99.140  0.0108    99.667  659.07
  54   0.0271     99.130  0.0102    99.643  671.61
  55   0.0244     99.270  0.0097    99.693  683.99
  56   0.0264     99.190  0.0090    99.713  696.38
  57   0.0320     99.010  0.0099    99.708  708.88
  58   0.0282     99.110  0.0096    99.707  721.25
  59   0.0266     99.100  0.0088    99.722  733.64
  60   0.0336     99.030  0.0082    99.728  746.09
  61   0.0289     99.020  0.0086    99.700  758.44
  62   0.0305     99.040  0.0083    99.740  770.82
  63   0.0281     99.140  0.0081    99.743  783.21
  64   0.0275     99.180  0.0080    99.733  795.59
  65   0.0253     99.150  0.0074    99.752  807.93
  66   0.0260     99.240  0.0072    99.782  820.28
  67   0.0330     98.980  0.0073    99.777  832.62
  68   0.0301     99.140  0.0071    99.775  845.00
  69   0.0269     99.140  0.0070    99.783  857.38
  70   0.0319     98.920  0.0070    99.795  869.84
  71   0.0264     99.150  0.0069    99.768  882.20
  72   0.0287     99.100  0.0061    99.817  894.59
  73   0.0274     99.180  0.0065    99.800  907.08
  74   0.0266     99.170  0.0064    99.800  919.45
  75   0.0267     99.160  0.0061    99.803  931.84
  76   0.0255     99.210  0.0057    99.812  944.20
  77   0.0261     99.120  0.0059    99.835  956.56
  78   0.0267     99.130  0.0058    99.832  968.92
  79   0.0256     99.180  0.0055    99.835  981.29
  80   0.0232     99.260  0.0057    99.847  993.68
  81   0.0273     99.160  0.0054    99.820  1006.04
  82   0.0260     99.200  0.0056    99.820  1018.39
  83   0.0301     99.070  0.0052    99.827  1030.76
  84   0.0269     99.220  0.0052    99.837  1043.11
  85   0.0276     99.210  0.0050    99.840  1055.47
  86   0.0288     99.130  0.0052    99.852  1067.86
  87   0.0286     99.190  0.0050    99.838  1080.33
  88   0.0312     99.050  0.0046    99.870  1092.67
  89   0.0265     99.220  0.0048    99.837  1105.18
  90   0.0301     99.070  0.0048    99.848  1117.55
