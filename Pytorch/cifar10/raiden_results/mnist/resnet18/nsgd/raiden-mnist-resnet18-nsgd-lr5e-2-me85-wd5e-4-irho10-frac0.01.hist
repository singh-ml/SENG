Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.0915     29.280  2.3350    26.640  14.83
   2   0.8994     68.630  0.9861    63.192  27.28
   3   0.2264     92.920  0.3239    89.857  39.69
   4   0.1420     95.540  0.1543    95.373  52.28
   5   0.1572     94.970  0.1015    96.857  64.69
   6   0.0849     97.190  0.0804    97.518  77.07
   7   0.0619     97.890  0.0682    97.883  89.75
   8   0.0774     97.400  0.0615    98.182  102.13
   9   0.0503     98.330  0.0581    98.232  114.72
  10   0.0581     98.100  0.0562    98.197  127.20
  11   0.0447     98.490  0.0539    98.335  139.81
  12   0.0590     97.970  0.0501    98.447  152.41
  13   0.0635     98.010  0.0481    98.503  165.00
  14   0.0524     98.250  0.0472    98.558  177.58
  15   0.0637     97.810  0.0451    98.605  189.93
  16   0.1248     96.370  0.0417    98.705  202.43
  17   0.0577     98.200  0.0463    98.560  215.03
  18   0.0458     98.560  0.0412    98.702  227.65
  19   0.0519     98.260  0.0405    98.728  240.35
  20   0.0483     98.390  0.0394    98.792  252.97
  21   0.0491     98.430  0.0418    98.612  265.56
  22   0.0433     98.670  0.0376    98.800  278.14
  23   0.0351     98.780  0.0379    98.808  290.90
  24   0.0390     98.740  0.0364    98.833  303.51
  25   0.0486     98.380  0.0349    98.920  315.91
  26   0.0407     98.750  0.0389    98.800  328.52
  27   0.0435     98.760  0.0325    99.005  341.14
  28   0.0659     97.990  0.0356    98.830  353.53
  29   0.0500     98.400  0.0340    98.893  366.22
  30   0.0449     98.480  0.0326    98.927  378.82
  31   0.0543     98.120  0.0323    98.993  391.41
  32   0.0571     98.260  0.0333    98.922  404.06
  33   0.0477     98.450  0.0304    99.005  416.42
  34   0.0310     98.940  0.0286    99.083  429.03
  35   0.0409     98.750  0.0291    99.058  441.61
  36   0.0929     96.910  0.0307    99.067  454.02
  37   0.0413     98.640  0.0281    99.133  466.59
  38   0.0491     98.390  0.0269    99.155  479.19
  39   0.0397     98.760  0.0278    99.090  491.92
  40   0.0331     98.980  0.0274    99.152  504.55
  41   0.0342     98.810  0.0250    99.177  517.14
  42   0.0279     99.090  0.0260    99.128  529.86
  43   0.0448     98.500  0.0237    99.235  542.45
  44   0.0387     98.700  0.0248    99.177  555.07
  45   0.0313     98.880  0.0248    99.183  567.68
  46   0.0287     99.070  0.0203    99.363  580.27
  47   0.0394     98.710  0.0217    99.292  592.87
  48   0.0382     98.780  0.0217    99.288  605.39
  49   0.0416     98.650  0.0189    99.378  617.77
  50   0.0295     98.940  0.0176    99.430  630.38
  51   0.0335     98.880  0.0177    99.425  643.10
  52   0.0360     98.830  0.0173    99.400  655.49
  53   0.0339     98.930  0.0170    99.438  667.89
  54   0.0336     98.850  0.0161    99.462  680.61
  55   0.0250     99.100  0.0153    99.488  693.00
  56   0.0308     98.910  0.0144    99.542  705.58
  57   0.0442     98.680  0.0130    99.532  717.99
  58   0.0215     99.310  0.0126    99.598  730.58
  59   0.0353     98.800  0.0111    99.642  743.16
  60   0.0278     99.100  0.0116    99.627  755.78
  61   0.0385     98.770  0.0116    99.612  768.47
  62   0.0261     99.280  0.0103    99.633  781.08
  63   0.0271     99.130  0.0091    99.700  793.69
  64   0.0226     99.240  0.0081    99.738  806.19
  65   0.0200     99.320  0.0078    99.740  818.81
  66   0.0269     99.150  0.0066    99.802  831.36
  67   0.0260     99.180  0.0059    99.795  843.98
  68   0.0249     99.230  0.0060    99.795  856.53
  69   0.0243     99.080  0.0055    99.812  869.12
  70   0.0296     99.070  0.0047    99.860  881.84
  71   0.0300     99.100  0.0047    99.843  894.24
  72   0.0275     99.080  0.0045    99.858  906.83
  73   0.0256     99.180  0.0037    99.893  919.19
  74   0.0260     99.180  0.0034    99.888  931.80
  75   0.0275     99.230  0.0031    99.905  944.39
  76   0.0296     99.080  0.0031    99.903  956.97
  77   0.0280     99.150  0.0027    99.915  969.51
  78   0.0275     99.130  0.0028    99.927  982.10
  79   0.0290     99.130  0.0026    99.925  994.71
  80   0.0264     99.160  0.0022    99.943  1007.31
  81   0.0273     99.170  0.0022    99.940  1019.94
  82   0.0290     99.170  0.0019    99.952  1032.56
  83   0.0283     99.120  0.0021    99.947  1045.38
  84   0.0278     99.170  0.0019    99.955  1058.03
  85   0.0298     99.100  0.0018    99.957  1070.50
