Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2839     12.240  3.0300    11.265  14.79
   2   1.3712     43.280  1.9495    25.687  27.06
   3   0.7901     76.590  0.7493    73.552  39.37
   4   0.3704     86.990  0.3049    90.392  51.76
   5   0.1251     95.980  0.1785    94.508  64.02
   6   0.1521     95.310  0.1291    96.063  76.26
   7   0.1929     93.840  0.1033    96.862  88.63
   8   0.0714     97.770  0.0879    97.305  100.89
   9   0.0781     97.540  0.0754    97.657  113.17
  10   0.1073     96.580  0.0718    97.742  125.57
  11   0.0826     97.510  0.0628    98.070  137.85
  12   0.0750     97.650  0.0619    98.025  150.11
  13   0.0574     98.020  0.0587    98.127  162.56
  14   0.0560     98.020  0.0536    98.308  175.03
  15   0.0584     98.090  0.0524    98.347  187.29
  16   0.0566     98.220  0.0491    98.475  199.55
  17   0.0329     98.760  0.0495    98.452  212.00
  18   0.0454     98.510  0.0454    98.602  224.27
  19   0.0416     98.710  0.0439    98.602  236.52
  20   0.0492     98.580  0.0454    98.533  248.93
  21   0.0559     98.110  0.0423    98.643  261.41
  22   0.0703     97.720  0.0426    98.635  273.87
  23   0.0676     97.850  0.0412    98.695  286.41
  24   0.0542     98.280  0.0404    98.742  298.69
  25   0.0693     97.710  0.0370    98.837  310.95
  26   0.0470     98.490  0.0391    98.767  323.31
  27   0.0336     98.890  0.0378    98.828  335.78
  28   0.0613     98.020  0.0369    98.853  348.04
  29   0.0552     98.140  0.0361    98.843  360.29
  30   0.0499     98.470  0.0373    98.843  372.52
  31   0.0369     98.790  0.0347    98.860  384.76
  32   0.0629     98.190  0.0343    98.912  397.19
  33   0.0421     98.550  0.0346    98.877  409.44
  34   0.0488     98.440  0.0317    98.982  421.70
  35   0.0486     98.450  0.0333    98.935  433.94
  36   0.0295     99.140  0.0298    99.068  446.36
  37   0.0388     98.690  0.0304    99.013  458.62
  38   0.0637     98.070  0.0300    99.045  470.88
  39   0.0302     99.000  0.0298    98.993  483.14
  40   0.0569     98.160  0.0287    99.075  495.42
  41   0.0302     99.110  0.0276    99.105  507.69
  42   0.0409     98.630  0.0280    99.083  520.17
  43   0.0299     99.120  0.0264    99.147  532.42
  44   0.0419     98.610  0.0256    99.188  544.66
  45   0.0368     98.750  0.0225    99.273  556.94
  46   0.0392     98.660  0.0246    99.217  569.29
  47   0.0385     98.770  0.0231    99.262  581.55
  48   0.0353     98.890  0.0232    99.213  593.77
  49   0.0371     98.750  0.0235    99.268  606.32
  50   0.0394     98.750  0.0208    99.317  618.56
  51   0.0235     99.270  0.0198    99.345  630.77
  52   0.0269     99.150  0.0195    99.348  643.03
  53   0.0341     98.810  0.0189    99.375  655.28
  54   0.0336     98.980  0.0171    99.442  667.75
  55   0.0335     98.860  0.0186    99.393  680.05
  56   0.0257     99.220  0.0164    99.467  692.41
  57   0.0295     99.000  0.0169    99.455  704.65
  58   0.0262     99.150  0.0144    99.510  717.10
  59   0.0294     99.010  0.0150    99.512  729.69
  60   0.0425     98.660  0.0144    99.537  741.95
  61   0.0287     99.010  0.0125    99.568  754.19
  62   0.0269     99.110  0.0119    99.615  766.63
  63   0.0262     99.110  0.0118    99.602  778.86
  64   0.0248     99.180  0.0116    99.620  791.09
  65   0.0315     99.060  0.0104    99.680  803.33
  66   0.0277     99.110  0.0099    99.688  815.61
  67   0.0284     98.990  0.0097    99.667  828.09
  68   0.0271     99.130  0.0098    99.690  840.34
  69   0.0257     99.160  0.0083    99.735  852.72
  70   0.0247     99.270  0.0081    99.748  864.96
  71   0.0232     99.190  0.0076    99.762  877.22
  72   0.0274     99.120  0.0068    99.792  889.78
  73   0.0273     99.170  0.0063    99.802  902.07
  74   0.0304     99.110  0.0062    99.805  914.31
  75   0.0269     99.240  0.0054    99.837  926.75
  76   0.0310     99.120  0.0052    99.820  939.02
  77   0.0284     99.090  0.0050    99.840  951.25
  78   0.0286     99.130  0.0049    99.853  963.51
  79   0.0255     99.180  0.0042    99.875  975.79
  80   0.0237     99.190  0.0039    99.883  988.03
  81   0.0276     99.180  0.0039    99.888  1000.29
  82   0.0259     99.170  0.0039    99.882  1012.70
  83   0.0286     99.140  0.0039    99.873  1024.94
  84   0.0271     99.170  0.0038    99.882  1037.19
  85   0.0277     99.100  0.0035    99.897  1049.60
  86   0.0274     99.110  0.0032    99.915  1062.05
  87   0.0282     99.130  0.0033    99.912  1074.37
  88   0.0279     99.120  0.0032    99.913  1086.98
  89   0.0272     99.170  0.0031    99.910  1099.25
  90   0.0286     99.110  0.0034    99.905  1111.75
