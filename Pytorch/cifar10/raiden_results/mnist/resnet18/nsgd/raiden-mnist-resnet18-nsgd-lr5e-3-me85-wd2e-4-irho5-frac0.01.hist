Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1133     96.480  0.4559    84.277  14.67
   2   0.0792     97.260  0.0908    97.120  27.11
   3   0.0795     97.350  0.0679    97.875  39.64
   4   0.0796     97.300  0.0587    98.125  52.06
   5   0.0834     97.340  0.0518    98.340  64.57
   6   0.0529     98.360  0.0458    98.558  77.00
   7   0.0654     97.740  0.0413    98.680  89.41
   8   0.0347     98.850  0.0393    98.683  101.76
   9   0.0396     98.870  0.0367    98.832  114.13
  10   0.0388     98.800  0.0354    98.888  126.51
  11   0.0864     97.110  0.0319    98.953  138.91
  12   0.0530     98.160  0.0310    99.012  151.30
  13   0.0500     98.360  0.0299    99.007  163.70
  14   0.0356     98.880  0.0284    99.112  176.08
  15   0.0389     98.740  0.0269    99.107  188.44
  16   0.0508     98.260  0.0265    99.132  200.93
  17   0.0281     99.070  0.0266    99.172  213.30
  18   0.0381     98.790  0.0240    99.235  225.69
  19   0.0302     99.080  0.0238    99.253  238.06
  20   0.0365     98.790  0.0214    99.295  250.44
  21   0.0313     99.010  0.0216    99.277  262.83
  22   0.0362     98.900  0.0211    99.305  275.21
  23   0.0290     98.980  0.0194    99.362  287.60
  24   0.0385     98.860  0.0199    99.362  299.99
  25   0.0283     98.970  0.0185    99.372  312.34
  26   0.0295     99.010  0.0175    99.432  324.89
  27   0.0333     98.860  0.0183    99.378  337.25
  28   0.0299     98.980  0.0185    99.345  349.63
  29   0.0326     98.930  0.0159    99.482  361.99
  30   0.0322     98.930  0.0170    99.432  374.36
  31   0.0330     98.820  0.0160    99.490  386.73
  32   0.0353     98.820  0.0154    99.463  399.10
  33   0.0293     98.970  0.0147    99.503  411.55
  34   0.0355     98.820  0.0135    99.518  423.92
  35   0.0351     98.920  0.0122    99.610  436.30
  36   0.0337     98.910  0.0132    99.557  448.80
  37   0.0307     99.020  0.0135    99.535  461.16
  38   0.0284     99.060  0.0129    99.562  473.51
  39   0.0376     98.960  0.0119    99.598  485.91
  40   0.0261     99.150  0.0110    99.617  498.27
  41   0.0319     99.020  0.0117    99.602  510.64
  42   0.0306     98.990  0.0112    99.613  523.02
  43   0.0375     98.800  0.0099    99.677  535.38
  44   0.0266     99.090  0.0103    99.658  547.72
  45   0.0307     99.060  0.0101    99.647  560.09
  46   0.0323     98.950  0.0092    99.695  572.59
  47   0.0323     98.910  0.0092    99.680  584.97
  48   0.0274     99.080  0.0091    99.698  597.32
  49   0.0297     99.050  0.0087    99.715  609.82
  50   0.0348     99.030  0.0088    99.712  622.18
  51   0.0298     99.060  0.0084    99.740  634.57
  52   0.0265     99.180  0.0074    99.762  647.04
  53   0.0270     99.060  0.0065    99.777  659.42
  54   0.0310     99.150  0.0073    99.747  671.80
  55   0.0347     98.980  0.0069    99.773  684.21
  56   0.0294     99.110  0.0067    99.785  696.57
  57   0.0279     99.200  0.0060    99.832  708.93
  58   0.0332     99.000  0.0056    99.820  721.29
  59   0.0326     99.010  0.0057    99.807  733.65
  60   0.0267     99.180  0.0056    99.803  746.01
  61   0.0352     98.880  0.0052    99.812  758.36
  62   0.0289     99.120  0.0049    99.857  770.84
  63   0.0279     99.100  0.0060    99.800  783.21
  64   0.0349     98.870  0.0051    99.830  795.57
  65   0.0304     99.020  0.0048    99.828  808.06
  66   0.0314     99.030  0.0049    99.840  820.43
  67   0.0336     98.980  0.0049    99.832  832.77
  68   0.0346     98.980  0.0042    99.867  845.16
  69   0.0339     99.020  0.0041    99.867  857.60
  70   0.0321     99.020  0.0042    99.862  869.95
  71   0.0315     99.110  0.0043    99.873  882.31
  72   0.0332     99.090  0.0039    99.887  894.83
  73   0.0314     99.040  0.0040    99.860  907.21
  74   0.0320     99.060  0.0040    99.880  919.55
  75   0.0338     99.060  0.0036    99.895  932.03
  76   0.0286     99.210  0.0035    99.880  944.37
  77   0.0292     99.150  0.0034    99.893  956.69
  78   0.0283     99.140  0.0032    99.902  969.19
  79   0.0291     99.190  0.0032    99.903  981.58
  80   0.0338     99.040  0.0035    99.878  993.93
  81   0.0315     99.130  0.0031    99.902  1006.41
  82   0.0348     99.080  0.0031    99.910  1018.78
  83   0.0327     99.100  0.0031    99.902  1031.13
  84   0.0359     99.070  0.0023    99.947  1043.51
  85   0.0349     99.060  0.0026    99.923  1056.13
