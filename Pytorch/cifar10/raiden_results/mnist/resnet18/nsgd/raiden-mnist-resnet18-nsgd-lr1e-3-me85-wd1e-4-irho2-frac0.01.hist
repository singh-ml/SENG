Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5770     82.870  1.4467    53.370  14.62
   2   0.2817     91.240  0.4036    87.948  27.16
   3   0.1930     94.040  0.2382    92.875  39.60
   4   0.1452     95.320  0.1738    94.763  52.04
   5   0.1228     96.060  0.1390    95.720  64.49
   6   0.0929     97.090  0.1174    96.383  76.95
   7   0.0864     97.290  0.1012    96.910  89.34
   8   0.0862     97.260  0.0893    97.310  101.76
   9   0.0733     97.680  0.0816    97.535  114.16
  10   0.0816     97.350  0.0733    97.770  126.56
  11   0.0652     98.030  0.0684    97.903  138.95
  12   0.0612     97.990  0.0651    97.977  151.33
  13   0.0550     98.170  0.0613    98.095  163.72
  14   0.0646     97.880  0.0578    98.172  176.10
  15   0.0593     98.130  0.0545    98.330  188.61
  16   0.0542     98.200  0.0539    98.333  200.98
  17   0.0529     98.190  0.0504    98.447  213.40
  18   0.0514     98.300  0.0482    98.483  225.92
  19   0.0483     98.450  0.0466    98.538  238.32
  20   0.0518     98.380  0.0447    98.570  250.75
  21   0.0462     98.450  0.0433    98.668  263.15
  22   0.0427     98.560  0.0420    98.713  275.53
  23   0.0472     98.490  0.0408    98.708  287.94
  24   0.0430     98.520  0.0386    98.722  300.35
  25   0.0479     98.390  0.0386    98.777  312.85
  26   0.0382     98.760  0.0379    98.837  325.21
  27   0.0372     98.790  0.0354    98.887  337.63
  28   0.0473     98.350  0.0356    98.872  350.00
  29   0.0397     98.740  0.0348    98.900  362.40
  30   0.0437     98.490  0.0345    98.915  374.76
  31   0.0399     98.680  0.0345    98.932  387.17
  32   0.0379     98.700  0.0327    98.955  399.56
  33   0.0418     98.540  0.0317    98.950  411.95
  34   0.0386     98.670  0.0311    98.980  424.31
  35   0.0351     98.750  0.0303    99.038  436.81
  36   0.0416     98.630  0.0289    99.063  449.22
  37   0.0368     98.740  0.0295    99.057  461.61
  38   0.0376     98.690  0.0279    99.125  474.10
  39   0.0402     98.620  0.0272    99.112  486.46
  40   0.0387     98.780  0.0273    99.143  498.86
  41   0.0377     98.740  0.0269    99.155  511.24
  42   0.0376     98.720  0.0272    99.092  523.60
  43   0.0380     98.680  0.0264    99.123  535.97
  44   0.0407     98.620  0.0254    99.163  548.31
  45   0.0437     98.630  0.0252    99.175  560.66
  46   0.0340     98.830  0.0247    99.225  573.05
  47   0.0337     98.820  0.0240    99.243  585.44
  48   0.0308     98.960  0.0245    99.203  597.94
  49   0.0390     98.700  0.0221    99.277  610.32
  50   0.0447     98.470  0.0237    99.242  622.69
  51   0.0413     98.490  0.0232    99.257  635.19
  52   0.0326     98.930  0.0225    99.233  647.53
  53   0.0336     98.760  0.0221    99.282  659.92
  54   0.0362     98.760  0.0218    99.293  672.41
  55   0.0342     98.810  0.0213    99.298  684.79
  56   0.0343     98.860  0.0215    99.283  697.14
  57   0.0384     98.760  0.0206    99.342  709.59
  58   0.0469     98.470  0.0207    99.333  721.95
  59   0.0325     98.880  0.0208    99.320  734.29
  60   0.0398     98.740  0.0199    99.380  746.64
  61   0.0307     98.910  0.0192    99.392  759.01
  62   0.0364     98.830  0.0189    99.395  771.38
  63   0.0349     98.850  0.0189    99.413  783.74
  64   0.0393     98.620  0.0186    99.410  796.21
  65   0.0361     98.800  0.0188    99.405  808.59
  66   0.0349     98.790  0.0176    99.438  820.98
  67   0.0337     98.880  0.0190    99.365  833.47
  68   0.0329     98.810  0.0187    99.393  845.85
  69   0.0344     98.900  0.0176    99.447  858.23
  70   0.0321     98.960  0.0169    99.448  870.72
  71   0.0343     98.910  0.0164    99.468  883.07
  72   0.0351     98.820  0.0170    99.465  895.41
  73   0.0327     98.890  0.0173    99.458  907.78
  74   0.0288     99.090  0.0168    99.498  920.15
  75   0.0437     98.600  0.0152    99.492  932.51
  76   0.0388     98.710  0.0164    99.470  944.88
  77   0.0346     98.870  0.0160    99.468  957.27
  78   0.0322     99.020  0.0169    99.455  969.64
  79   0.0351     98.850  0.0155    99.480  982.03
  80   0.0299     98.970  0.0149    99.550  994.52
  81   0.0337     98.830  0.0148    99.530  1006.91
  82   0.0295     99.060  0.0141    99.517  1019.29
  83   0.0378     98.950  0.0149    99.530  1031.81
  84   0.0328     98.880  0.0141    99.548  1044.24
  85   0.0377     98.760  0.0132    99.560  1056.63
