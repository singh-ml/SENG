Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2624     91.220  0.6634    77.027  14.85
   2   0.1541     95.140  0.1195    96.318  27.48
   3   0.1069     96.410  0.0825    97.468  39.93
   4   0.0879     97.300  0.0672    97.882  52.45
   5   0.0579     98.120  0.0592    98.173  65.05
   6   0.0490     98.370  0.0524    98.320  77.53
   7   0.0659     97.700  0.0474    98.522  90.02
   8   0.0631     97.920  0.0441    98.562  102.52
   9   0.0382     98.760  0.0407    98.735  115.16
  10   0.0458     98.460  0.0384    98.753  127.63
  11   0.0405     98.760  0.0370    98.775  140.09
  12   0.0356     98.730  0.0346    98.917  152.69
  13   0.0357     98.810  0.0316    98.940  165.16
  14   0.0304     98.970  0.0323    99.003  177.61
  15   0.0609     97.950  0.0301    99.058  190.12
  16   0.0426     98.530  0.0282    99.078  202.59
  17   0.0394     98.730  0.0279    99.072  215.05
  18   0.0415     98.590  0.0270    99.152  227.53
  19   0.0366     98.770  0.0251    99.192  239.99
  20   0.0361     98.710  0.0247    99.148  252.49
  21   0.0388     98.840  0.0257    99.153  264.98
  22   0.0361     98.780  0.0233    99.263  277.47
  23   0.0458     98.300  0.0232    99.220  289.96
  24   0.0319     98.860  0.0217    99.287  302.46
  25   0.0320     98.860  0.0219    99.302  315.07
  26   0.0340     99.000  0.0207    99.335  327.52
  27   0.0396     98.740  0.0201    99.370  339.99
  28   0.0308     98.920  0.0200    99.362  352.60
  29   0.0285     99.110  0.0183    99.398  365.07
  30   0.0367     98.680  0.0186    99.368  377.56
  31   0.0270     99.020  0.0177    99.412  390.19
  32   0.0343     98.900  0.0175    99.435  402.67
  33   0.0356     98.800  0.0168    99.452  415.14
  34   0.0370     98.770  0.0160    99.498  427.64
  35   0.0365     98.810  0.0161    99.477  440.09
  36   0.0284     99.000  0.0157    99.497  452.55
  37   0.0226     99.220  0.0142    99.533  465.04
  38   0.0287     99.050  0.0154    99.473  477.54
  39   0.0377     98.630  0.0141    99.522  490.02
  40   0.0268     99.090  0.0135    99.540  502.48
  41   0.0303     98.940  0.0141    99.547  515.10
  42   0.0257     99.090  0.0130    99.563  527.58
  43   0.0299     98.990  0.0126    99.588  540.05
  44   0.0285     99.100  0.0124    99.590  552.62
  45   0.0315     98.960  0.0125    99.578  565.09
  46   0.0312     98.980  0.0116    99.628  577.57
  47   0.0255     99.140  0.0117    99.638  590.14
  48   0.0260     99.130  0.0107    99.628  602.64
  49   0.0284     99.050  0.0108    99.643  615.15
  50   0.0272     98.980  0.0108    99.640  627.66
  51   0.0328     98.950  0.0102    99.650  640.16
  52   0.0326     98.880  0.0097    99.710  652.63
  53   0.0285     99.080  0.0093    99.720  665.12
  54   0.0320     99.030  0.0096    99.678  677.59
  55   0.0266     99.130  0.0090    99.710  690.05
  56   0.0291     99.020  0.0090    99.718  702.50
  57   0.0282     99.000  0.0086    99.732  715.08
  58   0.0288     99.060  0.0091    99.710  727.56
  59   0.0300     99.030  0.0088    99.720  740.04
  60   0.0286     99.060  0.0085    99.723  752.60
  61   0.0311     98.970  0.0079    99.752  765.06
  62   0.0266     99.120  0.0081    99.738  777.54
  63   0.0256     99.120  0.0074    99.767  790.01
  64   0.0246     99.180  0.0073    99.762  802.44
  65   0.0280     98.990  0.0073    99.755  814.89
  66   0.0283     99.050  0.0069    99.800  827.40
  67   0.0274     99.070  0.0073    99.800  839.98
  68   0.0319     98.990  0.0067    99.803  852.50
  69   0.0252     99.160  0.0062    99.800  864.99
  70   0.0264     99.150  0.0062    99.803  877.59
  71   0.0264     99.130  0.0062    99.813  890.10
  72   0.0278     99.100  0.0061    99.827  902.59
  73   0.0286     99.120  0.0062    99.815  915.11
  74   0.0276     99.070  0.0058    99.832  927.61
  75   0.0259     99.100  0.0057    99.843  940.11
  76   0.0293     99.030  0.0058    99.818  952.61
  77   0.0299     99.050  0.0060    99.820  965.20
  78   0.0265     99.080  0.0058    99.848  977.69
  79   0.0274     99.050  0.0052    99.863  990.15
  80   0.0273     99.070  0.0056    99.850  1002.67
  81   0.0255     99.080  0.0055    99.823  1015.14
  82   0.0281     99.100  0.0050    99.850  1027.65
  83   0.0298     99.030  0.0054    99.853  1040.15
  84   0.0254     99.180  0.0053    99.843  1052.65
  85   0.0300     98.980  0.0053    99.855  1065.12
  86   0.0268     99.130  0.0049    99.867  1077.71
  87   0.0282     99.110  0.0046    99.867  1090.17
  88   0.0292     99.050  0.0048    99.878  1102.62
  89   0.0274     99.120  0.0045    99.882  1115.11
  90   0.0282     99.100  0.0044    99.875  1127.75
