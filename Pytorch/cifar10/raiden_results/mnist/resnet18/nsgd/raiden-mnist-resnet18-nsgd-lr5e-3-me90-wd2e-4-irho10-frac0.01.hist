Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1146     96.440  0.3987    86.475  14.88
   2   0.0709     97.790  0.0890    97.205  27.37
   3   0.0674     97.950  0.0643    97.932  39.88
   4   0.0717     97.690  0.0541    98.288  52.35
   5   0.0551     98.160  0.0508    98.463  64.83
   6   0.0497     98.360  0.0431    98.660  77.29
   7   0.0495     98.450  0.0405    98.698  89.75
   8   0.0354     98.840  0.0382    98.820  102.18
   9   0.0460     98.590  0.0369    98.840  114.65
  10   0.0320     98.930  0.0360    98.875  127.14
  11   0.0435     98.590  0.0328    98.912  139.66
  12   0.0379     98.670  0.0323    98.983  152.27
  13   0.0327     98.950  0.0294    98.992  164.73
  14   0.0457     98.510  0.0278    99.087  177.20
  15   0.0396     98.700  0.0278    99.115  189.66
  16   0.0305     98.950  0.0254    99.150  202.24
  17   0.0323     98.980  0.0262    99.115  214.70
  18   0.0337     98.920  0.0249    99.170  227.18
  19   0.0292     99.070  0.0224    99.287  239.66
  20   0.0269     99.170  0.0233    99.263  252.12
  21   0.0292     99.100  0.0214    99.305  264.60
  22   0.0307     99.010  0.0203    99.347  277.06
  23   0.0355     98.920  0.0205    99.340  289.59
  24   0.0385     98.710  0.0197    99.337  302.06
  25   0.0301     98.950  0.0194    99.382  314.48
  26   0.0284     99.110  0.0175    99.395  327.09
  27   0.0321     98.940  0.0176    99.467  339.52
  28   0.0369     98.890  0.0170    99.418  351.99
  29   0.0302     99.010  0.0169    99.450  364.45
  30   0.0325     99.020  0.0162    99.457  377.01
  31   0.0400     98.790  0.0160    99.427  389.46
  32   0.0401     98.730  0.0147    99.488  401.95
  33   0.0361     98.890  0.0148    99.517  414.53
  34   0.0311     99.100  0.0137    99.540  426.98
  35   0.0350     98.970  0.0131    99.582  439.45
  36   0.0343     98.930  0.0131    99.557  451.92
  37   0.0354     98.940  0.0134    99.535  464.39
  38   0.0349     98.950  0.0122    99.587  476.88
  39   0.0280     99.160  0.0124    99.580  489.37
  40   0.0381     98.820  0.0117    99.592  501.84
  41   0.0301     99.180  0.0109    99.625  514.31
  42   0.0282     99.180  0.0111    99.613  526.77
  43   0.0274     99.170  0.0106    99.638  539.38
  44   0.0340     98.950  0.0094    99.650  551.83
  45   0.0376     98.970  0.0092    99.710  564.34
  46   0.0305     99.060  0.0088    99.675  576.91
  47   0.0290     99.110  0.0093    99.710  589.34
  48   0.0369     98.870  0.0090    99.692  601.79
  49   0.0336     99.040  0.0086    99.692  614.36
  50   0.0295     99.150  0.0083    99.735  626.79
  51   0.0255     99.210  0.0078    99.748  639.24
  52   0.0373     98.900  0.0081    99.732  651.70
  53   0.0346     98.980  0.0077    99.735  664.14
  54   0.0375     99.050  0.0067    99.743  676.61
  55   0.0323     99.090  0.0070    99.762  689.08
  56   0.0348     99.020  0.0070    99.753  701.63
  57   0.0290     99.210  0.0058    99.800  714.12
  58   0.0319     99.070  0.0057    99.820  726.57
  59   0.0365     99.010  0.0052    99.817  739.18
  60   0.0285     99.110  0.0053    99.815  751.64
  61   0.0309     99.070  0.0049    99.838  764.09
  62   0.0363     99.070  0.0043    99.870  776.64
  63   0.0318     99.200  0.0051    99.835  789.06
  64   0.0371     99.030  0.0045    99.853  801.51
  65   0.0336     99.050  0.0047    99.832  813.98
  66   0.0296     99.120  0.0048    99.848  826.41
  67   0.0338     99.040  0.0037    99.878  838.85
  68   0.0307     99.150  0.0042    99.848  851.27
  69   0.0323     99.110  0.0037    99.878  863.82
  70   0.0348     99.050  0.0037    99.883  876.28
  71   0.0336     99.160  0.0034    99.882  888.82
  72   0.0327     99.070  0.0037    99.870  901.28
  73   0.0317     99.040  0.0034    99.892  913.74
  74   0.0304     99.180  0.0032    99.902  926.28
  75   0.0320     99.040  0.0030    99.900  938.81
  76   0.0294     99.140  0.0023    99.938  951.25
  77   0.0359     99.050  0.0027    99.925  963.71
  78   0.0341     99.110  0.0024    99.925  976.31
  79   0.0356     99.040  0.0026    99.918  988.77
  80   0.0392     99.010  0.0026    99.927  1001.20
  81   0.0348     99.070  0.0027    99.915  1013.60
  82   0.0355     99.090  0.0024    99.913  1026.18
  83   0.0386     98.880  0.0025    99.923  1038.64
  84   0.0366     99.070  0.0020    99.947  1051.11
  85   0.0347     99.160  0.0025    99.920  1063.64
  86   0.0339     99.140  0.0021    99.942  1076.07
  87   0.0342     99.120  0.0020    99.943  1088.49
  88   0.0331     99.130  0.0020    99.940  1100.99
  89   0.0386     99.000  0.0023    99.923  1113.48
  90   0.0377     99.030  0.0021    99.945  1125.95
