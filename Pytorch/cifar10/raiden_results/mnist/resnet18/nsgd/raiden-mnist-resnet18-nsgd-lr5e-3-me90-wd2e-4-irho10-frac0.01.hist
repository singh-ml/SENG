Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3218     90.460  0.4619    85.432  14.91
   2   0.1321     95.770  0.0911    97.145  27.34
   3   0.0729     97.560  0.0663    97.875  39.92
   4   0.0405     98.530  0.0545    98.300  52.32
   5   0.0394     98.780  0.0468    98.540  64.76
   6   0.0479     98.490  0.0460    98.610  77.27
   7   0.0601     98.060  0.0412    98.708  89.68
   8   0.0511     98.450  0.0380    98.773  102.09
   9   0.0716     97.870  0.0355    98.848  114.54
  10   0.0326     98.880  0.0342    98.913  127.00
  11   0.0480     98.360  0.0320    99.015  139.45
  12   0.0320     98.890  0.0315    98.988  151.83
  13   0.0419     98.690  0.0304    99.048  164.41
  14   0.0372     98.790  0.0281    99.060  176.82
  15   0.0495     98.290  0.0271    99.142  189.24
  16   0.0252     99.110  0.0254    99.202  201.80
  17   0.0434     98.750  0.0266    99.112  214.23
  18   0.0307     99.040  0.0267    99.147  226.64
  19   0.0482     98.410  0.0231    99.198  239.24
  20   0.0345     98.880  0.0223    99.253  251.64
  21   0.0246     99.180  0.0209    99.307  264.06
  22   0.0271     99.070  0.0205    99.295  276.60
  23   0.0255     99.220  0.0188    99.373  289.02
  24   0.0271     99.160  0.0191    99.407  301.43
  25   0.0310     99.030  0.0192    99.347  313.86
  26   0.0374     98.780  0.0179    99.410  326.27
  27   0.0299     99.010  0.0174    99.403  338.67
  28   0.0383     98.760  0.0165    99.452  351.08
  29   0.0290     99.170  0.0157    99.473  363.48
  30   0.0323     99.010  0.0151    99.497  375.89
  31   0.0325     99.030  0.0152    99.485  388.28
  32   0.0373     98.780  0.0162    99.435  400.81
  33   0.0311     99.060  0.0154    99.490  413.22
  34   0.0380     98.770  0.0151    99.498  425.64
  35   0.0418     98.790  0.0137    99.530  438.06
  36   0.0333     99.000  0.0129    99.580  450.44
  37   0.0341     98.920  0.0123    99.585  462.88
  38   0.0324     98.950  0.0127    99.557  475.26
  39   0.0297     99.060  0.0123    99.560  487.67
  40   0.0287     99.170  0.0108    99.645  500.11
  41   0.0412     98.730  0.0102    99.675  512.51
  42   0.0330     99.020  0.0099    99.685  525.04
  43   0.0327     99.020  0.0102    99.680  537.41
  44   0.0355     98.890  0.0109    99.605  549.81
  45   0.0427     98.840  0.0089    99.715  562.33
  46   0.0226     99.250  0.0086    99.693  574.73
  47   0.0407     98.790  0.0091    99.713  587.14
  48   0.0303     99.110  0.0088    99.698  599.55
  49   0.0273     99.170  0.0086    99.703  611.94
  50   0.0289     99.110  0.0084    99.685  624.37
  51   0.0270     99.220  0.0074    99.762  636.78
  52   0.0306     99.110  0.0073    99.758  649.34
  53   0.0321     99.000  0.0066    99.763  661.79
  54   0.0329     99.070  0.0066    99.778  674.20
  55   0.0319     99.040  0.0061    99.812  686.77
  56   0.0314     99.130  0.0066    99.765  699.17
  57   0.0311     99.170  0.0062    99.787  711.59
  58   0.0395     98.790  0.0058    99.837  724.02
  59   0.0378     98.960  0.0058    99.805  736.43
  60   0.0293     99.100  0.0057    99.820  748.83
  61   0.0266     99.230  0.0054    99.807  761.27
  62   0.0305     99.110  0.0047    99.853  773.80
  63   0.0315     99.090  0.0046    99.835  786.22
  64   0.0284     99.100  0.0049    99.827  798.64
  65   0.0303     99.150  0.0041    99.877  811.02
  66   0.0362     98.950  0.0045    99.855  823.56
  67   0.0244     99.350  0.0041    99.868  835.98
  68   0.0297     99.150  0.0039    99.887  848.37
  69   0.0310     99.030  0.0034    99.885  860.78
  70   0.0309     99.080  0.0036    99.877  873.30
  71   0.0347     99.050  0.0034    99.892  885.72
  72   0.0312     99.160  0.0032    99.905  898.11
  73   0.0330     99.030  0.0030    99.912  910.67
  74   0.0321     99.010  0.0030    99.908  923.09
  75   0.0283     99.070  0.0029    99.908  935.49
  76   0.0381     98.910  0.0026    99.922  947.90
  77   0.0356     99.010  0.0024    99.933  960.33
  78   0.0347     98.970  0.0026    99.905  972.75
  79   0.0311     99.100  0.0024    99.918  985.13
  80   0.0360     99.030  0.0026    99.925  997.64
  81   0.0324     99.150  0.0026    99.928  1010.07
  82   0.0320     99.070  0.0024    99.917  1022.48
  83   0.0326     99.100  0.0024    99.932  1034.87
  84   0.0341     99.080  0.0024    99.925  1047.30
  85   0.0388     98.990  0.0020    99.942  1059.67
  86   0.0366     99.010  0.0021    99.940  1072.08
  87   0.0351     99.080  0.0024    99.927  1084.50
  88   0.0401     99.040  0.0017    99.960  1096.94
  89   0.0397     98.950  0.0020    99.933  1109.48
  90   0.0350     99.100  0.0021    99.952  1121.89
