Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4108     86.760  1.3776    61.485  14.66
   2   0.1346     95.910  0.1895    93.887  27.00
   3   0.1369     95.530  0.0980    96.912  39.35
   4   0.0877     97.000  0.0729    97.705  51.80
   5   0.0587     97.950  0.0610    98.052  64.18
   6   0.0703     97.680  0.0562    98.242  76.57
   7   0.0457     98.460  0.0507    98.415  88.87
   8   0.0534     98.120  0.0471    98.542  101.24
   9   0.0449     98.560  0.0432    98.648  113.57
  10   0.0394     98.690  0.0414    98.677  125.88
  11   0.0341     98.890  0.0399    98.762  138.32
  12   0.0336     98.970  0.0392    98.712  150.60
  13   0.0504     98.240  0.0349    98.903  162.93
  14   0.0476     98.500  0.0357    98.868  175.34
  15   0.0433     98.580  0.0338    98.915  187.68
  16   0.0384     98.750  0.0344    98.878  200.01
  17   0.0361     98.830  0.0313    99.032  212.34
  18   0.0311     99.070  0.0302    99.037  224.64
  19   0.0358     98.740  0.0291    99.092  236.97
  20   0.0377     98.740  0.0296    99.043  249.29
  21   0.0314     98.930  0.0288    99.085  261.72
  22   0.0314     98.950  0.0274    99.078  274.03
  23   0.0390     98.790  0.0278    99.103  286.36
  24   0.0314     99.100  0.0268    99.117  298.77
  25   0.0368     98.830  0.0244    99.192  311.04
  26   0.0408     98.640  0.0245    99.203  323.35
  27   0.0417     98.660  0.0242    99.193  335.65
  28   0.0270     99.170  0.0233    99.275  348.02
  29   0.0224     99.300  0.0228    99.237  360.34
  30   0.0271     99.160  0.0220    99.245  372.68
  31   0.0234     99.210  0.0211    99.302  385.00
  32   0.0321     98.940  0.0210    99.322  397.33
  33   0.0361     98.750  0.0204    99.355  409.64
  34   0.0254     99.220  0.0194    99.383  421.95
  35   0.0309     99.060  0.0189    99.380  434.36
  36   0.0440     98.480  0.0181    99.402  446.69
  37   0.0286     99.110  0.0184    99.397  459.02
  38   0.0311     99.090  0.0162    99.473  471.38
  39   0.0397     98.640  0.0159    99.473  483.88
  40   0.0273     99.120  0.0169    99.430  496.20
  41   0.0259     99.170  0.0158    99.505  508.54
  42   0.0309     99.000  0.0159    99.458  520.99
  43   0.0256     99.270  0.0145    99.493  533.30
  44   0.0276     99.020  0.0130    99.597  545.62
  45   0.0308     99.020  0.0134    99.557  558.04
  46   0.0309     98.970  0.0138    99.543  570.36
  47   0.0328     98.980  0.0130    99.570  582.67
  48   0.0259     99.140  0.0120    99.618  594.99
  49   0.0275     99.010  0.0111    99.668  607.27
  50   0.0295     99.130  0.0111    99.623  619.56
  51   0.0289     99.020  0.0115    99.627  631.86
  52   0.0247     99.200  0.0095    99.677  644.18
  53   0.0293     99.090  0.0097    99.672  656.47
  54   0.0233     99.240  0.0092    99.705  668.80
  55   0.0271     99.210  0.0084    99.740  681.27
  56   0.0273     99.150  0.0080    99.738  693.59
  57   0.0261     99.170  0.0074    99.762  705.90
  58   0.0284     99.120  0.0073    99.767  718.23
  59   0.0299     99.040  0.0069    99.788  730.55
  60   0.0245     99.230  0.0067    99.772  742.88
  61   0.0232     99.280  0.0062    99.782  755.18
  62   0.0291     99.160  0.0054    99.835  767.69
  63   0.0256     99.280  0.0050    99.850  779.99
  64   0.0282     99.140  0.0049    99.845  792.32
  65   0.0267     99.250  0.0047    99.873  804.64
  66   0.0268     99.200  0.0044    99.870  816.95
  67   0.0269     99.250  0.0041    99.860  829.29
  68   0.0303     99.140  0.0034    99.910  841.72
  69   0.0298     99.100  0.0034    99.893  854.02
  70   0.0260     99.210  0.0031    99.912  866.34
  71   0.0268     99.230  0.0032    99.903  878.64
  72   0.0304     99.120  0.0031    99.918  891.18
  73   0.0267     99.250  0.0025    99.940  903.51
  74   0.0295     99.170  0.0027    99.922  915.81
  75   0.0288     99.130  0.0024    99.935  928.24
  76   0.0302     99.120  0.0026    99.937  940.57
  77   0.0307     99.130  0.0026    99.933  952.87
  78   0.0289     99.170  0.0022    99.948  965.29
  79   0.0287     99.190  0.0020    99.955  977.60
  80   0.0308     99.150  0.0020    99.958  989.94
  81   0.0306     99.160  0.0020    99.952  1002.40
  82   0.0306     99.150  0.0019    99.960  1014.70
  83   0.0320     99.130  0.0018    99.962  1027.07
  84   0.0306     99.160  0.0019    99.965  1039.45
  85   0.0300     99.160  0.0021    99.952  1051.87
