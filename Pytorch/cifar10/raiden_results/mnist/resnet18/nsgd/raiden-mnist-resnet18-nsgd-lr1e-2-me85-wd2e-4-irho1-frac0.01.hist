Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2155     93.350  0.6495    78.162  14.63
   2   0.0837     97.180  0.1217    96.182  27.18
   3   0.0651     97.940  0.0835    97.315  39.63
   4   0.0582     97.980  0.0687    97.870  52.25
   5   0.0554     98.190  0.0586    98.147  64.69
   6   0.0664     97.770  0.0520    98.370  77.13
   7   0.0563     98.170  0.0483    98.455  89.53
   8   0.0790     97.410  0.0442    98.557  101.98
   9   0.0489     98.400  0.0405    98.685  114.40
  10   0.0530     98.140  0.0384    98.772  126.90
  11   0.0426     98.640  0.0360    98.883  139.36
  12   0.0426     98.530  0.0340    98.940  151.80
  13   0.0332     98.830  0.0335    98.892  164.39
  14   0.0563     98.130  0.0312    99.003  176.85
  15   0.0360     98.870  0.0307    98.985  189.31
  16   0.0336     98.890  0.0294    99.053  201.72
  17   0.0335     98.940  0.0277    99.118  214.18
  18   0.0428     98.520  0.0266    99.128  226.64
  19   0.0333     98.960  0.0267    99.080  239.08
  20   0.0294     98.920  0.0263    99.160  251.53
  21   0.0356     98.770  0.0247    99.178  263.99
  22   0.0367     98.710  0.0241    99.208  276.46
  23   0.0359     98.850  0.0238    99.213  288.91
  24   0.0394     98.810  0.0229    99.247  301.35
  25   0.0331     98.920  0.0216    99.302  313.81
  26   0.0292     99.000  0.0209    99.323  326.34
  27   0.0358     98.850  0.0201    99.335  338.79
  28   0.0317     98.900  0.0198    99.365  351.26
  29   0.0350     98.870  0.0197    99.358  363.73
  30   0.0338     98.860  0.0182    99.412  376.20
  31   0.0378     98.800  0.0185    99.363  388.66
  32   0.0297     98.980  0.0172    99.430  401.10
  33   0.0275     99.080  0.0173    99.455  413.54
  34   0.0321     98.920  0.0170    99.445  425.98
  35   0.0304     98.930  0.0164    99.445  438.43
  36   0.0360     98.800  0.0154    99.485  451.01
  37   0.0343     98.780  0.0145    99.528  463.42
  38   0.0270     99.120  0.0139    99.535  475.88
  39   0.0292     99.050  0.0142    99.538  488.33
  40   0.0335     98.780  0.0150    99.477  500.91
  41   0.0296     98.920  0.0132    99.565  513.33
  42   0.0281     99.040  0.0133    99.548  525.79
  43   0.0282     99.030  0.0122    99.610  538.25
  44   0.0294     99.000  0.0125    99.577  550.69
  45   0.0325     98.970  0.0124    99.578  563.13
  46   0.0298     99.020  0.0124    99.608  575.69
  47   0.0318     98.990  0.0110    99.640  588.13
  48   0.0285     99.080  0.0113    99.643  600.59
  49   0.0265     99.090  0.0112    99.622  613.16
  50   0.0287     99.030  0.0102    99.653  625.62
  51   0.0247     99.090  0.0098    99.692  638.06
  52   0.0331     98.940  0.0100    99.687  650.60
  53   0.0341     98.920  0.0096    99.705  663.05
  54   0.0272     99.130  0.0101    99.670  675.51
  55   0.0252     99.180  0.0090    99.738  688.07
  56   0.0280     99.110  0.0091    99.728  700.53
  57   0.0244     99.200  0.0082    99.727  712.99
  58   0.0282     99.160  0.0086    99.728  725.42
  59   0.0277     99.190  0.0078    99.780  737.83
  60   0.0292     99.160  0.0075    99.768  750.30
  61   0.0269     99.120  0.0082    99.758  762.76
  62   0.0296     99.100  0.0072    99.780  775.20
  63   0.0284     99.110  0.0073    99.788  787.64
  64   0.0267     99.160  0.0070    99.787  800.08
  65   0.0299     99.110  0.0070    99.775  812.65
  66   0.0313     99.040  0.0072    99.775  825.09
  67   0.0295     99.100  0.0069    99.802  837.53
  68   0.0273     99.120  0.0065    99.812  850.13
  69   0.0270     99.080  0.0068    99.798  862.60
  70   0.0284     99.060  0.0063    99.817  875.05
  71   0.0294     98.960  0.0059    99.828  887.49
  72   0.0305     99.050  0.0057    99.837  899.88
  73   0.0266     99.170  0.0058    99.840  912.30
  74   0.0284     99.140  0.0057    99.837  924.86
  75   0.0286     99.070  0.0057    99.822  937.31
  76   0.0301     98.990  0.0054    99.850  949.75
  77   0.0246     99.210  0.0057    99.847  962.21
  78   0.0288     99.090  0.0056    99.845  974.65
  79   0.0300     99.040  0.0051    99.858  987.13
  80   0.0317     99.040  0.0050    99.860  999.64
  81   0.0311     99.030  0.0049    99.872  1012.27
  82   0.0293     99.120  0.0055    99.833  1024.76
  83   0.0278     99.160  0.0054    99.850  1037.26
  84   0.0283     99.120  0.0056    99.837  1049.88
  85   0.0276     99.110  0.0052    99.847  1062.33
