Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3173     89.000  1.1054    70.045  14.70
   2   0.0951     96.950  0.1393    95.655  27.26
   3   0.0959     97.000  0.0870    97.308  39.78
   4   0.0678     97.640  0.0684    97.860  52.32
   5   0.0927     96.920  0.0584    98.150  64.86
   6   0.0469     98.620  0.0550    98.298  77.38
   7   0.0663     97.790  0.0482    98.488  89.98
   8   0.0463     98.570  0.0448    98.582  102.62
   9   0.0522     98.380  0.0414    98.680  115.12
  10   0.0579     98.150  0.0426    98.635  127.65
  11   0.0550     98.230  0.0375    98.770  140.30
  12   0.0647     97.860  0.0363    98.820  152.79
  13   0.0355     98.890  0.0338    98.905  165.31
  14   0.0397     98.760  0.0345    98.887  177.95
  15   0.0487     98.470  0.0329    98.943  190.46
  16   0.0443     98.550  0.0319    98.955  203.01
  17   0.0488     98.540  0.0324    98.958  215.54
  18   0.0597     98.030  0.0299    99.023  228.27
  19   0.0440     98.710  0.0277    99.108  240.77
  20   0.0325     99.050  0.0276    99.113  253.30
  21   0.0301     99.130  0.0279    99.113  265.81
  22   0.0423     98.690  0.0264    99.132  278.34
  23   0.0358     98.790  0.0266    99.127  290.85
  24   0.0451     98.390  0.0257    99.170  303.49
  25   0.0356     98.800  0.0255    99.180  316.04
  26   0.0450     98.520  0.0243    99.195  328.57
  27   0.0339     98.890  0.0228    99.223  341.20
  28   0.0322     99.000  0.0235    99.193  353.69
  29   0.0439     98.560  0.0235    99.217  366.21
  30   0.0301     99.110  0.0218    99.282  378.84
  31   0.0331     98.900  0.0219    99.282  391.35
  32   0.0388     98.790  0.0205    99.337  403.89
  33   0.0449     98.640  0.0200    99.348  416.44
  34   0.0253     99.180  0.0197    99.357  429.19
  35   0.0431     98.660  0.0188    99.353  441.70
  36   0.0271     99.100  0.0179    99.403  454.22
  37   0.0329     99.050  0.0168    99.440  466.78
  38   0.0434     98.640  0.0178    99.388  479.30
  39   0.0329     99.010  0.0170    99.447  491.83
  40   0.0260     99.290  0.0152    99.502  504.47
  41   0.0358     98.910  0.0164    99.435  516.98
  42   0.0276     99.200  0.0147    99.505  529.53
  43   0.0378     98.910  0.0150    99.537  542.17
  44   0.0255     99.140  0.0151    99.495  554.69
  45   0.0322     98.960  0.0138    99.535  567.24
  46   0.0363     98.960  0.0136    99.548  579.76
  47   0.0315     98.940  0.0126    99.593  592.51
  48   0.0246     99.180  0.0120    99.610  605.07
  49   0.0376     98.750  0.0130    99.565  617.61
  50   0.0293     98.880  0.0124    99.622  630.14
  51   0.0297     99.020  0.0111    99.627  642.64
  52   0.0242     99.270  0.0111    99.638  655.18
  53   0.0269     99.060  0.0105    99.638  667.70
  54   0.0264     99.150  0.0096    99.690  680.24
  55   0.0255     99.180  0.0100    99.663  692.82
  56   0.0337     98.940  0.0083    99.733  705.49
  57   0.0256     99.210  0.0080    99.742  718.01
  58   0.0356     98.910  0.0079    99.747  730.55
  59   0.0320     99.050  0.0071    99.777  743.08
  60   0.0311     99.100  0.0068    99.765  755.61
  61   0.0298     99.200  0.0063    99.798  768.15
  62   0.0349     98.920  0.0060    99.805  780.76
  63   0.0304     99.060  0.0057    99.835  793.35
  64   0.0297     99.130  0.0059    99.815  805.85
  65   0.0310     99.120  0.0048    99.858  818.48
  66   0.0323     99.080  0.0051    99.842  831.00
  67   0.0280     99.170  0.0048    99.845  843.54
  68   0.0278     99.210  0.0042    99.880  856.22
  69   0.0342     98.970  0.0042    99.880  868.78
  70   0.0347     99.010  0.0040    99.882  881.30
  71   0.0277     99.200  0.0034    99.905  893.98
  72   0.0318     99.080  0.0033    99.898  906.50
  73   0.0270     99.130  0.0029    99.920  919.00
  74   0.0281     99.180  0.0029    99.905  931.52
  75   0.0286     99.140  0.0027    99.927  944.00
  76   0.0303     99.060  0.0024    99.933  956.50
  77   0.0344     99.050  0.0023    99.938  969.04
  78   0.0302     99.170  0.0021    99.943  981.63
  79   0.0307     99.170  0.0021    99.957  994.19
  80   0.0290     99.160  0.0018    99.965  1006.70
  81   0.0304     99.130  0.0020    99.950  1019.34
  82   0.0325     99.100  0.0020    99.948  1031.85
  83   0.0322     99.110  0.0019    99.958  1044.44
  84   0.0309     99.150  0.0017    99.968  1056.96
  85   0.0330     99.110  0.0017    99.958  1069.48
  86   0.0327     99.100  0.0015    99.970  1082.01
  87   0.0325     99.150  0.0016    99.965  1094.55
  88   0.0299     99.140  0.0016    99.955  1107.08
  89   0.0325     99.120  0.0015    99.968  1119.61
  90   0.0320     99.100  0.0016    99.967  1132.16
