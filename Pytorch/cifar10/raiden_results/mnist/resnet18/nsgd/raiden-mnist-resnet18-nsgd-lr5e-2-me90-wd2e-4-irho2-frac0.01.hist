Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.6586     80.590  1.6560    47.305  14.75
   2   0.2715     91.660  0.1882    94.067  27.20
   3   0.1425     95.410  0.1057    96.662  39.56
   4   0.0773     97.500  0.0850    97.330  51.99
   5   0.0853     97.230  0.0727    97.713  64.51
   6   0.0506     98.450  0.0637    98.002  76.89
   7   0.0392     98.670  0.0598    98.030  89.24
   8   0.0565     98.120  0.0529    98.362  101.75
   9   0.0752     97.640  0.0490    98.450  114.14
  10   0.0444     98.510  0.0460    98.503  126.52
  11   0.0474     98.490  0.0440    98.608  139.00
  12   0.0444     98.360  0.0408    98.678  151.38
  13   0.0373     98.790  0.0379    98.797  163.74
  14   0.0432     98.550  0.0366    98.840  176.13
  15   0.0306     98.870  0.0367    98.807  188.50
  16   0.0491     98.440  0.0339    98.902  200.89
  17   0.0558     98.170  0.0338    98.912  213.29
  18   0.0486     98.330  0.0329    98.940  225.78
  19   0.0437     98.490  0.0318    98.958  238.17
  20   0.0444     98.560  0.0308    99.052  250.54
  21   0.0366     98.700  0.0298    99.003  263.03
  22   0.0335     98.920  0.0298    99.037  275.43
  23   0.0365     98.740  0.0282    99.115  287.81
  24   0.0314     98.980  0.0270    99.098  300.17
  25   0.0376     98.720  0.0268    99.147  312.52
  26   0.0352     98.760  0.0264    99.140  324.89
  27   0.0404     98.640  0.0241    99.208  337.36
  28   0.0250     99.200  0.0249    99.180  349.73
  29   0.0300     98.970  0.0231    99.248  362.10
  30   0.0337     98.890  0.0232    99.215  374.50
  31   0.0414     98.590  0.0227    99.260  386.92
  32   0.0360     98.930  0.0220    99.288  399.29
  33   0.0266     99.140  0.0228    99.228  411.63
  34   0.0317     98.890  0.0208    99.320  424.15
  35   0.0444     98.510  0.0193    99.367  436.52
  36   0.0336     98.820  0.0206    99.312  448.91
  37   0.0326     98.940  0.0207    99.298  461.41
  38   0.0244     99.110  0.0187    99.372  473.76
  39   0.0353     98.940  0.0174    99.438  486.13
  40   0.0247     99.280  0.0175    99.447  498.49
  41   0.0357     98.850  0.0166    99.482  510.87
  42   0.0303     99.030  0.0165    99.457  523.20
  43   0.0292     99.100  0.0167    99.452  535.58
  44   0.0253     99.220  0.0165    99.467  547.94
  45   0.0239     99.150  0.0143    99.522  560.29
  46   0.0281     99.000  0.0141    99.528  572.67
  47   0.0212     99.310  0.0141    99.528  585.14
  48   0.0249     99.140  0.0138    99.552  597.52
  49   0.0308     98.970  0.0129    99.582  609.92
  50   0.0289     99.120  0.0130    99.568  622.43
  51   0.0242     99.170  0.0117    99.615  634.78
  52   0.0250     99.140  0.0116    99.633  647.17
  53   0.0251     99.210  0.0108    99.632  659.57
  54   0.0198     99.340  0.0106    99.653  671.99
  55   0.0262     99.190  0.0105    99.667  684.35
  56   0.0248     99.120  0.0105    99.668  696.71
  57   0.0277     99.110  0.0094    99.685  709.21
  58   0.0262     99.130  0.0094    99.715  721.58
  59   0.0249     99.240  0.0076    99.767  733.95
  60   0.0281     99.070  0.0080    99.742  746.44
  61   0.0236     99.200  0.0077    99.748  758.82
  62   0.0256     99.140  0.0072    99.768  771.21
  63   0.0271     99.190  0.0069    99.783  783.60
  64   0.0267     99.150  0.0066    99.800  795.97
  65   0.0216     99.360  0.0058    99.845  808.34
  66   0.0263     99.140  0.0061    99.813  820.73
  67   0.0201     99.360  0.0059    99.818  833.07
  68   0.0250     99.200  0.0050    99.855  845.45
  69   0.0259     99.200  0.0050    99.857  857.80
  70   0.0273     99.090  0.0047    99.853  870.34
  71   0.0264     99.160  0.0047    99.863  882.72
  72   0.0270     99.210  0.0043    99.877  895.09
  73   0.0259     99.170  0.0042    99.883  907.57
  74   0.0277     99.070  0.0039    99.885  919.96
  75   0.0283     99.100  0.0037    99.912  932.32
  76   0.0261     99.140  0.0033    99.897  944.69
  77   0.0241     99.210  0.0037    99.890  957.33
  78   0.0283     99.120  0.0035    99.912  969.67
  79   0.0276     99.080  0.0034    99.898  982.15
  80   0.0254     99.190  0.0029    99.922  994.54
  81   0.0247     99.190  0.0028    99.922  1006.88
  82   0.0275     99.100  0.0029    99.930  1019.27
  83   0.0254     99.210  0.0029    99.928  1031.64
  84   0.0270     99.110  0.0027    99.930  1044.01
  85   0.0263     99.160  0.0028    99.928  1056.40
  86   0.0264     99.150  0.0026    99.940  1068.87
  87   0.0254     99.200  0.0025    99.937  1081.30
  88   0.0253     99.240  0.0027    99.940  1093.67
  89   0.0268     99.090  0.0026    99.932  1106.15
  90   0.0278     99.090  0.0024    99.958  1118.53
