Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1819     93.840  0.9944    70.163  14.56
   2   0.1925     94.200  0.1198    96.228  27.05
   3   0.1014     96.540  0.0830    97.433  39.51
   4   0.0614     97.770  0.0660    97.922  51.98
   5   0.0531     98.110  0.0553    98.253  64.63
   6   0.0500     98.290  0.0499    98.378  77.08
   7   0.0566     98.020  0.0470    98.513  89.60
   8   0.0414     98.570  0.0435    98.682  102.18
   9   0.0388     98.700  0.0398    98.690  114.63
  10   0.0443     98.580  0.0378    98.758  127.09
  11   0.0432     98.580  0.0363    98.865  139.57
  12   0.0385     98.770  0.0324    98.930  152.01
  13   0.0543     98.290  0.0317    98.920  164.46
  14   0.0293     99.030  0.0296    99.022  176.96
  15   0.0464     98.620  0.0298    99.020  189.44
  16   0.0341     98.880  0.0290    99.040  201.87
  17   0.0246     99.150  0.0279    99.102  214.33
  18   0.0359     98.720  0.0249    99.182  226.89
  19   0.0442     98.610  0.0263    99.153  239.30
  20   0.0263     99.060  0.0247    99.190  251.76
  21   0.0284     99.090  0.0231    99.235  264.31
  22   0.0338     98.870  0.0213    99.270  276.79
  23   0.0250     99.250  0.0215    99.265  289.25
  24   0.0253     99.170  0.0209    99.332  301.72
  25   0.0398     98.750  0.0193    99.360  314.26
  26   0.0311     99.040  0.0188    99.355  326.74
  27   0.0332     99.030  0.0200    99.347  339.18
  28   0.0349     98.980  0.0189    99.368  351.78
  29   0.0281     99.050  0.0177    99.403  364.25
  30   0.0365     98.920  0.0168    99.473  376.77
  31   0.0358     98.880  0.0161    99.452  389.25
  32   0.0241     99.100  0.0162    99.448  401.70
  33   0.0303     98.940  0.0152    99.460  414.16
  34   0.0370     98.870  0.0141    99.512  426.74
  35   0.0323     98.950  0.0145    99.493  439.20
  36   0.0253     99.160  0.0138    99.533  451.67
  37   0.0270     99.270  0.0125    99.563  464.22
  38   0.0345     98.960  0.0121    99.598  476.70
  39   0.0306     99.070  0.0120    99.607  489.14
  40   0.0272     99.170  0.0120    99.613  501.71
  41   0.0289     99.150  0.0123    99.580  514.20
  42   0.0324     98.960  0.0121    99.580  526.63
  43   0.0262     99.210  0.0110    99.658  539.11
  44   0.0239     99.300  0.0104    99.645  551.76
  45   0.0273     99.110  0.0105    99.643  564.22
  46   0.0263     99.190  0.0093    99.702  576.70
  47   0.0295     99.080  0.0085    99.737  589.41
  48   0.0303     99.090  0.0084    99.718  601.88
  49   0.0290     99.150  0.0088    99.698  614.34
  50   0.0315     99.090  0.0081    99.723  626.90
  51   0.0347     98.990  0.0084    99.720  639.33
  52   0.0332     99.080  0.0078    99.735  651.79
  53   0.0268     99.280  0.0075    99.728  664.37
  54   0.0299     99.120  0.0065    99.773  676.83
  55   0.0313     99.130  0.0066    99.780  689.24
  56   0.0270     99.210  0.0073    99.757  701.82
  57   0.0329     99.040  0.0063    99.777  714.25
  58   0.0290     99.170  0.0059    99.788  726.70
  59   0.0299     99.050  0.0057    99.813  739.15
  60   0.0291     99.130  0.0053    99.830  751.79
  61   0.0270     99.220  0.0049    99.837  764.24
  62   0.0337     99.030  0.0048    99.850  776.70
  63   0.0318     99.090  0.0047    99.835  789.29
  64   0.0285     99.200  0.0042    99.853  801.73
  65   0.0276     99.180  0.0042    99.857  814.16
  66   0.0296     99.140  0.0042    99.855  826.73
  67   0.0320     99.010  0.0038    99.880  839.24
  68   0.0376     99.030  0.0041    99.858  851.70
  69   0.0343     99.120  0.0041    99.872  864.20
  70   0.0313     99.130  0.0041    99.868  876.71
  71   0.0345     99.100  0.0037    99.878  889.19
  72   0.0336     99.140  0.0033    99.893  901.71
  73   0.0342     99.120  0.0038    99.867  914.15
  74   0.0336     99.080  0.0033    99.900  926.65
  75   0.0333     99.140  0.0030    99.927  939.11
  76   0.0321     99.120  0.0029    99.898  951.66
  77   0.0381     99.040  0.0030    99.900  964.12
  78   0.0320     99.110  0.0026    99.937  976.59
  79   0.0323     99.120  0.0029    99.918  989.20
  80   0.0331     99.070  0.0027    99.927  1001.67
  81   0.0341     99.050  0.0024    99.928  1014.15
  82   0.0352     99.010  0.0027    99.917  1026.77
  83   0.0335     99.080  0.0025    99.927  1039.24
  84   0.0340     99.060  0.0024    99.928  1051.68
  85   0.0364     99.090  0.0021    99.940  1064.25
  86   0.0341     99.100  0.0023    99.933  1076.69
  87   0.0360     99.060  0.0021    99.950  1089.14
  88   0.0321     99.090  0.0024    99.940  1101.58
  89   0.0367     99.060  0.0024    99.925  1114.02
  90   0.0370     99.050  0.0020    99.943  1126.49
