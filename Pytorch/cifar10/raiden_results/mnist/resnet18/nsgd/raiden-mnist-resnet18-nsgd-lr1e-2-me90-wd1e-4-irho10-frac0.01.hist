Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4188     86.690  1.2904    62.298  14.80
   2   0.1027     96.740  0.1415    95.683  27.27
   3   0.0870     97.350  0.0847    97.377  39.70
   4   0.0526     98.380  0.0677    97.913  52.29
   5   0.0550     98.010  0.0596    98.140  64.73
   6   0.0641     97.850  0.0526    98.400  77.20
   7   0.0415     98.650  0.0477    98.545  89.65
   8   0.0409     98.630  0.0424    98.638  102.12
   9   0.0364     98.770  0.0393    98.778  114.56
  10   0.0502     98.410  0.0383    98.833  127.00
  11   0.0377     98.690  0.0365    98.855  139.41
  12   0.0500     98.390  0.0338    98.927  151.86
  13   0.0398     98.650  0.0334    98.888  164.30
  14   0.0350     98.850  0.0323    98.988  176.93
  15   0.0360     98.750  0.0299    99.037  189.37
  16   0.0352     98.790  0.0288    99.052  201.83
  17   0.0420     98.590  0.0270    99.127  214.39
  18   0.0306     98.900  0.0264    99.140  226.81
  19   0.0283     99.060  0.0258    99.177  239.24
  20   0.0346     98.880  0.0256    99.163  251.84
  21   0.0306     98.930  0.0244    99.203  264.25
  22   0.0370     98.660  0.0236    99.252  276.67
  23   0.0398     98.840  0.0228    99.258  289.11
  24   0.0274     99.010  0.0212    99.303  301.55
  25   0.0285     99.060  0.0207    99.332  314.00
  26   0.0276     99.000  0.0199    99.338  326.41
  27   0.0342     98.870  0.0188    99.385  338.85
  28   0.0314     99.010  0.0181    99.410  351.29
  29   0.0367     98.820  0.0195    99.352  363.72
  30   0.0318     99.070  0.0173    99.412  376.14
  31   0.0257     99.240  0.0173    99.427  388.55
  32   0.0365     98.820  0.0161    99.473  400.96
  33   0.0317     98.890  0.0155    99.508  413.50
  34   0.0286     99.070  0.0166    99.413  425.93
  35   0.0272     99.030  0.0144    99.538  438.32
  36   0.0294     99.050  0.0147    99.500  450.78
  37   0.0275     99.050  0.0137    99.568  463.27
  38   0.0287     99.130  0.0126    99.580  475.68
  39   0.0260     99.110  0.0128    99.580  488.12
  40   0.0266     99.080  0.0121    99.613  500.56
  41   0.0267     99.110  0.0120    99.583  513.02
  42   0.0283     99.170  0.0115    99.618  525.45
  43   0.0288     99.130  0.0110    99.632  537.88
  44   0.0312     99.110  0.0113    99.608  550.33
  45   0.0267     99.080  0.0104    99.640  562.75
  46   0.0290     99.100  0.0105    99.632  575.34
  47   0.0213     99.320  0.0099    99.653  587.76
  48   0.0282     99.150  0.0092    99.685  600.21
  49   0.0301     99.070  0.0086    99.717  612.67
  50   0.0278     99.060  0.0085    99.717  625.10
  51   0.0296     99.240  0.0089    99.710  637.55
  52   0.0262     99.200  0.0086    99.717  650.09
  53   0.0261     99.150  0.0072    99.772  662.55
  54   0.0332     98.950  0.0070    99.767  674.98
  55   0.0277     99.100  0.0069    99.787  687.39
  56   0.0269     99.150  0.0067    99.775  699.97
  57   0.0267     99.110  0.0062    99.780  712.43
  58   0.0282     99.120  0.0062    99.790  724.88
  59   0.0251     99.190  0.0056    99.802  737.41
  60   0.0285     99.170  0.0054    99.828  749.86
  61   0.0306     99.060  0.0056    99.810  762.29
  62   0.0296     99.200  0.0054    99.827  774.85
  63   0.0285     99.120  0.0050    99.838  787.29
  64   0.0280     99.070  0.0043    99.867  799.75
  65   0.0303     99.180  0.0047    99.848  812.32
  66   0.0282     99.150  0.0047    99.840  824.73
  67   0.0336     99.020  0.0038    99.882  837.16
  68   0.0327     99.020  0.0036    99.900  849.59
  69   0.0353     99.040  0.0040    99.870  862.02
  70   0.0297     99.170  0.0039    99.865  874.42
  71   0.0309     99.150  0.0037    99.887  886.86
  72   0.0297     99.120  0.0033    99.897  899.26
  73   0.0303     99.140  0.0032    99.902  911.67
  74   0.0331     99.020  0.0032    99.890  924.09
  75   0.0316     99.080  0.0030    99.925  936.61
  76   0.0315     99.080  0.0028    99.913  949.03
  77   0.0369     99.030  0.0024    99.935  961.47
  78   0.0321     99.100  0.0026    99.930  974.06
  79   0.0337     99.090  0.0027    99.905  986.48
  80   0.0346     99.110  0.0026    99.920  998.89
  81   0.0381     98.930  0.0023    99.930  1011.34
  82   0.0328     99.080  0.0025    99.922  1024.00
  83   0.0310     99.110  0.0023    99.927  1036.45
  84   0.0321     99.140  0.0027    99.928  1048.91
  85   0.0347     99.070  0.0022    99.937  1061.35
  86   0.0329     99.040  0.0024    99.917  1073.88
  87   0.0353     98.980  0.0023    99.922  1086.29
  88   0.0365     98.980  0.0024    99.932  1098.74
  89   0.0339     99.040  0.0019    99.947  1111.21
  90   0.0345     99.040  0.0023    99.937  1123.65
