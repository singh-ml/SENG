Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2240     92.440  0.6555    77.895  14.73
   2   0.0979     96.860  0.1201    96.285  27.42
   3   0.1185     96.440  0.0841    97.372  40.01
   4   0.0676     97.840  0.0678    97.845  52.55
   5   0.0652     97.820  0.0585    98.158  65.25
   6   0.0600     98.060  0.0521    98.322  77.87
   7   0.0712     97.720  0.0465    98.513  90.43
   8   0.0465     98.390  0.0431    98.622  103.01
   9   0.0662     97.790  0.0401    98.745  115.56
  10   0.0699     97.840  0.0377    98.802  128.15
  11   0.0362     98.900  0.0376    98.797  140.73
  12   0.0724     97.540  0.0348    98.907  153.30
  13   0.0326     98.940  0.0322    98.950  165.85
  14   0.0378     98.900  0.0334    98.903  178.41
  15   0.0343     98.890  0.0304    99.008  190.97
  16   0.0541     98.290  0.0294    99.080  203.52
  17   0.0349     98.800  0.0293    99.045  216.11
  18   0.0423     98.630  0.0270    99.087  228.79
  19   0.0451     98.450  0.0258    99.142  241.34
  20   0.0463     98.550  0.0260    99.162  253.90
  21   0.0353     98.850  0.0231    99.235  266.62
  22   0.0292     99.080  0.0250    99.178  279.18
  23   0.0373     98.740  0.0230    99.223  291.77
  24   0.0331     98.990  0.0219    99.290  304.45
  25   0.0437     98.430  0.0229    99.237  317.02
  26   0.0344     98.850  0.0227    99.292  329.59
  27   0.0303     99.060  0.0225    99.287  342.25
  28   0.0386     98.730  0.0200    99.322  354.82
  29   0.0279     99.100  0.0196    99.370  367.40
  30   0.0326     98.990  0.0194    99.377  379.99
  31   0.0283     99.070  0.0190    99.330  392.57
  32   0.0290     99.060  0.0187    99.395  405.15
  33   0.0290     98.980  0.0186    99.367  417.72
  34   0.0274     99.100  0.0178    99.425  430.44
  35   0.0320     98.880  0.0182    99.398  442.98
  36   0.0280     99.030  0.0165    99.458  455.59
  37   0.0275     99.080  0.0169    99.402  468.35
  38   0.0363     98.760  0.0172    99.415  480.91
  39   0.0255     99.170  0.0170    99.412  493.48
  40   0.0376     98.780  0.0156    99.493  506.19
  41   0.0268     99.070  0.0147    99.505  518.80
  42   0.0225     99.310  0.0149    99.475  531.35
  43   0.0256     99.120  0.0147    99.527  543.94
  44   0.0307     99.060  0.0148    99.493  556.51
  45   0.0260     99.130  0.0137    99.570  569.07
  46   0.0318     98.940  0.0137    99.535  581.76
  47   0.0314     98.980  0.0139    99.510  594.35
  48   0.0354     98.890  0.0136    99.568  606.90
  49   0.0268     99.170  0.0132    99.550  619.47
  50   0.0321     99.020  0.0123    99.598  632.06
  51   0.0334     99.000  0.0124    99.587  644.64
  52   0.0327     99.000  0.0117    99.618  657.20
  53   0.0308     98.970  0.0110    99.622  669.77
  54   0.0332     98.860  0.0117    99.588  682.36
  55   0.0279     99.100  0.0109    99.622  694.93
  56   0.0298     99.140  0.0109    99.667  707.57
  57   0.0356     98.960  0.0101    99.670  720.16
  58   0.0327     98.930  0.0109    99.660  732.76
  59   0.0393     98.810  0.0108    99.612  745.45
  60   0.0340     99.020  0.0108    99.622  758.03
  61   0.0374     98.890  0.0100    99.675  770.58
  62   0.0369     98.830  0.0116    99.607  783.15
  63   0.0337     99.010  0.0111    99.620  795.95
  64   0.0315     99.120  0.0098    99.682  808.55
  65   0.0396     98.720  0.0101    99.667  821.24
  66   0.0369     99.000  0.0099    99.653  833.82
  67   0.0440     98.810  0.0100    99.633  846.41
  68   0.0279     99.110  0.0087    99.703  859.11
  69   0.0343     98.900  0.0092    99.675  871.70
  70   0.0312     99.150  0.0088    99.688  884.29
  71   0.0402     98.810  0.0091    99.693  896.89
  72   0.0305     99.040  0.0089    99.707  909.54
  73   0.0331     99.040  0.0082    99.703  922.13
  74   0.0390     98.930  0.0084    99.725  934.82
  75   0.0432     98.740  0.0084    99.705  947.39
  76   0.0262     99.210  0.0070    99.750  959.97
  77   0.0299     99.190  0.0083    99.712  972.59
  78   0.0320     99.060  0.0075    99.755  985.25
  79   0.0349     98.940  0.0075    99.737  997.83
  80   0.0293     99.100  0.0075    99.747  1010.42
  81   0.0343     99.040  0.0068    99.793  1023.03
  82   0.0341     99.130  0.0074    99.747  1035.61
  83   0.0333     99.040  0.0083    99.700  1048.21
  84   0.0335     99.000  0.0075    99.707  1060.81
  85   0.0338     99.030  0.0076    99.752  1073.39
  86   0.0349     99.090  0.0077    99.730  1085.96
  87   0.0282     99.230  0.0087    99.713  1098.52
  88   0.0482     98.660  0.0069    99.762  1111.09
  89   0.0353     99.020  0.0073    99.752  1123.63
  90   0.0328     99.060  0.0064    99.787  1136.19
