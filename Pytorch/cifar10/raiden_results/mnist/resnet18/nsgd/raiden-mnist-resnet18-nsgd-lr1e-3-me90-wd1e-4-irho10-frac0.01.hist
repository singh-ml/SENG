Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3815     87.490  0.6471    77.963  14.65
   2   0.3531     89.150  0.1240    96.080  27.12
   3   0.1449     95.100  0.0847    97.363  39.74
   4   0.1036     96.630  0.0687    97.873  52.20
   5   0.0657     97.880  0.0605    98.105  64.64
   6   0.0551     98.160  0.0519    98.382  77.10
   7   0.0737     97.580  0.0465    98.482  89.65
   8   0.0467     98.460  0.0434    98.642  102.04
   9   0.0530     98.230  0.0411    98.700  114.47
  10   0.0400     98.770  0.0384    98.760  127.02
  11   0.0462     98.580  0.0362    98.822  139.39
  12   0.0476     98.420  0.0367    98.838  151.84
  13   0.0578     98.250  0.0339    98.952  164.43
  14   0.0439     98.500  0.0309    98.990  176.86
  15   0.0342     98.960  0.0310    99.017  189.30
  16   0.0278     99.060  0.0295    99.040  201.84
  17   0.0354     98.910  0.0296    99.047  214.27
  18   0.0344     98.920  0.0272    99.148  226.71
  19   0.0420     98.690  0.0253    99.168  239.15
  20   0.0533     98.390  0.0258    99.133  251.58
  21   0.0337     98.900  0.0261    99.162  264.00
  22   0.0398     98.600  0.0244    99.165  276.41
  23   0.0382     98.820  0.0233    99.223  288.92
  24   0.0341     98.950  0.0229    99.270  301.32
  25   0.0378     98.800  0.0213    99.327  313.72
  26   0.0447     98.510  0.0215    99.307  326.29
  27   0.0601     98.060  0.0212    99.265  338.70
  28   0.0439     98.680  0.0199    99.387  351.16
  29   0.0313     99.070  0.0201    99.337  363.73
  30   0.0271     99.110  0.0193    99.350  376.17
  31   0.0402     98.710  0.0198    99.363  388.60
  32   0.0307     99.040  0.0188    99.385  401.01
  33   0.0314     99.000  0.0185    99.397  413.45
  34   0.0270     99.140  0.0186    99.387  425.85
  35   0.0354     98.900  0.0174    99.407  438.28
  36   0.0269     99.180  0.0161    99.462  450.72
  37   0.0378     98.650  0.0174    99.407  463.15
  38   0.0305     99.100  0.0157    99.488  475.58
  39   0.0348     98.990  0.0165    99.452  488.14
  40   0.0372     98.890  0.0162    99.457  500.58
  41   0.0288     99.080  0.0154    99.473  513.02
  42   0.0266     99.110  0.0147    99.497  525.61
  43   0.0354     99.010  0.0143    99.505  538.07
  44   0.0296     99.220  0.0144    99.525  550.50
  45   0.0266     99.200  0.0133    99.575  563.08
  46   0.0386     98.750  0.0139    99.533  575.50
  47   0.0323     99.060  0.0136    99.540  587.93
  48   0.0420     98.780  0.0129    99.588  600.49
  49   0.0361     98.920  0.0125    99.583  612.94
  50   0.0351     98.890  0.0133    99.542  625.34
  51   0.0372     98.920  0.0123    99.598  637.78
  52   0.0329     99.060  0.0121    99.603  650.20
  53   0.0349     98.940  0.0131    99.552  662.62
  54   0.0560     98.520  0.0109    99.632  675.04
  55   0.0352     99.020  0.0119    99.583  687.59
  56   0.0323     99.060  0.0122    99.597  700.02
  57   0.0290     99.150  0.0125    99.595  712.46
  58   0.0372     98.940  0.0103    99.650  725.02
  59   0.0424     98.670  0.0115    99.603  737.43
  60   0.0289     99.090  0.0112    99.618  749.85
  61   0.0300     99.100  0.0106    99.645  762.29
  62   0.0374     99.020  0.0098    99.668  774.83
  63   0.0356     98.930  0.0106    99.612  787.28
  64   0.0275     99.140  0.0102    99.660  799.71
  65   0.0335     98.970  0.0094    99.690  812.15
  66   0.0315     99.000  0.0095    99.672  824.61
  67   0.0358     99.030  0.0100    99.670  837.07
  68   0.0331     99.130  0.0090    99.697  849.72
  69   0.0335     99.040  0.0087    99.722  862.17
  70   0.0323     99.150  0.0100    99.650  874.58
  71   0.0259     99.210  0.0087    99.692  887.13
  72   0.0422     98.800  0.0087    99.735  899.58
  73   0.0345     98.980  0.0085    99.730  912.02
  74   0.0342     98.890  0.0085    99.692  924.49
  75   0.0349     99.040  0.0086    99.705  937.12
  76   0.0473     98.630  0.0082    99.710  949.56
  77   0.0305     99.060  0.0087    99.698  962.00
  78   0.0336     98.950  0.0084    99.710  974.54
  79   0.0465     98.820  0.0075    99.753  986.96
  80   0.0414     98.740  0.0082    99.727  999.38
  81   0.0339     99.090  0.0082    99.697  1011.83
  82   0.0371     99.010  0.0068    99.773  1024.38
  83   0.0331     99.100  0.0076    99.728  1036.81
  84   0.0346     99.030  0.0069    99.765  1049.26
  85   0.0390     98.860  0.0069    99.792  1061.67
  86   0.0348     99.040  0.0071    99.743  1074.27
  87   0.0432     98.820  0.0075    99.753  1086.70
  88   0.0367     98.950  0.0079    99.733  1099.12
  89   0.0324     99.090  0.0066    99.763  1111.73
  90   0.0387     98.900  0.0073    99.730  1124.18
