Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1328     95.810  0.4234    85.637  15.38
   2   0.0725     97.630  0.0836    97.347  28.31
   3   0.0613     98.040  0.0651    97.938  41.27
   4   0.0830     97.360  0.0538    98.290  54.24
   5   0.0739     97.750  0.0486    98.475  67.16
   6   0.0634     97.840  0.0457    98.543  80.11
   7   0.0722     97.780  0.0400    98.713  93.08
   8   0.0424     98.620  0.0381    98.783  106.05
   9   0.0330     98.870  0.0375    98.783  119.02
  10   0.0588     97.970  0.0349    98.828  131.97
  11   0.0417     98.660  0.0327    98.940  144.91
  12   0.0415     98.770  0.0321    98.995  157.85
  13   0.0352     98.860  0.0297    99.100  170.89
  14   0.0445     98.550  0.0285    99.095  183.83
  15   0.0375     98.870  0.0275    99.112  196.76
  16   0.0452     98.520  0.0254    99.170  209.83
  17   0.0474     98.510  0.0246    99.182  222.79
  18   0.0275     99.090  0.0256    99.155  235.72
  19   0.0241     99.200  0.0249    99.178  248.70
  20   0.0381     98.720  0.0221    99.248  261.66
  21   0.0421     98.640  0.0224    99.245  274.63
  22   0.0296     99.070  0.0215    99.307  287.60
  23   0.0353     98.830  0.0206    99.272  300.55
  24   0.0346     98.860  0.0222    99.265  313.53
  25   0.0358     98.830  0.0200    99.325  326.62
  26   0.0266     99.090  0.0193    99.338  339.57
  27   0.0489     98.480  0.0179    99.435  352.52
  28   0.0485     98.410  0.0176    99.420  365.57
  29   0.0361     98.870  0.0161    99.457  378.52
  30   0.0361     98.800  0.0170    99.437  391.47
  31   0.0293     99.100  0.0159    99.465  404.50
  32   0.0520     98.530  0.0152    99.475  417.45
  33   0.0384     98.740  0.0155    99.487  430.39
  34   0.0357     98.870  0.0140    99.543  443.35
  35   0.0301     99.080  0.0149    99.490  456.27
  36   0.0305     99.000  0.0133    99.547  469.22
  37   0.0354     98.900  0.0128    99.540  482.19
  38   0.0358     98.910  0.0121    99.577  495.16
  39   0.0288     99.110  0.0124    99.575  508.12
  40   0.0293     99.090  0.0125    99.583  521.20
  41   0.0288     98.950  0.0115    99.612  534.17
  42   0.0308     99.030  0.0105    99.668  547.13
  43   0.0350     98.890  0.0102    99.688  560.08
  44   0.0333     98.950  0.0097    99.685  573.14
  45   0.0278     99.180  0.0089    99.707  586.12
  46   0.0474     98.630  0.0086    99.703  599.08
  47   0.0302     99.130  0.0084    99.732  612.15
  48   0.0323     98.950  0.0083    99.745  625.11
  49   0.0290     99.120  0.0078    99.738  638.03
  50   0.0266     99.180  0.0073    99.752  651.11
  51   0.0289     99.120  0.0078    99.747  664.03
  52   0.0333     99.000  0.0068    99.792  677.00
  53   0.0315     99.040  0.0068    99.797  690.06
  54   0.0268     99.180  0.0058    99.812  703.00
  55   0.0352     99.000  0.0060    99.790  715.98
  56   0.0323     98.930  0.0055    99.823  728.93
  57   0.0281     99.160  0.0057    99.830  741.91
  58   0.0279     99.130  0.0052    99.843  754.87
  59   0.0245     99.200  0.0043    99.885  767.87
  60   0.0313     99.130  0.0045    99.877  780.84
  61   0.0258     99.180  0.0044    99.867  793.81
  62   0.0270     99.210  0.0042    99.865  806.76
  63   0.0305     99.110  0.0036    99.883  819.73
  64   0.0267     99.200  0.0033    99.908  832.69
  65   0.0300     99.070  0.0035    99.892  845.75
  66   0.0315     99.070  0.0030    99.918  858.69
  67   0.0294     99.070  0.0030    99.923  871.63
  68   0.0291     99.110  0.0027    99.937  884.70
  69   0.0280     99.130  0.0028    99.918  897.64
  70   0.0286     99.180  0.0029    99.915  910.59
  71   0.0321     99.090  0.0028    99.928  923.64
  72   0.0299     99.020  0.0025    99.937  936.58
  73   0.0294     99.180  0.0025    99.930  949.54
  74   0.0284     99.120  0.0023    99.953  962.57
  75   0.0299     99.080  0.0021    99.942  975.61
  76   0.0272     99.220  0.0023    99.933  988.59
  77   0.0305     99.090  0.0021    99.958  1001.55
  78   0.0309     99.090  0.0020    99.960  1014.55
  79   0.0305     99.110  0.0022    99.955  1027.52
  80   0.0303     99.080  0.0020    99.958  1040.47
  81   0.0295     99.160  0.0018    99.960  1053.42
  82   0.0298     99.140  0.0018    99.963  1066.37
  83   0.0295     99.130  0.0019    99.952  1079.46
  84   0.0286     99.180  0.0020    99.957  1092.44
  85   0.0304     99.120  0.0019    99.952  1105.40
