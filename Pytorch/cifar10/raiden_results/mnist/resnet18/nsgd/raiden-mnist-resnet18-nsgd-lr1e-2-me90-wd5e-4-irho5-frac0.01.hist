Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5334     84.960  0.4370    85.622  14.83
   2   0.1393     95.410  0.0922    97.177  27.33
   3   0.0720     97.630  0.0674    97.897  39.77
   4   0.0732     97.430  0.0561    98.213  52.32
   5   0.0593     98.050  0.0482    98.472  64.79
   6   0.0526     98.220  0.0462    98.570  77.24
   7   0.0634     98.080  0.0405    98.715  89.83
   8   0.0489     98.350  0.0404    98.680  102.26
   9   0.0448     98.650  0.0376    98.825  114.77
  10   0.0361     98.890  0.0353    98.830  127.24
  11   0.0370     98.840  0.0322    98.963  139.69
  12   0.0363     98.940  0.0322    98.982  152.14
  13   0.0527     98.270  0.0299    99.002  164.58
  14   0.0329     98.950  0.0304    99.052  177.04
  15   0.0428     98.720  0.0289    99.085  189.51
  16   0.0366     98.790  0.0280    99.080  201.95
  17   0.0308     98.960  0.0256    99.178  214.43
  18   0.0305     99.050  0.0246    99.205  226.85
  19   0.0359     98.880  0.0246    99.243  239.33
  20   0.0289     99.060  0.0238    99.217  251.87
  21   0.0293     98.980  0.0234    99.200  264.34
  22   0.0337     98.940  0.0223    99.270  276.80
  23   0.0276     99.130  0.0217    99.300  289.26
  24   0.0231     99.280  0.0203    99.338  301.72
  25   0.0389     98.810  0.0199    99.312  314.19
  26   0.0320     98.900  0.0179    99.395  326.64
  27   0.0336     98.870  0.0201    99.343  339.09
  28   0.0315     98.850  0.0174    99.398  351.53
  29   0.0320     98.990  0.0189    99.365  363.99
  30   0.0267     99.090  0.0176    99.423  376.55
  31   0.0263     99.190  0.0166    99.488  389.01
  32   0.0318     99.010  0.0173    99.395  401.45
  33   0.0281     99.060  0.0152    99.482  413.96
  34   0.0257     99.160  0.0152    99.488  426.43
  35   0.0314     99.010  0.0145    99.530  438.90
  36   0.0283     99.070  0.0134    99.557  451.47
  37   0.0324     98.940  0.0140    99.533  463.94
  38   0.0288     99.020  0.0142    99.527  476.42
  39   0.0258     99.110  0.0134    99.557  489.00
  40   0.0357     98.950  0.0124    99.590  501.49
  41   0.0281     99.140  0.0115    99.618  513.97
  42   0.0258     99.170  0.0113    99.640  526.55
  43   0.0308     98.920  0.0114    99.630  538.97
  44   0.0249     99.170  0.0105    99.652  551.41
  45   0.0224     99.190  0.0097    99.652  563.87
  46   0.0213     99.220  0.0100    99.673  576.31
  47   0.0260     99.180  0.0091    99.698  588.75
  48   0.0290     99.080  0.0093    99.685  601.23
  49   0.0277     99.140  0.0097    99.690  613.79
  50   0.0238     99.200  0.0089    99.708  626.26
  51   0.0284     99.110  0.0084    99.727  638.69
  52   0.0285     99.060  0.0076    99.758  651.26
  53   0.0233     99.230  0.0069    99.768  663.72
  54   0.0309     99.010  0.0065    99.803  676.24
  55   0.0245     99.220  0.0069    99.762  688.71
  56   0.0285     99.160  0.0068    99.783  701.18
  57   0.0278     99.090  0.0058    99.812  713.64
  58   0.0226     99.290  0.0061    99.807  726.23
  59   0.0246     99.170  0.0059    99.818  738.67
  60   0.0294     99.060  0.0052    99.832  751.12
  61   0.0229     99.240  0.0054    99.847  763.54
  62   0.0255     99.210  0.0044    99.872  776.09
  63   0.0293     99.080  0.0049    99.838  788.53
  64   0.0299     99.160  0.0048    99.867  801.00
  65   0.0305     99.040  0.0046    99.860  813.57
  66   0.0285     99.120  0.0038    99.887  826.04
  67   0.0250     99.160  0.0040    99.868  838.52
  68   0.0340     98.960  0.0039    99.890  851.02
  69   0.0297     99.130  0.0033    99.895  863.50
  70   0.0291     99.050  0.0034    99.892  875.96
  71   0.0276     99.130  0.0028    99.928  888.48
  72   0.0287     99.060  0.0029    99.925  901.11
  73   0.0286     99.160  0.0029    99.918  913.54
  74   0.0273     99.140  0.0028    99.922  926.01
  75   0.0267     99.160  0.0027    99.925  938.47
  76   0.0314     99.040  0.0024    99.943  950.92
  77   0.0300     99.070  0.0019    99.960  963.39
  78   0.0287     99.130  0.0022    99.945  976.00
  79   0.0268     99.190  0.0021    99.947  988.46
  80   0.0257     99.240  0.0018    99.952  1000.91
  81   0.0280     99.220  0.0021    99.950  1013.47
  82   0.0292     99.150  0.0020    99.958  1025.95
  83   0.0305     99.210  0.0018    99.953  1038.42
  84   0.0312     99.110  0.0016    99.968  1050.88
  85   0.0293     99.130  0.0020    99.950  1063.58
  86   0.0304     99.150  0.0016    99.965  1076.02
  87   0.0286     99.160  0.0015    99.968  1088.61
  88   0.0296     99.160  0.0018    99.953  1101.14
  89   0.0297     99.120  0.0017    99.960  1113.66
  90   0.0287     99.140  0.0017    99.963  1126.15
