Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3374     91.260  0.4481    85.415  14.39
   2   0.1499     95.560  0.0892    97.202  26.82
   3   0.0942     97.020  0.0680    97.867  39.08
   4   0.0544     98.230  0.0569    98.168  51.36
   5   0.0688     97.880  0.0485    98.478  63.75
   6   0.0502     98.230  0.0458    98.497  76.02
   7   0.0423     98.610  0.0399    98.752  88.28
   8   0.0332     98.920  0.0398    98.692  100.52
   9   0.0358     98.720  0.0354    98.882  112.91
  10   0.0328     98.940  0.0336    98.928  125.17
  11   0.0527     98.230  0.0346    98.872  137.44
  12   0.0583     98.140  0.0317    99.003  149.67
  13   0.0386     98.810  0.0299    99.025  161.91
  14   0.0461     98.570  0.0294    99.053  174.13
  15   0.0429     98.590  0.0286    99.058  186.49
  16   0.0321     98.970  0.0267    99.160  198.75
  17   0.0352     98.920  0.0260    99.137  211.01
  18   0.0316     99.040  0.0249    99.172  223.26
  19   0.0329     99.030  0.0243    99.215  235.51
  20   0.0380     98.880  0.0247    99.150  247.76
  21   0.0308     99.110  0.0221    99.265  260.03
  22   0.0388     98.630  0.0221    99.280  272.43
  23   0.0352     98.840  0.0194    99.335  284.69
  24   0.0405     98.820  0.0209    99.312  296.96
  25   0.0335     99.050  0.0202    99.343  309.34
  26   0.0333     98.860  0.0202    99.355  321.60
  27   0.0263     99.130  0.0189    99.360  333.84
  28   0.0345     98.920  0.0184    99.388  346.13
  29   0.0237     99.300  0.0189    99.377  358.41
  30   0.0277     99.080  0.0166    99.450  370.65
  31   0.0256     99.180  0.0173    99.442  382.90
  32   0.0345     98.840  0.0164    99.433  395.26
  33   0.0482     98.520  0.0160    99.483  407.53
  34   0.0247     99.220  0.0156    99.495  419.80
  35   0.0318     98.910  0.0136    99.537  432.22
  36   0.0256     99.090  0.0143    99.530  444.49
  37   0.0335     98.970  0.0137    99.548  456.76
  38   0.0479     98.570  0.0139    99.550  469.12
  39   0.0314     99.060  0.0139    99.548  481.41
  40   0.0262     99.110  0.0132    99.533  493.69
  41   0.0374     98.830  0.0120    99.608  505.98
  42   0.0344     98.960  0.0116    99.615  518.38
  43   0.0282     99.090  0.0105    99.650  530.65
  44   0.0296     99.050  0.0109    99.628  542.91
  45   0.0242     99.200  0.0105    99.655  555.18
  46   0.0258     99.200  0.0096    99.678  567.46
  47   0.0317     98.910  0.0097    99.670  579.74
  48   0.0293     99.090  0.0092    99.675  592.01
  49   0.0390     98.840  0.0092    99.687  604.32
  50   0.0327     99.010  0.0086    99.720  616.58
  51   0.0337     98.950  0.0081    99.723  628.85
  52   0.0273     99.150  0.0078    99.735  641.14
  53   0.0290     99.130  0.0070    99.758  653.53
  54   0.0303     99.070  0.0071    99.787  665.80
  55   0.0301     99.090  0.0070    99.777  678.07
  56   0.0320     99.030  0.0063    99.812  690.35
  57   0.0350     98.950  0.0058    99.823  702.58
  58   0.0291     99.090  0.0060    99.825  714.85
  59   0.0269     99.200  0.0053    99.828  727.11
  60   0.0333     98.980  0.0055    99.815  739.50
  61   0.0310     99.060  0.0053    99.828  751.80
  62   0.0257     99.210  0.0046    99.845  764.07
  63   0.0288     99.130  0.0046    99.853  776.45
  64   0.0272     99.180  0.0045    99.868  788.73
  65   0.0296     99.030  0.0044    99.860  800.98
  66   0.0271     99.200  0.0041    99.880  813.25
  67   0.0325     99.040  0.0035    99.887  825.57
  68   0.0313     99.040  0.0031    99.922  837.86
  69   0.0307     99.170  0.0034    99.892  850.18
  70   0.0329     99.120  0.0031    99.907  862.57
  71   0.0273     99.240  0.0033    99.913  874.81
  72   0.0368     98.870  0.0027    99.923  887.08
  73   0.0359     98.970  0.0026    99.925  899.49
  74   0.0351     99.080  0.0023    99.945  911.81
  75   0.0348     99.010  0.0026    99.933  924.14
  76   0.0321     99.110  0.0023    99.948  936.42
  77   0.0320     99.100  0.0021    99.952  948.73
  78   0.0337     99.060  0.0022    99.950  961.03
  79   0.0341     99.020  0.0020    99.955  973.32
  80   0.0342     99.060  0.0017    99.963  985.69
  81   0.0302     99.120  0.0018    99.952  997.95
  82   0.0326     99.090  0.0017    99.958  1010.21
  83   0.0356     99.050  0.0017    99.960  1022.59
  84   0.0343     99.060  0.0016    99.970  1034.87
  85   0.0351     99.090  0.0014    99.977  1047.12
  86   0.0346     99.050  0.0018    99.952  1059.40
  87   0.0313     99.110  0.0016    99.958  1071.67
  88   0.0349     99.090  0.0016    99.960  1083.94
  89   0.0348     99.110  0.0019    99.953  1096.31
  90   0.0341     99.070  0.0014    99.965  1108.58
