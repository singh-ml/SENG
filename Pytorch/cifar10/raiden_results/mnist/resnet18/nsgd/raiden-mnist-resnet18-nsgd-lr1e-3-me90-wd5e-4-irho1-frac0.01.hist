Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.3102     61.780  1.8102    38.202  14.62
   2   0.5261     85.280  0.9283    73.745  27.04
   3   0.3143     90.090  0.4560    86.853  39.44
   4   0.2429     92.720  0.3065    91.233  52.01
   5   0.2069     93.610  0.2337    93.192  64.41
   6   0.1574     95.080  0.1937    94.257  76.80
   7   0.1467     95.320  0.1675    94.972  89.19
   8   0.1436     95.520  0.1500    95.488  101.59
   9   0.1431     95.340  0.1347    95.832  114.01
  10   0.1168     96.440  0.1241    96.187  126.43
  11   0.1001     96.790  0.1147    96.477  138.81
  12   0.1227     96.090  0.1076    96.800  151.15
  13   0.0856     97.310  0.1003    96.995  163.54
  14   0.0854     97.230  0.0943    97.077  176.06
  15   0.0828     97.380  0.0891    97.357  188.47
  16   0.0795     97.500  0.0847    97.418  200.82
  17   0.0785     97.500  0.0805    97.482  213.34
  18   0.0721     97.750  0.0787    97.593  225.75
  19   0.0700     97.740  0.0751    97.733  238.15
  20   0.0888     97.050  0.0718    97.833  250.65
  21   0.0605     98.030  0.0680    97.887  263.02
  22   0.0704     97.660  0.0671    97.922  275.41
  23   0.0613     97.970  0.0639    97.997  287.82
  24   0.0680     97.830  0.0623    98.075  300.37
  25   0.0670     97.780  0.0615    98.105  312.74
  26   0.0558     98.260  0.0587    98.215  325.12
  27   0.0541     98.290  0.0569    98.213  337.64
  28   0.0512     98.360  0.0562    98.275  350.02
  29   0.0598     98.040  0.0530    98.350  362.40
  30   0.0584     98.180  0.0521    98.373  374.77
  31   0.0563     98.130  0.0503    98.430  387.35
  32   0.0576     98.190  0.0495    98.458  399.71
  33   0.0531     98.330  0.0487    98.455  412.07
  34   0.0511     98.320  0.0467    98.552  424.56
  35   0.0495     98.480  0.0468    98.538  436.94
  36   0.0485     98.410  0.0453    98.597  449.35
  37   0.0495     98.420  0.0438    98.652  461.84
  38   0.0504     98.350  0.0443    98.595  474.22
  39   0.0486     98.500  0.0437    98.662  486.59
  40   0.0454     98.570  0.0414    98.703  499.13
  41   0.0470     98.480  0.0412    98.702  511.48
  42   0.0496     98.470  0.0412    98.713  523.83
  43   0.0495     98.350  0.0395    98.762  536.31
  44   0.0504     98.310  0.0386    98.778  548.65
  45   0.0418     98.720  0.0385    98.783  561.04
  46   0.0506     98.240  0.0377    98.842  573.43
  47   0.0451     98.500  0.0380    98.793  585.77
  48   0.0473     98.430  0.0364    98.912  598.15
  49   0.0460     98.520  0.0356    98.857  610.53
  50   0.0456     98.540  0.0355    98.893  622.88
  51   0.0543     98.230  0.0351    98.883  635.26
  52   0.0447     98.500  0.0341    98.940  647.63
  53   0.0444     98.440  0.0348    98.905  660.13
  54   0.0413     98.640  0.0334    98.990  672.51
  55   0.0431     98.660  0.0329    98.993  684.90
  56   0.0375     98.800  0.0332    98.955  697.40
  57   0.0419     98.570  0.0318    99.023  709.78
  58   0.0411     98.720  0.0317    99.008  722.15
  59   0.0397     98.760  0.0308    99.053  734.67
  60   0.0428     98.580  0.0308    99.047  747.02
  61   0.0386     98.760  0.0300    99.042  759.42
  62   0.0414     98.520  0.0298    99.040  771.89
  63   0.0396     98.740  0.0299    99.067  784.27
  64   0.0389     98.700  0.0284    99.125  796.65
  65   0.0470     98.510  0.0282    99.092  809.00
  66   0.0411     98.610  0.0287    99.112  821.43
  67   0.0435     98.560  0.0281    99.118  833.81
  68   0.0383     98.770  0.0283    99.122  846.19
  69   0.0372     98.760  0.0285    99.102  858.68
  70   0.0341     98.840  0.0277    99.150  871.05
  71   0.0411     98.630  0.0260    99.160  883.45
  72   0.0380     98.780  0.0256    99.208  895.95
  73   0.0390     98.640  0.0243    99.272  908.34
  74   0.0366     98.810  0.0258    99.217  920.74
  75   0.0390     98.760  0.0260    99.178  933.11
  76   0.0365     98.820  0.0250    99.190  945.63
  77   0.0382     98.780  0.0253    99.203  958.09
  78   0.0379     98.670  0.0249    99.197  970.49
  79   0.0349     98.840  0.0248    99.182  982.92
  80   0.0400     98.650  0.0249    99.183  995.32
  81   0.0413     98.590  0.0238    99.232  1007.71
  82   0.0384     98.780  0.0232    99.262  1020.14
  83   0.0400     98.570  0.0228    99.320  1032.65
  84   0.0375     98.710  0.0233    99.232  1045.04
  85   0.0420     98.600  0.0232    99.257  1057.42
  86   0.0390     98.660  0.0226    99.265  1069.79
  87   0.0375     98.810  0.0223    99.307  1082.16
  88   0.0418     98.640  0.0224    99.285  1094.50
  89   0.0376     98.790  0.0223    99.320  1106.90
  90   0.0364     98.810  0.0215    99.313  1119.39
