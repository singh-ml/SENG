Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2372     92.690  1.0693    72.097  14.64
   2   0.1071     96.570  0.1309    95.957  27.17
   3   0.0844     97.230  0.0921    97.107  39.61
   4   0.0821     97.290  0.0731    97.678  52.02
   5   0.0776     97.300  0.0605    98.092  64.53
   6   0.0602     97.990  0.0578    98.150  76.95
   7   0.0561     98.320  0.0515    98.352  89.37
   8   0.0497     98.300  0.0473    98.442  101.90
   9   0.0530     98.250  0.0427    98.622  114.32
  10   0.0509     98.460  0.0426    98.608  126.73
  11   0.0463     98.570  0.0390    98.748  139.15
  12   0.0371     98.770  0.0378    98.773  151.57
  13   0.0347     98.840  0.0372    98.827  163.99
  14   0.0432     98.570  0.0343    98.902  176.40
  15   0.0327     98.860  0.0335    98.928  188.90
  16   0.0502     98.370  0.0309    98.985  201.30
  17   0.0501     98.280  0.0296    99.063  213.75
  18   0.0359     98.850  0.0302    99.030  226.28
  19   0.0448     98.560  0.0290    99.048  238.69
  20   0.0357     98.730  0.0281    99.085  251.11
  21   0.0608     98.010  0.0274    99.095  263.53
  22   0.0295     99.000  0.0273    99.140  276.06
  23   0.0423     98.680  0.0261    99.148  288.48
  24   0.0342     98.900  0.0243    99.200  300.90
  25   0.0303     98.920  0.0235    99.223  313.32
  26   0.0306     98.970  0.0222    99.263  325.72
  27   0.0304     98.950  0.0221    99.283  338.13
  28   0.0453     98.570  0.0217    99.277  350.55
  29   0.0285     99.020  0.0213    99.295  362.93
  30   0.0288     99.020  0.0205    99.335  375.31
  31   0.0350     98.870  0.0188    99.353  387.82
  32   0.0315     99.060  0.0188    99.338  400.20
  33   0.0317     98.900  0.0183    99.385  412.60
  34   0.0413     98.660  0.0182    99.363  425.00
  35   0.0261     99.120  0.0174    99.398  437.41
  36   0.0312     98.990  0.0166    99.473  449.85
  37   0.0285     99.070  0.0167    99.447  462.26
  38   0.0326     98.970  0.0149    99.493  474.70
  39   0.0312     98.970  0.0162    99.470  487.13
  40   0.0248     99.200  0.0144    99.518  499.54
  41   0.0263     99.120  0.0143    99.520  511.95
  42   0.0289     98.930  0.0132    99.575  524.36
  43   0.0257     99.040  0.0138    99.538  536.76
  44   0.0293     99.040  0.0122    99.593  549.27
  45   0.0302     99.060  0.0124    99.585  561.70
  46   0.0302     99.050  0.0126    99.555  574.11
  47   0.0296     99.020  0.0108    99.645  586.57
  48   0.0353     98.850  0.0109    99.650  598.97
  49   0.0289     99.090  0.0110    99.618  611.40
  50   0.0280     99.140  0.0100    99.660  623.82
  51   0.0321     99.040  0.0097    99.665  636.22
  52   0.0345     99.000  0.0100    99.682  648.65
  53   0.0360     98.820  0.0088    99.710  661.07
  54   0.0255     99.090  0.0082    99.738  673.56
  55   0.0306     99.040  0.0074    99.758  685.96
  56   0.0337     98.960  0.0072    99.755  698.38
  57   0.0299     99.060  0.0073    99.785  710.89
  58   0.0316     99.050  0.0064    99.802  723.30
  59   0.0350     98.810  0.0061    99.808  735.73
  60   0.0254     99.220  0.0063    99.805  748.16
  61   0.0349     98.950  0.0058    99.832  760.55
  62   0.0317     99.030  0.0049    99.858  772.99
  63   0.0308     99.100  0.0050    99.857  785.41
  64   0.0290     99.150  0.0050    99.862  797.95
  65   0.0300     99.040  0.0047    99.865  810.37
  66   0.0265     99.200  0.0043    99.872  822.76
  67   0.0271     99.150  0.0041    99.883  835.29
  68   0.0293     99.090  0.0039    99.878  847.71
  69   0.0316     99.040  0.0037    99.877  860.13
  70   0.0265     99.230  0.0034    99.905  872.63
  71   0.0302     99.050  0.0035    99.895  885.04
  72   0.0299     99.090  0.0033    99.905  897.45
  73   0.0276     99.150  0.0031    99.915  909.86
  74   0.0281     99.220  0.0029    99.932  922.28
  75   0.0305     99.020  0.0026    99.940  934.68
  76   0.0295     99.120  0.0027    99.928  947.04
  77   0.0287     99.140  0.0027    99.928  959.51
  78   0.0311     99.100  0.0026    99.922  971.93
  79   0.0331     99.020  0.0024    99.930  984.37
  80   0.0316     99.050  0.0026    99.928  996.86
  81   0.0322     99.010  0.0023    99.933  1009.28
  82   0.0309     99.050  0.0023    99.938  1021.69
  83   0.0313     99.050  0.0021    99.952  1034.15
  84   0.0327     99.020  0.0023    99.935  1046.57
  85   0.0308     99.070  0.0021    99.952  1058.99
  86   0.0313     99.100  0.0022    99.952  1071.54
  87   0.0315     99.040  0.0021    99.952  1084.01
  88   0.0310     99.070  0.0019    99.947  1096.44
  89   0.0317     99.070  0.0021    99.950  1108.86
  90   0.0309     99.070  0.0019    99.957  1121.35
