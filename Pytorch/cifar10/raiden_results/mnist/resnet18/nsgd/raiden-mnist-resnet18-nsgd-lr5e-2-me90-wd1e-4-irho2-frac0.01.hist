Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4405     83.310  1.5402    56.117  14.69
   2   0.2360     92.440  0.1880    94.253  27.11
   3   0.0989     96.760  0.1081    96.623  39.50
   4   0.0845     97.230  0.0819    97.390  51.88
   5   0.0947     96.800  0.0699    97.837  64.33
   6   0.0517     98.260  0.0623    98.103  76.70
   7   0.0510     98.320  0.0544    98.283  89.07
   8   0.0370     98.760  0.0492    98.458  101.54
   9   0.0701     97.520  0.0473    98.512  113.92
  10   0.0303     98.850  0.0441    98.617  126.28
  11   0.0369     98.600  0.0427    98.663  138.69
  12   0.0331     98.780  0.0392    98.735  151.11
  13   0.0369     98.700  0.0380    98.765  163.48
  14   0.0333     98.880  0.0365    98.825  175.87
  15   0.0429     98.540  0.0349    98.877  188.32
  16   0.0371     98.730  0.0333    98.882  200.66
  17   0.0319     98.990  0.0323    99.007  213.04
  18   0.0382     98.760  0.0307    98.988  225.59
  19   0.0326     98.800  0.0295    99.040  237.97
  20   0.0245     99.150  0.0284    99.080  250.38
  21   0.0275     99.110  0.0274    99.097  262.92
  22   0.0561     97.950  0.0265    99.105  275.35
  23   0.0317     98.970  0.0259    99.177  287.80
  24   0.0260     99.070  0.0255    99.182  300.21
  25   0.0409     98.560  0.0262    99.155  312.63
  26   0.0286     99.030  0.0242    99.243  325.07
  27   0.0278     98.930  0.0235    99.223  337.46
  28   0.0228     99.270  0.0226    99.275  349.97
  29   0.0309     98.920  0.0219    99.263  362.38
  30   0.0303     98.990  0.0225    99.277  374.81
  31   0.0287     99.030  0.0206    99.325  387.33
  32   0.0262     99.040  0.0209    99.322  399.76
  33   0.0534     98.120  0.0208    99.325  412.21
  34   0.0325     98.920  0.0197    99.340  424.61
  35   0.0226     99.240  0.0180    99.373  437.15
  36   0.0260     99.130  0.0175    99.425  449.60
  37   0.0257     99.110  0.0177    99.422  461.99
  38   0.0272     99.070  0.0179    99.392  474.47
  39   0.0219     99.260  0.0156    99.487  486.92
  40   0.0280     98.980  0.0162    99.482  499.31
  41   0.0194     99.330  0.0158    99.485  511.71
  42   0.0293     99.090  0.0144    99.512  524.37
  43   0.0296     99.000  0.0152    99.493  536.75
  44   0.0263     99.020  0.0140    99.552  549.19
  45   0.0288     99.020  0.0148    99.533  561.64
  46   0.0206     99.230  0.0131    99.575  574.14
  47   0.0263     99.060  0.0125    99.597  586.51
  48   0.0236     99.190  0.0122    99.612  598.93
  49   0.0398     98.640  0.0127    99.583  611.45
  50   0.0220     99.290  0.0117    99.635  623.82
  51   0.0218     99.320  0.0119    99.612  636.22
  52   0.0251     99.110  0.0113    99.642  648.78
  53   0.0289     99.020  0.0105    99.650  661.16
  54   0.0229     99.260  0.0099    99.663  673.55
  55   0.0239     99.270  0.0098    99.680  685.96
  56   0.0220     99.290  0.0091    99.692  698.46
  57   0.0242     99.200  0.0087    99.740  710.85
  58   0.0213     99.230  0.0087    99.717  723.28
  59   0.0220     99.270  0.0079    99.747  735.69
  60   0.0247     99.140  0.0073    99.757  748.30
  61   0.0203     99.310  0.0077    99.755  760.71
  62   0.0243     99.170  0.0079    99.752  773.14
  63   0.0222     99.280  0.0070    99.762  785.57
  64   0.0226     99.240  0.0070    99.780  798.01
  65   0.0287     99.100  0.0064    99.788  810.38
  66   0.0249     99.210  0.0062    99.805  822.91
  67   0.0255     99.130  0.0057    99.817  835.37
  68   0.0223     99.160  0.0059    99.813  847.74
  69   0.0207     99.250  0.0054    99.823  860.26
  70   0.0252     99.170  0.0056    99.835  872.69
  71   0.0232     99.190  0.0054    99.843  885.11
  72   0.0221     99.280  0.0047    99.860  897.51
  73   0.0223     99.180  0.0046    99.872  909.96
  74   0.0231     99.220  0.0049    99.865  922.36
  75   0.0228     99.220  0.0047    99.847  934.76
  76   0.0220     99.210  0.0046    99.853  947.28
  77   0.0237     99.150  0.0042    99.875  959.67
  78   0.0252     99.200  0.0042    99.868  972.06
  79   0.0246     99.170  0.0042    99.880  984.51
  80   0.0230     99.180  0.0039    99.873  997.06
  81   0.0231     99.180  0.0040    99.890  1009.44
  82   0.0248     99.190  0.0042    99.875  1021.88
  83   0.0234     99.240  0.0037    99.907  1034.43
  84   0.0226     99.230  0.0036    99.913  1046.80
  85   0.0231     99.220  0.0039    99.888  1059.25
  86   0.0233     99.200  0.0034    99.910  1071.75
  87   0.0233     99.240  0.0035    99.902  1084.10
  88   0.0237     99.170  0.0036    99.898  1096.50
  89   0.0233     99.220  0.0035    99.902  1108.94
  90   0.0236     99.190  0.0037    99.887  1121.36
