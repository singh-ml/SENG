Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3517     88.980  0.9102    69.377  15.30
   2   0.1526     95.100  0.1886    94.273  27.67
   3   0.1218     95.940  0.1183    96.337  40.00
   4   0.0794     97.510  0.0919    97.198  52.33
   5   0.0605     98.110  0.0780    97.607  64.63
   6   0.0980     97.040  0.0664    97.942  77.00
   7   0.0576     98.150  0.0606    98.123  89.32
   8   0.0558     98.110  0.0558    98.218  101.82
   9   0.0703     97.810  0.0514    98.373  114.14
  10   0.0493     98.450  0.0483    98.498  126.46
  11   0.0554     98.280  0.0446    98.607  138.78
  12   0.1011     96.350  0.0428    98.633  151.10
  13   0.0523     98.270  0.0405    98.777  163.40
  14   0.0543     98.220  0.0372    98.812  175.72
  15   0.0614     98.120  0.0363    98.867  188.09
  16   0.0358     98.790  0.0349    98.872  200.38
  17   0.0357     98.750  0.0347    98.862  212.68
  18   0.0452     98.490  0.0321    99.050  225.14
  19   0.0489     98.400  0.0321    98.943  237.49
  20   0.0437     98.540  0.0297    99.048  249.89
  21   0.0456     98.590  0.0292    99.048  262.34
  22   0.0408     98.700  0.0280    99.122  274.63
  23   0.0477     98.360  0.0272    99.117  286.95
  24   0.0332     98.850  0.0268    99.115  299.35
  25   0.0332     98.820  0.0265    99.147  311.64
  26   0.0358     98.850  0.0250    99.183  323.97
  27   0.0393     98.750  0.0255    99.198  336.32
  28   0.0356     98.930  0.0246    99.188  348.72
  29   0.0358     98.690  0.0240    99.220  361.03
  30   0.0400     98.600  0.0223    99.277  373.35
  31   0.0374     98.800  0.0224    99.260  385.75
  32   0.0349     98.840  0.0213    99.300  398.07
  33   0.0309     98.870  0.0220    99.305  410.41
  34   0.0342     98.860  0.0204    99.368  422.73
  35   0.0319     99.030  0.0207    99.347  435.06
  36   0.0314     98.990  0.0190    99.370  447.39
  37   0.0273     99.110  0.0191    99.372  459.69
  38   0.0369     98.830  0.0185    99.432  472.11
  39   0.0364     98.720  0.0191    99.357  484.42
  40   0.0311     98.940  0.0181    99.423  496.73
  41   0.0322     98.880  0.0180    99.430  509.14
  42   0.0302     98.900  0.0174    99.440  521.45
  43   0.0380     98.780  0.0175    99.460  533.76
  44   0.0306     98.850  0.0164    99.477  546.09
  45   0.0348     98.870  0.0167    99.475  558.38
  46   0.0285     99.010  0.0160    99.478  570.70
  47   0.0315     98.980  0.0154    99.523  583.00
  48   0.0403     98.790  0.0150    99.515  595.30
  49   0.0362     98.860  0.0147    99.530  607.61
  50   0.0347     98.840  0.0144    99.552  619.91
  51   0.0308     98.940  0.0146    99.560  632.23
  52   0.0365     98.760  0.0136    99.590  644.54
  53   0.0332     98.950  0.0135    99.563  656.87
  54   0.0283     99.090  0.0134    99.583  669.29
  55   0.0300     99.010  0.0129    99.618  681.58
  56   0.0290     99.020  0.0126    99.592  693.92
  57   0.0321     98.990  0.0122    99.615  706.36
  58   0.0279     99.020  0.0123    99.622  718.67
  59   0.0325     98.840  0.0130    99.577  730.99
  60   0.0303     99.000  0.0114    99.643  743.45
  61   0.0303     98.960  0.0113    99.642  755.77
  62   0.0283     98.960  0.0119    99.637  768.10
  63   0.0321     98.890  0.0111    99.663  780.41
  64   0.0270     99.070  0.0104    99.692  792.75
  65   0.0256     99.130  0.0109    99.678  805.05
  66   0.0333     98.870  0.0113    99.653  817.40
  67   0.0300     99.030  0.0108    99.680  829.84
  68   0.0295     99.070  0.0096    99.712  842.12
  69   0.0260     99.100  0.0098    99.705  854.42
  70   0.0283     98.970  0.0096    99.713  866.77
  71   0.0258     99.100  0.0096    99.725  879.06
  72   0.0328     98.910  0.0103    99.693  891.36
  73   0.0275     99.090  0.0095    99.723  903.65
  74   0.0294     98.970  0.0093    99.730  915.96
  75   0.0296     98.960  0.0084    99.758  928.26
  76   0.0326     98.910  0.0090    99.737  940.54
  77   0.0316     98.960  0.0082    99.780  953.01
  78   0.0295     99.010  0.0086    99.740  965.28
  79   0.0287     99.020  0.0082    99.770  977.58
  80   0.0285     99.100  0.0086    99.753  989.97
  81   0.0260     99.140  0.0083    99.745  1002.29
  82   0.0269     99.110  0.0080    99.777  1014.60
  83   0.0280     99.120  0.0080    99.782  1026.92
  84   0.0328     98.900  0.0084    99.757  1039.23
  85   0.0312     98.930  0.0070    99.823  1051.55
  86   0.0273     99.060  0.0076    99.798  1063.86
  87   0.0308     98.960  0.0071    99.822  1076.18
  88   0.0281     99.060  0.0075    99.805  1088.50
  89   0.0291     99.100  0.0074    99.788  1100.83
  90   0.0287     99.110  0.0071    99.795  1113.13
