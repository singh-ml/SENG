Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2132     93.190  1.2579    62.975  14.95
   2   0.1034     96.370  0.1313    96.005  27.44
   3   0.0914     96.990  0.0856    97.335  39.92
   4   0.0638     97.960  0.0682    97.768  52.39
   5   0.0680     97.750  0.0564    98.278  65.01
   6   0.0527     98.150  0.0530    98.370  77.49
   7   0.0463     98.410  0.0486    98.465  89.97
   8   0.0456     98.360  0.0427    98.627  102.65
   9   0.0327     98.980  0.0410    98.680  115.15
  10   0.0416     98.580  0.0394    98.758  127.64
  11   0.0439     98.630  0.0394    98.727  140.26
  12   0.0376     98.730  0.0361    98.857  152.75
  13   0.0494     98.270  0.0354    98.845  165.23
  14   0.0365     98.780  0.0330    98.940  177.70
  15   0.0342     98.800  0.0320    98.983  190.19
  16   0.0369     98.750  0.0301    99.037  202.72
  17   0.0354     98.710  0.0292    99.075  215.22
  18   0.0413     98.520  0.0300    99.060  227.68
  19   0.0270     99.130  0.0284    99.093  240.18
  20   0.0312     98.990  0.0272    99.148  252.65
  21   0.0383     98.740  0.0272    99.105  265.27
  22   0.0315     98.960  0.0263    99.148  277.75
  23   0.0376     98.760  0.0255    99.157  290.23
  24   0.0347     98.930  0.0237    99.227  302.87
  25   0.0276     99.090  0.0249    99.230  315.34
  26   0.0261     99.130  0.0234    99.213  327.82
  27   0.0359     98.760  0.0232    99.245  340.34
  28   0.0393     98.760  0.0227    99.275  352.94
  29   0.0295     99.070  0.0226    99.257  365.44
  30   0.0218     99.230  0.0215    99.305  377.90
  31   0.0342     98.900  0.0203    99.352  390.49
  32   0.0258     99.210  0.0204    99.337  402.94
  33   0.0275     99.010  0.0194    99.365  415.43
  34   0.0316     98.980  0.0202    99.327  427.89
  35   0.0273     99.090  0.0197    99.342  440.39
  36   0.0327     98.850  0.0182    99.388  452.86
  37   0.0266     98.990  0.0185    99.388  465.44
  38   0.0276     99.230  0.0178    99.395  477.89
  39   0.0209     99.350  0.0180    99.430  490.38
  40   0.0222     99.230  0.0165    99.453  502.86
  41   0.0215     99.310  0.0157    99.467  515.32
  42   0.0364     98.870  0.0159    99.478  527.78
  43   0.0195     99.330  0.0140    99.552  540.23
  44   0.0255     99.150  0.0150    99.502  552.69
  45   0.0346     98.880  0.0144    99.525  565.13
  46   0.0249     99.250  0.0134    99.540  577.56
  47   0.0316     98.970  0.0126    99.583  590.03
  48   0.0224     99.360  0.0125    99.557  602.50
  49   0.0256     99.130  0.0126    99.587  614.99
  50   0.0219     99.290  0.0109    99.633  627.55
  51   0.0257     99.170  0.0108    99.645  640.02
  52   0.0414     98.650  0.0111    99.628  652.47
  53   0.0310     99.020  0.0098    99.690  665.08
  54   0.0180     99.450  0.0111    99.637  677.54
  55   0.0311     98.970  0.0095    99.702  689.99
  56   0.0228     99.320  0.0089    99.713  702.47
  57   0.0310     99.040  0.0089    99.715  715.13
  58   0.0241     99.270  0.0087    99.725  727.60
  59   0.0204     99.420  0.0080    99.742  740.07
  60   0.0267     99.170  0.0073    99.767  752.53
  61   0.0255     99.210  0.0071    99.793  765.01
  62   0.0235     99.230  0.0064    99.793  777.49
  63   0.0197     99.380  0.0065    99.807  790.09
  64   0.0241     99.290  0.0056    99.842  802.57
  65   0.0237     99.270  0.0052    99.845  815.07
  66   0.0270     99.110  0.0055    99.803  827.60
  67   0.0326     99.050  0.0051    99.850  840.07
  68   0.0221     99.320  0.0045    99.865  852.59
  69   0.0299     99.040  0.0045    99.877  865.17
  70   0.0246     99.230  0.0044    99.863  877.71
  71   0.0289     99.170  0.0035    99.902  890.29
  72   0.0250     99.230  0.0038    99.892  902.77
  73   0.0226     99.330  0.0032    99.910  915.32
  74   0.0244     99.260  0.0032    99.908  927.87
  75   0.0229     99.300  0.0031    99.915  940.37
  76   0.0249     99.280  0.0028    99.922  953.03
  77   0.0247     99.270  0.0026    99.935  965.58
  78   0.0254     99.230  0.0025    99.955  978.10
  79   0.0273     99.150  0.0024    99.945  990.69
  80   0.0245     99.260  0.0023    99.958  1003.20
  81   0.0248     99.230  0.0021    99.957  1015.74
  82   0.0250     99.200  0.0020    99.948  1028.38
  83   0.0245     99.270  0.0023    99.948  1040.93
  84   0.0252     99.260  0.0018    99.968  1053.51
  85   0.0241     99.260  0.0018    99.962  1066.05
  86   0.0236     99.260  0.0018    99.965  1078.57
  87   0.0246     99.250  0.0020    99.955  1091.12
  88   0.0243     99.280  0.0021    99.942  1103.63
  89   0.0260     99.190  0.0018    99.967  1116.10
  90   0.0259     99.210  0.0020    99.952  1128.63
