Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2006     93.760  0.6723    77.067  14.63
   2   0.1226     95.870  0.1247    96.127  27.04
   3   0.1087     96.360  0.0832    97.408  39.62
   4   0.0818     97.500  0.0668    97.905  52.04
   5   0.0662     97.970  0.0590    98.175  64.49
   6   0.0530     98.290  0.0521    98.392  77.08
   7   0.0475     98.460  0.0488    98.448  89.50
   8   0.0672     97.770  0.0453    98.563  101.92
   9   0.0562     98.070  0.0400    98.743  114.45
  10   0.0454     98.490  0.0405    98.662  126.85
  11   0.0560     98.180  0.0374    98.773  139.30
  12   0.0425     98.600  0.0350    98.898  151.75
  13   0.0821     97.460  0.0340    98.897  164.15
  14   0.0386     98.740  0.0325    98.962  176.59
  15   0.0616     98.010  0.0312    99.002  189.01
  16   0.0350     98.790  0.0299    99.068  201.58
  17   0.0421     98.640  0.0277    99.108  214.00
  18   0.0467     98.540  0.0281    99.090  226.40
  19   0.0360     98.840  0.0274    99.133  238.92
  20   0.0391     98.650  0.0267    99.182  251.31
  21   0.0353     98.730  0.0245    99.203  263.72
  22   0.0373     98.760  0.0249    99.213  276.25
  23   0.0364     98.810  0.0238    99.225  288.65
  24   0.0391     98.640  0.0225    99.250  301.07
  25   0.0281     99.120  0.0223    99.293  313.49
  26   0.0311     99.040  0.0219    99.293  325.89
  27   0.0329     98.930  0.0214    99.295  338.32
  28   0.0412     98.650  0.0217    99.295  350.76
  29   0.0381     98.750  0.0204    99.325  363.31
  30   0.0295     98.960  0.0194    99.380  375.74
  31   0.0296     98.970  0.0198    99.370  388.15
  32   0.0304     99.050  0.0186    99.410  400.70
  33   0.0239     99.220  0.0170    99.443  413.13
  34   0.0322     98.960  0.0174    99.438  425.53
  35   0.0383     98.820  0.0168    99.482  438.08
  36   0.0334     98.890  0.0174    99.443  450.51
  37   0.0308     98.990  0.0167    99.453  462.92
  38   0.0312     98.960  0.0152    99.530  475.42
  39   0.0265     99.150  0.0147    99.558  487.81
  40   0.0306     99.020  0.0146    99.545  500.21
  41   0.0333     98.840  0.0139    99.537  512.66
  42   0.0272     99.110  0.0142    99.548  525.08
  43   0.0332     98.930  0.0140    99.565  537.50
  44   0.0297     99.080  0.0129    99.602  549.91
  45   0.0355     98.860  0.0130    99.613  562.32
  46   0.0313     99.040  0.0128    99.620  574.75
  47   0.0240     99.130  0.0123    99.625  587.15
  48   0.0269     99.150  0.0123    99.612  599.63
  49   0.0263     99.130  0.0119    99.652  612.06
  50   0.0253     99.230  0.0113    99.638  624.49
  51   0.0306     98.980  0.0111    99.660  637.05
  52   0.0346     98.860  0.0117    99.648  649.46
  53   0.0287     99.050  0.0107    99.665  661.87
  54   0.0282     99.080  0.0098    99.692  674.30
  55   0.0338     98.960  0.0098    99.713  686.69
  56   0.0266     99.120  0.0096    99.687  699.09
  57   0.0282     99.130  0.0097    99.722  711.50
  58   0.0256     99.100  0.0092    99.722  723.89
  59   0.0271     99.130  0.0086    99.760  736.28
  60   0.0269     99.120  0.0079    99.785  748.71
  61   0.0243     99.170  0.0084    99.750  761.24
  62   0.0244     99.210  0.0081    99.742  773.69
  63   0.0346     98.940  0.0080    99.768  786.10
  64   0.0258     99.170  0.0075    99.778  798.64
  65   0.0278     99.040  0.0068    99.820  811.03
  66   0.0303     99.080  0.0072    99.787  823.46
  67   0.0359     98.930  0.0072    99.800  835.88
  68   0.0258     99.130  0.0070    99.797  848.27
  69   0.0265     99.180  0.0067    99.813  860.70
  70   0.0271     99.100  0.0063    99.828  873.12
  71   0.0295     99.100  0.0058    99.845  885.52
  72   0.0266     99.130  0.0063    99.822  897.92
  73   0.0263     99.220  0.0054    99.865  910.32
  74   0.0237     99.230  0.0058    99.850  922.71
  75   0.0248     99.150  0.0053    99.878  935.14
  76   0.0285     99.120  0.0050    99.873  947.53
  77   0.0289     99.080  0.0056    99.862  960.05
  78   0.0282     99.120  0.0050    99.882  972.43
  79   0.0281     99.120  0.0048    99.888  984.84
  80   0.0281     99.150  0.0047    99.882  997.23
  81   0.0290     99.060  0.0046    99.897  1009.69
  82   0.0268     99.160  0.0047    99.883  1022.10
  83   0.0267     99.200  0.0044    99.907  1034.55
  84   0.0281     99.150  0.0047    99.878  1047.05
  85   0.0274     99.210  0.0043    99.903  1059.47
  86   0.0260     99.190  0.0042    99.922  1071.88
  87   0.0268     99.200  0.0044    99.900  1084.38
  88   0.0276     99.180  0.0043    99.912  1096.78
  89   0.0274     99.160  0.0042    99.917  1109.17
  90   0.0305     99.090  0.0042    99.907  1121.69
