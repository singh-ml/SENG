Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.8084     72.590  1.8769    46.035  14.50
   2   0.2765     90.800  0.2615    91.962  26.85
   3   0.2296     92.620  0.1263    96.122  39.20
   4   0.1241     95.910  0.0915    97.213  51.54
   5   0.0728     97.590  0.0745    97.665  63.85
   6   0.0686     97.610  0.0638    97.995  76.31
   7   0.0522     98.160  0.0564    98.217  88.62
   8   0.0457     98.510  0.0530    98.298  100.93
   9   0.0458     98.350  0.0481    98.545  113.25
  10   0.0487     98.330  0.0455    98.557  125.56
  11   0.0414     98.480  0.0435    98.635  137.84
  12   0.0663     97.910  0.0404    98.723  150.16
  13   0.0491     98.470  0.0391    98.768  162.50
  14   0.0684     97.520  0.0357    98.848  174.79
  15   0.0416     98.580  0.0359    98.865  187.10
  16   0.0433     98.560  0.0333    98.893  199.54
  17   0.0388     98.660  0.0336    98.915  211.86
  18   0.0388     98.800  0.0317    99.005  224.17
  19   0.0395     98.600  0.0315    98.982  236.61
  20   0.0362     98.760  0.0302    99.022  248.92
  21   0.0449     98.540  0.0295    99.072  261.24
  22   0.0329     98.840  0.0283    99.073  273.55
  23   0.0287     98.940  0.0272    99.097  285.99
  24   0.0352     98.800  0.0272    99.117  298.31
  25   0.0413     98.750  0.0267    99.112  310.62
  26   0.0352     98.740  0.0263    99.198  322.91
  27   0.0278     99.070  0.0269    99.118  335.21
  28   0.0369     98.750  0.0238    99.203  347.52
  29   0.0280     99.130  0.0230    99.305  359.95
  30   0.0319     98.900  0.0239    99.193  372.27
  31   0.0334     98.840  0.0213    99.305  384.57
  32   0.0384     98.820  0.0210    99.288  397.03
  33   0.0343     98.830  0.0228    99.247  409.34
  34   0.0300     99.040  0.0203    99.313  421.65
  35   0.0389     98.720  0.0194    99.362  433.97
  36   0.0361     98.790  0.0181    99.408  446.28
  37   0.0292     99.010  0.0197    99.363  458.55
  38   0.0285     99.100  0.0190    99.393  470.83
  39   0.0306     99.080  0.0186    99.378  483.27
  40   0.0311     99.000  0.0171    99.390  495.57
  41   0.0386     98.730  0.0162    99.472  507.90
  42   0.0347     98.840  0.0167    99.407  520.31
  43   0.0265     99.100  0.0152    99.470  532.63
  44   0.0376     98.730  0.0145    99.500  544.91
  45   0.0316     98.980  0.0153    99.467  557.22
  46   0.0295     99.080  0.0144    99.542  569.52
  47   0.0317     98.930  0.0127    99.597  581.79
  48   0.0367     98.900  0.0120    99.588  594.07
  49   0.0301     99.080  0.0125    99.585  606.37
  50   0.0323     98.920  0.0115    99.628  618.71
  51   0.0289     99.030  0.0109    99.630  631.01
  52   0.0324     98.840  0.0108    99.633  643.43
  53   0.0283     99.110  0.0102    99.673  655.73
  54   0.0274     99.050  0.0102    99.645  668.04
  55   0.0333     99.000  0.0088    99.698  680.52
  56   0.0332     98.950  0.0094    99.677  692.82
  57   0.0243     99.210  0.0075    99.755  705.12
  58   0.0301     99.030  0.0086    99.705  717.42
  59   0.0281     99.170  0.0073    99.770  729.72
  60   0.0270     99.170  0.0070    99.777  742.03
  61   0.0288     99.040  0.0064    99.803  754.36
  62   0.0261     99.130  0.0054    99.837  766.88
  63   0.0249     99.220  0.0056    99.843  779.23
  64   0.0298     99.030  0.0049    99.842  791.51
  65   0.0272     99.120  0.0047    99.858  803.88
  66   0.0299     99.060  0.0046    99.852  816.22
  67   0.0286     99.050  0.0040    99.877  828.55
  68   0.0309     98.990  0.0046    99.860  840.97
  69   0.0274     99.110  0.0041    99.860  853.26
  70   0.0276     99.170  0.0037    99.883  865.59
  71   0.0273     99.130  0.0035    99.895  878.10
  72   0.0285     99.050  0.0032    99.907  890.38
  73   0.0292     99.090  0.0035    99.903  902.68
  74   0.0305     99.010  0.0029    99.925  915.01
  75   0.0288     99.090  0.0029    99.920  927.42
  76   0.0283     99.120  0.0028    99.923  939.72
  77   0.0293     99.080  0.0025    99.940  952.04
  78   0.0280     99.170  0.0025    99.937  964.49
  79   0.0274     99.130  0.0029    99.930  976.78
  80   0.0292     99.100  0.0025    99.942  989.08
  81   0.0286     99.090  0.0023    99.938  1001.48
  82   0.0298     99.060  0.0025    99.928  1013.76
  83   0.0298     99.100  0.0022    99.942  1026.03
  84   0.0294     99.070  0.0026    99.938  1038.35
  85   0.0284     99.070  0.0024    99.937  1050.64
