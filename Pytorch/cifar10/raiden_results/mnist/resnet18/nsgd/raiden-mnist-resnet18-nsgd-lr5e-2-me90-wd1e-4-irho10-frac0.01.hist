Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2147     18.340  2.4336    21.630  14.49
   2   0.4808     84.450  0.9604    62.127  26.74
   3   0.2239     93.220  0.2973    91.065  38.91
   4   0.1261     96.240  0.1473    95.622  51.09
   5   0.0977     97.050  0.1058    96.817  63.22
   6   0.0640     98.000  0.0827    97.535  75.35
   7   0.0911     97.380  0.0720    97.805  87.50
   8   0.0544     98.330  0.0682    97.955  99.61
   9   0.0792     97.360  0.0599    98.202  112.06
  10   0.0975     97.060  0.0544    98.313  124.18
  11   0.0381     98.810  0.0520    98.407  136.48
  12   0.0564     98.210  0.0491    98.467  148.92
  13   0.0395     98.710  0.0476    98.528  161.03
  14   0.0465     98.540  0.0458    98.568  173.35
  15   0.0602     98.130  0.0415    98.660  185.79
  16   0.0350     98.910  0.0408    98.725  198.12
  17   0.0461     98.520  0.0381    98.853  210.25
  18   0.0412     98.610  0.0405    98.728  222.40
  19   0.0384     98.780  0.0368    98.872  234.56
  20   0.0397     98.750  0.0354    98.907  246.72
  21   0.0477     98.510  0.0338    98.895  259.06
  22   0.0345     98.870  0.0315    99.028  271.46
  23   0.0397     98.750  0.0306    98.992  283.60
  24   0.0429     98.690  0.0318    98.987  295.78
  25   0.0292     99.120  0.0293    99.067  308.21
  26   0.0309     98.990  0.0294    99.090  320.34
  27   0.0440     98.650  0.0261    99.142  332.68
  28   0.0311     99.050  0.0267    99.178  344.80
  29   0.0332     98.940  0.0248    99.223  357.18
  30   0.0304     99.050  0.0246    99.215  369.36
  31   0.0312     99.080  0.0251    99.187  381.69
  32   0.0347     98.910  0.0249    99.198  393.85
  33   0.0372     98.880  0.0242    99.183  406.00
  34   0.0313     99.030  0.0214    99.305  418.33
  35   0.0333     98.910  0.0213    99.313  430.76
  36   0.0410     98.750  0.0213    99.283  442.90
  37   0.0403     98.760  0.0201    99.360  455.03
  38   0.0260     99.160  0.0201    99.345  467.16
  39   0.0396     98.810  0.0192    99.383  479.30
  40   0.0343     98.940  0.0185    99.395  491.45
  41   0.0347     98.840  0.0193    99.373  503.82
  42   0.0324     98.990  0.0174    99.433  515.95
  43   0.0328     99.040  0.0174    99.422  528.08
  44   0.0355     98.940  0.0160    99.487  540.22
  45   0.0393     98.830  0.0163    99.483  552.67
  46   0.0359     98.840  0.0155    99.490  565.01
  47   0.0309     99.070  0.0143    99.532  577.15
  48   0.0243     99.250  0.0136    99.542  589.41
  49   0.0393     98.780  0.0130    99.567  601.54
  50   0.0405     98.700  0.0122    99.575  613.86
  51   0.0279     99.110  0.0128    99.583  626.02
  52   0.0300     99.110  0.0118    99.617  638.36
  53   0.0321     99.080  0.0117    99.620  650.49
  54   0.0320     99.000  0.0105    99.648  662.62
  55   0.0292     99.100  0.0112    99.652  674.75
  56   0.0325     99.000  0.0099    99.650  687.09
  57   0.0301     99.140  0.0098    99.662  699.20
  58   0.0340     98.930  0.0092    99.687  711.62
  59   0.0349     98.920  0.0086    99.728  723.96
  60   0.0291     99.140  0.0079    99.728  736.10
  61   0.0284     99.100  0.0083    99.708  748.23
  62   0.0310     99.060  0.0070    99.772  760.56
  63   0.0309     99.080  0.0076    99.770  772.90
  64   0.0334     99.050  0.0065    99.783  785.04
  65   0.0311     99.070  0.0065    99.797  797.46
  66   0.0311     99.010  0.0061    99.798  809.80
  67   0.0341     99.000  0.0061    99.813  821.92
  68   0.0304     99.160  0.0052    99.815  834.14
  69   0.0306     99.120  0.0057    99.817  846.47
  70   0.0312     99.130  0.0046    99.850  858.60
  71   0.0294     99.180  0.0050    99.828  870.85
  72   0.0317     99.080  0.0047    99.848  882.99
  73   0.0339     99.080  0.0042    99.863  895.11
  74   0.0335     99.130  0.0042    99.850  907.24
  75   0.0323     99.100  0.0039    99.883  919.56
  76   0.0335     99.080  0.0037    99.885  931.70
  77   0.0326     99.140  0.0036    99.887  943.83
  78   0.0337     99.100  0.0035    99.875  956.05
  79   0.0329     99.120  0.0035    99.895  968.17
  80   0.0315     99.140  0.0032    99.900  980.29
  81   0.0338     99.100  0.0033    99.907  992.40
  82   0.0319     99.080  0.0030    99.902  1004.93
  83   0.0334     99.020  0.0028    99.905  1017.03
  84   0.0338     99.080  0.0031    99.897  1029.18
  85   0.0342     99.060  0.0029    99.907  1041.54
  86   0.0334     99.090  0.0029    99.915  1053.65
  87   0.0332     99.100  0.0028    99.917  1065.78
  88   0.0330     99.090  0.0027    99.918  1078.01
  89   0.0342     99.070  0.0028    99.910  1090.33
  90   0.0327     99.110  0.0027    99.922  1102.67
