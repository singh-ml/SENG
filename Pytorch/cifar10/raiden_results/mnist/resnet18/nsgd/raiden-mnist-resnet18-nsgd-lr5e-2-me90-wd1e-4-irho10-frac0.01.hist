Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.5248     36.080  2.3140    26.068  14.79
   2   2.3161     58.500  0.9620    64.942  26.90
   3   0.3439     89.730  0.3680    88.262  39.03
   4   0.1411     95.350  0.2085    93.755  51.36
   5   0.1630     94.990  0.1495    95.497  63.49
   6   0.1287     96.220  0.1106    96.602  75.59
   7   0.1175     96.490  0.0871    97.418  87.69
   8   0.0508     98.340  0.0781    97.635  99.80
   9   0.0547     98.210  0.0664    97.978  111.91
  10   0.0552     98.320  0.0635    98.082  124.02
  11   0.0678     97.900  0.0559    98.303  136.35
  12   0.0532     98.260  0.0528    98.367  148.44
  13   0.0531     98.350  0.0507    98.477  160.54
  14   0.0465     98.490  0.0468    98.518  172.76
  15   0.0449     98.570  0.0439    98.615  185.07
  16   0.0541     98.240  0.0405    98.715  197.17
  17   0.0478     98.450  0.0421    98.687  209.29
  18   0.0524     98.340  0.0380    98.800  221.41
  19   0.0340     98.990  0.0368    98.842  233.51
  20   0.0349     98.890  0.0352    98.912  245.65
  21   0.0429     98.620  0.0340    98.928  257.89
  22   0.0493     98.340  0.0334    98.962  270.00
  23   0.0432     98.680  0.0324    99.000  282.12
  24   0.0366     98.760  0.0312    99.020  294.35
  25   0.0444     98.710  0.0298    99.072  306.46
  26   0.0488     98.490  0.0290    99.085  318.60
  27   0.0375     98.810  0.0286    99.090  330.84
  28   0.0365     98.690  0.0279    99.078  342.96
  29   0.0520     98.280  0.0282    99.120  355.07
  30   0.0460     98.540  0.0260    99.153  367.17
  31   0.0331     98.970  0.0260    99.155  379.29
  32   0.0391     98.760  0.0255    99.158  391.39
  33   0.0374     98.950  0.0228    99.282  403.49
  34   0.0350     98.940  0.0226    99.250  415.70
  35   0.0382     98.830  0.0225    99.293  427.82
  36   0.0398     98.720  0.0207    99.323  439.93
  37   0.0308     98.990  0.0198    99.380  452.21
  38   0.0316     98.900  0.0193    99.358  464.30
  39   0.0318     99.010  0.0189    99.385  476.41
  40   0.0326     98.880  0.0185    99.403  488.50
  41   0.0366     98.920  0.0187    99.410  500.76
  42   0.0401     98.750  0.0181    99.410  512.89
  43   0.0488     98.440  0.0174    99.437  525.00
  44   0.0363     98.890  0.0176    99.410  537.27
  45   0.0334     98.860  0.0167    99.460  549.39
  46   0.0343     98.960  0.0142    99.548  561.49
  47   0.0299     99.050  0.0141    99.570  573.60
  48   0.0351     98.910  0.0139    99.540  585.95
  49   0.0391     98.880  0.0136    99.552  598.06
  50   0.0331     99.010  0.0132    99.570  610.18
  51   0.0322     99.050  0.0137    99.582  622.30
  52   0.0311     99.100  0.0115    99.608  634.42
  53   0.0332     98.930  0.0117    99.605  646.54
  54   0.0336     99.050  0.0108    99.643  658.81
  55   0.0325     99.010  0.0110    99.640  670.93
  56   0.0323     98.940  0.0100    99.677  683.03
  57   0.0313     99.050  0.0100    99.667  695.26
  58   0.0356     98.990  0.0096    99.675  707.39
  59   0.0340     99.020  0.0092    99.673  719.68
  60   0.0273     99.160  0.0083    99.733  731.97
  61   0.0316     99.130  0.0081    99.757  744.22
  62   0.0384     98.950  0.0072    99.753  756.32
  63   0.0310     99.040  0.0075    99.732  768.43
  64   0.0322     99.050  0.0070    99.768  780.63
  65   0.0308     99.060  0.0065    99.780  792.74
  66   0.0298     99.070  0.0061    99.798  804.83
  67   0.0330     98.980  0.0058    99.810  817.11
  68   0.0288     99.120  0.0055    99.820  829.23
  69   0.0312     99.120  0.0053    99.822  841.35
  70   0.0305     99.130  0.0050    99.833  853.58
  71   0.0328     99.100  0.0050    99.845  865.94
  72   0.0316     99.060  0.0043    99.852  878.15
  73   0.0322     99.070  0.0040    99.892  890.28
  74   0.0330     99.050  0.0043    99.868  902.39
  75   0.0353     99.030  0.0040    99.868  914.52
  76   0.0326     99.040  0.0037    99.892  926.63
  77   0.0353     99.040  0.0037    99.883  938.91
  78   0.0326     99.080  0.0037    99.887  951.03
  79   0.0337     99.090  0.0034    99.890  963.14
  80   0.0326     99.080  0.0032    99.908  975.25
  81   0.0330     99.090  0.0032    99.892  987.57
  82   0.0345     99.030  0.0032    99.900  999.70
  83   0.0318     99.120  0.0032    99.908  1012.04
  84   0.0347     99.060  0.0031    99.885  1024.26
  85   0.0355     99.120  0.0031    99.910  1036.43
  86   0.0340     99.090  0.0030    99.908  1048.78
  87   0.0347     99.090  0.0026    99.925  1060.94
  88   0.0340     99.100  0.0029    99.908  1073.07
  89   0.0332     99.100  0.0029    99.908  1085.21
  90   0.0346     99.060  0.0026    99.918  1097.33
