Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1264     96.120  0.4878    83.170  14.48
   2   0.1741     94.610  0.1014    96.785  26.82
   3   0.1113     96.270  0.0711    97.785  39.22
   4   0.0720     97.790  0.0600    98.045  51.50
   5   0.0532     98.350  0.0514    98.428  63.78
   6   0.0734     97.430  0.0455    98.567  76.20
   7   0.0577     98.080  0.0418    98.662  88.47
   8   0.0532     98.350  0.0394    98.670  100.76
   9   0.0461     98.580  0.0373    98.818  113.12
  10   0.0629     97.900  0.0361    98.800  125.36
  11   0.0499     98.390  0.0341    98.927  137.64
  12   0.0399     98.660  0.0312    99.047  149.89
  13   0.0334     98.890  0.0287    99.052  162.19
  14   0.0480     98.540  0.0290    99.080  174.45
  15   0.0521     98.430  0.0269    99.133  186.72
  16   0.0445     98.510  0.0269    99.090  199.11
  17   0.0332     98.900  0.0241    99.237  211.37
  18   0.0480     98.530  0.0249    99.222  223.63
  19   0.0295     99.020  0.0258    99.180  235.90
  20   0.0361     98.790  0.0232    99.212  248.19
  21   0.0364     98.750  0.0241    99.238  260.45
  22   0.0387     98.760  0.0220    99.287  272.73
  23   0.0298     99.070  0.0214    99.307  285.14
  24   0.0318     98.960  0.0201    99.348  297.42
  25   0.0322     99.050  0.0208    99.307  309.70
  26   0.0325     98.990  0.0190    99.393  322.08
  27   0.0325     98.950  0.0184    99.388  334.34
  28   0.0439     98.650  0.0190    99.363  346.60
  29   0.0291     98.900  0.0177    99.407  358.87
  30   0.0309     98.860  0.0160    99.503  371.14
  31   0.0275     99.060  0.0161    99.478  383.39
  32   0.0283     99.130  0.0150    99.510  395.67
  33   0.0388     98.680  0.0152    99.512  408.06
  34   0.0336     98.970  0.0152    99.475  420.31
  35   0.0322     99.000  0.0134    99.562  432.58
  36   0.0317     98.910  0.0149    99.492  444.98
  37   0.0289     99.050  0.0140    99.510  457.25
  38   0.0287     99.050  0.0137    99.537  469.54
  39   0.0241     99.160  0.0126    99.597  481.81
  40   0.0277     99.050  0.0124    99.603  494.22
  41   0.0299     99.130  0.0114    99.612  506.48
  42   0.0358     98.820  0.0113    99.643  518.74
  43   0.0288     99.020  0.0119    99.602  531.03
  44   0.0272     99.130  0.0114    99.625  543.42
  45   0.0264     99.130  0.0105    99.672  555.66
  46   0.0270     99.010  0.0101    99.670  567.95
  47   0.0295     99.010  0.0099    99.673  580.31
  48   0.0236     99.230  0.0087    99.723  592.57
  49   0.0325     98.990  0.0090    99.710  604.87
  50   0.0357     98.880  0.0091    99.683  617.16
  51   0.0333     98.960  0.0088    99.730  629.55
  52   0.0273     99.110  0.0085    99.707  641.81
  53   0.0284     99.060  0.0081    99.718  654.09
  54   0.0244     99.170  0.0081    99.718  666.38
  55   0.0301     98.960  0.0074    99.768  678.68
  56   0.0276     99.110  0.0070    99.780  690.92
  57   0.0295     99.080  0.0072    99.763  703.20
  58   0.0265     99.120  0.0063    99.812  715.60
  59   0.0283     99.050  0.0073    99.787  727.88
  60   0.0280     98.970  0.0060    99.810  740.17
  61   0.0285     99.110  0.0057    99.827  752.58
  62   0.0299     99.010  0.0058    99.810  764.85
  63   0.0264     99.160  0.0060    99.812  777.08
  64   0.0280     99.100  0.0051    99.837  789.35
  65   0.0255     99.210  0.0055    99.832  801.61
  66   0.0279     99.130  0.0051    99.853  813.86
  67   0.0293     98.970  0.0045    99.847  826.12
  68   0.0302     98.970  0.0048    99.858  838.39
  69   0.0258     99.180  0.0049    99.863  850.70
  70   0.0304     98.980  0.0042    99.863  862.98
  71   0.0282     99.060  0.0045    99.847  875.37
  72   0.0285     99.110  0.0042    99.877  887.65
  73   0.0270     99.130  0.0040    99.880  900.00
  74   0.0312     99.020  0.0039    99.888  912.40
  75   0.0255     99.180  0.0044    99.852  924.69
  76   0.0310     99.000  0.0038    99.898  936.96
  77   0.0264     99.140  0.0034    99.903  949.23
  78   0.0287     99.110  0.0038    99.885  961.50
  79   0.0292     99.040  0.0033    99.903  973.76
  80   0.0263     99.100  0.0041    99.868  986.04
  81   0.0308     98.980  0.0036    99.895  998.48
  82   0.0306     99.010  0.0034    99.900  1010.73
  83   0.0288     99.090  0.0031    99.917  1023.00
  84   0.0297     99.080  0.0032    99.928  1035.37
  85   0.0284     99.110  0.0030    99.912  1047.72
  86   0.0313     98.970  0.0030    99.925  1060.01
  87   0.0311     98.990  0.0032    99.905  1072.27
  88   0.0304     99.040  0.0033    99.898  1084.76
  89   0.0277     99.120  0.0030    99.927  1097.03
  90   0.0295     99.070  0.0030    99.920  1109.30
