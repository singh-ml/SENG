Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1170     96.400  0.4995    82.740  14.59
   2   0.0990     96.680  0.0972    96.862  27.06
   3   0.0820     97.490  0.0705    97.775  39.36
   4   0.0587     97.970  0.0599    98.112  51.69
   5   0.0802     97.180  0.0515    98.385  64.05
   6   0.0461     98.550  0.0455    98.553  76.52
   7   0.0442     98.660  0.0424    98.665  88.84
   8   0.0449     98.580  0.0395    98.730  101.22
   9   0.0537     98.450  0.0371    98.797  113.64
  10   0.0501     98.540  0.0351    98.842  125.96
  11   0.0396     98.750  0.0327    98.973  138.29
  12   0.0480     98.390  0.0325    98.962  150.70
  13   0.0441     98.680  0.0309    99.020  163.07
  14   0.0365     98.830  0.0283    99.078  175.44
  15   0.0365     98.880  0.0288    99.072  187.79
  16   0.0340     98.890  0.0262    99.125  200.15
  17   0.0279     99.080  0.0263    99.140  212.51
  18   0.0354     98.880  0.0259    99.158  224.84
  19   0.0325     99.020  0.0234    99.253  237.22
  20   0.0379     98.800  0.0233    99.267  249.59
  21   0.0365     98.710  0.0231    99.210  261.94
  22   0.0311     99.040  0.0212    99.315  274.39
  23   0.0278     99.010  0.0209    99.297  286.71
  24   0.0349     98.890  0.0201    99.338  299.06
  25   0.0345     98.860  0.0187    99.333  311.48
  26   0.0425     98.670  0.0195    99.357  323.84
  27   0.0253     99.060  0.0188    99.362  336.20
  28   0.0287     99.040  0.0174    99.418  348.56
  29   0.0327     98.930  0.0181    99.400  360.91
  30   0.0348     98.740  0.0170    99.425  373.25
  31   0.0268     99.090  0.0163    99.488  385.59
  32   0.0282     99.080  0.0155    99.468  397.92
  33   0.0285     99.150  0.0156    99.488  410.25
  34   0.0375     98.900  0.0149    99.508  422.60
  35   0.0277     99.080  0.0143    99.490  435.05
  36   0.0278     99.100  0.0139    99.542  447.41
  37   0.0308     98.970  0.0135    99.557  459.75
  38   0.0241     99.190  0.0135    99.547  472.21
  39   0.0356     98.900  0.0130    99.545  484.51
  40   0.0319     98.930  0.0130    99.583  496.84
  41   0.0247     99.230  0.0121    99.575  509.20
  42   0.0306     98.990  0.0108    99.672  521.77
  43   0.0286     99.120  0.0114    99.638  534.13
  44   0.0235     99.210  0.0103    99.678  546.47
  45   0.0317     98.930  0.0102    99.678  558.84
  46   0.0248     99.140  0.0094    99.690  571.17
  47   0.0307     98.940  0.0101    99.650  583.53
  48   0.0319     98.930  0.0098    99.688  595.92
  49   0.0311     98.990  0.0095    99.685  608.28
  50   0.0263     99.080  0.0086    99.707  620.62
  51   0.0276     99.110  0.0082    99.743  633.08
  52   0.0317     98.980  0.0077    99.782  645.40
  53   0.0264     99.160  0.0088    99.703  657.76
  54   0.0299     99.000  0.0079    99.745  670.11
  55   0.0256     99.150  0.0078    99.752  682.45
  56   0.0254     99.140  0.0069    99.783  694.80
  57   0.0345     98.960  0.0063    99.813  707.14
  58   0.0300     99.050  0.0069    99.758  719.48
  59   0.0314     99.010  0.0062    99.805  731.80
  60   0.0291     99.090  0.0063    99.777  744.14
  61   0.0298     99.080  0.0058    99.818  756.59
  62   0.0278     99.200  0.0058    99.845  768.93
  63   0.0265     99.150  0.0049    99.858  781.27
  64   0.0306     99.230  0.0057    99.820  793.74
  65   0.0284     99.170  0.0053    99.837  806.08
  66   0.0262     99.180  0.0044    99.862  818.39
  67   0.0250     99.210  0.0048    99.852  830.75
  68   0.0295     99.020  0.0048    99.863  843.11
  69   0.0329     99.030  0.0043    99.875  855.45
  70   0.0280     99.180  0.0039    99.895  867.81
  71   0.0281     99.140  0.0040    99.883  880.24
  72   0.0273     99.150  0.0050    99.855  892.60
  73   0.0294     99.060  0.0045    99.882  904.96
  74   0.0313     99.050  0.0035    99.912  917.42
  75   0.0324     99.050  0.0040    99.878  929.76
  76   0.0247     99.270  0.0036    99.892  942.10
  77   0.0299     99.040  0.0034    99.902  954.45
  78   0.0309     99.070  0.0033    99.908  966.82
  79   0.0301     99.080  0.0035    99.898  979.19
  80   0.0279     99.110  0.0034    99.890  991.54
  81   0.0284     99.140  0.0036    99.912  1003.86
  82   0.0290     99.090  0.0033    99.913  1016.20
  83   0.0279     99.100  0.0034    99.893  1028.60
  84   0.0276     99.140  0.0032    99.923  1041.07
  85   0.0292     99.130  0.0031    99.918  1053.44
  86   0.0280     99.100  0.0028    99.943  1065.78
  87   0.0298     99.110  0.0032    99.910  1078.14
  88   0.0281     99.140  0.0029    99.933  1090.52
  89   0.0282     99.170  0.0028    99.922  1102.94
  90   0.0290     99.090  0.0030    99.923  1115.37
