Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1774     94.550  1.0459    71.567  14.73
   2   0.0933     96.860  0.1393    95.637  27.26
   3   0.1515     95.620  0.0919    97.138  39.77
   4   0.0683     97.660  0.0716    97.755  52.39
   5   0.0848     97.290  0.0631    97.997  64.89
   6   0.0571     98.160  0.0549    98.270  77.40
   7   0.0692     97.640  0.0494    98.427  89.90
   8   0.0452     98.480  0.0451    98.598  102.64
   9   0.0380     98.730  0.0426    98.688  115.13
  10   0.0459     98.590  0.0403    98.752  127.63
  11   0.0355     98.950  0.0379    98.807  140.32
  12   0.0522     98.380  0.0358    98.838  152.80
  13   0.0326     98.840  0.0347    98.877  165.30
  14   0.0387     98.690  0.0325    98.962  177.82
  15   0.0374     98.690  0.0335    98.907  190.34
  16   0.0389     98.710  0.0303    99.020  202.84
  17   0.0440     98.510  0.0287    99.062  215.34
  18   0.0379     98.700  0.0275    99.132  227.85
  19   0.0302     99.000  0.0279    99.082  240.34
  20   0.0491     98.580  0.0261    99.137  252.96
  21   0.0315     98.860  0.0265    99.205  265.50
  22   0.0362     98.920  0.0238    99.265  277.99
  23   0.0343     98.910  0.0238    99.235  290.61
  24   0.0316     99.000  0.0234    99.230  303.13
  25   0.0316     98.930  0.0212    99.307  315.61
  26   0.0406     98.790  0.0200    99.362  328.28
  27   0.0324     98.920  0.0208    99.312  340.81
  28   0.0289     99.190  0.0195    99.353  353.31
  29   0.0282     99.040  0.0195    99.343  365.81
  30   0.0306     99.150  0.0183    99.408  378.45
  31   0.0320     98.890  0.0180    99.390  390.98
  32   0.0254     99.110  0.0168    99.467  403.48
  33   0.0300     99.090  0.0179    99.345  415.96
  34   0.0252     99.190  0.0177    99.397  428.47
  35   0.0332     98.980  0.0170    99.443  440.96
  36   0.0312     98.950  0.0163    99.470  453.60
  37   0.0350     98.910  0.0159    99.457  466.10
  38   0.0332     98.970  0.0155    99.487  478.62
  39   0.0299     99.040  0.0144    99.505  491.28
  40   0.0325     98.900  0.0137    99.547  503.82
  41   0.0333     98.870  0.0131    99.558  516.32
  42   0.0328     98.910  0.0127    99.572  528.94
  43   0.0283     99.110  0.0129    99.587  541.45
  44   0.0293     99.070  0.0124    99.560  553.95
  45   0.0317     99.000  0.0113    99.615  566.47
  46   0.0340     98.900  0.0109    99.633  578.98
  47   0.0259     99.170  0.0116    99.622  591.47
  48   0.0406     98.730  0.0107    99.645  603.98
  49   0.0321     98.880  0.0103    99.653  616.60
  50   0.0349     98.950  0.0105    99.628  629.11
  51   0.0296     99.050  0.0091    99.703  641.59
  52   0.0331     98.930  0.0083    99.745  654.20
  53   0.0295     99.080  0.0091    99.693  666.73
  54   0.0305     99.030  0.0078    99.723  679.24
  55   0.0292     99.050  0.0074    99.733  691.75
  56   0.0275     99.210  0.0080    99.743  704.27
  57   0.0378     98.950  0.0065    99.767  716.79
  58   0.0278     99.160  0.0080    99.715  729.29
  59   0.0272     99.060  0.0062    99.805  741.97
  60   0.0311     98.990  0.0062    99.807  754.45
  61   0.0296     99.090  0.0060    99.782  766.95
  62   0.0283     99.130  0.0061    99.783  779.43
  63   0.0295     99.140  0.0052    99.817  791.94
  64   0.0303     99.090  0.0056    99.820  804.41
  65   0.0375     98.830  0.0050    99.837  816.88
  66   0.0329     99.060  0.0045    99.853  829.50
  67   0.0319     99.060  0.0045    99.855  841.98
  68   0.0357     99.010  0.0038    99.887  854.48
  69   0.0330     99.100  0.0033    99.890  866.96
  70   0.0337     99.030  0.0039    99.882  879.71
  71   0.0330     99.130  0.0032    99.898  892.21
  72   0.0329     99.050  0.0034    99.890  904.69
  73   0.0359     99.050  0.0032    99.910  917.32
  74   0.0377     98.980  0.0028    99.912  929.83
  75   0.0378     98.970  0.0027    99.927  942.32
  76   0.0339     99.030  0.0024    99.923  954.92
  77   0.0333     99.070  0.0027    99.922  967.44
  78   0.0372     99.050  0.0025    99.932  979.94
  79   0.0325     99.040  0.0021    99.943  992.61
  80   0.0348     99.040  0.0025    99.922  1005.18
  81   0.0333     99.140  0.0020    99.948  1017.70
  82   0.0327     99.100  0.0023    99.938  1030.26
  83   0.0354     99.050  0.0019    99.955  1042.78
  84   0.0371     99.060  0.0018    99.955  1055.30
  85   0.0353     99.050  0.0021    99.943  1067.83
  86   0.0401     98.950  0.0019    99.950  1080.51
  87   0.0344     99.070  0.0016    99.957  1093.08
  88   0.0383     99.010  0.0016    99.965  1105.63
  89   0.0411     98.870  0.0016    99.963  1118.27
  90   0.0335     99.080  0.0017    99.958  1130.79
