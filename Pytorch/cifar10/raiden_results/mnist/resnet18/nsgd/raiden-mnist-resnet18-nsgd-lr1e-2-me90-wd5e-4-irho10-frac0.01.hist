Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1955     93.670  1.0213    73.357  14.60
   2   0.0938     96.830  0.1109    96.583  27.09
   3   0.0681     97.840  0.0755    97.647  39.54
   4   0.0658     97.830  0.0598    98.125  51.96
   5   0.0449     98.490  0.0525    98.363  64.47
   6   0.0724     97.460  0.0496    98.430  76.92
   7   0.0518     98.300  0.0438    98.605  89.38
   8   0.0351     98.840  0.0424    98.627  101.82
   9   0.0391     98.800  0.0403    98.742  114.22
  10   0.0371     98.830  0.0353    98.890  126.66
  11   0.0379     98.810  0.0360    98.862  139.13
  12   0.0309     99.020  0.0330    98.920  151.63
  13   0.0323     98.930  0.0334    98.933  164.08
  14   0.0265     99.220  0.0313    98.967  176.52
  15   0.0333     98.870  0.0288    99.068  189.09
  16   0.0309     98.930  0.0291    99.038  201.50
  17   0.0387     98.660  0.0286    99.073  213.95
  18   0.0394     98.810  0.0272    99.120  226.56
  19   0.0353     98.760  0.0263    99.132  239.00
  20   0.0331     98.880  0.0249    99.185  251.42
  21   0.0306     99.080  0.0231    99.232  263.85
  22   0.0334     98.900  0.0241    99.210  276.38
  23   0.0489     98.380  0.0230    99.227  288.78
  24   0.0278     99.200  0.0227    99.252  301.20
  25   0.0248     99.110  0.0227    99.243  313.73
  26   0.0441     98.420  0.0197    99.372  326.16
  27   0.0257     99.130  0.0214    99.308  338.60
  28   0.0270     99.060  0.0219    99.260  351.03
  29   0.0268     99.090  0.0211    99.253  363.46
  30   0.0323     98.890  0.0193    99.327  375.90
  31   0.0289     99.050  0.0188    99.387  388.32
  32   0.0368     98.870  0.0188    99.352  400.73
  33   0.0312     99.010  0.0178    99.405  413.15
  34   0.0254     99.080  0.0167    99.438  425.69
  35   0.0356     98.900  0.0165    99.457  438.13
  36   0.0236     99.260  0.0172    99.442  450.54
  37   0.0331     99.030  0.0153    99.507  462.94
  38   0.0259     99.140  0.0154    99.478  475.59
  39   0.0265     99.250  0.0143    99.533  488.03
  40   0.0273     99.160  0.0151    99.513  500.57
  41   0.0270     99.230  0.0134    99.555  512.97
  42   0.0219     99.310  0.0139    99.538  525.41
  43   0.0304     99.100  0.0127    99.573  537.83
  44   0.0274     99.040  0.0132    99.562  550.26
  45   0.0436     98.650  0.0130    99.583  562.69
  46   0.0199     99.340  0.0121    99.565  575.12
  47   0.0279     99.120  0.0105    99.675  587.67
  48   0.0340     98.950  0.0111    99.618  600.12
  49   0.0232     99.260  0.0109    99.642  612.55
  50   0.0225     99.230  0.0097    99.672  625.06
  51   0.0268     99.160  0.0100    99.668  637.50
  52   0.0292     99.060  0.0100    99.675  649.93
  53   0.0254     99.290  0.0098    99.670  662.36
  54   0.0292     98.980  0.0089    99.727  674.77
  55   0.0328     98.910  0.0077    99.762  687.23
  56   0.0263     99.190  0.0089    99.712  699.66
  57   0.0269     99.170  0.0084    99.720  712.24
  58   0.0254     99.250  0.0075    99.760  724.68
  59   0.0302     99.190  0.0068    99.787  737.12
  60   0.0299     99.190  0.0070    99.762  749.53
  61   0.0305     99.040  0.0065    99.798  761.93
  62   0.0366     98.930  0.0061    99.775  774.35
  63   0.0258     99.200  0.0070    99.783  786.90
  64   0.0273     99.140  0.0056    99.832  799.35
  65   0.0294     99.170  0.0052    99.835  811.79
  66   0.0308     99.090  0.0048    99.867  824.31
  67   0.0243     99.300  0.0048    99.853  836.71
  68   0.0260     99.220  0.0050    99.843  849.15
  69   0.0296     99.110  0.0047    99.840  861.69
  70   0.0291     99.150  0.0043    99.867  874.16
  71   0.0296     99.000  0.0037    99.897  886.60
  72   0.0271     99.200  0.0039    99.878  899.09
  73   0.0299     99.100  0.0041    99.875  911.66
  74   0.0332     99.090  0.0038    99.883  924.08
  75   0.0240     99.340  0.0030    99.900  936.50
  76   0.0289     99.150  0.0038    99.875  949.09
  77   0.0323     99.060  0.0032    99.908  961.53
  78   0.0282     99.160  0.0027    99.932  973.95
  79   0.0291     99.230  0.0029    99.917  986.37
  80   0.0294     99.190  0.0027    99.930  998.96
  81   0.0354     98.970  0.0026    99.932  1011.37
  82   0.0345     98.980  0.0029    99.917  1023.79
  83   0.0313     99.150  0.0024    99.935  1036.19
  84   0.0320     99.150  0.0022    99.947  1048.63
  85   0.0319     99.120  0.0022    99.948  1061.09
  86   0.0325     99.120  0.0023    99.940  1073.64
  87   0.0333     99.040  0.0022    99.945  1086.09
  88   0.0310     99.140  0.0021    99.947  1098.52
  89   0.0262     99.210  0.0022    99.930  1111.01
  90   0.0320     99.070  0.0022    99.947  1123.44
