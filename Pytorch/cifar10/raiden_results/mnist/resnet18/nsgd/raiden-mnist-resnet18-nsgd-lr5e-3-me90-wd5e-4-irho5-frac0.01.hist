Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1101     96.470  0.4577    84.383  14.70
   2   0.0876     97.000  0.0898    97.135  27.23
   3   0.0733     97.570  0.0678    97.860  39.69
   4   0.0650     97.940  0.0584    98.173  52.19
   5   0.0826     97.410  0.0492    98.448  64.83
   6   0.0649     98.210  0.0455    98.557  77.28
   7   0.0410     98.660  0.0416    98.652  89.73
   8   0.0392     98.710  0.0385    98.810  102.20
   9   0.0476     98.240  0.0362    98.857  114.66
  10   0.0445     98.510  0.0343    98.920  127.12
  11   0.0365     98.770  0.0331    98.955  139.56
  12   0.0658     97.920  0.0310    98.995  152.02
  13   0.0291     98.990  0.0315    98.970  164.48
  14   0.0418     98.670  0.0290    99.062  176.94
  15   0.0370     98.710  0.0272    99.080  189.39
  16   0.0281     99.060  0.0262    99.138  201.85
  17   0.0308     98.910  0.0259    99.152  214.30
  18   0.0324     98.970  0.0225    99.278  226.92
  19   0.0335     98.970  0.0240    99.203  239.43
  20   0.0354     98.840  0.0226    99.238  251.87
  21   0.0258     99.090  0.0226    99.275  264.31
  22   0.0557     98.130  0.0221    99.263  276.76
  23   0.0339     98.930  0.0208    99.310  289.22
  24   0.0344     98.900  0.0197    99.383  301.81
  25   0.0532     98.390  0.0193    99.365  314.25
  26   0.0372     98.740  0.0197    99.297  326.70
  27   0.0392     98.650  0.0191    99.382  339.18
  28   0.0468     98.470  0.0175    99.435  351.64
  29   0.0281     99.120  0.0171    99.435  364.09
  30   0.0257     99.150  0.0166    99.452  376.57
  31   0.0296     99.060  0.0161    99.463  389.03
  32   0.0350     98.870  0.0171    99.442  401.47
  33   0.0342     98.970  0.0145    99.533  413.96
  34   0.0317     98.990  0.0156    99.452  426.41
  35   0.0367     98.800  0.0152    99.512  438.88
  36   0.0338     98.780  0.0143    99.515  451.32
  37   0.0303     99.050  0.0135    99.543  463.90
  38   0.0371     98.800  0.0128    99.582  476.38
  39   0.0314     98.990  0.0123    99.615  488.82
  40   0.0274     99.130  0.0124    99.590  501.41
  41   0.0314     99.100  0.0122    99.598  513.89
  42   0.0319     99.090  0.0108    99.633  526.35
  43   0.0327     99.040  0.0115    99.613  538.80
  44   0.0360     98.950  0.0108    99.618  551.25
  45   0.0280     99.140  0.0109    99.608  563.71
  46   0.0328     98.980  0.0106    99.655  576.15
  47   0.0336     98.860  0.0102    99.655  588.61
  48   0.0348     98.870  0.0100    99.667  601.06
  49   0.0296     99.060  0.0088    99.712  613.49
  50   0.0266     99.150  0.0088    99.713  626.09
  51   0.0315     99.100  0.0082    99.715  638.52
  52   0.0278     99.160  0.0077    99.768  650.96
  53   0.0308     99.090  0.0076    99.740  663.41
  54   0.0384     98.920  0.0078    99.730  675.97
  55   0.0305     99.040  0.0071    99.775  688.43
  56   0.0373     98.840  0.0067    99.797  701.02
  57   0.0286     99.140  0.0066    99.810  713.48
  58   0.0268     99.180  0.0065    99.800  725.94
  59   0.0309     98.970  0.0060    99.812  738.37
  60   0.0268     99.120  0.0059    99.822  750.92
  61   0.0336     98.940  0.0061    99.818  763.36
  62   0.0333     98.940  0.0050    99.852  775.79
  63   0.0371     98.960  0.0055    99.812  788.35
  64   0.0312     99.080  0.0049    99.838  800.79
  65   0.0276     99.250  0.0055    99.837  813.19
  66   0.0320     99.070  0.0047    99.850  825.61
  67   0.0298     99.160  0.0044    99.865  838.14
  68   0.0323     99.120  0.0044    99.862  850.58
  69   0.0320     99.050  0.0047    99.847  863.01
  70   0.0336     99.000  0.0047    99.870  875.48
  71   0.0343     98.990  0.0037    99.887  887.91
  72   0.0359     99.000  0.0037    99.882  900.35
  73   0.0347     98.950  0.0031    99.922  912.80
  74   0.0340     98.990  0.0034    99.898  925.36
  75   0.0301     99.150  0.0036    99.897  937.80
  76   0.0304     99.120  0.0034    99.900  950.26
  77   0.0340     99.150  0.0035    99.878  962.71
  78   0.0392     99.030  0.0031    99.917  975.14
  79   0.0369     98.920  0.0028    99.922  987.56
  80   0.0320     99.140  0.0030    99.917  1000.03
  81   0.0349     98.990  0.0028    99.922  1012.50
  82   0.0324     99.070  0.0027    99.917  1024.95
  83   0.0362     98.990  0.0027    99.928  1037.37
  84   0.0388     98.900  0.0028    99.910  1049.89
  85   0.0370     98.940  0.0028    99.905  1062.38
  86   0.0313     99.150  0.0029    99.920  1074.88
  87   0.0320     99.130  0.0023    99.940  1087.52
  88   0.0315     99.090  0.0023    99.945  1099.99
  89   0.0319     99.150  0.0026    99.922  1112.45
  90   0.0395     98.980  0.0023    99.947  1124.89
