Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1234     95.770  0.4629    83.940  14.66
   2   0.0847     97.100  0.0890    97.153  27.03
   3   0.1397     95.580  0.0690    97.785  39.42
   4   0.1177     96.460  0.0559    98.183  51.81
   5   0.0477     98.370  0.0502    98.390  64.19
   6   0.0699     97.580  0.0430    98.668  76.58
   7   0.0421     98.550  0.0410    98.695  88.90
   8   0.0348     98.810  0.0389    98.738  101.36
   9   0.0482     98.580  0.0354    98.872  113.71
  10   0.0408     98.650  0.0327    98.960  126.06
  11   0.0550     98.170  0.0329    98.943  138.37
  12   0.0365     98.750  0.0319    98.972  150.87
  13   0.0408     98.670  0.0302    99.037  163.24
  14   0.0300     99.020  0.0285    99.098  175.59
  15   0.0327     98.980  0.0292    99.040  188.05
  16   0.0384     98.780  0.0261    99.150  200.45
  17   0.0321     98.950  0.0262    99.117  212.81
  18   0.0403     98.740  0.0257    99.162  225.28
  19   0.0291     98.980  0.0239    99.233  237.64
  20   0.0348     98.820  0.0220    99.282  250.01
  21   0.0395     98.780  0.0227    99.245  262.34
  22   0.0333     98.840  0.0225    99.235  274.69
  23   0.0401     98.700  0.0203    99.330  287.04
  24   0.0309     98.980  0.0202    99.323  299.38
  25   0.0247     99.200  0.0204    99.323  311.81
  26   0.0264     99.160  0.0193    99.367  324.15
  27   0.0287     99.040  0.0200    99.363  336.51
  28   0.0341     98.850  0.0173    99.407  348.88
  29   0.0364     98.840  0.0175    99.422  361.37
  30   0.0275     98.960  0.0170    99.438  373.72
  31   0.0248     99.180  0.0165    99.430  386.09
  32   0.0271     99.140  0.0160    99.477  398.45
  33   0.0288     99.090  0.0166    99.417  410.79
  34   0.0369     98.990  0.0155    99.473  423.13
  35   0.0334     98.890  0.0147    99.518  435.47
  36   0.0320     99.050  0.0149    99.502  447.84
  37   0.0283     99.140  0.0139    99.507  460.20
  38   0.0273     99.130  0.0136    99.543  472.65
  39   0.0317     99.050  0.0130    99.567  484.97
  40   0.0254     99.210  0.0123    99.582  497.29
  41   0.0249     99.310  0.0131    99.578  509.66
  42   0.0202     99.320  0.0118    99.625  522.02
  43   0.0274     99.010  0.0110    99.648  534.37
  44   0.0349     98.840  0.0108    99.633  546.72
  45   0.0292     99.020  0.0099    99.685  559.06
  46   0.0300     99.120  0.0095    99.670  571.38
  47   0.0273     99.070  0.0100    99.667  583.74
  48   0.0241     99.200  0.0091    99.708  596.09
  49   0.0283     99.070  0.0093    99.698  608.45
  50   0.0334     98.880  0.0094    99.680  620.83
  51   0.0343     98.860  0.0088    99.717  633.28
  52   0.0267     99.120  0.0091    99.708  645.64
  53   0.0253     99.170  0.0079    99.758  657.94
  54   0.0241     99.210  0.0077    99.747  670.30
  55   0.0256     99.130  0.0077    99.755  682.62
  56   0.0213     99.350  0.0064    99.800  694.96
  57   0.0248     99.220  0.0074    99.747  707.45
  58   0.0243     99.220  0.0069    99.782  719.81
  59   0.0331     98.970  0.0069    99.767  732.20
  60   0.0235     99.240  0.0064    99.790  744.57
  61   0.0265     99.110  0.0060    99.815  756.93
  62   0.0227     99.340  0.0057    99.818  769.29
  63   0.0283     99.160  0.0052    99.843  781.65
  64   0.0216     99.320  0.0055    99.818  794.12
  65   0.0207     99.370  0.0054    99.848  806.46
  66   0.0242     99.250  0.0047    99.862  818.83
  67   0.0269     99.140  0.0050    99.825  831.21
  68   0.0237     99.260  0.0050    99.837  843.60
  69   0.0273     99.140  0.0050    99.845  855.95
  70   0.0263     99.280  0.0045    99.855  868.29
  71   0.0296     99.110  0.0041    99.873  880.64
  72   0.0317     99.040  0.0042    99.880  892.99
  73   0.0280     99.120  0.0038    99.887  905.34
  74   0.0270     99.260  0.0040    99.887  917.79
  75   0.0360     99.010  0.0040    99.880  930.13
  76   0.0237     99.250  0.0039    99.895  942.48
  77   0.0285     99.040  0.0037    99.888  954.94
  78   0.0292     99.180  0.0034    99.905  967.27
  79   0.0244     99.260  0.0034    99.902  979.60
  80   0.0240     99.260  0.0032    99.898  991.94
  81   0.0255     99.190  0.0030    99.920  1004.42
  82   0.0280     99.130  0.0032    99.902  1016.75
  83   0.0274     99.200  0.0032    99.908  1029.09
  84   0.0316     99.040  0.0033    99.902  1041.41
  85   0.0289     99.220  0.0029    99.930  1053.73
  86   0.0292     99.120  0.0029    99.913  1066.07
  87   0.0300     99.170  0.0031    99.913  1078.44
  88   0.0324     99.100  0.0029    99.910  1090.76
  89   0.0318     99.110  0.0026    99.932  1103.09
  90   0.0309     99.050  0.0026    99.935  1115.54
