Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7850115072 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1985     93.160  0.6696    77.205  19.63
   2   0.0913     97.160  0.1283    95.978  32.67
   3   0.1409     95.520  0.0865    97.305  45.61
   4   0.0892     97.180  0.0687    97.888  58.55
   5   0.1062     96.590  0.0598    98.105  71.48
   6   0.0676     97.850  0.0511    98.390  84.63
   7   0.0581     98.030  0.0491    98.355  97.57
   8   0.0496     98.350  0.0442    98.560  110.50
   9   0.0499     98.370  0.0414    98.683  123.45
  10   0.0500     98.390  0.0406    98.693  136.40
  11   0.0333     98.930  0.0369    98.823  149.34
  12   0.0416     98.550  0.0346    98.880  162.39
  13   0.0630     97.990  0.0351    98.830  175.33
  14   0.0395     98.760  0.0318    99.015  188.26
  15   0.0463     98.520  0.0314    99.020  201.19
  16   0.0426     98.590  0.0298    99.028  214.14
  17   0.0333     98.880  0.0286    99.073  227.09
  18   0.0323     98.750  0.0282    99.070  240.03
  19   0.0318     98.830  0.0270    99.093  253.12
  20   0.0400     98.690  0.0261    99.145  266.07
  21   0.0367     98.750  0.0256    99.143  279.04
  22   0.0438     98.570  0.0248    99.180  292.09
  23   0.0323     99.020  0.0241    99.230  305.05
  24   0.0376     98.840  0.0233    99.257  318.03
  25   0.0377     98.720  0.0230    99.240  331.06
  26   0.0383     98.670  0.0216    99.308  344.02
  27   0.0430     98.520  0.0218    99.280  356.96
  28   0.0341     98.930  0.0214    99.275  369.90
  29   0.0330     98.920  0.0211    99.300  382.94
  30   0.0319     98.950  0.0202    99.340  395.90
  31   0.0334     98.860  0.0186    99.392  408.85
  32   0.0386     98.830  0.0202    99.322  421.79
  33   0.0311     99.010  0.0186    99.388  434.74
  34   0.0335     98.890  0.0176    99.435  447.70
  35   0.0405     98.730  0.0190    99.382  460.65
  36   0.0403     98.690  0.0172    99.408  473.60
  37   0.0275     99.120  0.0176    99.423  486.64
  38   0.0327     98.950  0.0159    99.472  499.59
  39   0.0353     98.840  0.0165    99.428  512.57
  40   0.0402     98.930  0.0159    99.443  525.52
  41   0.0391     98.820  0.0170    99.433  538.47
  42   0.0323     98.940  0.0154    99.483  551.43
  43   0.0421     98.720  0.0142    99.512  564.38
  44   0.0388     98.810  0.0149    99.477  577.33
  45   0.0413     98.650  0.0147    99.480  590.27
  46   0.0341     98.850  0.0163    99.432  603.22
  47   0.0393     98.690  0.0149    99.507  616.28
  48   0.0306     99.070  0.0150    99.487  629.22
  49   0.0374     98.850  0.0131    99.547  642.18
  50   0.0315     98.940  0.0131    99.567  655.21
  51   0.0295     99.160  0.0120    99.613  668.14
  52   0.0288     99.120  0.0122    99.588  681.12
  53   0.0317     99.000  0.0133    99.532  694.17
  54   0.0549     98.230  0.0123    99.585  707.14
  55   0.0321     98.880  0.0132    99.563  720.09
  56   0.0291     99.090  0.0119    99.603  733.09
  57   0.0440     98.620  0.0126    99.553  746.04
  58   0.0293     99.100  0.0121    99.590  758.96
  59   0.0339     98.990  0.0113    99.603  772.01
  60   0.0404     98.690  0.0106    99.643  784.97
  61   0.0269     99.080  0.0110    99.635  797.92
  62   0.0339     98.880  0.0107    99.638  810.93
  63   0.0411     98.630  0.0120    99.583  823.88
  64   0.0395     98.880  0.0110    99.607  836.84
  65   0.0356     98.860  0.0099    99.660  849.88
  66   0.0314     99.050  0.0096    99.667  862.82
  67   0.0500     98.550  0.0098    99.685  875.72
  68   0.0372     98.890  0.0101    99.663  888.67
  69   0.0345     98.970  0.0094    99.703  901.61
  70   0.0370     98.890  0.0102    99.662  914.55
  71   0.0365     98.950  0.0097    99.670  927.48
  72   0.0337     99.080  0.0099    99.675  940.51
  73   0.0324     99.150  0.0092    99.682  953.45
  74   0.0323     99.100  0.0082    99.727  966.38
  75   0.0383     98.760  0.0090    99.675  979.31
  76   0.0427     98.720  0.0092    99.695  992.27
  77   0.0321     98.950  0.0077    99.773  1005.24
  78   0.0330     98.990  0.0083    99.738  1018.19
  79   0.0324     99.000  0.0078    99.743  1031.13
  80   0.0265     99.150  0.0085    99.713  1044.09
  81   0.0328     99.050  0.0080    99.732  1057.04
  82   0.0268     99.230  0.0070    99.773  1069.99
  83   0.0415     98.840  0.0080    99.723  1082.93
  84   0.0342     98.880  0.0083    99.723  1095.95
  85   0.0292     99.050  0.0074    99.752  1108.95
