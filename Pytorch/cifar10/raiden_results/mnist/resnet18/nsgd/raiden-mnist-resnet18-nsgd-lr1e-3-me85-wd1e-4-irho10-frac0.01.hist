Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1606     94.760  0.6632    77.572  14.76
   2   0.1429     95.200  0.1262    96.067  27.17
   3   0.0915     97.060  0.0856    97.287  39.53
   4   0.0611     97.930  0.0698    97.852  52.01
   5   0.0634     97.870  0.0600    98.082  64.38
   6   0.0513     98.340  0.0540    98.255  76.80
   7   0.0546     98.240  0.0475    98.513  89.30
   8   0.0550     98.220  0.0437    98.633  101.66
   9   0.0513     98.380  0.0414    98.685  114.02
  10   0.0377     98.750  0.0377    98.770  126.38
  11   0.0523     98.300  0.0374    98.757  138.88
  12   0.0640     97.850  0.0363    98.890  151.22
  13   0.0387     98.780  0.0334    98.907  163.56
  14   0.0358     98.840  0.0325    98.967  176.00
  15   0.0436     98.620  0.0304    99.032  188.33
  16   0.0340     98.820  0.0308    99.032  200.67
  17   0.0413     98.580  0.0287    99.072  213.16
  18   0.0445     98.630  0.0279    99.067  225.50
  19   0.0382     98.690  0.0273    99.103  237.83
  20   0.0364     98.750  0.0252    99.175  250.29
  21   0.0327     98.810  0.0262    99.128  262.63
  22   0.0457     98.430  0.0263    99.150  274.98
  23   0.0317     98.980  0.0234    99.247  287.31
  24   0.0380     98.670  0.0230    99.218  299.66
  25   0.0461     98.500  0.0219    99.293  312.01
  26   0.0402     98.710  0.0227    99.257  324.32
  27   0.0303     98.950  0.0212    99.305  336.80
  28   0.0308     98.930  0.0216    99.278  349.13
  29   0.0385     98.610  0.0205    99.353  361.51
  30   0.0337     98.910  0.0188    99.370  373.90
  31   0.0352     98.850  0.0189    99.388  386.32
  32   0.0393     98.690  0.0192    99.327  398.64
  33   0.0287     99.140  0.0184    99.420  410.98
  34   0.0321     98.840  0.0181    99.410  423.46
  35   0.0324     98.870  0.0194    99.327  435.78
  36   0.0362     98.760  0.0176    99.412  448.13
  37   0.0321     98.920  0.0170    99.437  460.47
  38   0.0467     98.520  0.0173    99.417  473.01
  39   0.0314     99.030  0.0159    99.463  485.37
  40   0.0319     98.980  0.0164    99.430  497.71
  41   0.0299     99.080  0.0156    99.465  510.05
  42   0.0285     99.070  0.0161    99.465  522.39
  43   0.0376     98.830  0.0154    99.465  534.72
  44   0.0363     98.710  0.0146    99.528  547.12
  45   0.0284     99.030  0.0139    99.515  559.48
  46   0.0392     98.760  0.0147    99.527  571.81
  47   0.0319     99.040  0.0139    99.503  584.27
  48   0.0336     98.850  0.0142    99.500  596.63
  49   0.0334     98.950  0.0133    99.542  608.96
  50   0.0395     98.750  0.0134    99.548  621.42
  51   0.0344     98.860  0.0137    99.517  633.76
  52   0.0349     98.960  0.0126    99.597  646.12
  53   0.0353     98.890  0.0129    99.558  658.47
  54   0.0376     98.840  0.0120    99.590  670.84
  55   0.0303     99.020  0.0118    99.613  683.19
  56   0.0278     99.080  0.0111    99.652  695.53
  57   0.0388     98.850  0.0109    99.647  707.85
  58   0.0345     99.040  0.0107    99.610  720.18
  59   0.0387     98.740  0.0116    99.608  732.51
  60   0.0311     99.090  0.0108    99.652  744.94
  61   0.0338     98.990  0.0106    99.637  757.28
  62   0.0367     98.830  0.0100    99.655  769.64
  63   0.0333     99.030  0.0099    99.658  782.13
  64   0.0411     98.780  0.0104    99.648  794.49
  65   0.0523     98.310  0.0108    99.648  806.85
  66   0.0313     99.090  0.0103    99.645  819.20
  67   0.0307     99.060  0.0095    99.692  831.69
  68   0.0355     99.040  0.0100    99.638  844.05
  69   0.0324     99.060  0.0089    99.715  856.40
  70   0.0324     99.030  0.0089    99.698  868.89
  71   0.0406     98.800  0.0106    99.655  881.24
  72   0.0646     98.250  0.0097    99.653  893.58
  73   0.0297     99.060  0.0093    99.707  906.06
  74   0.0336     98.920  0.0089    99.672  918.40
  75   0.0450     98.750  0.0086    99.715  930.75
  76   0.0360     99.040  0.0087    99.708  943.18
  77   0.0398     98.820  0.0079    99.702  955.49
  78   0.0348     98.980  0.0080    99.720  967.82
  79   0.0356     99.060  0.0082    99.733  980.27
  80   0.0362     98.990  0.0074    99.747  992.63
  81   0.0335     98.910  0.0085    99.717  1004.94
  82   0.0481     98.760  0.0072    99.790  1017.28
  83   0.0371     98.870  0.0072    99.768  1029.61
  84   0.0361     98.910  0.0065    99.777  1041.96
  85   0.0357     99.040  0.0071    99.758  1054.34
