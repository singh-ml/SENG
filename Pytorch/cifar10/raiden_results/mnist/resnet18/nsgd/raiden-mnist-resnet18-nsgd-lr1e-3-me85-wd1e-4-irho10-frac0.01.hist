Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1916     93.770  0.6496    77.763  14.58
   2   0.1230     95.970  0.1304    95.917  26.92
   3   0.1008     96.810  0.0863    97.302  39.24
   4   0.0626     97.830  0.0700    97.752  51.69
   5   0.0551     98.160  0.0586    98.167  64.08
   6   0.0578     98.150  0.0519    98.410  76.55
   7   0.0606     98.120  0.0479    98.470  88.86
   8   0.0483     98.500  0.0447    98.557  101.20
   9   0.0737     97.330  0.0415    98.620  113.53
  10   0.0455     98.640  0.0380    98.797  125.86
  11   0.0406     98.660  0.0371    98.813  138.20
  12   0.0362     98.820  0.0358    98.878  150.51
  13   0.0346     98.880  0.0335    98.940  162.95
  14   0.0458     98.550  0.0312    99.013  175.28
  15   0.0405     98.590  0.0324    98.953  187.65
  16   0.0360     98.760  0.0294    99.050  200.10
  17   0.0256     99.210  0.0298    99.052  212.43
  18   0.0472     98.510  0.0277    99.138  224.78
  19   0.0455     98.600  0.0263    99.122  237.25
  20   0.0333     98.940  0.0259    99.128  249.61
  21   0.0374     98.760  0.0250    99.167  261.93
  22   0.0384     98.700  0.0253    99.218  274.28
  23   0.0301     99.010  0.0230    99.270  286.84
  24   0.0504     98.490  0.0234    99.202  299.18
  25   0.0308     98.960  0.0230    99.275  311.53
  26   0.0345     99.100  0.0221    99.282  323.97
  27   0.0354     98.770  0.0218    99.247  336.34
  28   0.0279     99.120  0.0216    99.290  348.68
  29   0.0368     98.790  0.0211    99.280  361.15
  30   0.0314     99.080  0.0201    99.348  373.49
  31   0.0356     98.750  0.0194    99.357  385.83
  32   0.0388     98.560  0.0184    99.390  398.27
  33   0.0331     98.800  0.0196    99.303  410.62
  34   0.0340     98.880  0.0178    99.380  422.94
  35   0.0414     98.640  0.0177    99.425  435.31
  36   0.0270     99.060  0.0175    99.407  447.65
  37   0.0262     99.010  0.0177    99.450  460.00
  38   0.0371     98.680  0.0163    99.437  472.36
  39   0.0339     98.890  0.0155    99.485  484.76
  40   0.0318     99.060  0.0159    99.460  497.11
  41   0.0443     98.760  0.0145    99.528  509.44
  42   0.0331     98.950  0.0156    99.427  521.88
  43   0.0381     98.920  0.0150    99.497  534.24
  44   0.0273     99.110  0.0149    99.507  546.58
  45   0.0307     98.980  0.0151    99.517  559.04
  46   0.0398     98.840  0.0151    99.495  571.40
  47   0.0336     98.920  0.0142    99.492  583.72
  48   0.0318     98.880  0.0140    99.525  596.20
  49   0.0309     99.050  0.0130    99.567  608.54
  50   0.0413     98.720  0.0141    99.520  620.89
  51   0.0338     98.860  0.0126    99.567  633.24
  52   0.0361     98.920  0.0125    99.570  645.61
  53   0.0350     98.910  0.0115    99.617  657.95
  54   0.0367     98.830  0.0125    99.578  670.26
  55   0.0407     98.860  0.0117    99.618  682.69
  56   0.0301     99.110  0.0112    99.603  695.04
  57   0.0269     99.170  0.0116    99.603  707.35
  58   0.0312     99.120  0.0114    99.600  719.81
  59   0.0252     99.150  0.0118    99.583  732.16
  60   0.0341     98.980  0.0099    99.650  744.47
  61   0.0309     99.100  0.0113    99.615  756.92
  62   0.0261     99.160  0.0103    99.642  769.24
  63   0.0332     99.000  0.0102    99.657  781.58
  64   0.0322     99.040  0.0105    99.653  793.99
  65   0.0301     99.020  0.0104    99.653  806.33
  66   0.0388     98.920  0.0099    99.650  818.66
  67   0.0449     98.590  0.0100    99.675  830.96
  68   0.0361     98.840  0.0105    99.637  843.30
  69   0.0421     98.680  0.0093    99.715  855.64
  70   0.0306     99.080  0.0097    99.668  867.99
  71   0.0380     98.890  0.0088    99.727  880.40
  72   0.0340     98.930  0.0082    99.727  892.75
  73   0.0368     98.850  0.0088    99.703  905.08
  74   0.0284     99.130  0.0085    99.695  917.56
  75   0.0380     98.890  0.0082    99.727  929.89
  76   0.0349     99.050  0.0085    99.715  942.23
  77   0.0366     98.900  0.0092    99.662  954.59
  78   0.0314     99.100  0.0079    99.747  967.07
  79   0.0251     99.210  0.0075    99.740  979.41
  80   0.0380     98.920  0.0072    99.765  991.74
  81   0.0330     99.100  0.0070    99.777  1004.20
  82   0.0362     98.970  0.0073    99.735  1016.54
  83   0.0348     98.970  0.0080    99.728  1028.89
  84   0.0340     99.060  0.0075    99.742  1041.36
  85   0.0338     99.010  0.0074    99.742  1053.71
