Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1374     95.440  0.4523    84.958  14.53
   2   0.0802     97.330  0.0925    97.098  26.98
   3   0.0666     97.920  0.0649    97.918  39.36
   4   0.1002     96.820  0.0567    98.225  51.74
   5   0.0449     98.520  0.0501    98.375  64.21
   6   0.0393     98.690  0.0434    98.610  76.58
   7   0.0447     98.500  0.0447    98.643  88.98
   8   0.0529     98.150  0.0397    98.698  101.50
   9   0.0392     98.700  0.0372    98.773  113.90
  10   0.0587     97.980  0.0355    98.855  126.29
  11   0.0321     98.950  0.0322    98.953  138.69
  12   0.0325     98.970  0.0316    98.977  151.03
  13   0.0371     98.690  0.0310    98.955  163.39
  14   0.0325     98.830  0.0287    99.080  175.73
  15   0.0392     98.730  0.0276    99.118  188.25
  16   0.0366     98.820  0.0276    99.113  200.58
  17   0.0326     99.010  0.0269    99.133  212.94
  18   0.0323     98.890  0.0245    99.150  225.41
  19   0.0386     98.540  0.0245    99.197  237.77
  20   0.0390     98.600  0.0244    99.177  250.11
  21   0.0386     98.800  0.0221    99.270  262.60
  22   0.0344     98.850  0.0201    99.308  274.98
  23   0.0303     99.080  0.0218    99.322  287.33
  24   0.0285     99.050  0.0208    99.320  299.80
  25   0.0276     99.070  0.0187    99.360  312.12
  26   0.0435     98.680  0.0179    99.432  324.51
  27   0.0281     99.030  0.0188    99.387  336.85
  28   0.0245     99.200  0.0185    99.385  349.22
  29   0.0353     98.950  0.0173    99.470  361.57
  30   0.0259     99.160  0.0176    99.430  373.95
  31   0.0221     99.200  0.0163    99.488  386.41
  32   0.0354     98.960  0.0153    99.482  398.74
  33   0.0344     98.930  0.0158    99.440  411.08
  34   0.0255     99.130  0.0153    99.467  423.56
  35   0.0267     99.110  0.0138    99.563  435.93
  36   0.0341     98.950  0.0141    99.528  448.28
  37   0.0308     99.000  0.0142    99.498  460.74
  38   0.0196     99.270  0.0133    99.545  473.11
  39   0.0305     98.980  0.0133    99.568  485.50
  40   0.0299     98.920  0.0128    99.545  497.87
  41   0.0296     99.010  0.0121    99.605  510.24
  42   0.0317     98.990  0.0120    99.595  522.61
  43   0.0342     98.910  0.0113    99.587  534.97
  44   0.0335     98.890  0.0107    99.657  547.43
  45   0.0296     99.070  0.0098    99.687  559.80
  46   0.0283     99.010  0.0100    99.647  572.14
  47   0.0290     99.080  0.0099    99.635  584.64
  48   0.0350     98.890  0.0106    99.622  597.00
  49   0.0416     98.780  0.0087    99.712  609.34
  50   0.0258     99.130  0.0089    99.705  621.76
  51   0.0274     99.150  0.0090    99.690  634.13
  52   0.0258     99.210  0.0083    99.737  646.51
  53   0.0278     99.120  0.0068    99.782  658.88
  54   0.0279     99.100  0.0069    99.783  671.41
  55   0.0382     98.770  0.0066    99.792  683.75
  56   0.0274     99.070  0.0064    99.797  696.11
  57   0.0339     99.010  0.0066    99.787  708.63
  58   0.0331     99.070  0.0073    99.768  721.03
  59   0.0283     99.110  0.0059    99.802  733.41
  60   0.0283     99.150  0.0053    99.827  745.88
  61   0.0343     98.930  0.0056    99.823  758.23
  62   0.0301     99.080  0.0057    99.840  770.62
  63   0.0300     99.110  0.0050    99.830  782.98
  64   0.0299     99.060  0.0049    99.847  795.46
  65   0.0336     99.080  0.0044    99.840  807.82
  66   0.0286     99.070  0.0053    99.818  820.16
  67   0.0307     99.170  0.0045    99.863  832.63
  68   0.0321     99.000  0.0051    99.840  844.98
  69   0.0289     99.160  0.0038    99.878  857.37
  70   0.0307     99.050  0.0037    99.885  869.71
  71   0.0308     99.080  0.0038    99.887  882.22
  72   0.0289     99.110  0.0036    99.873  894.54
  73   0.0293     99.050  0.0034    99.887  906.88
  74   0.0298     99.090  0.0033    99.893  919.20
  75   0.0282     99.210  0.0031    99.900  931.57
  76   0.0269     99.170  0.0030    99.897  943.92
  77   0.0297     99.130  0.0031    99.915  956.25
  78   0.0376     99.020  0.0032    99.885  968.73
  79   0.0317     99.130  0.0027    99.928  981.07
  80   0.0316     99.050  0.0027    99.918  993.44
  81   0.0308     99.090  0.0026    99.930  1005.79
  82   0.0302     99.090  0.0026    99.927  1018.15
  83   0.0352     98.910  0.0022    99.940  1030.49
  84   0.0308     99.140  0.0022    99.938  1042.87
  85   0.0359     98.970  0.0024    99.925  1055.38
  86   0.0374     98.930  0.0025    99.930  1067.74
  87   0.0306     99.130  0.0021    99.943  1080.08
  88   0.0369     99.050  0.0020    99.957  1092.58
  89   0.0332     99.060  0.0021    99.947  1105.00
  90   0.0360     99.030  0.0018    99.948  1117.38
