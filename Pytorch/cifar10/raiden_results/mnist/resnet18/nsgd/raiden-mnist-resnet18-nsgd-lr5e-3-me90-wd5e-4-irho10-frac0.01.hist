Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1865     94.010  0.4039    86.058  14.67
   2   0.0629     97.890  0.0882    97.258  27.20
   3   0.0684     97.880  0.0662    97.922  39.55
   4   0.0408     98.660  0.0556    98.268  51.91
   5   0.0545     98.180  0.0470    98.518  64.31
   6   0.0367     98.760  0.0444    98.563  76.67
   7   0.0506     98.350  0.0424    98.657  89.04
   8   0.0505     98.350  0.0380    98.808  101.37
   9   0.0463     98.500  0.0378    98.790  113.80
  10   0.0331     98.880  0.0345    98.848  126.16
  11   0.0419     98.730  0.0325    98.940  138.50
  12   0.0559     98.110  0.0316    98.945  150.83
  13   0.0385     98.750  0.0310    99.020  163.18
  14   0.0345     98.710  0.0289    99.047  175.55
  15   0.0255     99.110  0.0289    99.073  187.90
  16   0.0324     98.940  0.0260    99.177  200.34
  17   0.0344     98.870  0.0254    99.210  212.76
  18   0.0410     98.750  0.0249    99.195  225.12
  19   0.0326     98.960  0.0255    99.205  237.63
  20   0.0300     98.950  0.0226    99.277  249.99
  21   0.0283     99.000  0.0217    99.267  262.33
  22   0.0396     98.800  0.0214    99.270  274.64
  23   0.0324     98.920  0.0208    99.302  286.98
  24   0.0336     98.980  0.0197    99.358  299.36
  25   0.0305     99.040  0.0195    99.342  311.72
  26   0.0341     98.910  0.0188    99.352  324.18
  27   0.0264     99.130  0.0176    99.402  336.53
  28   0.0311     98.920  0.0169    99.437  348.86
  29   0.0239     99.190  0.0173    99.435  361.28
  30   0.0305     99.040  0.0173    99.408  373.63
  31   0.0271     99.110  0.0162    99.460  385.97
  32   0.0357     98.840  0.0157    99.483  398.33
  33   0.0241     99.150  0.0155    99.458  410.68
  34   0.0332     98.950  0.0152    99.475  423.01
  35   0.0282     99.090  0.0142    99.530  435.36
  36   0.0264     99.100  0.0132    99.550  447.71
  37   0.0332     98.890  0.0134    99.533  460.09
  38   0.0276     99.160  0.0130    99.538  472.42
  39   0.0273     99.160  0.0137    99.557  484.86
  40   0.0205     99.360  0.0124    99.582  497.18
  41   0.0281     99.100  0.0115    99.618  509.54
  42   0.0283     99.120  0.0120    99.613  521.88
  43   0.0222     99.220  0.0106    99.643  534.18
  44   0.0251     99.260  0.0109    99.632  546.51
  45   0.0378     98.800  0.0101    99.653  558.83
  46   0.0291     99.110  0.0102    99.662  571.16
  47   0.0304     99.070  0.0100    99.672  583.50
  48   0.0256     99.160  0.0091    99.707  595.84
  49   0.0308     99.010  0.0086    99.695  608.20
  50   0.0265     99.130  0.0082    99.730  620.53
  51   0.0345     98.940  0.0082    99.740  632.88
  52   0.0285     99.150  0.0082    99.730  645.31
  53   0.0225     99.350  0.0084    99.718  657.65
  54   0.0273     99.190  0.0077    99.725  670.00
  55   0.0279     99.130  0.0073    99.748  682.38
  56   0.0261     99.250  0.0066    99.772  694.69
  57   0.0247     99.150  0.0072    99.765  707.04
  58   0.0266     99.170  0.0061    99.803  719.54
  59   0.0258     99.240  0.0063    99.785  731.88
  60   0.0262     99.220  0.0061    99.803  744.24
  61   0.0244     99.310  0.0055    99.820  756.59
  62   0.0301     99.110  0.0050    99.838  768.94
  63   0.0309     99.070  0.0048    99.828  781.29
  64   0.0328     99.090  0.0055    99.815  793.61
  65   0.0273     99.170  0.0047    99.835  806.02
  66   0.0238     99.350  0.0045    99.845  818.35
  67   0.0316     99.080  0.0046    99.858  830.71
  68   0.0236     99.300  0.0043    99.860  843.10
  69   0.0317     99.110  0.0040    99.868  855.44
  70   0.0301     99.100  0.0042    99.865  867.78
  71   0.0255     99.350  0.0036    99.865  880.10
  72   0.0289     99.110  0.0036    99.880  892.42
  73   0.0298     99.110  0.0034    99.902  904.76
  74   0.0324     99.060  0.0030    99.898  917.09
  75   0.0360     99.020  0.0033    99.898  929.57
  76   0.0311     99.140  0.0033    99.898  941.90
  77   0.0338     99.150  0.0029    99.915  954.25
  78   0.0289     99.250  0.0030    99.905  966.75
  79   0.0303     99.160  0.0025    99.915  979.08
  80   0.0297     99.220  0.0026    99.913  991.41
  81   0.0286     99.210  0.0026    99.918  1003.76
  82   0.0351     99.000  0.0022    99.943  1016.32
  83   0.0325     99.140  0.0023    99.930  1028.68
  84   0.0315     99.080  0.0024    99.928  1041.06
  85   0.0375     99.050  0.0022    99.932  1053.42
  86   0.0328     99.120  0.0022    99.930  1065.78
  87   0.0299     99.210  0.0019    99.935  1078.15
  88   0.0317     99.210  0.0022    99.928  1090.52
  89   0.0320     99.190  0.0021    99.943  1102.86
  90   0.0358     99.040  0.0025    99.915  1115.21
