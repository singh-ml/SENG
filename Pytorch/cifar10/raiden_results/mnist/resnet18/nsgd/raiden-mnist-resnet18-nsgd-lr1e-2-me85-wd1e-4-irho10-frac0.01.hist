Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3199     89.530  1.6233    49.008  14.54
   2   0.1993     93.630  0.1668    94.753  26.84
   3   0.0738     97.560  0.0928    97.092  39.23
   4   0.1083     96.480  0.0700    97.772  51.53
   5   0.0820     97.080  0.0601    98.082  63.83
   6   0.0459     98.320  0.0513    98.392  76.24
   7   0.0483     98.290  0.0492    98.460  88.55
   8   0.0378     98.740  0.0413    98.707  100.83
   9   0.0445     98.430  0.0413    98.697  113.11
  10   0.0389     98.720  0.0387    98.812  125.52
  11   0.0362     98.760  0.0371    98.843  137.83
  12   0.0448     98.530  0.0349    98.885  150.14
  13   0.0630     98.060  0.0330    98.928  162.50
  14   0.0389     98.750  0.0320    98.943  174.77
  15   0.0401     98.650  0.0291    99.073  187.09
  16   0.0440     98.540  0.0301    99.062  199.48
  17   0.0370     98.720  0.0289    99.008  211.78
  18   0.0305     99.010  0.0262    99.143  224.06
  19   0.0339     98.850  0.0260    99.192  236.32
  20   0.0239     99.230  0.0249    99.197  248.74
  21   0.0277     99.150  0.0244    99.172  261.02
  22   0.0326     98.920  0.0234    99.245  273.30
  23   0.0310     99.020  0.0212    99.327  285.61
  24   0.0382     98.660  0.0208    99.302  297.90
  25   0.0317     98.990  0.0201    99.300  310.16
  26   0.0259     99.190  0.0193    99.345  322.61
  27   0.0280     99.110  0.0189    99.372  334.92
  28   0.0283     99.100  0.0180    99.363  347.23
  29   0.0280     99.110  0.0175    99.422  359.62
  30   0.0352     98.870  0.0178    99.393  371.92
  31   0.0349     98.870  0.0170    99.443  384.21
  32   0.0374     98.750  0.0155    99.472  396.47
  33   0.0337     98.910  0.0169    99.437  408.76
  34   0.0229     99.280  0.0143    99.542  421.04
  35   0.0228     99.360  0.0141    99.525  433.33
  36   0.0295     99.030  0.0144    99.495  445.68
  37   0.0253     99.160  0.0139    99.535  457.99
  38   0.0314     99.010  0.0121    99.578  470.27
  39   0.0310     99.080  0.0133    99.558  482.71
  40   0.0284     99.190  0.0132    99.552  495.00
  41   0.0315     98.950  0.0114    99.603  507.32
  42   0.0339     99.100  0.0111    99.650  519.74
  43   0.0332     99.090  0.0114    99.613  532.01
  44   0.0266     99.170  0.0104    99.658  544.29
  45   0.0299     99.150  0.0097    99.672  556.67
  46   0.0254     99.150  0.0094    99.683  568.98
  47   0.0298     99.150  0.0100    99.672  581.27
  48   0.0296     99.180  0.0098    99.682  593.55
  49   0.0288     99.170  0.0088    99.708  605.85
  50   0.0264     99.170  0.0085    99.723  618.11
  51   0.0290     99.120  0.0083    99.693  630.39
  52   0.0306     99.150  0.0075    99.745  642.68
  53   0.0266     99.220  0.0073    99.757  654.99
  54   0.0316     99.060  0.0068    99.757  667.25
  55   0.0350     99.030  0.0068    99.767  679.52
  56   0.0319     99.080  0.0065    99.797  691.81
  57   0.0295     99.210  0.0061    99.793  704.10
  58   0.0270     99.180  0.0061    99.792  716.39
  59   0.0347     98.960  0.0059    99.802  728.79
  60   0.0284     99.170  0.0054    99.838  741.12
  61   0.0329     99.090  0.0052    99.817  753.46
  62   0.0319     99.120  0.0047    99.858  765.92
  63   0.0287     99.150  0.0046    99.868  778.19
  64   0.0314     99.110  0.0048    99.855  790.49
  65   0.0260     99.260  0.0043    99.862  802.89
  66   0.0294     99.190  0.0049    99.850  815.22
  67   0.0349     99.080  0.0044    99.865  827.55
  68   0.0296     99.220  0.0045    99.872  839.85
  69   0.0278     99.240  0.0038    99.882  852.16
  70   0.0315     99.120  0.0041    99.875  864.47
  71   0.0359     99.030  0.0036    99.902  876.77
  72   0.0315     99.190  0.0036    99.888  889.14
  73   0.0331     99.130  0.0035    99.903  901.44
  74   0.0346     99.080  0.0035    99.890  913.68
  75   0.0332     99.050  0.0036    99.883  925.96
  76   0.0322     99.130  0.0033    99.893  938.32
  77   0.0336     99.160  0.0031    99.910  950.60
  78   0.0288     99.210  0.0032    99.897  962.89
  79   0.0306     99.220  0.0033    99.908  975.34
  80   0.0316     99.170  0.0031    99.895  987.65
  81   0.0327     99.160  0.0029    99.907  999.95
  82   0.0355     99.100  0.0028    99.915  1012.32
  83   0.0350     99.100  0.0028    99.927  1024.59
  84   0.0338     99.140  0.0028    99.933  1036.87
  85   0.0366     99.110  0.0026    99.930  1049.32
