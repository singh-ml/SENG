Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2793     90.790  1.2846    65.547  14.65
   2   0.1055     96.430  0.1599    95.042  27.04
   3   0.1268     95.830  0.1001    96.852  39.43
   4   0.0954     96.860  0.0826    97.482  51.76
   5   0.0668     97.720  0.0671    97.880  64.12
   6   0.0622     98.030  0.0601    98.145  76.45
   7   0.0526     98.300  0.0558    98.218  88.86
   8   0.0411     98.580  0.0500    98.437  101.18
   9   0.0513     98.360  0.0468    98.477  113.51
  10   0.0504     98.250  0.0457    98.532  126.06
  11   0.0490     98.360  0.0407    98.710  138.43
  12   0.0464     98.490  0.0382    98.757  150.80
  13   0.0515     98.230  0.0366    98.795  163.31
  14   0.0381     98.700  0.0356    98.843  175.64
  15   0.0406     98.600  0.0345    98.878  188.01
  16   0.0448     98.480  0.0317    98.943  200.48
  17   0.0538     98.160  0.0321    99.030  212.82
  18   0.0335     98.890  0.0290    99.035  225.15
  19   0.0367     98.810  0.0302    99.057  237.51
  20   0.0324     98.930  0.0276    99.108  249.87
  21   0.0308     99.080  0.0284    99.083  262.21
  22   0.0320     98.960  0.0258    99.137  274.54
  23   0.0289     98.940  0.0245    99.185  287.01
  24   0.0381     98.710  0.0255    99.170  299.36
  25   0.0370     98.740  0.0244    99.200  311.68
  26   0.0345     98.760  0.0232    99.242  324.19
  27   0.0332     98.860  0.0221    99.262  336.51
  28   0.0304     98.910  0.0224    99.287  348.85
  29   0.0415     98.760  0.0202    99.348  361.35
  30   0.0342     98.890  0.0210    99.258  373.68
  31   0.0341     98.790  0.0196    99.340  386.02
  32   0.0308     98.950  0.0188    99.410  398.39
  33   0.0285     98.990  0.0194    99.367  410.87
  34   0.0275     99.150  0.0183    99.430  423.22
  35   0.0326     98.870  0.0170    99.427  435.57
  36   0.0319     99.000  0.0169    99.447  448.09
  37   0.0279     99.110  0.0161    99.492  460.44
  38   0.0279     99.100  0.0155    99.482  472.76
  39   0.0217     99.290  0.0162    99.453  485.22
  40   0.0314     98.990  0.0156    99.453  497.52
  41   0.0318     98.910  0.0139    99.528  509.87
  42   0.0260     99.220  0.0140    99.527  522.18
  43   0.0348     98.960  0.0134    99.573  534.50
  44   0.0281     99.140  0.0126    99.592  546.85
  45   0.0365     98.820  0.0132    99.563  559.19
  46   0.0330     98.930  0.0118    99.632  571.58
  47   0.0331     98.860  0.0115    99.592  583.89
  48   0.0265     99.140  0.0110    99.648  596.24
  49   0.0277     99.070  0.0117    99.620  608.57
  50   0.0291     99.040  0.0118    99.577  620.89
  51   0.0302     99.020  0.0103    99.640  633.23
  52   0.0264     99.100  0.0107    99.658  645.55
  53   0.0279     99.040  0.0097    99.662  658.06
  54   0.0257     99.160  0.0091    99.697  670.40
  55   0.0243     99.200  0.0087    99.717  682.72
  56   0.0279     99.070  0.0087    99.713  695.04
  57   0.0264     99.190  0.0088    99.703  707.35
  58   0.0335     98.960  0.0079    99.718  719.74
  59   0.0301     99.020  0.0080    99.733  732.07
  60   0.0252     99.180  0.0075    99.742  744.44
  61   0.0340     98.930  0.0071    99.777  756.77
  62   0.0274     99.110  0.0073    99.765  769.20
  63   0.0335     98.970  0.0071    99.777  781.51
  64   0.0312     98.970  0.0066    99.802  793.82
  65   0.0276     99.110  0.0069    99.790  806.16
  66   0.0310     98.980  0.0063    99.787  818.49
  67   0.0301     99.050  0.0060    99.800  830.80
  68   0.0329     98.940  0.0066    99.785  843.27
  69   0.0292     99.080  0.0056    99.810  855.59
  70   0.0272     99.100  0.0055    99.837  867.92
  71   0.0321     99.000  0.0057    99.827  880.37
  72   0.0288     99.060  0.0055    99.842  892.70
  73   0.0318     99.010  0.0049    99.848  905.05
  74   0.0333     98.950  0.0050    99.840  917.37
  75   0.0305     99.090  0.0048    99.853  929.80
  76   0.0301     99.010  0.0050    99.827  942.13
  77   0.0310     99.010  0.0050    99.833  954.46
  78   0.0291     99.070  0.0049    99.833  966.87
  79   0.0304     98.980  0.0046    99.870  979.18
  80   0.0325     99.010  0.0046    99.853  991.51
  81   0.0296     99.040  0.0044    99.873  1003.97
  82   0.0307     99.040  0.0045    99.860  1016.33
  83   0.0270     99.150  0.0047    99.842  1028.65
  84   0.0294     99.090  0.0045    99.865  1040.97
  85   0.0300     99.010  0.0045    99.858  1053.33
