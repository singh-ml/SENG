Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2966     90.010  0.5149    82.297  14.67
   2   0.0654     97.850  0.0964    96.985  27.21
   3   0.0640     97.910  0.0711    97.808  39.77
   4   0.0657     97.970  0.0591    98.120  52.33
   5   0.0513     98.150  0.0522    98.318  65.02
   6   0.0733     97.510  0.0463    98.508  77.54
   7   0.0564     98.210  0.0443    98.567  90.06
   8   0.0631     97.780  0.0404    98.723  102.72
   9   0.0429     98.540  0.0380    98.793  115.27
  10   0.0418     98.610  0.0348    98.890  127.82
  11   0.0358     98.770  0.0338    98.922  140.46
  12   0.0405     98.720  0.0300    99.043  153.02
  13   0.0370     98.820  0.0304    99.028  165.57
  14   0.0319     98.840  0.0303    98.988  178.11
  15   0.0634     98.020  0.0277    99.088  190.89
  16   0.0297     99.010  0.0277    99.090  203.44
  17   0.0508     98.450  0.0270    99.120  215.99
  18   0.0375     98.800  0.0254    99.202  228.67
  19   0.0343     98.790  0.0253    99.158  241.24
  20   0.0410     98.600  0.0232    99.265  253.77
  21   0.0244     99.200  0.0236    99.258  266.30
  22   0.0463     98.380  0.0224    99.262  278.86
  23   0.0327     98.900  0.0221    99.270  291.44
  24   0.0265     99.100  0.0215    99.277  303.98
  25   0.0506     98.340  0.0212    99.302  316.52
  26   0.0335     98.820  0.0203    99.322  329.08
  27   0.0440     98.660  0.0199    99.365  341.71
  28   0.0288     99.000  0.0192    99.363  354.27
  29   0.0304     99.020  0.0185    99.410  366.80
  30   0.0344     98.850  0.0173    99.430  379.46
  31   0.0303     98.980  0.0160    99.468  392.02
  32   0.0400     98.690  0.0183    99.377  404.55
  33   0.0324     99.010  0.0167    99.430  417.22
  34   0.0355     98.880  0.0157    99.488  429.75
  35   0.0391     98.910  0.0160    99.463  442.30
  36   0.0333     98.880  0.0145    99.530  455.02
  37   0.0281     99.000  0.0149    99.488  467.58
  38   0.0234     99.180  0.0136    99.555  480.14
  39   0.0373     98.960  0.0142    99.565  492.65
  40   0.0328     98.960  0.0144    99.485  505.20
  41   0.0251     99.150  0.0138    99.573  517.75
  42   0.0331     98.990  0.0122    99.610  530.30
  43   0.0259     99.220  0.0124    99.615  542.93
  44   0.0295     99.070  0.0127    99.588  555.47
  45   0.0364     98.950  0.0110    99.645  567.96
  46   0.0257     99.220  0.0109    99.643  580.55
  47   0.0264     99.140  0.0110    99.648  593.12
  48   0.0261     99.100  0.0104    99.663  605.65
  49   0.0269     99.070  0.0101    99.692  618.14
  50   0.0255     99.240  0.0096    99.685  630.67
  51   0.0276     99.140  0.0090    99.733  643.19
  52   0.0287     99.110  0.0092    99.705  655.84
  53   0.0231     99.260  0.0091    99.690  668.39
  54   0.0267     99.140  0.0083    99.745  680.94
  55   0.0301     99.050  0.0076    99.765  693.45
  56   0.0300     99.060  0.0076    99.773  706.09
  57   0.0251     99.250  0.0074    99.760  718.64
  58   0.0275     99.150  0.0075    99.772  731.20
  59   0.0256     99.180  0.0072    99.778  743.86
  60   0.0256     99.160  0.0067    99.775  756.40
  61   0.0304     99.090  0.0062    99.822  768.95
  62   0.0303     98.980  0.0065    99.793  781.49
  63   0.0255     99.260  0.0062    99.822  794.00
  64   0.0296     99.110  0.0056    99.837  806.55
  65   0.0248     99.240  0.0058    99.838  819.22
  66   0.0272     99.110  0.0054    99.848  831.75
  67   0.0259     99.190  0.0052    99.847  844.28
  68   0.0240     99.270  0.0051    99.857  856.84
  69   0.0244     99.190  0.0043    99.890  869.37
  70   0.0319     99.030  0.0045    99.858  881.91
  71   0.0262     99.210  0.0045    99.880  894.44
  72   0.0311     99.100  0.0040    99.880  907.11
  73   0.0285     99.160  0.0040    99.903  919.65
  74   0.0272     99.220  0.0037    99.898  932.14
  75   0.0349     99.010  0.0036    99.897  944.75
  76   0.0289     99.130  0.0037    99.910  957.30
  77   0.0300     99.090  0.0035    99.910  969.82
  78   0.0297     99.130  0.0035    99.917  982.51
  79   0.0357     98.950  0.0032    99.910  995.09
  80   0.0293     99.170  0.0031    99.935  1007.64
  81   0.0275     99.130  0.0034    99.902  1020.31
  82   0.0317     99.060  0.0032    99.927  1032.85
  83   0.0298     99.160  0.0029    99.932  1045.47
  84   0.0284     99.160  0.0029    99.932  1058.01
  85   0.0308     99.120  0.0028    99.927  1070.59
  86   0.0302     99.170  0.0026    99.938  1083.11
  87   0.0254     99.240  0.0028    99.930  1095.64
  88   0.0300     99.120  0.0026    99.948  1108.32
  89   0.0297     99.100  0.0030    99.932  1120.86
  90   0.0291     99.130  0.0025    99.953  1133.38
