Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1425     95.140  0.5122    82.515  14.65
   2   0.1426     95.340  0.0983    96.872  27.10
   3   0.0553     98.260  0.0697    97.738  39.68
   4   0.0601     98.060  0.0600    98.068  52.07
   5   0.0619     97.990  0.0507    98.347  64.45
   6   0.0615     98.070  0.0463    98.532  76.99
   7   0.0490     98.280  0.0421    98.675  89.41
   8   0.0498     98.300  0.0400    98.717  101.82
   9   0.0439     98.640  0.0373    98.818  114.22
  10   0.0541     98.280  0.0344    98.857  126.59
  11   0.0400     98.780  0.0341    98.947  139.01
  12   0.0503     98.390  0.0325    98.938  151.43
  13   0.0378     98.820  0.0325    98.920  164.00
  14   0.0347     98.820  0.0289    99.077  176.40
  15   0.0465     98.540  0.0286    99.058  188.80
  16   0.0347     98.900  0.0269    99.202  201.30
  17   0.0415     98.580  0.0263    99.163  213.68
  18   0.0437     98.550  0.0256    99.170  226.02
  19   0.0400     98.820  0.0249    99.215  238.50
  20   0.0317     98.900  0.0236    99.247  250.90
  21   0.0279     99.110  0.0237    99.193  263.29
  22   0.0271     99.180  0.0220    99.293  275.79
  23   0.0448     98.620  0.0210    99.352  288.22
  24   0.0586     98.030  0.0211    99.315  300.63
  25   0.0319     98.930  0.0204    99.343  313.14
  26   0.0325     98.980  0.0197    99.355  325.55
  27   0.0437     98.540  0.0188    99.400  337.96
  28   0.0359     98.760  0.0179    99.423  350.36
  29   0.0405     98.700  0.0188    99.378  362.75
  30   0.0260     99.160  0.0179    99.415  375.17
  31   0.0320     98.920  0.0181    99.378  387.57
  32   0.0277     99.110  0.0158    99.480  400.12
  33   0.0294     99.010  0.0156    99.485  412.52
  34   0.0287     99.100  0.0149    99.552  424.91
  35   0.0291     99.040  0.0143    99.537  437.40
  36   0.0476     98.470  0.0149    99.538  449.82
  37   0.0221     99.350  0.0153    99.515  462.20
  38   0.0391     98.820  0.0138    99.550  474.71
  39   0.0283     99.050  0.0137    99.557  487.09
  40   0.0278     99.060  0.0131    99.533  499.48
  41   0.0252     99.090  0.0127    99.620  511.88
  42   0.0242     99.170  0.0121    99.625  524.29
  43   0.0257     99.240  0.0118    99.630  536.70
  44   0.0252     99.150  0.0125    99.603  549.10
  45   0.0220     99.340  0.0118    99.652  561.50
  46   0.0256     99.070  0.0105    99.645  573.90
  47   0.0243     99.230  0.0101    99.697  586.30
  48   0.0268     99.150  0.0101    99.662  598.85
  49   0.0304     99.010  0.0097    99.670  611.24
  50   0.0226     99.250  0.0092    99.725  623.66
  51   0.0291     99.130  0.0091    99.712  636.06
  52   0.0310     99.030  0.0086    99.718  648.48
  53   0.0222     99.290  0.0083    99.722  660.87
  54   0.0266     99.090  0.0078    99.765  673.27
  55   0.0282     99.060  0.0080    99.748  685.91
  56   0.0306     99.080  0.0076    99.765  698.32
  57   0.0269     99.120  0.0073    99.760  710.74
  58   0.0251     99.200  0.0075    99.760  723.23
  59   0.0257     99.210  0.0067    99.805  735.63
  60   0.0262     99.110  0.0066    99.787  748.01
  61   0.0227     99.190  0.0058    99.830  760.40
  62   0.0278     99.160  0.0058    99.837  772.79
  63   0.0279     99.150  0.0060    99.825  785.19
  64   0.0273     99.100  0.0057    99.833  797.60
  65   0.0234     99.180  0.0055    99.835  810.13
  66   0.0221     99.220  0.0052    99.855  822.52
  67   0.0264     99.180  0.0044    99.878  835.01
  68   0.0249     99.140  0.0053    99.842  847.40
  69   0.0250     99.170  0.0045    99.875  859.81
  70   0.0208     99.270  0.0041    99.882  872.24
  71   0.0247     99.110  0.0038    99.907  884.73
  72   0.0266     99.120  0.0038    99.903  897.13
  73   0.0257     99.160  0.0039    99.887  909.50
  74   0.0277     99.030  0.0038    99.897  921.98
  75   0.0276     99.130  0.0034    99.912  934.39
  76   0.0252     99.140  0.0034    99.912  946.82
  77   0.0261     99.160  0.0032    99.922  959.34
  78   0.0267     99.150  0.0031    99.932  971.75
  79   0.0260     99.140  0.0033    99.905  984.15
  80   0.0297     99.030  0.0031    99.918  996.65
  81   0.0269     99.120  0.0028    99.932  1009.03
  82   0.0259     99.190  0.0030    99.933  1021.44
  83   0.0267     99.120  0.0028    99.933  1033.84
  84   0.0259     99.130  0.0028    99.930  1046.21
  85   0.0272     98.980  0.0026    99.957  1058.61
  86   0.0281     99.120  0.0028    99.933  1071.04
  87   0.0308     99.140  0.0025    99.945  1083.57
  88   0.0259     99.150  0.0028    99.937  1095.96
  89   0.0283     99.090  0.0026    99.930  1108.38
  90   0.0272     99.080  0.0024    99.943  1120.88
