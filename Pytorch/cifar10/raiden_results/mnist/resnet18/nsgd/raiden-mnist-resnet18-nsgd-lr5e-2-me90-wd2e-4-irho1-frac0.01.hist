Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1027     96.680  0.4221    85.542  14.60
   2   0.0861     97.250  0.0863    97.302  27.24
   3   0.0503     98.320  0.0665    97.913  39.66
   4   0.0530     98.240  0.0535    98.267  52.11
   5   0.0624     97.920  0.0508    98.402  64.64
   6   0.0413     98.590  0.0456    98.585  77.13
   7   0.0361     98.780  0.0410    98.715  89.58
   8   0.0363     98.860  0.0391    98.782  102.01
   9   0.0408     98.590  0.0375    98.823  114.45
  10   0.0386     98.920  0.0346    98.902  126.89
  11   0.0423     98.650  0.0340    98.893  139.33
  12   0.0421     98.710  0.0327    98.947  151.76
  13   0.0433     98.440  0.0320    98.962  164.24
  14   0.0377     98.770  0.0300    99.057  176.69
  15   0.0634     98.050  0.0274    99.123  189.24
  16   0.0347     98.860  0.0288    99.027  201.72
  17   0.0282     99.070  0.0266    99.117  214.18
  18   0.0343     98.810  0.0263    99.127  226.73
  19   0.0415     98.510  0.0245    99.193  239.21
  20   0.0444     98.650  0.0250    99.205  251.64
  21   0.0267     99.160  0.0244    99.238  264.22
  22   0.0357     98.880  0.0251    99.177  276.64
  23   0.0338     98.820  0.0230    99.262  289.10
  24   0.0424     98.540  0.0230    99.258  301.69
  25   0.0390     98.690  0.0218    99.272  314.12
  26   0.0284     99.050  0.0219    99.270  326.54
  27   0.0349     98.810  0.0197    99.357  338.94
  28   0.0310     99.070  0.0201    99.322  351.40
  29   0.0393     98.740  0.0203    99.308  363.83
  30   0.0269     99.070  0.0192    99.345  376.25
  31   0.0274     99.090  0.0181    99.440  388.85
  32   0.0239     99.230  0.0192    99.370  401.27
  33   0.0196     99.350  0.0184    99.417  413.71
  34   0.0352     98.870  0.0173    99.413  426.27
  35   0.0384     98.730  0.0165    99.458  438.71
  36   0.0301     99.020  0.0150    99.543  451.16
  37   0.0383     98.760  0.0170    99.460  463.62
  38   0.0342     98.940  0.0158    99.463  476.08
  39   0.0346     98.970  0.0149    99.533  488.51
  40   0.0331     98.940  0.0154    99.495  500.94
  41   0.0356     98.900  0.0140    99.537  513.41
  42   0.0271     99.120  0.0147    99.523  525.85
  43   0.0303     98.980  0.0130    99.563  538.31
  44   0.0300     99.030  0.0117    99.615  550.77
  45   0.0319     99.080  0.0117    99.630  563.20
  46   0.0248     99.130  0.0117    99.612  575.65
  47   0.0357     98.830  0.0104    99.670  588.26
  48   0.0291     99.110  0.0111    99.610  600.71
  49   0.0335     98.990  0.0099    99.670  613.14
  50   0.0350     98.830  0.0103    99.667  625.71
  51   0.0240     99.140  0.0093    99.690  638.13
  52   0.0288     99.030  0.0077    99.782  650.60
  53   0.0252     99.220  0.0082    99.737  663.07
  54   0.0268     99.090  0.0075    99.768  675.61
  55   0.0312     99.040  0.0074    99.740  688.02
  56   0.0270     99.190  0.0076    99.765  700.44
  57   0.0282     99.160  0.0069    99.778  713.05
  58   0.0285     99.190  0.0062    99.800  725.50
  59   0.0271     99.060  0.0070    99.793  737.95
  60   0.0293     99.120  0.0061    99.825  750.51
  61   0.0252     99.190  0.0055    99.835  762.95
  62   0.0268     99.140  0.0047    99.852  775.41
  63   0.0304     99.120  0.0047    99.860  787.84
  64   0.0316     99.080  0.0040    99.885  800.35
  65   0.0276     99.160  0.0038    99.878  812.80
  66   0.0339     99.050  0.0035    99.913  825.35
  67   0.0276     99.090  0.0031    99.923  837.78
  68   0.0263     99.160  0.0034    99.912  850.23
  69   0.0263     99.160  0.0032    99.917  862.71
  70   0.0303     99.100  0.0025    99.942  875.14
  71   0.0297     99.150  0.0029    99.937  887.57
  72   0.0293     99.190  0.0023    99.950  900.06
  73   0.0333     99.030  0.0021    99.957  912.53
  74   0.0282     99.160  0.0021    99.962  925.02
  75   0.0296     99.140  0.0022    99.940  937.51
  76   0.0295     99.140  0.0019    99.963  950.11
  77   0.0303     99.110  0.0018    99.965  962.55
  78   0.0293     99.130  0.0018    99.960  974.96
  79   0.0282     99.160  0.0016    99.967  987.53
  80   0.0278     99.180  0.0015    99.977  999.99
  81   0.0308     99.080  0.0015    99.972  1012.47
  82   0.0296     99.110  0.0012    99.992  1025.05
  83   0.0298     99.120  0.0014    99.972  1037.51
  84   0.0302     99.170  0.0014    99.980  1049.96
  85   0.0290     99.150  0.0014    99.980  1062.55
  86   0.0326     99.080  0.0012    99.983  1075.00
  87   0.0300     99.160  0.0012    99.978  1087.45
  88   0.0313     99.120  0.0013    99.982  1099.90
  89   0.0310     99.150  0.0012    99.982  1112.35
  90   0.0316     99.110  0.0012    99.988  1124.79
