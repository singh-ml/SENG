Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1352     95.490  0.4634    84.992  14.78
   2   0.0883     97.230  0.0929    97.068  27.53
   3   0.0834     97.340  0.0674    97.827  40.05
   4   0.0604     98.110  0.0574    98.170  52.57
   5   0.0448     98.500  0.0509    98.395  65.10
   6   0.0418     98.570  0.0463    98.553  77.62
   7   0.0638     97.880  0.0437    98.588  90.13
   8   0.0354     98.870  0.0385    98.802  102.79
   9   0.0384     98.650  0.0350    98.917  115.31
  10   0.0516     98.530  0.0343    98.892  127.84
  11   0.0355     98.790  0.0318    99.010  140.39
  12   0.0445     98.510  0.0317    98.972  152.88
  13   0.0316     98.950  0.0293    99.063  165.40
  14   0.0315     99.030  0.0287    99.055  177.89
  15   0.0376     98.840  0.0276    99.105  190.57
  16   0.0336     98.880  0.0261    99.137  203.11
  17   0.0412     98.810  0.0243    99.230  215.64
  18   0.0400     98.670  0.0247    99.207  228.27
  19   0.0298     99.030  0.0243    99.222  240.78
  20   0.0304     99.120  0.0229    99.233  253.29
  21   0.0285     99.080  0.0213    99.278  265.83
  22   0.0284     99.130  0.0209    99.325  278.39
  23   0.0319     99.000  0.0190    99.412  290.95
  24   0.0415     98.750  0.0197    99.355  303.48
  25   0.0296     99.110  0.0181    99.383  316.00
  26   0.0305     99.040  0.0184    99.395  328.53
  27   0.0346     98.920  0.0183    99.360  341.07
  28   0.0305     98.940  0.0172    99.415  353.63
  29   0.0304     99.050  0.0171    99.410  366.17
  30   0.0322     99.020  0.0160    99.442  378.68
  31   0.0285     99.130  0.0148    99.523  391.28
  32   0.0274     99.120  0.0145    99.518  403.82
  33   0.0265     99.180  0.0153    99.472  416.36
  34   0.0255     99.160  0.0135    99.547  429.06
  35   0.0248     99.190  0.0131    99.547  441.62
  36   0.0400     98.580  0.0132    99.542  454.16
  37   0.0300     99.020  0.0126    99.592  466.73
  38   0.0345     98.890  0.0129    99.567  479.21
  39   0.0378     98.780  0.0121    99.605  491.73
  40   0.0269     99.200  0.0113    99.625  504.27
  41   0.0373     98.830  0.0110    99.595  516.84
  42   0.0337     98.970  0.0097    99.677  529.38
  43   0.0238     99.300  0.0103    99.672  541.92
  44   0.0308     99.150  0.0094    99.685  554.44
  45   0.0255     99.170  0.0088    99.715  566.95
  46   0.0316     99.050  0.0092    99.687  579.47
  47   0.0254     99.270  0.0082    99.713  592.01
  48   0.0327     99.060  0.0083    99.710  604.55
  49   0.0375     98.900  0.0086    99.730  617.08
  50   0.0380     98.810  0.0083    99.717  629.75
  51   0.0341     98.920  0.0075    99.738  642.27
  52   0.0339     99.100  0.0070    99.763  654.78
  53   0.0287     99.190  0.0065    99.778  667.42
  54   0.0363     98.950  0.0066    99.792  679.93
  55   0.0292     99.160  0.0069    99.772  692.46
  56   0.0309     99.070  0.0066    99.775  705.07
  57   0.0362     98.870  0.0057    99.813  717.56
  58   0.0286     99.140  0.0063    99.783  730.11
  59   0.0296     99.180  0.0051    99.840  742.76
  60   0.0309     99.250  0.0050    99.838  755.31
  61   0.0380     99.050  0.0050    99.842  767.82
  62   0.0327     99.060  0.0046    99.838  780.35
  63   0.0346     99.110  0.0044    99.870  792.88
  64   0.0306     99.070  0.0041    99.875  805.41
  65   0.0296     99.140  0.0046    99.835  817.96
  66   0.0331     99.040  0.0043    99.865  830.50
  67   0.0317     99.110  0.0040    99.868  843.00
  68   0.0348     99.000  0.0040    99.875  855.55
  69   0.0334     99.110  0.0042    99.868  868.21
  70   0.0351     99.000  0.0037    99.878  880.75
  71   0.0340     99.020  0.0037    99.882  893.30
  72   0.0315     99.200  0.0033    99.897  905.84
  73   0.0320     99.080  0.0029    99.913  918.46
  74   0.0382     99.050  0.0035    99.897  930.98
  75   0.0349     98.970  0.0031    99.902  943.51
  76   0.0318     99.100  0.0034    99.883  956.05
  77   0.0329     99.140  0.0028    99.907  968.60
  78   0.0362     99.090  0.0031    99.912  981.13
  79   0.0343     99.020  0.0027    99.930  993.79
  80   0.0363     98.980  0.0022    99.935  1006.43
  81   0.0367     99.140  0.0024    99.928  1019.05
  82   0.0341     99.160  0.0026    99.922  1031.69
  83   0.0354     99.160  0.0026    99.923  1044.22
  84   0.0382     99.050  0.0022    99.935  1056.79
  85   0.0374     99.030  0.0026    99.912  1069.50
