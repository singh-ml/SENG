Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet18', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1196     96.120  0.4122    85.955  14.80
   2   0.0873     97.080  0.0854    97.395  27.27
   3   0.0474     98.450  0.0654    97.987  39.74
   4   0.0953     97.030  0.0559    98.252  52.20
   5   0.0547     98.160  0.0483    98.447  64.67
   6   0.0457     98.520  0.0461    98.547  77.16
   7   0.0488     98.440  0.0403    98.707  89.65
   8   0.0402     98.640  0.0386    98.772  102.10
   9   0.0283     99.100  0.0364    98.865  114.54
  10   0.0360     98.750  0.0335    98.943  127.01
  11   0.0356     98.800  0.0326    98.910  139.64
  12   0.0301     98.850  0.0303    99.048  152.11
  13   0.0348     98.850  0.0309    98.962  164.57
  14   0.0433     98.570  0.0292    99.047  177.13
  15   0.0326     98.830  0.0279    99.078  189.60
  16   0.0328     98.850  0.0258    99.120  202.04
  17   0.0397     98.650  0.0243    99.188  214.45
  18   0.0315     98.880  0.0227    99.252  226.99
  19   0.0286     99.100  0.0241    99.228  239.44
  20   0.0372     98.680  0.0229    99.227  251.91
  21   0.0322     99.000  0.0206    99.323  264.50
  22   0.0310     99.100  0.0203    99.323  276.95
  23   0.0432     98.650  0.0198    99.347  289.41
  24   0.0280     98.950  0.0193    99.355  301.86
  25   0.0396     98.790  0.0185    99.367  314.55
  26   0.0321     98.930  0.0175    99.397  326.99
  27   0.0263     99.140  0.0173    99.423  339.46
  28   0.0328     98.910  0.0174    99.453  351.95
  29   0.0360     98.740  0.0169    99.412  364.42
  30   0.0310     98.920  0.0155    99.475  376.88
  31   0.0272     99.070  0.0160    99.442  389.47
  32   0.0293     99.090  0.0148    99.500  401.93
  33   0.0311     98.880  0.0142    99.507  414.39
  34   0.0283     98.960  0.0143    99.518  427.00
  35   0.0234     99.190  0.0132    99.567  439.47
  36   0.0335     98.880  0.0121    99.592  451.94
  37   0.0239     99.220  0.0131    99.530  464.40
  38   0.0285     99.040  0.0110    99.645  477.04
  39   0.0250     99.220  0.0108    99.645  489.51
  40   0.0262     99.150  0.0106    99.618  501.96
  41   0.0285     99.210  0.0110    99.630  514.44
  42   0.0346     99.010  0.0104    99.650  526.92
  43   0.0300     99.060  0.0105    99.650  539.38
  44   0.0306     99.050  0.0099    99.668  551.84
  45   0.0346     98.830  0.0090    99.682  564.31
  46   0.0282     99.100  0.0091    99.700  576.73
  47   0.0311     99.020  0.0087    99.698  589.21
  48   0.0264     99.170  0.0083    99.722  601.66
  49   0.0331     98.950  0.0082    99.728  614.13
  50   0.0292     99.090  0.0074    99.762  626.68
  51   0.0300     99.100  0.0067    99.770  639.11
  52   0.0305     99.120  0.0068    99.767  651.58
  53   0.0326     99.070  0.0064    99.772  664.14
  54   0.0252     99.200  0.0071    99.755  676.62
  55   0.0325     98.990  0.0059    99.805  689.10
  56   0.0400     98.780  0.0059    99.790  701.68
  57   0.0348     99.000  0.0062    99.787  714.15
  58   0.0321     99.050  0.0054    99.832  726.62
  59   0.0329     98.960  0.0053    99.843  739.10
  60   0.0384     98.850  0.0059    99.807  751.59
  61   0.0310     99.120  0.0049    99.827  764.03
  62   0.0331     99.110  0.0055    99.807  776.51
  63   0.0309     99.100  0.0046    99.847  789.05
  64   0.0355     99.090  0.0041    99.863  801.50
  65   0.0351     99.050  0.0043    99.867  813.96
  66   0.0290     99.130  0.0037    99.877  826.56
  67   0.0333     99.100  0.0044    99.855  839.02
  68   0.0317     99.050  0.0037    99.892  851.49
  69   0.0326     99.050  0.0035    99.877  864.06
  70   0.0345     99.030  0.0035    99.880  876.52
  71   0.0369     98.910  0.0036    99.890  888.98
  72   0.0341     99.100  0.0032    99.903  901.58
  73   0.0356     99.000  0.0029    99.903  914.06
  74   0.0325     99.070  0.0029    99.900  926.53
  75   0.0353     99.070  0.0026    99.925  938.98
  76   0.0345     99.080  0.0029    99.913  951.45
  77   0.0364     99.040  0.0027    99.937  963.89
  78   0.0308     99.200  0.0023    99.938  976.41
  79   0.0337     99.090  0.0028    99.903  988.95
  80   0.0363     99.130  0.0024    99.917  1001.44
  81   0.0382     99.050  0.0025    99.910  1013.91
  82   0.0348     99.100  0.0024    99.932  1026.52
  83   0.0350     99.080  0.0028    99.918  1038.99
  84   0.0339     99.140  0.0020    99.950  1051.47
  85   0.0408     98.920  0.0024    99.932  1064.10
