Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1932     93.770  0.6606    77.603  15.54
   2   0.1171     96.150  0.1306    95.905  27.85
   3   0.0823     97.280  0.0870    97.328  40.17
   4   0.0865     97.280  0.0713    97.765  52.49
   5   0.0662     97.680  0.0601    98.128  64.78
   6   0.0593     98.070  0.0531    98.312  77.23
   7   0.0574     98.150  0.0489    98.410  89.51
   8   0.0609     98.140  0.0459    98.563  101.79
   9   0.0609     98.020  0.0422    98.667  114.18
  10   0.0706     97.790  0.0396    98.765  126.47
  11   0.0411     98.680  0.0372    98.792  138.76
  12   0.0407     98.610  0.0347    98.887  151.03
  13   0.0487     98.260  0.0348    98.872  163.46
  14   0.0421     98.610  0.0322    98.962  175.72
  15   0.0332     98.870  0.0322    98.955  188.04
  16   0.0395     98.760  0.0303    99.025  200.47
  17   0.0406     98.700  0.0293    99.022  212.78
  18   0.0419     98.720  0.0279    99.127  225.08
  19   0.0396     98.790  0.0271    99.100  237.52
  20   0.0329     98.960  0.0256    99.187  249.84
  21   0.0365     98.850  0.0246    99.192  262.14
  22   0.0406     98.590  0.0249    99.195  274.47
  23   0.0441     98.550  0.0233    99.220  286.93
  24   0.0331     99.030  0.0230    99.233  299.19
  25   0.0323     99.090  0.0235    99.202  311.50
  26   0.0295     98.980  0.0203    99.327  323.81
  27   0.0283     99.020  0.0205    99.315  336.16
  28   0.0365     98.780  0.0207    99.368  348.45
  29   0.0312     99.000  0.0199    99.332  360.86
  30   0.0417     98.750  0.0200    99.372  373.15
  31   0.0303     99.010  0.0183    99.398  385.43
  32   0.0380     98.800  0.0192    99.368  397.84
  33   0.0362     98.770  0.0182    99.402  410.13
  34   0.0368     98.890  0.0171    99.460  422.48
  35   0.0279     99.060  0.0171    99.453  434.78
  36   0.0349     98.810  0.0162    99.455  447.08
  37   0.0310     99.050  0.0158    99.470  459.34
  38   0.0256     99.070  0.0153    99.503  471.61
  39   0.0296     99.120  0.0153    99.505  483.89
  40   0.0330     98.980  0.0138    99.555  496.16
  41   0.0356     98.890  0.0137    99.533  508.43
  42   0.0326     98.980  0.0143    99.518  520.87
  43   0.0294     99.100  0.0138    99.558  533.14
  44   0.0272     99.050  0.0125    99.627  545.42
  45   0.0359     98.920  0.0124    99.605  557.88
  46   0.0292     99.000  0.0124    99.597  570.17
  47   0.0377     98.930  0.0117    99.600  582.46
  48   0.0344     98.940  0.0110    99.637  594.73
  49   0.0367     98.860  0.0113    99.623  607.00
  50   0.0330     99.030  0.0111    99.642  619.28
  51   0.0286     99.110  0.0100    99.663  631.52
  52   0.0340     98.850  0.0104    99.670  643.80
  53   0.0308     99.030  0.0104    99.688  656.08
  54   0.0330     98.960  0.0096    99.692  668.37
  55   0.0261     99.150  0.0100    99.673  680.80
  56   0.0293     99.100  0.0093    99.710  693.07
  57   0.0304     99.010  0.0082    99.747  705.36
  58   0.0293     99.090  0.0086    99.733  717.63
  59   0.0261     99.180  0.0087    99.723  729.94
  60   0.0279     99.040  0.0088    99.713  742.20
  61   0.0261     99.130  0.0078    99.760  754.51
  62   0.0307     99.000  0.0070    99.787  766.80
  63   0.0307     99.030  0.0074    99.788  779.05
  64   0.0321     99.000  0.0071    99.783  791.33
  65   0.0264     99.160  0.0066    99.807  803.62
  66   0.0312     99.090  0.0068    99.787  815.93
  67   0.0303     99.110  0.0065    99.813  828.20
  68   0.0257     99.200  0.0068    99.805  840.57
  69   0.0258     99.170  0.0059    99.835  852.84
  70   0.0314     99.040  0.0062    99.803  865.11
  71   0.0341     98.940  0.0060    99.810  877.39
  72   0.0322     99.020  0.0062    99.832  889.67
  73   0.0291     99.070  0.0058    99.835  901.92
  74   0.0254     99.230  0.0059    99.820  914.21
  75   0.0324     99.020  0.0058    99.850  926.46
  76   0.0328     99.000  0.0056    99.837  938.75
  77   0.0337     98.930  0.0054    99.848  951.05
  78   0.0303     99.090  0.0058    99.825  963.49
  79   0.0303     99.010  0.0054    99.845  975.79
  80   0.0289     99.110  0.0050    99.867  988.08
  81   0.0284     99.090  0.0049    99.860  1000.41
  82   0.0317     99.000  0.0048    99.862  1012.71
  83   0.0297     99.040  0.0046    99.885  1024.99
  84   0.0276     99.100  0.0045    99.878  1037.25
  85   0.0288     99.090  0.0047    99.868  1049.67
  86   0.0263     99.170  0.0046    99.888  1061.95
  87   0.0307     99.080  0.0046    99.880  1074.23
  88   0.0301     99.040  0.0042    99.903  1086.68
  89   0.0287     99.060  0.0045    99.880  1098.95
  90   0.0307     99.070  0.0043    99.893  1111.25
