Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1301     95.750  0.4642    84.120  14.82
   2   0.0823     97.200  0.0937    97.052  27.52
   3   0.0765     97.380  0.0689    97.772  40.06
   4   0.0637     97.940  0.0592    98.067  52.59
   5   0.0563     98.260  0.0497    98.447  65.22
   6   0.0744     97.670  0.0455    98.593  77.79
   7   0.0661     97.800  0.0420    98.602  90.34
   8   0.0395     98.690  0.0394    98.755  102.91
   9   0.0477     98.470  0.0368    98.813  115.48
  10   0.0465     98.410  0.0340    98.898  128.07
  11   0.0284     98.990  0.0330    98.910  140.61
  12   0.0499     98.450  0.0319    98.985  153.28
  13   0.0338     98.850  0.0316    98.997  165.86
  14   0.0359     98.850  0.0300    99.018  178.39
  15   0.0373     98.810  0.0285    99.087  190.92
  16   0.0316     98.970  0.0263    99.140  203.62
  17   0.0341     98.900  0.0253    99.150  216.17
  18   0.0376     98.820  0.0238    99.227  228.73
  19   0.0397     98.790  0.0242    99.198  241.40
  20   0.0365     98.820  0.0223    99.280  253.94
  21   0.0329     98.830  0.0216    99.287  266.47
  22   0.0346     98.890  0.0226    99.275  279.03
  23   0.0312     98.910  0.0185    99.415  291.60
  24   0.0304     99.010  0.0211    99.287  304.17
  25   0.0321     98.930  0.0191    99.330  316.71
  26   0.0283     99.120  0.0194    99.350  329.39
  27   0.0323     98.960  0.0176    99.420  341.91
  28   0.0416     98.660  0.0176    99.432  354.47
  29   0.0315     99.010  0.0164    99.453  367.02
  30   0.0308     98.910  0.0160    99.460  379.56
  31   0.0333     98.950  0.0160    99.480  392.14
  32   0.0295     99.100  0.0158    99.452  404.72
  33   0.0363     98.800  0.0161    99.467  417.29
  34   0.0242     99.200  0.0145    99.487  429.84
  35   0.0319     99.010  0.0135    99.528  442.40
  36   0.0258     99.160  0.0130    99.595  454.96
  37   0.0357     98.900  0.0130    99.552  467.53
  38   0.0361     98.810  0.0127    99.568  480.07
  39   0.0329     99.000  0.0117    99.610  492.74
  40   0.0319     99.000  0.0116    99.598  505.29
  41   0.0287     99.000  0.0104    99.672  517.83
  42   0.0362     98.880  0.0114    99.618  530.50
  43   0.0296     99.130  0.0103    99.660  543.04
  44   0.0308     99.040  0.0108    99.642  555.60
  45   0.0276     99.110  0.0096    99.683  568.27
  46   0.0307     99.140  0.0093    99.700  580.84
  47   0.0313     99.100  0.0101    99.650  593.39
  48   0.0249     99.230  0.0103    99.658  605.95
  49   0.0254     99.240  0.0091    99.665  618.50
  50   0.0241     99.230  0.0086    99.745  631.05
  51   0.0288     99.090  0.0080    99.733  643.59
  52   0.0285     99.030  0.0080    99.732  656.36
  53   0.0309     98.990  0.0072    99.773  668.89
  54   0.0322     99.060  0.0077    99.733  681.44
  55   0.0263     99.170  0.0071    99.757  694.08
  56   0.0324     98.990  0.0070    99.775  706.62
  57   0.0281     99.030  0.0062    99.787  719.19
  58   0.0283     99.080  0.0057    99.827  731.87
  59   0.0303     99.100  0.0059    99.822  744.43
  60   0.0300     99.080  0.0058    99.813  756.98
  61   0.0275     99.120  0.0060    99.805  769.52
  62   0.0295     99.050  0.0054    99.817  782.08
  63   0.0258     99.230  0.0054    99.802  794.63
  64   0.0338     99.040  0.0051    99.825  807.16
  65   0.0287     99.040  0.0045    99.865  819.71
  66   0.0322     99.100  0.0046    99.857  832.28
  67   0.0272     99.170  0.0047    99.847  844.86
  68   0.0285     99.130  0.0049    99.842  857.41
  69   0.0293     99.080  0.0045    99.848  870.02
  70   0.0297     99.110  0.0048    99.842  882.58
  71   0.0311     99.070  0.0038    99.898  895.20
  72   0.0329     99.080  0.0040    99.882  907.74
  73   0.0317     99.100  0.0038    99.880  920.29
  74   0.0300     99.210  0.0037    99.873  932.94
  75   0.0342     98.960  0.0035    99.900  945.50
  76   0.0312     99.090  0.0033    99.908  958.05
  77   0.0311     99.180  0.0035    99.890  970.61
  78   0.0353     98.920  0.0033    99.905  983.15
  79   0.0282     99.140  0.0031    99.915  995.72
  80   0.0339     99.040  0.0027    99.935  1008.26
  81   0.0310     99.120  0.0029    99.913  1020.92
  82   0.0328     99.140  0.0029    99.923  1033.46
  83   0.0315     99.090  0.0030    99.908  1046.00
  84   0.0328     99.110  0.0028    99.923  1058.55
  85   0.0316     99.090  0.0028    99.912  1071.18
  86   0.0315     99.160  0.0027    99.920  1083.78
  87   0.0379     98.970  0.0030    99.898  1096.44
  88   0.0345     99.070  0.0025    99.927  1109.01
  89   0.0320     99.120  0.0021    99.942  1121.57
  90   0.0364     98.990  0.0023    99.935  1134.24
