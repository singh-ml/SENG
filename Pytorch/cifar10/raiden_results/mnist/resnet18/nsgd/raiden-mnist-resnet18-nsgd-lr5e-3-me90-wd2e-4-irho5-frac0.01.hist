Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet18', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 7852212224 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.1922     93.700  0.4628    84.222  14.76
   2   0.0613     97.880  0.0972    96.945  27.20
   3   0.0897     97.100  0.0680    97.873  39.67
   4   0.0841     97.230  0.0573    98.188  52.12
   5   0.0489     98.510  0.0516    98.363  64.59
   6   0.1348     95.340  0.0471    98.508  77.03
   7   0.0470     98.580  0.0426    98.652  89.47
   8   0.0416     98.630  0.0400    98.727  101.90
   9   0.0562     98.200  0.0368    98.828  114.41
  10   0.0461     98.480  0.0341    98.892  126.85
  11   0.0601     98.320  0.0323    98.987  139.30
  12   0.0414     98.760  0.0321    98.997  151.93
  13   0.0431     98.640  0.0295    99.067  164.38
  14   0.0536     98.230  0.0272    99.107  176.82
  15   0.0373     98.700  0.0271    99.145  189.28
  16   0.0353     98.820  0.0270    99.143  201.72
  17   0.0250     99.160  0.0254    99.177  214.18
  18   0.0286     99.130  0.0237    99.203  226.63
  19   0.0365     98.730  0.0247    99.188  239.21
  20   0.0381     98.700  0.0225    99.258  251.66
  21   0.0430     98.610  0.0209    99.348  264.08
  22   0.0391     98.670  0.0210    99.285  276.64
  23   0.0333     98.920  0.0222    99.243  289.09
  24   0.0265     99.070  0.0206    99.297  301.55
  25   0.0489     98.590  0.0195    99.340  314.10
  26   0.0309     99.050  0.0189    99.362  326.52
  27   0.0267     99.170  0.0187    99.377  338.93
  28   0.0553     98.340  0.0189    99.377  351.51
  29   0.0262     99.130  0.0178    99.420  363.95
  30   0.0298     99.030  0.0158    99.472  376.40
  31   0.0405     98.640  0.0154    99.498  388.87
  32   0.0346     98.960  0.0156    99.470  401.31
  33   0.0412     98.690  0.0151    99.485  413.70
  34   0.0277     99.060  0.0149    99.493  426.13
  35   0.0345     98.870  0.0148    99.477  438.68
  36   0.0272     99.180  0.0133    99.568  451.10
  37   0.0265     99.120  0.0125    99.600  463.54
  38   0.0303     99.010  0.0123    99.578  476.11
  39   0.0335     98.930  0.0121    99.602  488.54
  40   0.0280     99.040  0.0116    99.603  500.93
  41   0.0263     99.120  0.0124    99.587  513.52
  42   0.0341     98.850  0.0112    99.642  525.94
  43   0.0310     99.000  0.0106    99.665  538.37
  44   0.0273     99.150  0.0105    99.638  550.92
  45   0.0273     99.080  0.0092    99.690  563.34
  46   0.0323     99.050  0.0094    99.672  575.74
  47   0.0327     98.990  0.0101    99.685  588.18
  48   0.0334     98.870  0.0091    99.680  600.73
  49   0.0333     98.950  0.0085    99.735  613.15
  50   0.0342     98.930  0.0079    99.720  625.59
  51   0.0373     98.910  0.0084    99.703  638.15
  52   0.0328     98.910  0.0081    99.728  650.56
  53   0.0257     99.210  0.0068    99.787  662.97
  54   0.0329     98.980  0.0075    99.743  675.50
  55   0.0394     98.690  0.0073    99.743  687.94
  56   0.0320     99.020  0.0070    99.772  700.36
  57   0.0358     98.900  0.0068    99.777  712.78
  58   0.0298     98.980  0.0057    99.810  725.30
  59   0.0304     99.060  0.0066    99.768  737.71
  60   0.0304     99.010  0.0053    99.832  750.15
  61   0.0334     99.030  0.0054    99.825  762.66
  62   0.0327     99.060  0.0057    99.825  775.08
  63   0.0331     99.030  0.0050    99.840  787.49
  64   0.0300     99.030  0.0052    99.838  799.89
  65   0.0314     99.030  0.0054    99.812  812.43
  66   0.0352     99.000  0.0052    99.835  824.87
  67   0.0316     99.040  0.0045    99.857  837.28
  68   0.0300     99.090  0.0045    99.845  849.72
  69   0.0359     98.960  0.0044    99.855  862.27
  70   0.0352     98.980  0.0043    99.863  874.67
  71   0.0349     98.930  0.0042    99.865  887.11
  72   0.0358     98.960  0.0036    99.900  899.66
  73   0.0329     99.060  0.0043    99.855  912.06
  74   0.0326     99.020  0.0035    99.900  924.45
  75   0.0322     99.110  0.0036    99.903  936.86
  76   0.0355     98.910  0.0035    99.875  949.28
  77   0.0378     98.830  0.0036    99.898  961.72
  78   0.0329     99.020  0.0032    99.915  974.14
  79   0.0377     98.910  0.0034    99.893  986.57
  80   0.0329     99.040  0.0030    99.920  998.98
  81   0.0320     99.090  0.0028    99.917  1011.42
  82   0.0331     99.030  0.0032    99.903  1023.97
  83   0.0355     98.980  0.0031    99.907  1036.40
  84   0.0358     98.920  0.0028    99.918  1048.83
  85   0.0385     98.860  0.0028    99.923  1061.50
  86   0.0348     99.010  0.0026    99.922  1073.92
  87   0.0382     98.940  0.0029    99.902  1086.36
  88   0.0358     99.020  0.0026    99.923  1098.94
  89   0.0336     99.040  0.0021    99.938  1111.38
  90   0.0399     98.910  0.0023    99.933  1123.82
