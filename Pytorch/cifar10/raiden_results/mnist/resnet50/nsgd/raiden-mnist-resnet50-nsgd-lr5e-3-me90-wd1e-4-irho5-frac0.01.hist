Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.8632     68.160  2.7373    32.805  51.57
   2   0.1874     94.050  0.4073    86.403  98.65
   3   0.1209     96.370  0.1559    95.087  145.74
   4   0.0826     97.410  0.1094    96.572  192.79
   5   0.0740     97.670  0.0873    97.310  239.87
   6   0.0760     97.670  0.0753    97.668  286.97
   7   0.0685     97.580  0.0647    97.998  334.03
   8   0.0738     97.670  0.0583    98.222  381.12
   9   0.0816     97.550  0.0515    98.372  428.20
  10   0.0555     98.170  0.0470    98.555  475.30
  11   0.0600     97.930  0.0441    98.613  522.41
  12   0.0508     98.350  0.0432    98.625  569.43
  13   0.0635     98.020  0.0378    98.830  616.49
  14   0.0599     98.220  0.0378    98.823  663.52
  15   0.0477     98.600  0.0350    98.827  710.61
  16   0.0446     98.500  0.0348    98.880  757.65
  17   0.0489     98.510  0.0327    98.980  804.69
  18   0.0389     98.810  0.0320    98.925  851.75
  19   0.0350     98.900  0.0293    99.063  898.75
  20   0.0379     98.770  0.0281    99.070  945.73
  21   0.0423     98.670  0.0269    99.137  992.74
  22   0.0323     99.010  0.0250    99.200  1039.79
  23   0.0416     98.690  0.0245    99.200  1086.87
  24   0.0472     98.600  0.0231    99.217  1133.93
  25   0.0338     98.970  0.0227    99.250  1181.03
  26   0.0306     98.920  0.0226    99.220  1228.14
  27   0.0475     98.620  0.0213    99.292  1275.20
  28   0.0439     98.640  0.0198    99.328  1322.27
  29   0.0407     98.840  0.0207    99.298  1369.34
  30   0.0394     98.870  0.0196    99.312  1416.40
  31   0.0404     98.790  0.0186    99.410  1463.42
  32   0.0435     98.660  0.0193    99.372  1510.48
  33   0.0391     98.900  0.0204    99.303  1557.53
  34   0.0301     99.110  0.0171    99.392  1604.76
  35   0.0316     99.090  0.0176    99.388  1651.80
  36   0.0513     98.440  0.0163    99.440  1698.86
  37   0.0321     99.050  0.0148    99.543  1745.94
  38   0.0403     98.870  0.0158    99.450  1793.00
  39   0.0527     98.450  0.0140    99.562  1840.06
  40   0.0361     98.900  0.0138    99.530  1887.12
  41   0.0365     98.870  0.0135    99.523  1934.20
  42   0.0304     99.170  0.0126    99.583  1981.30
  43   0.0322     99.220  0.0121    99.600  2028.37
  44   0.0413     98.900  0.0125    99.577  2075.48
  45   0.0304     99.130  0.0113    99.597  2122.48
  46   0.0387     98.980  0.0108    99.650  2169.54
  47   0.0432     98.710  0.0114    99.627  2216.55
  48   0.0358     98.950  0.0112    99.638  2263.68
  49   0.0309     99.180  0.0107    99.628  2310.75
  50   0.0335     99.130  0.0100    99.672  2357.80
  51   0.0354     99.110  0.0097    99.692  2404.86
  52   0.0362     99.110  0.0094    99.695  2451.94
  53   0.0323     99.180  0.0084    99.713  2498.97
  54   0.0368     99.070  0.0079    99.727  2545.99
  55   0.0429     98.880  0.0082    99.718  2593.05
  56   0.0398     99.010  0.0082    99.713  2640.35
  57   0.0339     99.050  0.0086    99.697  2687.45
  58   0.0353     99.140  0.0078    99.707  2734.56
  59   0.0377     99.030  0.0076    99.742  2781.58
  60   0.0330     99.120  0.0071    99.760  2828.65
  61   0.0365     99.030  0.0057    99.828  2875.69
  62   0.0332     99.150  0.0060    99.780  2922.74
  63   0.0368     99.140  0.0067    99.757  2969.81
  64   0.0384     98.990  0.0062    99.767  3016.91
  65   0.0349     99.050  0.0062    99.797  3063.96
  66   0.0389     99.040  0.0054    99.812  3111.02
  67   0.0316     99.180  0.0050    99.837  3158.06
  68   0.0351     99.120  0.0050    99.830  3205.11
  69   0.0357     99.140  0.0047    99.828  3252.16
  70   0.0420     99.130  0.0045    99.838  3299.18
  71   0.0364     99.080  0.0046    99.845  3346.23
  72   0.0377     99.070  0.0041    99.870  3393.30
  73   0.0411     99.080  0.0047    99.837  3440.39
  74   0.0384     99.140  0.0041    99.870  3487.50
  75   0.0374     99.110  0.0034    99.892  3534.59
  76   0.0381     99.140  0.0033    99.903  3581.63
  77   0.0415     99.010  0.0036    99.888  3628.65
  78   0.0376     99.190  0.0030    99.918  3675.70
  79   0.0488     98.960  0.0034    99.898  3722.72
  80   0.0427     99.020  0.0032    99.898  3769.81
  81   0.0425     99.070  0.0028    99.910  3816.84
  82   0.0405     99.100  0.0033    99.907  3863.88
  83   0.0537     98.980  0.0026    99.912  3910.97
  84   0.0419     99.060  0.0027    99.917  3958.01
  85   0.0377     99.160  0.0029    99.908  4005.05
  86   0.0425     99.220  0.0029    99.920  4052.12
  87   0.0529     98.880  0.0027    99.918  4099.15
  88   0.0480     98.940  0.0027    99.915  4146.16
  89   0.0446     99.010  0.0028    99.897  4193.20
  90   0.0432     99.130  0.0032    99.908  4240.30
