Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5339     83.310  2.3107    38.752  51.66
   2   0.1459     95.290  0.2733    90.962  99.16
   3   0.1173     96.130  0.1249    96.155  146.42
   4   0.0706     97.690  0.0879    97.295  193.66
   5   0.0535     98.250  0.0713    97.772  240.85
   6   0.0658     97.890  0.0648    97.917  288.07
   7   0.0938     97.160  0.0553    98.235  335.24
   8   0.0432     98.480  0.0513    98.413  382.47
   9   0.0466     98.490  0.0462    98.560  429.72
  10   0.0768     97.550  0.0452    98.545  476.94
  11   0.0518     98.400  0.0417    98.660  524.18
  12   0.0548     98.160  0.0386    98.738  571.43
  13   0.0452     98.510  0.0371    98.828  618.67
  14   0.0432     98.680  0.0352    98.877  665.94
  15   0.0418     98.520  0.0327    98.940  713.15
  16   0.0542     98.210  0.0328    98.868  760.33
  17   0.0521     98.390  0.0315    98.987  807.51
  18   0.0422     98.610  0.0294    99.042  854.77
  19   0.0406     98.720  0.0278    99.102  902.01
  20   0.0393     98.700  0.0273    99.103  949.25
  21   0.0382     98.770  0.0260    99.173  996.52
  22   0.0363     98.820  0.0239    99.232  1043.76
  23   0.0349     98.970  0.0242    99.168  1091.03
  24   0.0342     98.900  0.0227    99.267  1138.23
  25   0.0399     98.790  0.0233    99.185  1185.45
  26   0.0343     98.920  0.0219    99.267  1232.65
  27   0.0467     98.540  0.0207    99.303  1279.85
  28   0.0499     98.560  0.0212    99.277  1327.12
  29   0.0373     98.830  0.0206    99.307  1374.35
  30   0.0462     98.650  0.0196    99.375  1421.60
  31   0.0363     98.910  0.0186    99.357  1468.81
  32   0.0285     99.170  0.0180    99.402  1515.98
  33   0.0370     98.910  0.0168    99.455  1563.18
  34   0.0336     98.930  0.0165    99.453  1610.40
  35   0.0351     98.930  0.0167    99.418  1657.69
  36   0.0319     99.040  0.0165    99.417  1704.98
  37   0.0382     98.870  0.0136    99.548  1752.25
  38   0.0306     99.090  0.0151    99.473  1799.55
  39   0.0297     99.080  0.0149    99.485  1846.80
  40   0.0374     98.890  0.0131    99.558  1893.99
  41   0.0414     98.850  0.0122    99.607  1941.21
  42   0.0391     98.780  0.0141    99.522  1988.63
  43   0.0365     98.970  0.0123    99.603  2035.85
  44   0.0303     99.080  0.0116    99.623  2083.13
  45   0.0383     98.790  0.0107    99.647  2130.34
  46   0.0351     99.090  0.0109    99.620  2177.56
  47   0.0310     98.990  0.0110    99.623  2224.81
  48   0.0419     98.780  0.0104    99.662  2272.09
  49   0.0354     98.940  0.0103    99.667  2319.34
  50   0.0337     98.930  0.0100    99.655  2366.54
  51   0.0294     99.080  0.0084    99.717  2413.75
  52   0.0350     98.870  0.0087    99.720  2460.99
  53   0.0398     99.000  0.0084    99.725  2508.17
  54   0.0325     99.100  0.0074    99.740  2555.38
  55   0.0352     98.950  0.0082    99.727  2602.62
  56   0.0360     98.830  0.0079    99.722  2649.87
  57   0.0324     99.100  0.0071    99.767  2697.10
  58   0.0340     99.030  0.0073    99.745  2744.35
  59   0.0294     99.080  0.0069    99.755  2791.64
  60   0.0294     99.100  0.0067    99.757  2838.84
  61   0.0344     99.050  0.0065    99.807  2886.05
  62   0.0340     99.050  0.0061    99.777  2933.29
  63   0.0363     98.950  0.0061    99.792  2980.52
  64   0.0330     99.110  0.0055    99.825  3027.72
  65   0.0346     99.120  0.0054    99.820  3075.00
  66   0.0386     99.000  0.0051    99.837  3122.29
  67   0.0355     99.030  0.0049    99.827  3169.51
  68   0.0371     99.020  0.0052    99.818  3216.72
  69   0.0326     99.130  0.0049    99.825  3263.90
  70   0.0354     99.130  0.0041    99.878  3311.10
  71   0.0338     99.060  0.0048    99.832  3358.30
  72   0.0337     99.060  0.0042    99.858  3405.77
  73   0.0385     99.100  0.0047    99.845  3453.02
  74   0.0315     99.130  0.0040    99.880  3500.26
  75   0.0393     99.020  0.0042    99.857  3547.48
  76   0.0407     99.030  0.0035    99.887  3594.75
  77   0.0420     98.960  0.0032    99.893  3641.91
  78   0.0357     99.080  0.0033    99.885  3689.11
  79   0.0320     99.090  0.0032    99.883  3736.40
  80   0.0443     98.930  0.0034    99.887  3783.68
  81   0.0336     99.090  0.0033    99.890  3830.94
  82   0.0421     99.010  0.0033    99.883  3878.21
  83   0.0506     98.720  0.0034    99.895  3925.50
  84   0.0409     98.970  0.0030    99.910  3972.75
  85   0.0384     99.030  0.0023    99.922  4019.95
  86   0.0394     98.980  0.0027    99.918  4067.17
  87   0.0360     99.180  0.0028    99.913  4114.62
  88   0.0420     98.950  0.0027    99.902  4161.85
  89   0.0335     99.110  0.0027    99.922  4209.05
  90   0.0407     98.930  0.0026    99.923  4256.32
