Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.6003     44.660  1.9108    28.883  51.83
   2   0.8780     71.000  1.2635    57.112  99.21
   3   0.5404     82.050  0.6926    77.713  146.35
   4   0.3410     89.100  0.4413    86.357  193.55
   5   0.2611     91.810  0.3210    90.250  240.72
   6   0.2186     92.840  0.2512    92.383  287.90
   7   0.2032     93.660  0.2090    93.600  335.04
   8   0.1549     94.950  0.1801    94.340  382.20
   9   0.1438     95.320  0.1627    94.885  429.33
  10   0.1316     95.830  0.1442    95.485  476.47
  11   0.1323     95.580  0.1329    95.820  523.81
  12   0.1291     95.580  0.1229    96.130  571.03
  13   0.1244     95.940  0.1145    96.458  618.21
  14   0.1011     96.630  0.1077    96.623  665.37
  15   0.1020     96.710  0.1013    96.828  712.54
  16   0.0962     96.880  0.0944    97.020  759.67
  17   0.0906     97.020  0.0906    97.142  806.82
  18   0.0935     96.930  0.0860    97.287  853.97
  19   0.0822     97.420  0.0803    97.460  901.18
  20   0.0900     97.000  0.0790    97.498  948.31
  21   0.0790     97.350  0.0753    97.638  995.54
  22   0.0762     97.630  0.0726    97.728  1042.70
  23   0.0817     97.500  0.0680    97.800  1089.89
  24   0.0891     97.000  0.0674    97.888  1137.05
  25   0.0744     97.470  0.0641    97.997  1184.17
  26   0.0728     97.480  0.0619    98.020  1231.32
  27   0.0688     97.700  0.0597    98.053  1278.49
  28   0.0660     97.890  0.0582    98.190  1325.64
  29   0.0751     97.610  0.0576    98.153  1372.81
  30   0.0677     97.760  0.0549    98.255  1420.05
  31   0.0655     97.810  0.0525    98.380  1467.19
  32   0.0656     97.780  0.0525    98.397  1514.31
  33   0.0654     97.930  0.0498    98.432  1561.44
  34   0.0557     98.230  0.0499    98.392  1608.56
  35   0.0545     98.260  0.0482    98.478  1655.70
  36   0.0630     97.840  0.0469    98.553  1702.82
  37   0.0584     98.030  0.0461    98.533  1749.94
  38   0.0631     97.810  0.0457    98.517  1797.13
  39   0.0589     98.120  0.0446    98.598  1844.37
  40   0.0523     98.200  0.0422    98.683  1891.52
  41   0.0626     97.960  0.0420    98.693  1938.64
  42   0.0515     98.290  0.0402    98.727  1985.75
  43   0.0535     98.290  0.0390    98.758  2032.93
  44   0.0527     98.190  0.0398    98.737  2080.11
  45   0.0537     98.280  0.0399    98.750  2127.29
  46   0.0581     98.160  0.0376    98.767  2174.44
  47   0.0567     98.080  0.0380    98.788  2221.61
  48   0.0525     98.390  0.0366    98.778  2268.77
  49   0.0515     98.280  0.0360    98.850  2315.92
  50   0.0475     98.450  0.0366    98.855  2363.08
  51   0.0483     98.380  0.0356    98.868  2410.20
  52   0.0499     98.380  0.0344    98.853  2457.47
  53   0.0548     98.290  0.0345    98.945  2504.68
  54   0.0468     98.520  0.0331    98.910  2551.83
  55   0.0421     98.460  0.0326    98.962  2598.98
  56   0.0470     98.490  0.0321    98.945  2646.10
  57   0.0468     98.440  0.0309    98.992  2693.20
  58   0.0477     98.410  0.0308    99.008  2740.35
  59   0.0508     98.310  0.0303    99.050  2787.69
  60   0.0434     98.600  0.0304    99.023  2834.90
  61   0.0513     98.260  0.0296    99.032  2882.07
  62   0.0509     98.430  0.0287    99.068  2929.20
  63   0.0506     98.370  0.0284    99.072  2976.35
  64   0.0472     98.420  0.0289    99.050  3023.45
  65   0.0595     98.030  0.0280    99.120  3070.60
  66   0.0440     98.560  0.0288    99.083  3117.74
  67   0.0430     98.560  0.0280    99.068  3164.91
  68   0.0445     98.540  0.0256    99.178  3212.05
  69   0.0507     98.360  0.0266    99.122  3259.16
  70   0.0453     98.490  0.0263    99.158  3306.29
  71   0.0459     98.470  0.0258    99.148  3353.44
  72   0.0420     98.670  0.0260    99.137  3400.60
  73   0.0425     98.610  0.0248    99.218  3447.67
  74   0.0552     98.250  0.0247    99.220  3494.77
  75   0.0503     98.410  0.0239    99.213  3541.94
  76   0.0506     98.310  0.0241    99.197  3589.16
  77   0.0436     98.460  0.0240    99.218  3636.36
  78   0.0463     98.470  0.0232    99.230  3683.55
  79   0.0394     98.760  0.0225    99.273  3730.71
  80   0.0470     98.510  0.0225    99.275  3777.91
  81   0.0491     98.460  0.0225    99.270  3825.05
  82   0.0450     98.520  0.0222    99.275  3872.18
  83   0.0482     98.360  0.0214    99.300  3919.35
  84   0.0436     98.540  0.0217    99.317  3966.56
  85   0.0440     98.500  0.0219    99.310  4013.80
  86   0.0512     98.430  0.0209    99.300  4061.03
  87   0.0426     98.610  0.0197    99.342  4108.20
  88   0.0385     98.790  0.0217    99.292  4155.41
  89   0.0438     98.600  0.0189    99.372  4202.52
  90   0.0462     98.410  0.0197    99.350  4249.67
