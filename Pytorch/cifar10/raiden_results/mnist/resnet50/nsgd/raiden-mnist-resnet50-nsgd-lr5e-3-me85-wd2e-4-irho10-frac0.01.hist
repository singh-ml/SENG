Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.1028     22.730  3.2241    17.552  52.60
   2   0.5437     80.570  1.4287    47.492  99.53
   3   0.1569     94.790  0.2812    91.100  146.43
   4   0.1333     95.920  0.1586    95.107  193.33
   5   0.0950     96.930  0.1143    96.457  240.22
   6   0.1082     96.580  0.0944    97.075  287.10
   7   0.0742     97.490  0.0851    97.347  333.98
   8   0.0654     97.940  0.0714    97.772  380.82
   9   0.0642     97.780  0.0669    97.887  427.69
  10   0.0631     97.850  0.0626    97.988  474.54
  11   0.0429     98.460  0.0571    98.232  521.58
  12   0.0495     98.380  0.0543    98.280  568.50
  13   0.0480     98.550  0.0502    98.398  615.40
  14   0.0368     98.620  0.0471    98.497  662.31
  15   0.0433     98.620  0.0455    98.552  709.18
  16   0.0488     98.390  0.0434    98.598  756.06
  17   0.0345     98.800  0.0403    98.668  802.91
  18   0.0465     98.360  0.0386    98.788  849.76
  19   0.0473     98.420  0.0375    98.797  896.68
  20   0.0441     98.490  0.0382    98.770  943.60
  21   0.0410     98.500  0.0356    98.863  990.52
  22   0.0317     98.980  0.0336    98.930  1037.35
  23   0.0351     98.760  0.0345    98.885  1084.28
  24   0.0458     98.500  0.0320    98.967  1131.17
  25   0.0398     98.750  0.0289    99.055  1178.07
  26   0.0390     98.690  0.0296    99.042  1224.97
  27   0.0335     98.840  0.0292    99.070  1271.84
  28   0.0360     98.800  0.0261    99.167  1318.37
  29   0.0438     98.510  0.0283    99.080  1365.22
  30   0.0409     98.760  0.0261    99.140  1412.35
  31   0.0374     98.770  0.0241    99.222  1459.23
  32   0.0264     99.020  0.0248    99.178  1506.15
  33   0.0280     99.060  0.0240    99.202  1553.06
  34   0.0337     98.850  0.0229    99.257  1599.95
  35   0.0392     98.800  0.0230    99.267  1646.82
  36   0.0346     98.840  0.0206    99.332  1693.69
  37   0.0318     98.970  0.0214    99.287  1740.57
  38   0.0410     98.720  0.0206    99.315  1787.71
  39   0.0390     98.680  0.0199    99.348  1834.62
  40   0.0370     98.840  0.0201    99.333  1881.54
  41   0.0279     99.090  0.0192    99.373  1928.46
  42   0.0375     98.830  0.0187    99.392  1975.35
  43   0.0268     99.080  0.0173    99.460  2022.24
  44   0.0282     99.030  0.0177    99.407  2069.09
  45   0.0320     98.940  0.0169    99.422  2115.95
  46   0.0337     98.760  0.0174    99.430  2162.87
  47   0.0359     98.890  0.0163    99.452  2209.74
  48   0.0313     98.900  0.0158    99.442  2256.65
  49   0.0391     98.730  0.0150    99.502  2303.51
  50   0.0318     99.040  0.0144    99.527  2350.35
  51   0.0420     98.730  0.0140    99.515  2397.20
  52   0.0287     99.050  0.0134    99.553  2444.11
  53   0.0285     99.060  0.0127    99.547  2491.01
  54   0.0300     99.060  0.0126    99.597  2537.91
  55   0.0347     98.910  0.0122    99.588  2584.80
  56   0.0335     98.990  0.0112    99.597  2631.71
  57   0.0272     99.130  0.0118    99.593  2678.62
  58   0.0297     98.980  0.0114    99.615  2725.55
  59   0.0328     98.960  0.0112    99.612  2772.46
  60   0.0344     98.930  0.0107    99.645  2819.35
  61   0.0301     99.060  0.0107    99.635  2866.26
  62   0.0355     98.930  0.0099    99.655  2913.17
  63   0.0313     99.010  0.0090    99.705  2960.08
  64   0.0284     99.130  0.0095    99.675  3006.98
  65   0.0293     99.030  0.0090    99.692  3053.88
  66   0.0303     99.050  0.0094    99.663  3100.77
  67   0.0323     99.040  0.0086    99.712  3147.66
  68   0.0321     98.960  0.0087    99.727  3194.53
  69   0.0322     99.060  0.0082    99.727  3241.42
  70   0.0376     98.840  0.0081    99.743  3288.33
  71   0.0405     98.790  0.0076    99.758  3335.25
  72   0.0291     99.110  0.0077    99.757  3382.18
  73   0.0289     99.100  0.0075    99.758  3429.20
  74   0.0343     98.890  0.0074    99.737  3475.77
  75   0.0385     98.950  0.0070    99.777  3522.64
  76   0.0295     99.140  0.0069    99.750  3569.55
  77   0.0378     98.940  0.0075    99.750  3616.39
  78   0.0418     98.810  0.0065    99.783  3663.27
  79   0.0318     99.030  0.0064    99.782  3710.23
  80   0.0411     98.920  0.0064    99.787  3757.15
  81   0.0356     99.020  0.0063    99.790  3804.08
  82   0.0389     98.850  0.0065    99.763  3851.00
  83   0.0481     98.650  0.0061    99.807  3897.93
  84   0.0280     99.230  0.0067    99.743  3944.82
  85   0.0320     99.050  0.0055    99.827  3991.73
