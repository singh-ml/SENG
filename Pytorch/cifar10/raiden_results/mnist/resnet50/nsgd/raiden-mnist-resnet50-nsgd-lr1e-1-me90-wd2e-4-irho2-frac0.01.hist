Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3056     12.660  3.3741    11.400  51.58
   2   1.8405     30.390  2.2338    15.420  98.22
   3   0.6586     78.220  1.2468    54.925  144.93
   4   0.2812     91.270  0.4553    85.750  191.63
   5   0.1492     95.420  0.2261    93.145  238.56
   6   0.1045     96.410  0.1566    95.130  285.18
   7   0.1136     96.310  0.1197    96.327  332.10
   8   0.1312     95.920  0.0994    96.942  378.77
   9   0.1056     96.690  0.0875    97.265  425.47
  10   0.0834     97.180  0.0762    97.585  472.50
  11   0.0702     97.830  0.0696    97.860  519.52
  12   0.0699     97.700  0.0654    97.940  566.49
  13   0.0719     97.680  0.0613    98.073  613.54
  14   0.0590     97.970  0.0581    98.153  660.20
  15   0.0568     98.010  0.0535    98.375  706.81
  16   0.0510     98.340  0.0511    98.380  753.43
  17   0.0449     98.510  0.0505    98.388  800.37
  18   0.0588     97.970  0.0483    98.450  847.08
  19   0.0591     97.930  0.0475    98.513  893.72
  20   0.0501     98.390  0.0486    98.475  940.68
  21   0.0527     98.260  0.0454    98.530  987.36
  22   0.0360     98.780  0.0461    98.565  1034.03
  23   0.0510     98.340  0.0423    98.695  1081.01
  24   0.0580     98.010  0.0419    98.715  1127.98
  25   0.0493     98.330  0.0425    98.678  1174.92
  26   0.0506     98.440  0.0404    98.702  1221.89
  27   0.0574     98.000  0.0407    98.680  1268.85
  28   0.0494     98.370  0.0391    98.792  1315.51
  29   0.0372     98.740  0.0370    98.860  1362.19
  30   0.0431     98.590  0.0378    98.835  1409.19
  31   0.0442     98.700  0.0360    98.848  1456.19
  32   0.0380     98.750  0.0347    98.912  1503.29
  33   0.0452     98.480  0.0342    98.932  1550.27
  34   0.0426     98.600  0.0345    98.890  1597.22
  35   0.0310     99.010  0.0339    98.905  1644.13
  36   0.0386     98.760  0.0322    98.970  1691.10
  37   0.0367     98.740  0.0316    98.975  1738.13
  38   0.0350     98.790  0.0299    99.060  1785.11
  39   0.0353     98.790  0.0297    99.033  1832.07
  40   0.0581     98.160  0.0306    99.033  1879.03
  41   0.0317     98.980  0.0301    99.022  1926.02
  42   0.0414     98.680  0.0279    99.075  1972.99
  43   0.0497     98.320  0.0289    99.048  2019.94
  44   0.0406     98.730  0.0256    99.187  2066.91
  45   0.0338     98.970  0.0264    99.182  2113.87
  46   0.0370     98.810  0.0260    99.203  2161.04
  47   0.0414     98.790  0.0240    99.210  2208.07
  48   0.0351     98.880  0.0245    99.207  2255.10
  49   0.0297     99.070  0.0232    99.263  2302.08
  50   0.0358     98.880  0.0241    99.240  2349.07
  51   0.0343     98.870  0.0211    99.325  2396.00
  52   0.0323     98.880  0.0222    99.307  2442.98
  53   0.0294     99.040  0.0193    99.335  2490.03
  54   0.0373     98.750  0.0200    99.322  2537.17
  55   0.0386     98.770  0.0202    99.308  2584.12
  56   0.0326     98.950  0.0182    99.392  2630.79
  57   0.0330     98.910  0.0162    99.477  2677.45
  58   0.0286     99.020  0.0169    99.463  2724.42
  59   0.0353     98.850  0.0153    99.505  2771.41
  60   0.0301     98.930  0.0144    99.533  2818.41
  61   0.0345     98.910  0.0157    99.463  2865.45
  62   0.0271     99.050  0.0127    99.583  2912.39
  63   0.0365     98.850  0.0128    99.575  2959.35
  64   0.0308     98.900  0.0138    99.528  3006.31
  65   0.0294     99.030  0.0110    99.630  3053.32
  66   0.0397     98.890  0.0111    99.642  3100.29
  67   0.0316     99.030  0.0102    99.655  3146.95
  68   0.0280     99.080  0.0099    99.667  3193.93
  69   0.0280     99.120  0.0088    99.710  3240.94
  70   0.0299     98.990  0.0074    99.770  3287.86
  71   0.0329     99.060  0.0074    99.758  3334.59
  72   0.0292     99.120  0.0074    99.753  3381.60
  73   0.0344     99.040  0.0076    99.760  3428.56
  74   0.0278     99.140  0.0061    99.808  3475.52
  75   0.0375     98.910  0.0064    99.795  3522.49
  76   0.0288     99.170  0.0054    99.832  3569.47
  77   0.0356     98.940  0.0049    99.838  3616.47
  78   0.0305     99.060  0.0044    99.858  3663.44
  79   0.0302     99.210  0.0044    99.867  3710.46
  80   0.0314     99.090  0.0042    99.865  3757.44
  81   0.0295     99.120  0.0042    99.873  3804.43
  82   0.0294     99.180  0.0034    99.895  3851.43
  83   0.0331     99.050  0.0033    99.907  3898.41
  84   0.0321     99.090  0.0032    99.898  3945.43
  85   0.0456     98.850  0.0032    99.902  3992.41
  86   0.0338     99.060  0.0027    99.910  4039.40
  87   0.0379     98.950  0.0031    99.902  4086.41
  88   0.0310     99.160  0.0030    99.927  4133.42
  89   0.0346     99.020  0.0029    99.917  4180.40
  90   0.0344     99.070  0.0026    99.922  4227.40
