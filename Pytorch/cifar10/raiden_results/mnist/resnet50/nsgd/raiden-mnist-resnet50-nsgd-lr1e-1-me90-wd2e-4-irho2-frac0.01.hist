Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2984     12.430  3.9137    13.768  51.67
   2   2.2488     17.060  2.1665    19.218  98.54
   3   1.6624     36.860  1.9707    27.348  145.06
   4   0.5455     81.640  0.9918    65.057  191.97
   5   0.2103     93.600  0.3887    87.818  238.82
   6   0.1880     94.000  0.2310    93.028  285.66
   7   0.1589     94.740  0.1745    94.687  332.52
   8   0.1130     96.380  0.1407    95.698  379.44
   9   0.5863     96.830  0.1212    96.215  426.28
  10   0.0906     97.000  0.1074    96.667  473.15
  11   0.0767     97.510  0.0935    97.098  520.00
  12   0.0733     97.680  0.0869    97.280  566.82
  13   0.0806     97.300  0.0793    97.557  613.97
  14   0.0786     97.320  0.0768    97.557  660.82
  15   0.1015     96.540  0.0745    97.682  707.72
  16   0.0623     98.030  0.0674    97.800  754.64
  17   0.0602     98.020  0.0653    97.987  801.52
  18   0.0815     97.560  0.0631    97.998  848.46
  19   0.0695     97.940  0.0607    98.080  895.33
  20   0.2177     96.180  0.0606    98.097  942.09
  21   0.0651     97.890  0.0593    98.038  988.90
  22   0.0680     98.280  0.0558    98.208  1035.74
  23   0.0344     98.760  0.0538    98.328  1082.60
  24   0.0539     98.270  0.0526    98.317  1129.83
  25   0.0590     98.020  0.0509    98.417  1176.70
  26   0.0399     98.690  0.0497    98.443  1223.61
  27   0.0433     98.430  0.0486    98.453  1270.80
  28   0.0387     98.730  0.0458    98.518  1317.68
  29   0.0566     98.080  0.0443    98.558  1364.51
  30   0.0449     98.590  0.0434    98.595  1411.34
  31   0.0497     98.340  0.0418    98.655  1458.16
  32   0.0428     98.590  0.0422    98.637  1505.28
  33   0.0633     98.400  0.0412    98.645  1552.19
  34   0.0466     98.510  0.0408    98.737  1599.38
  35   0.0471     98.450  0.0396    98.735  1646.25
  36   0.0381     98.690  0.0371    98.790  1693.48
  37   0.0306     99.030  0.0373    98.827  1740.34
  38   0.0414     98.690  0.0370    98.832  1787.51
  39   0.0616     97.840  0.0348    98.853  1834.35
  40   0.0461     98.490  0.0346    98.880  1881.24
  41   0.0419     98.700  0.0360    98.813  1928.14
  42   0.0377     98.670  0.0314    98.982  1975.00
  43   0.0448     98.430  0.0326    98.953  2021.87
  44   0.0415     98.600  0.0306    99.022  2068.70
  45   0.0301     98.840  0.0304    99.033  2115.55
  46   0.0298     99.000  0.0298    99.012  2162.40
  47   0.0376     98.710  0.0296    99.040  2209.24
  48   0.0376     98.740  0.0282    99.107  2256.39
  49   0.0359     98.730  0.0279    99.085  2303.29
  50   0.1243     97.880  0.0266    99.147  2350.54
  51   0.0334     98.980  0.0265    99.140  2397.42
  52   0.0308     99.090  0.0237    99.238  2444.29
  53   0.0338     98.870  0.0249    99.173  2491.12
  54   0.0377     98.790  0.0225    99.285  2537.95
  55   0.0417     98.630  0.0220    99.285  2585.13
  56   0.0355     98.730  0.0223    99.272  2632.30
  57   0.0282     99.040  0.0210    99.308  2679.54
  58   0.0371     98.770  0.0196    99.382  2726.75
  59   0.0316     98.910  0.0197    99.347  2773.67
  60   0.0322     98.860  0.0196    99.378  2820.54
  61   0.0252     99.140  0.0165    99.448  2867.40
  62   0.0268     99.100  0.0166    99.462  2914.59
  63   0.0326     99.010  0.0159    99.505  2961.75
  64   0.0339     98.980  0.0153    99.525  3008.89
  65   0.0252     99.100  0.0143    99.540  3056.12
  66   0.0293     99.110  0.0132    99.595  3102.99
  67   0.0221     99.210  0.0131    99.567  3150.19
  68   0.0236     99.190  0.0127    99.593  3197.42
  69   0.0299     99.010  0.0118    99.642  3244.65
  70   0.0230     99.260  0.0112    99.638  3291.51
  71   0.0292     99.000  0.0102    99.698  3338.68
  72   0.0322     99.120  0.0090    99.740  3385.85
  73   0.0297     99.050  0.0090    99.723  3432.95
  74   0.0232     99.210  0.0087    99.730  3480.17
  75   0.0313     99.010  0.0080    99.752  3527.41
  76   0.0282     99.080  0.0079    99.735  3574.29
  77   0.0292     99.080  0.0070    99.783  3621.43
  78   0.0234     99.280  0.0073    99.772  3668.58
  79   0.0252     99.240  0.0064    99.817  3715.44
  80   0.0247     99.110  0.0063    99.827  3762.29
  81   0.0235     99.230  0.0064    99.828  3809.17
  82   0.0229     99.210  0.0062    99.807  3856.33
  83   0.0238     99.130  0.0058    99.843  3903.54
  84   0.0239     99.250  0.0058    99.832  3950.42
  85   0.0251     99.200  0.0051    99.862  3997.30
  86   0.0278     99.120  0.0053    99.855  4044.53
  87   0.0229     99.260  0.0050    99.875  4091.76
  88   0.0236     99.240  0.0052    99.878  4138.94
  89   0.0232     99.230  0.0052    99.873  4186.07
  90   0.0237     99.240  0.0052    99.880  4233.23
