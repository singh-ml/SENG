Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.0869     24.520  3.9279    12.917  51.60
   2   1.0753     63.610  1.5592    44.160  98.33
   3   0.4610     85.280  0.6943    77.537  145.06
   4   0.2737     91.580  0.3533    89.343  191.76
   5   0.2071     93.580  0.2337    92.920  238.53
   6   0.1865     93.750  0.1882    94.313  285.25
   7   0.1228     96.060  0.1538    95.213  331.65
   8   0.1074     96.650  0.1387    95.790  378.38
   9   0.1096     96.460  0.1197    96.302  425.07
  10   0.0877     97.200  0.1072    96.633  471.80
  11   0.1062     96.400  0.1005    96.787  518.49
  12   0.1262     95.900  0.0910    97.100  565.17
  13   0.1108     96.350  0.0865    97.320  612.13
  14   0.0782     97.370  0.0810    97.458  658.87
  15   0.0729     97.480  0.0758    97.637  705.61
  16   0.0799     97.410  0.0697    97.813  752.39
  17   0.0620     97.920  0.0691    97.852  799.14
  18   0.0779     97.620  0.0668    97.925  845.91
  19   0.0636     97.900  0.0616    98.037  892.63
  20   0.0502     98.220  0.0610    98.040  939.33
  21   0.0683     97.870  0.0596    98.125  985.99
  22   0.0573     98.200  0.0528    98.327  1032.69
  23   0.0509     98.350  0.0527    98.327  1079.64
  24   0.0715     97.750  0.0511    98.405  1126.40
  25   0.0743     97.610  0.0501    98.383  1173.10
  26   0.0449     98.520  0.0486    98.453  1219.87
  27   0.0477     98.440  0.0466    98.535  1266.60
  28   0.0499     98.430  0.0444    98.563  1313.32
  29   0.0594     98.030  0.0453    98.550  1360.03
  30   0.0415     98.630  0.0439    98.608  1406.79
  31   0.0563     98.030  0.0428    98.623  1453.16
  32   0.0434     98.500  0.0412    98.735  1499.55
  33   0.0457     98.520  0.0411    98.722  1546.29
  34   0.0417     98.720  0.0391    98.717  1593.25
  35   0.0443     98.550  0.0382    98.785  1640.01
  36   0.0386     98.850  0.0359    98.853  1686.77
  37   0.0419     98.550  0.0353    98.858  1733.52
  38   0.0451     98.560  0.0359    98.870  1780.27
  39   0.0387     98.660  0.0347    98.837  1826.98
  40   0.0376     98.760  0.0324    98.940  1873.74
  41   0.0362     98.870  0.0326    98.928  1920.44
  42   0.0431     98.720  0.0329    98.922  1967.15
  43   0.0416     98.720  0.0296    99.015  2013.85
  44   0.0437     98.480  0.0287    99.067  2060.57
  45   0.0474     98.470  0.0298    99.022  2107.29
  46   0.0451     98.610  0.0285    99.077  2154.00
  47   0.0463     98.520  0.0268    99.115  2200.72
  48   0.0392     98.780  0.0264    99.148  2247.48
  49   0.0331     98.890  0.0255    99.135  2294.41
  50   0.0379     98.740  0.0254    99.173  2341.37
  51   0.0388     98.720  0.0253    99.172  2388.12
  52   0.0383     98.710  0.0223    99.267  2434.82
  53   0.0397     98.690  0.0232    99.248  2481.53
  54   0.0438     98.550  0.0222    99.237  2528.26
  55   0.0386     98.720  0.0212    99.323  2574.95
  56   0.0424     98.720  0.0201    99.333  2621.64
  57   0.0374     98.780  0.0210    99.300  2668.36
  58   0.0345     98.840  0.0193    99.395  2715.19
  59   0.0374     98.910  0.0183    99.417  2761.92
  60   0.0332     98.870  0.0180    99.392  2808.65
  61   0.0381     98.630  0.0174    99.425  2855.40
  62   0.0376     98.770  0.0164    99.462  2902.13
  63   0.0380     98.710  0.0159    99.495  2948.81
  64   0.0369     98.850  0.0163    99.453  2995.52
  65   0.0319     99.090  0.0144    99.567  3042.29
  66   0.0334     98.990  0.0142    99.520  3089.05
  67   0.0325     98.880  0.0145    99.527  3135.77
  68   0.0355     98.790  0.0137    99.538  3182.48
  69   0.0322     98.980  0.0127    99.607  3229.23
  70   0.0352     98.850  0.0123    99.615  3275.98
  71   0.0302     98.930  0.0124    99.592  3322.71
  72   0.0344     98.990  0.0118    99.618  3369.42
  73   0.0316     98.990  0.0111    99.633  3416.15
  74   0.0297     98.980  0.0114    99.617  3462.88
  75   0.0315     98.940  0.0103    99.673  3509.61
  76   0.0336     99.020  0.0101    99.682  3556.36
  77   0.0292     99.070  0.0102    99.675  3603.12
  78   0.0311     99.010  0.0099    99.693  3649.92
  79   0.0377     98.830  0.0097    99.690  3696.65
  80   0.0331     98.940  0.0096    99.692  3743.40
  81   0.0299     99.000  0.0097    99.697  3790.12
  82   0.0368     98.840  0.0093    99.698  3836.84
  83   0.0332     98.960  0.0102    99.682  3883.58
  84   0.0305     99.060  0.0095    99.698  3930.33
  85   0.0316     99.050  0.0093    99.708  3977.11
