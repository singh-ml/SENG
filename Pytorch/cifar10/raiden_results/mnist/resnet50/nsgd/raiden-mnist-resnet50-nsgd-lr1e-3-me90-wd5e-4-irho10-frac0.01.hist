Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5506     80.020  1.9409    45.767  52.86
   2   0.1124     96.350  0.2396    92.438  100.12
   3   0.1062     96.510  0.1237    96.148  147.35
   4   0.0774     97.470  0.0857    97.332  194.56
   5   0.0924     97.200  0.0715    97.757  241.71
   6   0.0547     98.260  0.0631    97.997  288.93
   7   0.0623     97.940  0.0574    98.183  336.11
   8   0.0550     98.270  0.0511    98.393  383.35
   9   0.0558     98.140  0.0459    98.588  430.61
  10   0.0459     98.510  0.0432    98.632  477.85
  11   0.0475     98.540  0.0416    98.740  525.07
  12   0.0395     98.670  0.0385    98.747  572.30
  13   0.0432     98.680  0.0374    98.850  619.53
  14   0.0468     98.590  0.0327    98.927  666.77
  15   0.0472     98.530  0.0335    98.875  713.97
  16   0.0441     98.630  0.0314    99.022  761.16
  17   0.0707     98.040  0.0282    99.078  808.34
  18   0.0439     98.640  0.0286    99.070  855.58
  19   0.0383     98.810  0.0279    99.083  902.79
  20   0.0463     98.400  0.0282    99.088  950.06
  21   0.0378     98.840  0.0263    99.157  997.32
  22   0.0442     98.630  0.0247    99.202  1044.52
  23   0.0488     98.490  0.0230    99.258  1091.73
  24   0.0404     98.660  0.0233    99.212  1138.92
  25   0.0376     98.790  0.0220    99.330  1186.10
  26   0.0420     98.630  0.0224    99.303  1233.28
  27   0.0586     98.100  0.0213    99.303  1280.50
  28   0.0366     98.820  0.0215    99.280  1327.69
  29   0.0397     98.850  0.0199    99.378  1374.93
  30   0.0382     98.790  0.0191    99.357  1422.17
  31   0.0340     99.050  0.0172    99.425  1469.35
  32   0.0480     98.670  0.0185    99.413  1516.56
  33   0.0390     98.900  0.0182    99.388  1563.81
  34   0.0370     98.890  0.0183    99.385  1610.99
  35   0.0527     98.400  0.0169    99.460  1658.17
  36   0.0366     98.910  0.0172    99.425  1705.39
  37   0.0409     98.700  0.0167    99.437  1752.26
  38   0.0381     98.800  0.0154    99.487  1799.47
  39   0.0373     98.930  0.0142    99.513  1846.63
  40   0.0474     98.610  0.0166    99.460  1893.76
  41   0.0268     99.160  0.0151    99.485  1941.22
  42   0.0288     99.080  0.0155    99.493  1988.44
  43   0.0372     98.890  0.0141    99.497  2035.66
  44   0.0377     98.910  0.0136    99.533  2082.86
  45   0.0598     98.300  0.0136    99.562  2130.05
  46   0.0362     98.960  0.0131    99.578  2177.29
  47   0.0435     98.610  0.0131    99.568  2224.50
  48   0.0370     99.050  0.0126    99.550  2271.71
  49   0.0440     98.910  0.0114    99.642  2318.96
  50   0.0394     98.880  0.0108    99.655  2366.20
  51   0.0347     98.980  0.0109    99.630  2413.40
  52   0.0498     98.530  0.0119    99.582  2460.57
  53   0.0341     98.970  0.0132    99.573  2507.76
  54   0.0415     98.840  0.0114    99.637  2554.97
  55   0.0418     98.790  0.0120    99.605  2602.16
  56   0.0399     98.880  0.0107    99.635  2649.35
  57   0.0350     99.000  0.0105    99.648  2696.51
  58   0.0392     98.960  0.0094    99.662  2743.78
  59   0.0401     98.830  0.0101    99.665  2790.99
  60   0.0406     98.860  0.0105    99.638  2838.34
  61   0.0370     99.000  0.0095    99.663  2885.51
  62   0.0413     98.970  0.0098    99.675  2932.73
  63   0.0297     99.230  0.0090    99.715  2979.94
  64   0.0387     98.960  0.0104    99.665  3027.19
  65   0.0402     98.820  0.0099    99.657  3074.41
  66   0.0345     99.150  0.0082    99.730  3121.62
  67   0.0412     98.890  0.0091    99.660  3168.85
  68   0.0616     98.430  0.0084    99.717  3216.06
  69   0.0403     98.980  0.0091    99.670  3263.27
  70   0.0360     99.030  0.0087    99.688  3310.50
  71   0.0346     99.030  0.0085    99.705  3357.71
  72   0.0349     99.000  0.0083    99.710  3404.89
  73   0.0437     98.810  0.0081    99.700  3452.06
  74   0.0372     98.890  0.0078    99.738  3499.27
  75   0.0307     99.140  0.0078    99.728  3546.69
  76   0.0424     98.830  0.0080    99.720  3593.91
  77   0.0352     99.010  0.0072    99.740  3641.13
  78   0.0397     99.010  0.0083    99.693  3688.40
  79   0.0442     98.820  0.0078    99.735  3735.63
  80   0.0369     99.020  0.0075    99.715  3782.86
  81   0.0490     98.710  0.0086    99.680  3830.26
  82   0.0319     99.010  0.0088    99.693  3877.78
  83   0.0316     99.050  0.0060    99.797  3925.00
  84   0.0477     98.840  0.0071    99.762  3972.21
  85   0.0409     98.820  0.0057    99.812  4019.64
  86   0.0445     98.820  0.0067    99.745  4066.88
  87   0.0442     98.910  0.0066    99.777  4114.14
  88   0.0422     98.870  0.0059    99.798  4161.35
  89   0.0346     99.080  0.0059    99.805  4208.65
  90   0.0306     99.190  0.0054    99.827  4255.89
