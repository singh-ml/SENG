Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2408     92.470  1.8240    55.717  51.68
   2   0.1067     96.540  0.1895    94.252  98.74
   3   0.0828     97.140  0.1146    96.457  145.82
   4   0.0675     97.730  0.0874    97.287  192.86
   5   0.0598     98.150  0.0755    97.650  240.09
   6   0.0724     97.730  0.0648    97.930  287.13
   7   0.0621     97.930  0.0559    98.200  334.21
   8   0.1070     96.850  0.0521    98.415  381.30
   9   0.0510     98.280  0.0495    98.438  428.32
  10   0.0611     98.080  0.0449    98.530  475.37
  11   0.0566     98.150  0.0424    98.620  522.41
  12   0.0473     98.450  0.0407    98.677  569.42
  13   0.0447     98.600  0.0396    98.735  616.54
  14   0.0418     98.620  0.0364    98.823  663.62
  15   0.0777     97.600  0.0347    98.870  710.68
  16   0.0411     98.700  0.0345    98.913  757.79
  17   0.0453     98.640  0.0305    98.992  804.85
  18   0.0509     98.420  0.0295    99.060  851.88
  19   0.0449     98.460  0.0282    99.095  898.93
  20   0.0369     98.820  0.0279    99.103  946.08
  21   0.0481     98.580  0.0281    99.098  993.15
  22   0.0368     98.790  0.0268    99.137  1040.23
  23   0.0513     98.470  0.0257    99.182  1087.27
  24   0.0460     98.510  0.0249    99.197  1134.33
  25   0.0355     98.850  0.0242    99.227  1181.37
  26   0.0426     98.520  0.0226    99.252  1228.42
  27   0.0469     98.600  0.0225    99.243  1275.46
  28   0.0331     99.000  0.0215    99.292  1322.60
  29   0.0452     98.610  0.0199    99.298  1369.65
  30   0.0366     98.840  0.0212    99.300  1416.66
  31   0.0516     98.480  0.0195    99.337  1463.73
  32   0.0341     98.920  0.0173    99.438  1510.79
  33   0.0547     98.340  0.0187    99.407  1557.82
  34   0.0383     98.870  0.0189    99.338  1604.86
  35   0.0480     98.470  0.0181    99.415  1651.89
  36   0.0304     99.090  0.0174    99.428  1698.94
  37   0.0336     98.930  0.0151    99.490  1745.96
  38   0.0363     98.980  0.0169    99.408  1793.04
  39   0.0423     98.690  0.0162    99.443  1840.13
  40   0.0464     98.730  0.0153    99.465  1887.20
  41   0.0358     98.890  0.0143    99.537  1934.30
  42   0.0332     98.950  0.0147    99.530  1981.33
  43   0.0369     98.800  0.0148    99.502  2028.36
  44   0.0319     99.040  0.0149    99.527  2075.43
  45   0.0496     98.540  0.0137    99.533  2122.48
  46   0.0346     98.980  0.0132    99.548  2169.51
  47   0.0259     99.250  0.0133    99.547  2216.54
  48   0.0333     99.010  0.0124    99.550  2263.56
  49   0.0455     98.740  0.0135    99.540  2310.67
  50   0.0419     98.740  0.0123    99.573  2357.71
  51   0.0388     98.860  0.0120    99.592  2404.78
  52   0.0263     99.130  0.0105    99.640  2451.88
  53   0.0376     98.870  0.0126    99.570  2498.93
  54   0.0371     98.730  0.0117    99.612  2546.01
  55   0.0360     98.930  0.0131    99.532  2593.06
  56   0.0515     98.660  0.0108    99.637  2640.07
  57   0.0484     98.650  0.0106    99.647  2687.10
  58   0.0348     99.080  0.0104    99.622  2734.19
  59   0.0368     98.980  0.0114    99.615  2781.25
  60   0.0397     98.980  0.0100    99.637  2828.31
  61   0.0471     98.760  0.0088    99.702  2875.37
  62   0.0522     98.600  0.0093    99.700  2922.41
  63   0.0365     98.960  0.0101    99.660  2969.44
  64   0.0385     98.930  0.0092    99.682  3016.49
  65   0.0448     98.830  0.0096    99.685  3063.54
  66   0.0315     99.060  0.0091    99.695  3110.58
  67   0.0483     98.690  0.0089    99.700  3157.64
  68   0.0539     98.460  0.0110    99.650  3204.71
  69   0.0362     98.890  0.0073    99.727  3251.78
  70   0.0351     98.950  0.0079    99.743  3298.83
  71   0.0469     98.720  0.0083    99.710  3345.90
  72   0.0399     98.910  0.0080    99.755  3392.99
  73   0.0431     98.770  0.0073    99.745  3440.03
  74   0.0357     99.020  0.0082    99.713  3487.09
  75   0.0416     98.930  0.0079    99.767  3534.34
  76   0.0429     98.820  0.0084    99.703  3581.41
  77   0.0351     99.150  0.0068    99.768  3628.48
  78   0.0323     99.160  0.0065    99.772  3675.52
  79   0.0423     98.940  0.0069    99.773  3722.57
  80   0.0425     98.790  0.0082    99.717  3769.61
  81   0.0471     98.800  0.0068    99.750  3816.64
  82   0.0317     99.080  0.0070    99.770  3863.69
  83   0.0428     98.800  0.0060    99.803  3911.02
  84   0.0318     99.050  0.0059    99.798  3958.12
  85   0.0453     98.880  0.0069    99.782  4005.21
  86   0.0457     98.860  0.0072    99.737  4052.26
  87   0.0418     98.900  0.0061    99.787  4099.27
  88   0.0303     99.150  0.0062    99.768  4146.35
  89   0.0441     99.000  0.0069    99.760  4193.37
  90   0.0448     98.940  0.0070    99.757  4240.39
