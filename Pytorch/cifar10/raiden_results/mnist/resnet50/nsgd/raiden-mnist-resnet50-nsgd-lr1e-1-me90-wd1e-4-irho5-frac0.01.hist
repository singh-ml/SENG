Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3030     11.410  3.7914    10.627  52.14
   2   2.3013     11.460  2.3057    10.550  97.37
   3   2.3026     11.760  2.3057    10.507  142.55
   4   2.3048     11.430  2.3063    10.535  189.87
   5   2.3045     11.360  2.3049    10.598  236.86
   6   2.3052      9.800  2.3059    10.440  284.13
   7   2.3039      9.650  2.3053    10.315  329.32
   8   2.3066     10.130  2.3054    10.527  376.30
   9   2.2986      9.170  2.3045    10.683  423.63
  10   2.0106     19.110  2.1364    17.795  470.60
  11   1.0891     61.100  1.4808    44.902  517.88
  12   0.7382     76.890  0.8716    69.545  564.83
  13   0.3535     88.730  0.4557    84.262  612.13
  14   0.2139     93.450  0.2745    91.453  659.40
  15   0.1331     95.990  0.1668    95.043  706.31
  16   0.1013     97.130  0.1258    96.192  753.55
  17   0.1070     96.750  0.1098    96.542  800.84
  18   0.0970     96.920  0.0989    97.022  848.11
  19   0.0817     97.670  0.0895    97.258  895.38
  20   0.0769     97.800  0.0768    97.603  942.70
  21   0.0834     97.560  0.0721    97.742  989.99
  22   0.0726     97.790  0.0713    97.860  1037.31
  23   0.0787     97.740  0.0635    98.060  1084.62
  24   0.0667     97.920  0.0648    97.983  1131.84
  25   0.0677     97.770  0.0575    98.237  1179.15
  26   0.0528     98.290  0.0571    98.220  1226.47
  27   0.0546     98.180  0.0523    98.352  1273.77
  28   0.0681     97.940  0.0505    98.445  1321.10
  29   0.0548     98.290  0.0493    98.445  1368.43
  30   0.0538     98.390  0.0456    98.595  1415.71
  31   0.0610     98.200  0.0462    98.595  1463.03
  32   0.0540     98.400  0.0426    98.667  1510.33
  33   0.0694     97.990  0.0421    98.682  1557.62
  34   0.0497     98.480  0.0403    98.750  1604.92
  35   0.0548     98.200  0.0400    98.712  1652.21
  36   0.0526     98.390  0.0379    98.837  1699.23
  37   0.0443     98.620  0.0373    98.848  1746.53
  38   0.0495     98.480  0.0369    98.755  1793.51
  39   0.0489     98.550  0.0332    98.967  1840.82
  40   0.0474     98.620  0.0357    98.903  1888.11
  41   0.0403     98.720  0.0325    99.008  1935.40
  42   0.0476     98.560  0.0308    99.005  1982.66
  43   0.0390     98.840  0.0309    99.012  2029.99
  44   0.0361     98.860  0.0297    99.080  2077.32
  45   0.0375     98.730  0.0285    99.100  2124.65
  46   0.0434     98.640  0.0282    99.058  2171.62
  47   0.0460     98.640  0.0268    99.210  2218.94
  48   0.0468     98.620  0.0276    99.140  2266.21
  49   0.0359     99.000  0.0244    99.223  2313.51
  50   0.0372     98.780  0.0240    99.215  2360.80
  51   0.0346     98.900  0.0218    99.285  2408.11
  52   0.0571     98.370  0.0215    99.307  2455.44
  53   0.0349     99.000  0.0218    99.347  2502.78
  54   0.0421     98.630  0.0212    99.333  2550.13
  55   0.0369     98.820  0.0203    99.317  2597.45
  56   0.0491     98.620  0.0184    99.415  2644.77
  57   0.0363     98.860  0.0183    99.383  2692.05
  58   0.0416     98.790  0.0174    99.398  2739.37
  59   0.0398     98.830  0.0171    99.437  2786.67
  60   0.0334     98.980  0.0177    99.415  2834.24
  61   0.0370     98.950  0.0168    99.465  2881.58
  62   0.0385     98.880  0.0146    99.548  2928.89
  63   0.0385     98.830  0.0140    99.562  2976.21
  64   0.0308     99.060  0.0132    99.575  3023.55
  65   0.0420     98.720  0.0123    99.598  3070.86
  66   0.0461     98.690  0.0114    99.637  3118.16
  67   0.0390     98.790  0.0109    99.645  3165.43
  68   0.0337     99.070  0.0106    99.632  3212.73
  69   0.0330     98.960  0.0104    99.667  3260.04
  70   0.0353     99.040  0.0099    99.683  3307.37
  71   0.0355     99.010  0.0097    99.708  3354.70
  72   0.0345     98.980  0.0085    99.723  3402.06
  73   0.0369     98.900  0.0082    99.735  3449.36
  74   0.0441     98.880  0.0084    99.732  3496.66
  75   0.0348     98.990  0.0083    99.742  3543.94
  76   0.0337     98.990  0.0071    99.777  3591.22
  77   0.0337     99.090  0.0070    99.768  3638.71
  78   0.0361     99.100  0.0065    99.787  3685.98
  79   0.0443     98.890  0.0065    99.795  3733.32
  80   0.0438     98.960  0.0067    99.783  3780.61
  81   0.0548     98.570  0.0061    99.817  3827.89
  82   0.0382     98.840  0.0058    99.808  3875.20
  83   0.0401     98.930  0.0054    99.817  3922.46
  84   0.0353     98.970  0.0053    99.843  3969.76
  85   0.0372     99.010  0.0058    99.798  4017.54
  86   0.0350     99.000  0.0051    99.848  4064.89
  87   0.0361     98.980  0.0051    99.845  4112.22
  88   0.0377     99.000  0.0052    99.845  4159.21
  89   0.0391     98.940  0.0050    99.845  4206.52
  90   0.0388     98.960  0.0049    99.872  4253.78
