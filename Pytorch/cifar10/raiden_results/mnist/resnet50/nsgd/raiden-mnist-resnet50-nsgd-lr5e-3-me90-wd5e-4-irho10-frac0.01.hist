Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3155     12.430  3.5272    12.165  52.91
   2   1.6613     36.720  2.0660    22.713  99.81
   3   0.5356     80.510  1.1349    58.067  146.81
   4   0.2462     92.470  0.3984    86.820  193.80
   5   0.5394     92.350  0.2008    93.768  240.82
   6   0.1310     96.020  0.1416    95.627  287.81
   7   0.1257     96.300  0.1082    96.600  334.82
   8   0.0979     96.920  0.0880    97.300  381.80
   9   0.0670     97.640  0.0779    97.582  429.10
  10   0.1009     96.760  0.0707    97.797  476.11
  11   0.0756     97.290  0.0653    97.937  523.10
  12   0.0549     98.040  0.0596    98.092  570.13
  13   0.0733     97.570  0.0575    98.222  617.16
  14   0.0753     97.710  0.0533    98.327  664.16
  15   0.0583     98.080  0.0501    98.393  710.82
  16   0.0648     97.910  0.0463    98.517  757.97
  17   0.0508     98.290  0.0449    98.603  804.68
  18   0.0444     98.440  0.0439    98.595  851.68
  19   0.0543     98.370  0.0405    98.730  898.73
  20   0.0460     98.340  0.0407    98.685  945.78
  21   0.0343     98.870  0.0389    98.767  992.74
  22   0.0347     98.810  0.0360    98.855  1039.67
  23   0.0414     98.620  0.0362    98.878  1086.65
  24   0.0363     98.800  0.0328    98.912  1133.60
  25   0.0446     98.570  0.0315    98.965  1180.58
  26   0.0547     98.440  0.0328    98.957  1227.53
  27   0.0415     98.570  0.0310    98.980  1274.57
  28   0.0768     97.730  0.0305    99.018  1321.63
  29   0.0419     98.520  0.0294    99.042  1368.67
  30   0.0387     98.740  0.0274    99.093  1415.73
  31   0.0424     98.720  0.0265    99.172  1462.82
  32   0.0530     98.320  0.0256    99.182  1509.81
  33   0.0414     98.650  0.0254    99.162  1556.88
  34   0.0397     98.650  0.0238    99.205  1603.95
  35   0.0334     98.930  0.0231    99.240  1651.01
  36   0.0569     98.200  0.0231    99.193  1698.04
  37   0.0578     98.370  0.0235    99.222  1745.10
  38   0.0437     98.630  0.0221    99.257  1792.19
  39   0.0380     98.880  0.0241    99.188  1839.24
  40   0.0486     98.490  0.0220    99.255  1886.26
  41   0.0342     98.920  0.0190    99.372  1933.29
  42   0.0497     98.650  0.0203    99.340  1980.25
  43   0.0356     98.720  0.0185    99.377  2027.29
  44   0.0568     98.570  0.0188    99.415  2074.35
  45   0.0344     98.930  0.0203    99.328  2121.38
  46   0.0549     98.330  0.0167    99.438  2168.43
  47   0.0377     98.830  0.0174    99.423  2215.39
  48   0.0366     98.930  0.0166    99.475  2262.38
  49   0.0572     98.290  0.0162    99.477  2309.06
  50   0.0341     98.900  0.0161    99.472  2356.07
  51   0.0512     98.530  0.0157    99.465  2403.21
  52   0.0338     98.870  0.0145    99.532  2450.25
  53   0.0390     98.840  0.0142    99.558  2497.25
  54   0.0353     98.830  0.0128    99.562  2544.31
  55   0.0353     98.960  0.0132    99.567  2591.33
  56   0.0394     98.880  0.0131    99.545  2638.28
  57   0.0434     98.670  0.0127    99.562  2685.23
  58   0.0338     98.990  0.0129    99.567  2732.17
  59   0.0345     98.990  0.0114    99.615  2779.13
  60   0.0354     98.950  0.0116    99.603  2826.30
  61   0.0464     98.920  0.0109    99.625  2873.29
  62   0.0385     98.840  0.0104    99.657  2920.30
  63   0.0473     98.640  0.0105    99.640  2967.31
  64   0.0372     98.840  0.0102    99.657  3014.34
  65   0.0333     98.940  0.0097    99.690  3061.35
  66   0.0888     98.460  0.0088    99.708  3108.33
  67   0.0404     98.790  0.0086    99.697  3155.33
  68   0.0592     98.440  0.0088    99.715  3202.31
  69   0.0377     98.850  0.0087    99.723  3249.30
  70   0.0381     98.960  0.0089    99.687  3296.58
  71   0.0501     98.840  0.0080    99.747  3343.61
  72   0.0421     98.930  0.0075    99.743  3390.29
  73   0.0375     98.860  0.0069    99.768  3437.35
  74   0.0386     98.920  0.0070    99.758  3484.42
  75   0.0525     98.830  0.0070    99.768  3531.48
  76   0.0402     98.960  0.0073    99.770  3578.46
  77   0.0456     98.800  0.0069    99.762  3625.43
  78   0.0351     98.920  0.0069    99.758  3672.42
  79   0.0392     98.950  0.0064    99.777  3719.40
  80   0.0387     98.970  0.0061    99.797  3766.44
  81   0.0868     98.080  0.0055    99.833  3813.67
  82   0.0433     98.950  0.0055    99.823  3860.71
  83   0.0400     98.900  0.0061    99.785  3907.74
  84   0.0385     98.930  0.0057    99.822  3954.78
  85   0.0524     98.660  0.0051    99.812  4001.76
  86   0.0390     98.950  0.0054    99.827  4048.77
  87   0.0375     99.020  0.0056    99.790  4095.77
  88   0.0374     99.010  0.0056    99.815  4142.78
  89   0.0454     98.730  0.0055    99.800  4189.82
  90   0.0445     98.850  0.0053    99.838  4236.88
