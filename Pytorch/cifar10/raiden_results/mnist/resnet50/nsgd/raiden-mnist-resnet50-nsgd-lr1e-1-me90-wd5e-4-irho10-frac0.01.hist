Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3117      9.700  4.3450    11.408  51.61
   2   2.3014     10.720  2.2086    15.093  98.04
   3   2.2730     21.220  2.0899    19.318  144.82
   4   1.3753     47.570  1.5511    39.633  191.24
   5   0.9379     68.060  1.1252    57.622  237.64
   6   0.6650     77.500  0.6530    76.340  284.09
   7   0.4175     84.830  0.4612    83.857  330.49
   8   0.2395     92.280  0.3352    89.497  376.96
   9   0.1847     94.670  0.2001    94.088  423.43
  10   0.1446     96.010  0.1606    95.305  470.21
  11   0.1148     96.780  0.1467    95.703  517.00
  12   0.1364     95.880  0.1213    96.507  563.76
  13   0.0962     97.040  0.1123    96.717  610.23
  14   0.0928     97.100  0.1044    96.877  656.64
  15   0.1151     96.490  0.0948    97.133  703.38
  16   0.1168     96.830  0.0928    97.273  749.98
  17   0.0917     97.300  0.0938    97.225  796.80
  18   0.0791     97.650  0.0854    97.452  843.58
  19   0.0732     97.620  0.0848    97.477  890.38
  20   0.0572     98.320  0.0757    97.715  936.86
  21   0.0804     97.600  0.0744    97.808  983.59
  22   0.0461     98.560  0.0744    97.695  1030.34
  23   0.0603     98.130  0.0724    97.837  1077.09
  24   0.0735     97.680  0.0681    97.865  1123.89
  25   0.0634     98.010  0.0666    98.005  1170.72
  26   0.0460     98.550  0.0646    98.095  1217.53
  27   0.0616     97.980  0.0648    97.975  1264.30
  28   0.0565     98.190  0.0613    98.127  1311.09
  29   0.0799     97.670  0.0614    98.138  1357.57
  30   0.0512     98.440  0.0625    98.135  1404.33
  31   0.0615     98.090  0.0582    98.235  1450.79
  32   0.0706     97.920  0.0570    98.305  1497.18
  33   0.0632     98.080  0.0568    98.262  1543.55
  34   0.0418     98.710  0.0538    98.322  1590.33
  35   0.0659     97.910  0.0545    98.340  1637.04
  36   0.0476     98.580  0.0536    98.375  1683.63
  37   0.0433     98.700  0.0504    98.463  1730.07
  38   0.0508     98.360  0.0506    98.417  1776.88
  39   0.0472     98.430  0.0480    98.480  1823.63
  40   0.0479     98.600  0.0480    98.537  1869.97
  41   0.0635     98.050  0.0479    98.510  1916.39
  42   0.0436     98.480  0.0516    98.407  1963.15
  43   0.0563     98.330  0.0475    98.547  2009.57
  44   0.0834     97.260  0.0440    98.620  2056.42
  45   0.0695     97.710  0.0456    98.588  2103.21
  46   0.0472     98.500  0.0401    98.775  2149.65
  47   0.0418     98.680  0.0418    98.733  2196.11
  48   0.0515     98.420  0.0414    98.705  2242.87
  49   0.0299     99.040  0.0405    98.770  2289.27
  50   0.0330     98.910  0.0392    98.763  2335.69
  51   0.0437     98.680  0.0389    98.778  2382.12
  52   0.0692     98.180  0.0353    98.868  2428.88
  53   0.0600     97.980  0.0359    98.900  2475.31
  54   0.0374     98.750  0.0365    98.890  2521.78
  55   0.0504     98.430  0.0330    99.005  2568.23
  56   0.0437     98.480  0.0317    98.988  2615.06
  57   0.0318     99.040  0.0318    99.013  2661.89
  58   0.0482     98.560  0.0303    99.048  2708.65
  59   0.0598     98.160  0.0285    99.082  2755.05
  60   0.0414     98.740  0.0286    99.058  2801.43
  61   0.0597     98.060  0.0284    99.083  2847.85
  62   0.0349     98.980  0.0265    99.142  2894.32
  63   0.0428     98.530  0.0257    99.195  2940.83
  64   0.0353     98.830  0.0224    99.275  2987.31
  65   0.0315     98.970  0.0228    99.247  3033.79
  66   0.0294     99.110  0.0218    99.333  3080.23
  67   0.0333     99.060  0.0208    99.367  3126.64
  68   0.0296     98.960  0.0195    99.377  3173.07
  69   0.0300     99.010  0.0189    99.387  3219.48
  70   0.0234     99.220  0.0182    99.402  3265.89
  71   0.0263     99.060  0.0160    99.493  3312.66
  72   0.0268     99.090  0.0154    99.505  3359.17
  73   0.0341     98.950  0.0145    99.535  3406.01
  74   0.0291     99.080  0.0129    99.580  3452.74
  75   0.0259     99.140  0.0134    99.552  3499.22
  76   0.0272     99.030  0.0119    99.595  3545.68
  77   0.0272     99.130  0.0115    99.608  3592.10
  78   0.0252     99.120  0.0100    99.700  3638.54
  79   0.0288     99.110  0.0093    99.703  3685.05
  80   0.0286     99.070  0.0094    99.710  3731.48
  81   0.0281     99.120  0.0089    99.720  3777.94
  82   0.0281     99.080  0.0083    99.723  3824.41
  83   0.0318     99.000  0.0081    99.748  3870.82
  84   0.0268     99.190  0.0074    99.760  3917.20
  85   0.0262     99.200  0.0062    99.807  3963.63
  86   0.0259     99.180  0.0065    99.822  4010.02
  87   0.0282     99.180  0.0061    99.812  4056.79
  88   0.0319     99.220  0.0057    99.830  4103.44
  89   0.0251     99.230  0.0060    99.812  4149.90
  90   0.0248     99.300  0.0056    99.828  4196.30
