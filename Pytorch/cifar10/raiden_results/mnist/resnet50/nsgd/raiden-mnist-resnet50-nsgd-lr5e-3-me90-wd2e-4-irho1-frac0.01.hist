Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2868     90.520  1.1367    60.278  51.19
   2   0.1486     95.440  0.2108    93.458  98.32
   3   0.1247     96.320  0.1361    95.817  145.52
   4   0.0891     97.260  0.1020    96.790  192.64
   5   0.0808     97.530  0.0842    97.357  239.74
   6   0.0880     97.300  0.0745    97.630  286.84
   7   0.0728     97.750  0.0636    97.958  333.96
   8   0.0633     97.930  0.0571    98.188  381.24
   9   0.0566     98.140  0.0550    98.267  428.38
  10   0.0529     98.200  0.0500    98.403  475.54
  11   0.0554     98.120  0.0466    98.468  522.71
  12   0.0517     98.300  0.0433    98.597  569.87
  13   0.0532     98.190  0.0405    98.717  616.96
  14   0.0409     98.690  0.0389    98.748  664.05
  15   0.0557     98.160  0.0372    98.787  711.41
  16   0.0478     98.390  0.0356    98.872  758.51
  17   0.0348     98.830  0.0358    98.862  805.66
  18   0.0546     98.340  0.0337    98.903  852.77
  19   0.0520     98.350  0.0326    98.933  899.85
  20   0.0468     98.540  0.0301    99.030  946.97
  21   0.0369     98.760  0.0289    99.080  994.30
  22   0.0429     98.620  0.0284    99.082  1041.42
  23   0.0499     98.240  0.0267    99.112  1088.58
  24   0.0387     98.750  0.0267    99.117  1135.76
  25   0.0383     98.830  0.0257    99.178  1182.84
  26   0.0323     98.900  0.0251    99.197  1229.95
  27   0.0475     98.530  0.0235    99.227  1277.27
  28   0.0440     98.590  0.0234    99.252  1324.39
  29   0.0464     98.530  0.0221    99.302  1371.55
  30   0.0392     98.800  0.0211    99.267  1418.73
  31   0.0351     98.800  0.0222    99.273  1465.82
  32   0.0339     98.830  0.0205    99.315  1512.94
  33   0.0444     98.480  0.0198    99.323  1560.11
  34   0.0415     98.640  0.0189    99.358  1607.23
  35   0.0296     99.010  0.0184    99.398  1654.39
  36   0.0380     98.780  0.0171    99.423  1701.54
  37   0.0388     98.710  0.0178    99.400  1748.72
  38   0.0397     98.680  0.0169    99.413  1795.86
  39   0.0404     98.730  0.0163    99.472  1843.02
  40   0.0447     98.520  0.0161    99.468  1890.18
  41   0.0428     98.680  0.0155    99.513  1937.30
  42   0.0360     98.950  0.0149    99.505  1984.43
  43   0.0467     98.640  0.0146    99.488  2031.57
  44   0.0400     98.710  0.0143    99.555  2078.64
  45   0.0339     99.030  0.0141    99.532  2125.79
  46   0.0374     98.810  0.0149    99.500  2172.94
  47   0.0426     98.600  0.0145    99.525  2220.08
  48   0.0359     98.860  0.0124    99.623  2267.17
  49   0.0308     98.990  0.0129    99.562  2314.31
  50   0.0332     98.920  0.0126    99.590  2361.38
  51   0.0332     98.940  0.0117    99.620  2408.48
  52   0.0345     98.890  0.0115    99.645  2455.55
  53   0.0360     98.820  0.0114    99.623  2502.64
  54   0.0397     98.850  0.0112    99.633  2549.82
  55   0.0415     98.840  0.0107    99.632  2596.94
  56   0.0411     98.770  0.0106    99.660  2644.12
  57   0.0385     98.900  0.0103    99.657  2691.25
  58   0.0361     98.890  0.0098    99.670  2738.36
  59   0.0386     98.830  0.0094    99.690  2785.47
  60   0.0391     98.950  0.0101    99.667  2832.59
  61   0.0362     98.940  0.0090    99.703  2879.67
  62   0.0531     98.390  0.0090    99.738  2926.98
  63   0.0374     98.880  0.0086    99.700  2974.11
  64   0.0355     98.980  0.0083    99.747  3021.23
  65   0.0318     99.030  0.0083    99.732  3068.36
  66   0.0356     98.960  0.0080    99.742  3115.52
  67   0.0365     98.830  0.0078    99.743  3162.64
  68   0.0330     98.930  0.0081    99.725  3209.71
  69   0.0368     98.930  0.0080    99.737  3256.82
  70   0.0319     99.010  0.0072    99.755  3303.94
  71   0.0411     98.750  0.0079    99.747  3351.05
  72   0.0373     98.800  0.0076    99.752  3398.15
  73   0.0324     98.980  0.0072    99.773  3445.32
  74   0.0360     98.950  0.0067    99.790  3492.47
  75   0.0410     98.770  0.0068    99.797  3539.61
  76   0.0409     98.850  0.0066    99.790  3586.75
  77   0.0370     98.930  0.0060    99.808  3633.87
  78   0.0390     98.920  0.0065    99.793  3680.97
  79   0.0369     98.980  0.0064    99.797  3728.11
  80   0.0309     99.060  0.0060    99.797  3775.30
  81   0.0425     98.910  0.0066    99.803  3822.49
  82   0.0361     98.970  0.0058    99.842  3869.65
  83   0.0358     98.970  0.0062    99.815  3916.79
  84   0.0383     98.860  0.0056    99.815  3963.96
  85   0.0333     99.040  0.0058    99.822  4011.13
  86   0.0339     99.040  0.0053    99.832  4058.26
  87   0.0397     98.870  0.0054    99.835  4105.35
  88   0.0379     98.910  0.0055    99.827  4152.44
  89   0.0373     98.940  0.0051    99.850  4199.53
  90   0.0368     98.950  0.0057    99.832  4246.76
