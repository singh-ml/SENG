Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.9107     63.670  2.7990    26.928  51.67
   2   0.1635     94.630  0.4636    83.950  98.93
   3   0.0874     97.080  0.1323    95.960  146.16
   4   0.0726     97.810  0.0895    97.157  193.38
   5   0.0615     97.940  0.0738    97.718  240.62
   6   0.0731     97.800  0.0657    97.965  287.82
   7   0.0664     97.920  0.0568    98.178  334.98
   8   0.0478     98.480  0.0511    98.395  382.26
   9   0.0587     98.110  0.0491    98.437  429.52
  10   0.0532     98.380  0.0431    98.685  476.77
  11   0.0568     98.110  0.0423    98.655  523.99
  12   0.0458     98.520  0.0404    98.737  571.24
  13   0.0627     98.050  0.0368    98.868  618.51
  14   0.0504     98.460  0.0357    98.858  665.67
  15   0.0457     98.480  0.0334    98.912  712.84
  16   0.0388     98.770  0.0327    98.952  760.08
  17   0.0429     98.590  0.0305    99.042  807.27
  18   0.0402     98.730  0.0294    99.057  854.46
  19   0.0532     98.330  0.0282    99.112  901.69
  20   0.0404     98.610  0.0269    99.135  948.92
  21   0.0313     98.970  0.0247    99.178  996.13
  22   0.0346     98.810  0.0255    99.170  1043.27
  23   0.0524     98.290  0.0246    99.198  1090.43
  24   0.0418     98.680  0.0222    99.273  1137.62
  25   0.0450     98.570  0.0231    99.265  1185.05
  26   0.0410     98.730  0.0213    99.315  1232.26
  27   0.0326     98.970  0.0208    99.298  1279.47
  28   0.0384     98.850  0.0188    99.397  1326.71
  29   0.0328     98.990  0.0205    99.343  1373.88
  30   0.0388     98.780  0.0186    99.438  1421.07
  31   0.0358     99.010  0.0181    99.397  1468.24
  32   0.0388     98.810  0.0173    99.447  1515.43
  33   0.0317     99.050  0.0173    99.450  1562.60
  34   0.0389     98.730  0.0165    99.443  1609.83
  35   0.0305     99.050  0.0154    99.480  1657.00
  36   0.0342     98.950  0.0159    99.487  1704.21
  37   0.0362     98.850  0.0156    99.453  1751.46
  38   0.0383     98.860  0.0141    99.535  1798.65
  39   0.0378     98.770  0.0139    99.530  1845.87
  40   0.0405     98.770  0.0139    99.552  1893.23
  41   0.0406     98.870  0.0135    99.553  1940.42
  42   0.0350     98.950  0.0132    99.560  1987.55
  43   0.0305     99.090  0.0125    99.562  2034.74
  44   0.0354     99.010  0.0112    99.615  2082.18
  45   0.0468     98.700  0.0100    99.657  2129.36
  46   0.0321     99.070  0.0107    99.647  2176.58
  47   0.0268     99.150  0.0103    99.647  2223.73
  48   0.0385     98.910  0.0108    99.628  2270.92
  49   0.0375     98.920  0.0094    99.673  2318.12
  50   0.0453     98.610  0.0093    99.688  2365.55
  51   0.0373     98.900  0.0095    99.667  2412.78
  52   0.0267     99.190  0.0085    99.722  2459.98
  53   0.0334     98.980  0.0088    99.710  2507.17
  54   0.0355     98.930  0.0081    99.747  2554.41
  55   0.0408     98.890  0.0081    99.737  2601.58
  56   0.0367     98.940  0.0069    99.763  2648.80
  57   0.0298     99.110  0.0070    99.783  2696.01
  58   0.0340     99.020  0.0070    99.768  2743.23
  59   0.0370     98.990  0.0066    99.802  2790.43
  60   0.0324     99.030  0.0063    99.802  2837.68
  61   0.0385     98.870  0.0058    99.810  2884.91
  62   0.0381     98.990  0.0063    99.778  2932.10
  63   0.0424     98.950  0.0056    99.825  2979.29
  64   0.0371     99.050  0.0052    99.823  3026.49
  65   0.0307     99.150  0.0051    99.848  3073.74
  66   0.0358     99.050  0.0058    99.805  3120.94
  67   0.0479     98.700  0.0047    99.847  3168.21
  68   0.0406     98.890  0.0046    99.830  3215.50
  69   0.0323     99.060  0.0050    99.845  3262.73
  70   0.0321     99.100  0.0047    99.853  3309.93
  71   0.0348     99.010  0.0045    99.868  3357.14
  72   0.0373     98.950  0.0044    99.858  3404.30
  73   0.0331     98.970  0.0038    99.885  3451.44
  74   0.0442     98.810  0.0040    99.865  3498.61
  75   0.0413     98.970  0.0041    99.865  3545.78
  76   0.0359     98.980  0.0039    99.893  3592.99
  77   0.0418     98.880  0.0038    99.860  3640.19
  78   0.0341     99.060  0.0033    99.902  3687.43
  79   0.0306     99.130  0.0034    99.903  3734.64
  80   0.0337     98.990  0.0036    99.902  3781.84
  81   0.0395     98.960  0.0032    99.903  3829.06
  82   0.0349     98.990  0.0036    99.887  3876.30
  83   0.0500     98.630  0.0036    99.913  3923.45
  84   0.0392     98.870  0.0034    99.897  3970.65
  85   0.0339     98.970  0.0032    99.897  4017.86
  86   0.0375     98.880  0.0032    99.905  4065.08
  87   0.0407     98.890  0.0032    99.902  4112.31
  88   0.0379     99.040  0.0029    99.910  4159.48
  89   0.0456     98.890  0.0032    99.898  4206.65
  90   0.0491     98.850  0.0031    99.908  4253.82
