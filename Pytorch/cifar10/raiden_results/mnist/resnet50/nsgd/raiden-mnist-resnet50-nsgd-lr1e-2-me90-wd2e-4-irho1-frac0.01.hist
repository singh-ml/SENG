Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3948     87.370  1.8125    54.585  52.26
   2   0.1023     96.660  0.1994    93.927  99.45
   3   0.0892     97.140  0.1107    96.535  146.43
   4   0.0682     97.750  0.0881    97.287  193.42
   5   0.0604     98.030  0.0704    97.810  240.48
   6   0.0495     98.370  0.0636    98.030  287.44
   7   0.0467     98.440  0.0563    98.242  334.35
   8   0.0532     98.220  0.0526    98.332  381.42
   9   0.0548     98.120  0.0474    98.505  428.36
  10   0.0414     98.550  0.0440    98.612  475.32
  11   0.0435     98.600  0.0416    98.678  522.26
  12   0.0451     98.530  0.0398    98.718  569.28
  13   0.0609     98.150  0.0376    98.843  616.19
  14   0.0406     98.530  0.0356    98.852  663.13
  15   0.0459     98.490  0.0324    98.997  710.06
  16   0.0442     98.630  0.0334    98.938  757.01
  17   0.0360     98.770  0.0319    98.930  803.94
  18   0.0446     98.520  0.0296    99.065  850.87
  19   0.0352     98.840  0.0294    99.045  897.78
  20   0.0369     98.850  0.0273    99.130  944.75
  21   0.0336     98.860  0.0265    99.142  991.71
  22   0.0339     98.910  0.0245    99.210  1038.65
  23   0.0428     98.620  0.0230    99.237  1085.58
  24   0.0419     98.610  0.0226    99.237  1132.48
  25   0.0369     98.740  0.0226    99.273  1179.42
  26   0.0395     98.800  0.0209    99.327  1226.32
  27   0.0413     98.680  0.0214    99.295  1273.20
  28   0.0446     98.800  0.0192    99.345  1320.15
  29   0.0356     98.830  0.0206    99.293  1367.01
  30   0.0455     98.540  0.0176    99.462  1413.91
  31   0.0359     98.700  0.0179    99.400  1460.87
  32   0.0374     98.820  0.0178    99.403  1507.83
  33   0.0303     98.910  0.0164    99.445  1554.75
  34   0.0296     98.940  0.0171    99.423  1601.69
  35   0.0357     98.780  0.0150    99.487  1648.61
  36   0.0423     98.770  0.0145    99.538  1695.66
  37   0.0347     98.890  0.0146    99.527  1742.61
  38   0.0360     98.850  0.0148    99.473  1789.59
  39   0.0314     99.080  0.0140    99.512  1836.53
  40   0.0376     98.900  0.0130    99.575  1883.47
  41   0.0355     98.920  0.0125    99.590  1930.40
  42   0.0344     98.890  0.0120    99.622  1977.36
  43   0.0418     98.700  0.0110    99.632  2024.32
  44   0.0354     99.010  0.0109    99.637  2071.28
  45   0.0371     98.930  0.0114    99.633  2118.22
  46   0.0352     98.970  0.0103    99.658  2165.15
  47   0.0374     98.860  0.0106    99.648  2212.10
  48   0.0386     98.720  0.0097    99.677  2259.06
  49   0.0328     99.040  0.0103    99.663  2306.00
  50   0.0376     98.890  0.0096    99.682  2352.96
  51   0.0364     99.100  0.0091    99.715  2399.91
  52   0.0282     99.000  0.0085    99.733  2446.89
  53   0.0345     98.960  0.0084    99.728  2493.83
  54   0.0362     98.920  0.0076    99.750  2540.79
  55   0.0367     98.940  0.0078    99.757  2587.68
  56   0.0345     99.000  0.0067    99.798  2634.56
  57   0.0368     98.990  0.0072    99.782  2681.47
  58   0.0329     99.090  0.0061    99.822  2728.37
  59   0.0377     98.880  0.0065    99.775  2775.25
  60   0.0326     98.990  0.0061    99.815  2822.25
  61   0.0412     98.850  0.0059    99.817  2869.17
  62   0.0404     98.750  0.0057    99.827  2916.16
  63   0.0352     99.000  0.0059    99.802  2963.12
  64   0.0379     98.970  0.0051    99.852  3010.09
  65   0.0413     98.770  0.0051    99.842  3057.06
  66   0.0345     99.000  0.0048    99.860  3104.00
  67   0.0349     98.980  0.0050    99.842  3150.88
  68   0.0338     98.980  0.0045    99.842  3197.82
  69   0.0428     98.900  0.0046    99.847  3244.77
  70   0.0374     99.040  0.0043    99.875  3291.68
  71   0.0424     98.790  0.0045    99.863  3338.59
  72   0.0434     98.730  0.0042    99.880  3385.53
  73   0.0392     98.930  0.0040    99.893  3432.52
  74   0.0331     99.080  0.0035    99.900  3479.47
  75   0.0339     98.990  0.0038    99.887  3526.40
  76   0.0385     99.030  0.0041    99.883  3573.36
  77   0.0432     98.940  0.0037    99.890  3620.31
  78   0.0356     99.010  0.0037    99.893  3667.23
  79   0.0405     98.860  0.0037    99.897  3714.17
  80   0.0391     98.950  0.0033    99.908  3761.13
  81   0.0418     98.970  0.0033    99.907  3808.15
  82   0.0372     98.980  0.0034    99.895  3855.13
  83   0.0395     98.800  0.0034    99.907  3902.06
  84   0.0410     98.920  0.0027    99.927  3948.95
  85   0.0401     98.950  0.0031    99.937  3995.93
  86   0.0325     99.070  0.0029    99.927  4042.91
  87   0.0340     99.050  0.0030    99.902  4089.87
  88   0.0339     99.050  0.0030    99.922  4136.83
  89   0.0398     98.930  0.0028    99.930  4183.75
  90   0.0315     99.090  0.0031    99.903  4230.69
