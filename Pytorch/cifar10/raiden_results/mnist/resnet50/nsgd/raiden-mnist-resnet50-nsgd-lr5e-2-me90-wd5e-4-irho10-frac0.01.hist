Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.4114     10.560  4.4446    10.687  52.49
   2   2.1599     19.850  2.2855    12.830  98.78
   3   1.0257     66.040  1.5547    41.213  145.58
   4   0.5090     81.690  0.7398    75.530  192.17
   5   0.2138     93.570  0.3640    88.318  239.08
   6   0.1415     95.780  0.2085    93.768  285.74
   7   0.1265     95.810  0.1534    95.353  332.40
   8   0.1281     95.650  0.1270    96.097  379.09
   9   0.0800     97.450  0.1083    96.742  425.67
  10   0.1057     96.600  0.0924    97.223  472.24
  11   0.1127     96.530  0.0889    97.328  518.84
  12   0.0742     97.590  0.0796    97.555  565.44
  13   0.0924     96.910  0.0766    97.653  612.07
  14   0.0717     97.730  0.0709    97.823  658.64
  15   0.0693     97.670  0.0668    97.892  705.27
  16   0.0552     98.170  0.0626    98.080  751.86
  17   0.0597     97.980  0.0598    98.192  798.46
  18   0.0605     98.060  0.0586    98.242  845.06
  19   0.0652     97.850  0.0550    98.297  891.95
  20   0.0575     97.980  0.0558    98.265  938.51
  21   0.0613     97.950  0.0534    98.338  985.15
  22   0.0449     98.470  0.0503    98.462  1031.78
  23   0.0677     97.880  0.0511    98.427  1078.43
  24   0.0864     97.160  0.0493    98.463  1125.02
  25   0.0611     98.060  0.0503    98.453  1171.64
  26   0.0703     97.620  0.0469    98.542  1218.26
  27   0.0472     98.450  0.0468    98.508  1264.87
  28   0.0470     98.480  0.0458    98.557  1311.50
  29   0.0444     98.520  0.0448    98.572  1358.10
  30   0.0623     98.120  0.0425    98.637  1404.70
  31   0.0538     98.210  0.0459    98.523  1451.34
  32   0.0714     97.610  0.0410    98.743  1498.01
  33   0.0472     98.460  0.0413    98.703  1544.66
  34   0.0454     98.510  0.0430    98.615  1591.25
  35   0.0409     98.730  0.0398    98.733  1637.87
  36   0.0411     98.790  0.0400    98.718  1684.48
  37   0.0599     98.050  0.0382    98.828  1731.08
  38   0.0538     98.290  0.0369    98.807  1777.75
  39   0.0398     98.710  0.0368    98.833  1824.38
  40   0.0462     98.480  0.0369    98.873  1871.04
  41   0.0438     98.670  0.0367    98.770  1917.65
  42   0.0454     98.470  0.0338    98.912  1964.23
  43   0.0492     98.360  0.0354    98.888  2010.79
  44   0.0431     98.710  0.0327    98.957  2057.40
  45   0.0414     98.620  0.0321    98.963  2104.00
  46   0.0378     98.850  0.0300    99.037  2151.05
  47   0.0442     98.470  0.0315    99.017  2197.73
  48   0.0518     98.230  0.0299    99.025  2244.35
  49   0.0366     98.860  0.0282    99.118  2291.00
  50   0.0365     98.800  0.0286    99.040  2337.67
  51   0.0341     99.010  0.0265    99.165  2384.40
  52   0.0423     98.600  0.0260    99.162  2431.02
  53   0.0369     98.840  0.0248    99.177  2477.63
  54   0.0399     98.750  0.0234    99.243  2524.78
  55   0.0339     98.880  0.0239    99.213  2571.43
  56   0.0303     98.940  0.0239    99.232  2618.03
  57   0.0402     98.840  0.0234    99.252  2664.63
  58   0.0294     98.990  0.0222    99.295  2711.23
  59   0.0396     98.700  0.0205    99.337  2757.85
  60   0.0408     98.770  0.0187    99.390  2804.74
  61   0.0401     98.760  0.0178    99.417  2851.36
  62   0.0343     98.850  0.0182    99.390  2897.99
  63   0.0367     98.810  0.0171    99.450  2944.96
  64   0.0329     98.860  0.0159    99.513  2991.93
  65   0.0301     98.880  0.0170    99.430  3038.85
  66   0.0418     98.680  0.0146    99.520  3085.60
  67   0.0324     98.960  0.0136    99.563  3132.16
  68   0.0280     99.060  0.0134    99.558  3178.80
  69   0.0326     99.090  0.0122    99.613  3225.45
  70   0.0270     99.060  0.0114    99.615  3272.02
  71   0.0337     99.010  0.0107    99.647  3318.64
  72   0.0433     98.820  0.0101    99.678  3365.31
  73   0.0274     99.190  0.0090    99.693  3411.98
  74   0.0337     98.980  0.0084    99.713  3458.63
  75   0.0387     98.860  0.0081    99.728  3505.28
  76   0.0271     99.140  0.0071    99.777  3551.88
  77   0.0288     99.170  0.0065    99.783  3598.48
  78   0.0286     99.130  0.0066    99.772  3645.41
  79   0.0331     98.970  0.0056    99.837  3692.06
  80   0.0304     99.110  0.0056    99.830  3738.69
  81   0.0334     99.010  0.0046    99.857  3785.31
  82   0.0353     98.970  0.0044    99.878  3831.96
  83   0.0320     99.140  0.0043    99.875  3878.62
  84   0.0345     99.040  0.0044    99.865  3925.23
  85   0.0320     99.110  0.0041    99.873  3971.80
  86   0.0287     99.180  0.0039    99.885  4018.41
  87   0.0347     99.030  0.0038    99.882  4065.01
  88   0.0328     99.130  0.0035    99.890  4111.60
  89   0.0310     99.130  0.0035    99.890  4158.34
  90   0.0317     99.080  0.0036    99.887  4205.00
