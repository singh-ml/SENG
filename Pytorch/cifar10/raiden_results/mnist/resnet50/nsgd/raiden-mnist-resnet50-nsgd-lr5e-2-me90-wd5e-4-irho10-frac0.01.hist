Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3049     10.290  4.0685    10.743  51.80
   2   2.2197     11.660  2.2888    11.933  98.72
   3   1.2803     51.690  1.7857    31.770  145.25
   4   0.6524     81.000  0.8603    71.157  192.14
   5   0.2026     93.760  0.3555    89.443  239.03
   6   0.1532     95.400  0.1918    94.287  285.83
   7   0.1348     95.820  0.1433    95.820  332.62
   8   0.1048     96.970  0.1166    96.532  379.48
   9   0.0807     97.400  0.0946    97.138  426.36
  10   0.0989     97.100  0.0866    97.433  472.92
  11   0.0613     98.110  0.0775    97.643  519.84
  12   0.0727     97.880  0.0718    97.828  566.72
  13   0.0795     97.920  0.0663    97.920  613.60
  14   0.0549     98.150  0.0637    98.048  660.43
  15   0.0530     98.420  0.0607    98.100  706.93
  16   0.0761     97.660  0.0577    98.162  753.74
  17   0.0726     97.910  0.0567    98.227  800.54
  18   0.0672     97.850  0.0512    98.440  847.64
  19   0.0566     98.190  0.0510    98.445  894.59
  20   0.0719     97.830  0.0495    98.500  941.07
  21   0.0379     98.750  0.0491    98.483  987.98
  22   0.0474     98.570  0.0479    98.470  1034.82
  23   0.0513     98.370  0.0474    98.492  1081.62
  24   0.0556     98.180  0.0485    98.517  1128.43
  25   0.0523     98.270  0.0478    98.485  1175.27
  26   0.0386     98.700  0.0439    98.582  1222.16
  27   0.0366     98.770  0.0442    98.592  1269.07
  28   0.0479     98.450  0.0433    98.635  1315.94
  29   0.0575     98.320  0.0432    98.653  1362.82
  30   0.0462     98.490  0.0419    98.688  1409.73
  31   0.0442     98.640  0.0400    98.720  1456.61
  32   0.0437     98.630  0.0392    98.738  1503.40
  33   0.0461     98.680  0.0399    98.723  1550.28
  34   0.0462     98.570  0.0396    98.733  1597.10
  35   0.0424     98.630  0.0396    98.770  1643.95
  36   0.0365     98.850  0.0384    98.782  1690.80
  37   0.0385     98.750  0.0352    98.888  1737.66
  38   0.0515     98.290  0.0349    98.892  1784.49
  39   0.0407     98.700  0.0356    98.877  1831.34
  40   0.0492     98.330  0.0353    98.918  1878.20
  41   0.0383     98.770  0.0345    98.875  1925.05
  42   0.0406     98.780  0.0331    98.937  1971.90
  43   0.0406     98.710  0.0331    98.938  2018.70
  44   0.0388     98.730  0.0336    98.940  2065.54
  45   0.0237     99.120  0.0312    99.017  2112.39
  46   0.0485     98.510  0.0316    98.948  2159.27
  47   0.0307     98.970  0.0293    99.053  2206.12
  48   0.0354     98.890  0.0287    99.050  2252.98
  49   0.0417     98.690  0.0281    99.077  2299.87
  50   0.0291     99.080  0.0263    99.155  2346.71
  51   0.0373     98.820  0.0263    99.227  2393.89
  52   0.0291     98.990  0.0254    99.182  2440.71
  53   0.0404     98.780  0.0245    99.228  2487.56
  54   0.0329     98.900  0.0242    99.195  2534.41
  55   0.0283     99.040  0.0234    99.243  2581.35
  56   0.0319     99.000  0.0219    99.272  2628.22
  57   0.0530     98.480  0.0216    99.302  2675.06
  58   0.0403     98.660  0.0212    99.307  2721.89
  59   0.0316     98.960  0.0200    99.373  2768.73
  60   0.0347     98.750  0.0192    99.353  2815.55
  61   0.0472     98.630  0.0193    99.370  2862.40
  62   0.0381     98.780  0.0178    99.397  2909.29
  63   0.0263     99.040  0.0180    99.415  2956.14
  64   0.0373     98.820  0.0150    99.537  3003.03
  65   0.0336     98.900  0.0157    99.468  3049.96
  66   0.0267     99.080  0.0143    99.513  3096.77
  67   0.0244     99.150  0.0136    99.548  3143.63
  68   0.0336     99.010  0.0124    99.595  3190.47
  69   0.0258     99.160  0.0122    99.592  3237.31
  70   0.0302     99.070  0.0110    99.653  3284.16
  71   0.0269     99.160  0.0117    99.603  3331.08
  72   0.0252     99.200  0.0105    99.635  3378.00
  73   0.0388     98.850  0.0092    99.700  3424.92
  74   0.0409     98.750  0.0090    99.698  3471.84
  75   0.0311     99.040  0.0087    99.712  3518.70
  76   0.0343     98.870  0.0071    99.758  3565.51
  77   0.0365     98.930  0.0073    99.765  3612.37
  78   0.0307     99.050  0.0063    99.775  3659.28
  79   0.0282     99.120  0.0065    99.773  3706.15
  80   0.0327     99.010  0.0061    99.800  3753.01
  81   0.0296     99.080  0.0060    99.815  3799.86
  82   0.0264     99.190  0.0051    99.837  3846.73
  83   0.0271     99.130  0.0051    99.822  3893.69
  84   0.0346     98.890  0.0049    99.850  3940.52
  85   0.0309     99.060  0.0045    99.855  3987.37
  86   0.0379     98.920  0.0046    99.860  4034.23
  87   0.0298     99.140  0.0044    99.873  4081.09
  88   0.0288     99.100  0.0039    99.877  4127.92
  89   0.0326     99.040  0.0039    99.892  4174.77
  90   0.0288     99.080  0.0037    99.898  4221.68
