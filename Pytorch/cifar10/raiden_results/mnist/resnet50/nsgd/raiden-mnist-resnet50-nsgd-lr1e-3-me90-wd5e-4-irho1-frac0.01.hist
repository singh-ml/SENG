Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.5845     44.370  1.8917    29.592  52.87
   2   0.8326     73.650  1.2183    59.342  99.88
   3   0.4445     85.780  0.6376    79.737  146.92
   4   0.3050     90.480  0.3931    88.015  193.96
   5   0.2744     91.320  0.2898    91.160  240.96
   6   0.2020     93.710  0.2341    92.723  287.98
   7   0.1705     94.810  0.1951    94.017  334.96
   8   0.1532     95.260  0.1689    94.780  382.21
   9   0.1386     95.550  0.1508    95.312  429.26
  10   0.1269     96.150  0.1362    95.743  476.34
  11   0.1133     96.450  0.1259    96.062  523.39
  12   0.1213     96.150  0.1155    96.408  570.44
  13   0.1058     96.470  0.1084    96.600  617.51
  14   0.0956     96.930  0.0976    96.872  664.55
  15   0.1045     96.760  0.0930    97.023  711.55
  16   0.0902     97.210  0.0904    97.155  758.53
  17   0.0873     97.190  0.0860    97.250  805.55
  18   0.1018     96.670  0.0810    97.472  852.57
  19   0.0854     97.360  0.0785    97.553  899.78
  20   0.0818     97.460  0.0751    97.595  946.86
  21   0.0742     97.740  0.0726    97.735  993.93
  22   0.0733     97.870  0.0683    97.878  1040.97
  23   0.0766     97.530  0.0661    97.885  1087.97
  24   0.0776     97.670  0.0660    97.933  1135.04
  25   0.0649     97.980  0.0608    98.062  1182.07
  26   0.0851     97.370  0.0606    98.067  1229.07
  27   0.0772     97.640  0.0580    98.168  1276.10
  28   0.0717     97.700  0.0559    98.240  1323.14
  29   0.0667     97.830  0.0548    98.275  1370.17
  30   0.0602     97.930  0.0525    98.363  1417.23
  31   0.0630     97.910  0.0515    98.352  1464.24
  32   0.0598     97.990  0.0503    98.402  1511.28
  33   0.0686     97.760  0.0489    98.437  1558.24
  34   0.0606     97.960  0.0469    98.528  1605.24
  35   0.0613     98.120  0.0475    98.508  1652.31
  36   0.0714     97.760  0.0450    98.545  1699.38
  37   0.0601     97.940  0.0454    98.548  1746.38
  38   0.0598     98.030  0.0423    98.675  1793.39
  39   0.0532     98.250  0.0425    98.643  1840.41
  40   0.0586     98.030  0.0410    98.672  1887.38
  41   0.0494     98.360  0.0410    98.717  1934.36
  42   0.0562     98.080  0.0401    98.725  1981.40
  43   0.0498     98.290  0.0392    98.755  2028.43
  44   0.0576     98.250  0.0388    98.772  2075.49
  45   0.0504     98.270  0.0380    98.830  2122.58
  46   0.0468     98.480  0.0379    98.737  2169.57
  47   0.0520     98.240  0.0369    98.843  2216.56
  48   0.0553     98.210  0.0347    98.953  2263.59
  49   0.0525     98.290  0.0360    98.838  2310.65
  50   0.0682     97.810  0.0345    98.880  2357.66
  51   0.0459     98.550  0.0327    98.925  2404.67
  52   0.0484     98.430  0.0332    98.970  2451.69
  53   0.0442     98.470  0.0311    99.017  2498.70
  54   0.0483     98.290  0.0321    99.007  2545.70
  55   0.0541     98.120  0.0307    99.043  2592.70
  56   0.0538     98.170  0.0297    99.025  2639.70
  57   0.0496     98.330  0.0304    99.037  2686.70
  58   0.0459     98.440  0.0304    99.022  2733.71
  59   0.0467     98.440  0.0291    99.025  2780.78
  60   0.0598     98.080  0.0288    99.118  2827.80
  61   0.0433     98.630  0.0285    99.053  2874.82
  62   0.0514     98.270  0.0266    99.162  2921.82
  63   0.0501     98.340  0.0266    99.107  2968.79
  64   0.0538     98.190  0.0276    99.077  3015.79
  65   0.0540     98.230  0.0259    99.150  3062.76
  66   0.0506     98.230  0.0263    99.135  3109.81
  67   0.0449     98.550  0.0253    99.223  3156.82
  68   0.0428     98.610  0.0256    99.153  3203.84
  69   0.0476     98.470  0.0255    99.193  3251.08
  70   0.0425     98.580  0.0246    99.215  3298.14
  71   0.0422     98.600  0.0242    99.193  3345.19
  72   0.0455     98.470  0.0238    99.210  3392.21
  73   0.0446     98.440  0.0236    99.232  3439.23
  74   0.0468     98.580  0.0241    99.223  3486.27
  75   0.0445     98.560  0.0225    99.270  3533.28
  76   0.0453     98.500  0.0234    99.215  3580.25
  77   0.0433     98.690  0.0225    99.288  3627.26
  78   0.0419     98.640  0.0223    99.248  3674.34
  79   0.0392     98.630  0.0207    99.347  3721.39
  80   0.0479     98.480  0.0223    99.242  3768.42
  81   0.0356     98.820  0.0219    99.285  3815.66
  82   0.0451     98.590  0.0213    99.292  3862.70
  83   0.0401     98.720  0.0204    99.352  3909.92
  84   0.0459     98.450  0.0204    99.348  3957.14
  85   0.0397     98.740  0.0207    99.358  4004.16
  86   0.0412     98.660  0.0193    99.352  4051.18
  87   0.0391     98.640  0.0190    99.377  4098.15
  88   0.0372     98.660  0.0191    99.387  4145.20
  89   0.0419     98.610  0.0185    99.413  4192.23
  90   0.0393     98.730  0.0181    99.422  4239.28
