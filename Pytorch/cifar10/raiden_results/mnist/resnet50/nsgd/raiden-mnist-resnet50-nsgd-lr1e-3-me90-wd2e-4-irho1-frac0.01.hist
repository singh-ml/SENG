Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.5270     49.470  1.8701    31.732  52.77
   2   0.8141     72.620  1.2087    60.047  99.78
   3   0.4892     83.950  0.6632    79.000  147.04
   4   0.3337     90.200  0.4010    87.880  194.02
   5   0.2551     92.210  0.2963    91.033  241.10
   6   0.2093     93.690  0.2372    92.738  288.18
   7   0.1854     94.190  0.1986    93.867  335.26
   8   0.1553     95.240  0.1717    94.690  382.34
   9   0.1539     95.120  0.1531    95.265  429.42
  10   0.1373     95.570  0.1388    95.740  476.52
  11   0.1340     95.720  0.1270    96.073  523.58
  12   0.1303     96.000  0.1148    96.463  570.62
  13   0.1075     96.740  0.1083    96.615  617.70
  14   0.1018     96.930  0.0999    96.790  664.79
  15   0.0964     97.110  0.0942    97.078  711.84
  16   0.0936     97.200  0.0881    97.233  758.89
  17   0.0915     97.190  0.0841    97.423  805.96
  18   0.0846     97.510  0.0813    97.417  853.04
  19   0.0819     97.680  0.0775    97.538  900.05
  20   0.0820     97.460  0.0724    97.657  947.07
  21   0.0836     97.500  0.0716    97.727  994.34
  22   0.0767     97.800  0.0682    97.807  1041.42
  23   0.0716     98.030  0.0673    97.827  1088.53
  24   0.0797     97.760  0.0635    98.002  1135.60
  25   0.0691     98.070  0.0610    98.103  1182.60
  26   0.0650     97.980  0.0591    98.147  1229.69
  27   0.0831     97.550  0.0588    98.193  1276.75
  28   0.0672     98.010  0.0569    98.195  1323.87
  29   0.0595     98.160  0.0552    98.247  1370.97
  30   0.0573     98.320  0.0526    98.327  1418.03
  31   0.0589     98.220  0.0518    98.358  1465.06
  32   0.0661     97.990  0.0501    98.368  1512.10
  33   0.0603     98.230  0.0494    98.412  1559.07
  34   0.0604     98.170  0.0486    98.440  1606.14
  35   0.0579     98.270  0.0478    98.510  1653.23
  36   0.0655     98.080  0.0461    98.558  1700.33
  37   0.0606     98.090  0.0442    98.595  1747.38
  38   0.0535     98.440  0.0427    98.647  1794.44
  39   0.0542     98.310  0.0429    98.642  1841.52
  40   0.0591     98.200  0.0410    98.660  1888.58
  41   0.0559     98.280  0.0394    98.727  1935.58
  42   0.0568     98.220  0.0403    98.728  1982.59
  43   0.0662     97.870  0.0388    98.720  2029.63
  44   0.0573     98.170  0.0388    98.778  2076.67
  45   0.0518     98.400  0.0386    98.770  2123.75
  46   0.0529     98.310  0.0375    98.840  2170.83
  47   0.0549     98.230  0.0367    98.855  2217.93
  48   0.0508     98.310  0.0358    98.838  2264.97
  49   0.0547     98.190  0.0348    98.913  2311.99
  50   0.0485     98.470  0.0348    98.892  2359.08
  51   0.0518     98.380  0.0341    98.950  2406.16
  52   0.0571     98.290  0.0338    98.897  2453.26
  53   0.0539     98.280  0.0320    98.995  2500.33
  54   0.0578     98.250  0.0325    98.960  2547.44
  55   0.0478     98.430  0.0315    98.965  2594.50
  56   0.0534     98.320  0.0311    99.033  2641.59
  57   0.0533     98.370  0.0304    99.032  2688.69
  58   0.0473     98.480  0.0301    99.083  2735.73
  59   0.0453     98.520  0.0288    99.082  2782.80
  60   0.0434     98.640  0.0308    99.000  2829.82
  61   0.0470     98.430  0.0285    99.105  2876.83
  62   0.0495     98.490  0.0283    99.087  2923.86
  63   0.0455     98.540  0.0285    99.090  2970.95
  64   0.0427     98.580  0.0281    99.060  3018.04
  65   0.0451     98.520  0.0262    99.133  3065.09
  66   0.0639     98.060  0.0260    99.157  3112.17
  67   0.0523     98.370  0.0273    99.140  3159.22
  68   0.0514     98.390  0.0263    99.158  3206.27
  69   0.0448     98.540  0.0256    99.132  3253.30
  70   0.0486     98.430  0.0246    99.238  3300.37
  71   0.0510     98.420  0.0268    99.098  3347.42
  72   0.0504     98.360  0.0246    99.195  3394.53
  73   0.0471     98.500  0.0246    99.210  3441.57
  74   0.0632     98.150  0.0246    99.198  3488.61
  75   0.0545     98.350  0.0238    99.260  3535.64
  76   0.0509     98.410  0.0235    99.223  3582.68
  77   0.0581     98.380  0.0229    99.253  3629.70
  78   0.0453     98.560  0.0236    99.230  3676.76
  79   0.0471     98.530  0.0221    99.293  3724.03
  80   0.0494     98.430  0.0218    99.287  3771.11
  81   0.0490     98.440  0.0221    99.305  3818.17
  82   0.0483     98.460  0.0214    99.313  3865.21
  83   0.0456     98.470  0.0222    99.300  3912.33
  84   0.0465     98.600  0.0216    99.293  3959.46
  85   0.0495     98.530  0.0210    99.315  4006.56
  86   0.0619     98.060  0.0208    99.323  4053.62
  87   0.0425     98.540  0.0206    99.350  4100.68
  88   0.0463     98.540  0.0198    99.347  4147.85
  89   0.0439     98.710  0.0190    99.420  4194.97
  90   0.0489     98.370  0.0204    99.353  4242.13
