Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2873     90.600  1.0772    61.913  51.54
   2   0.1384     95.520  0.2077    93.490  98.57
   3   0.1231     96.080  0.1302    95.917  145.62
   4   0.0798     97.270  0.1006    96.855  192.68
   5   0.0753     97.470  0.0823    97.438  239.71
   6   0.0753     97.570  0.0728    97.663  286.78
   7   0.0673     97.870  0.0657    97.928  333.80
   8   0.0609     98.000  0.0609    98.085  380.91
   9   0.0536     98.320  0.0543    98.287  427.90
  10   0.0568     98.240  0.0513    98.423  474.92
  11   0.0511     98.220  0.0496    98.415  521.99
  12   0.0620     97.970  0.0465    98.495  569.07
  13   0.0511     98.380  0.0415    98.617  616.05
  14   0.0485     98.430  0.0413    98.700  663.07
  15   0.0513     98.300  0.0385    98.742  710.09
  16   0.0450     98.480  0.0355    98.828  757.08
  17   0.0545     98.250  0.0341    98.898  804.31
  18   0.0510     98.380  0.0337    98.925  851.37
  19   0.0400     98.590  0.0319    98.972  898.42
  20   0.0436     98.430  0.0308    98.992  945.44
  21   0.0457     98.540  0.0303    99.013  992.47
  22   0.0465     98.480  0.0288    99.063  1039.53
  23   0.0395     98.640  0.0298    99.008  1086.57
  24   0.0429     98.570  0.0286    99.073  1133.64
  25   0.0445     98.470  0.0253    99.183  1180.71
  26   0.0473     98.290  0.0267    99.115  1227.72
  27   0.0374     98.820  0.0252    99.185  1274.71
  28   0.0435     98.560  0.0262    99.150  1321.75
  29   0.0405     98.780  0.0235    99.220  1368.80
  30   0.0372     98.740  0.0237    99.245  1415.86
  31   0.0386     98.720  0.0236    99.222  1462.92
  32   0.0431     98.550  0.0226    99.260  1509.93
  33   0.0341     98.850  0.0215    99.263  1557.01
  34   0.0415     98.700  0.0203    99.295  1604.04
  35   0.0404     98.570  0.0211    99.313  1651.06
  36   0.0320     98.840  0.0195    99.388  1698.10
  37   0.0386     98.710  0.0191    99.368  1745.14
  38   0.0395     98.800  0.0192    99.365  1792.19
  39   0.0565     98.320  0.0177    99.410  1839.26
  40   0.0455     98.560  0.0192    99.348  1886.32
  41   0.0378     98.730  0.0175    99.435  1933.39
  42   0.0403     98.700  0.0179    99.413  1980.43
  43   0.0389     98.770  0.0168    99.430  2027.44
  44   0.0334     98.880  0.0161    99.472  2074.44
  45   0.0397     98.790  0.0165    99.460  2121.46
  46   0.0358     98.930  0.0163    99.447  2168.47
  47   0.0398     98.770  0.0155    99.482  2215.70
  48   0.0432     98.740  0.0155    99.453  2262.80
  49   0.0322     98.870  0.0148    99.523  2309.89
  50   0.0373     98.940  0.0149    99.515  2356.96
  51   0.0439     98.650  0.0140    99.537  2404.15
  52   0.0550     98.350  0.0146    99.488  2451.15
  53   0.0443     98.650  0.0141    99.528  2498.17
  54   0.0428     98.560  0.0139    99.512  2545.22
  55   0.0678     97.950  0.0125    99.583  2592.25
  56   0.0372     98.770  0.0129    99.558  2639.41
  57   0.0412     98.780  0.0122    99.585  2686.43
  58   0.0433     98.770  0.0136    99.562  2733.49
  59   0.0345     98.910  0.0119    99.590  2780.58
  60   0.0355     98.850  0.0113    99.622  2827.62
  61   0.0461     98.530  0.0116    99.597  2874.66
  62   0.0366     98.880  0.0120    99.563  2921.71
  63   0.0438     98.710  0.0115    99.595  2968.68
  64   0.0382     98.960  0.0110    99.632  3015.72
  65   0.0437     98.830  0.0111    99.615  3062.79
  66   0.0373     98.700  0.0109    99.620  3109.81
  67   0.0351     98.900  0.0102    99.683  3156.81
  68   0.0376     98.930  0.0100    99.658  3203.84
  69   0.0442     98.720  0.0102    99.647  3250.92
  70   0.0391     98.740  0.0103    99.655  3297.70
  71   0.0377     98.790  0.0096    99.697  3344.68
  72   0.0447     98.640  0.0096    99.668  3391.68
  73   0.0384     98.950  0.0101    99.658  3438.68
  74   0.0351     98.820  0.0086    99.703  3485.81
  75   0.0475     98.720  0.0101    99.628  3532.84
  76   0.0431     98.790  0.0094    99.673  3579.92
  77   0.0447     98.910  0.0087    99.700  3626.97
  78   0.0475     98.700  0.0098    99.653  3674.01
  79   0.0455     98.710  0.0089    99.687  3721.09
  80   0.0374     98.930  0.0077    99.760  3768.09
  81   0.0365     98.890  0.0095    99.652  3815.08
  82   0.0355     98.910  0.0085    99.725  3862.13
  83   0.0425     98.910  0.0082    99.697  3909.14
  84   0.0486     98.730  0.0082    99.723  3956.23
  85   0.0464     98.750  0.0078    99.733  4003.31
  86   0.0404     98.830  0.0074    99.737  4050.35
  87   0.0383     99.000  0.0079    99.747  4097.42
  88   0.0414     98.830  0.0081    99.727  4144.47
  89   0.0410     98.790  0.0083    99.702  4191.47
  90   0.0411     98.900  0.0069    99.778  4238.65
