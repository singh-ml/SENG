Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3740     88.060  1.2102    56.578  51.58
   2   0.1783     94.330  0.2739    91.288  98.56
   3   0.1444     95.120  0.1521    95.148  145.46
   4   0.1114     96.470  0.1129    96.472  192.36
   5   0.0886     97.230  0.0921    97.148  239.26
   6   0.0922     97.040  0.0791    97.532  286.33
   7   0.0784     97.600  0.0710    97.738  333.48
   8   0.0589     98.110  0.0610    98.080  380.41
   9   0.0656     97.680  0.0565    98.217  427.36
  10   0.0467     98.540  0.0546    98.273  474.30
  11   0.0622     97.950  0.0512    98.417  521.26
  12   0.0506     98.410  0.0499    98.387  568.19
  13   0.0416     98.610  0.0440    98.610  615.10
  14   0.0562     98.220  0.0427    98.653  661.99
  15   0.0428     98.690  0.0394    98.742  708.89
  16   0.0550     98.280  0.0384    98.727  755.81
  17   0.0479     98.440  0.0367    98.820  802.75
  18   0.0429     98.520  0.0351    98.870  849.74
  19   0.0423     98.690  0.0339    98.908  896.65
  20   0.0431     98.580  0.0310    99.020  943.78
  21   0.0499     98.490  0.0312    98.992  990.72
  22   0.0448     98.470  0.0312    99.012  1037.66
  23   0.0389     98.610  0.0301    99.022  1084.57
  24   0.0426     98.650  0.0274    99.097  1131.65
  25   0.0477     98.440  0.0269    99.107  1178.59
  26   0.0526     98.390  0.0257    99.153  1225.53
  27   0.0377     98.680  0.0275    99.117  1272.43
  28   0.0426     98.620  0.0253    99.147  1319.39
  29   0.0466     98.480  0.0245    99.228  1366.34
  30   0.0465     98.360  0.0242    99.210  1413.27
  31   0.0462     98.570  0.0229    99.248  1460.19
  32   0.0411     98.720  0.0219    99.300  1507.09
  33   0.0348     98.890  0.0224    99.263  1554.05
  34   0.0505     98.420  0.0223    99.252  1600.96
  35   0.0309     98.940  0.0217    99.333  1647.86
  36   0.0308     98.960  0.0207    99.305  1694.95
  37   0.0401     98.720  0.0191    99.358  1741.87
  38   0.0372     98.750  0.0198    99.345  1788.82
  39   0.0545     98.300  0.0190    99.357  1835.77
  40   0.0371     98.840  0.0190    99.333  1882.75
  41   0.0464     98.570  0.0183    99.375  1929.70
  42   0.0489     98.400  0.0169    99.447  1976.60
  43   0.0423     98.610  0.0164    99.465  2023.48
  44   0.0453     98.550  0.0165    99.483  2070.40
  45   0.0395     98.740  0.0178    99.387  2117.31
  46   0.0378     98.720  0.0177    99.408  2164.40
  47   0.0447     98.710  0.0177    99.380  2211.39
  48   0.0385     98.790  0.0152    99.505  2258.35
  49   0.0421     98.740  0.0152    99.500  2305.26
  50   0.0386     98.710  0.0156    99.502  2352.20
  51   0.0523     98.430  0.0147    99.493  2399.15
  52   0.0368     98.920  0.0146    99.497  2446.06
  53   0.0535     98.550  0.0149    99.487  2492.95
  54   0.0417     98.650  0.0139    99.530  2539.87
  55   0.0353     98.920  0.0138    99.530  2587.04
  56   0.0354     98.910  0.0139    99.532  2633.97
  57   0.0423     98.680  0.0133    99.537  2680.88
  58   0.0360     99.000  0.0131    99.552  2727.79
  59   0.0358     98.970  0.0117    99.622  2774.76
  60   0.0379     98.860  0.0124    99.555  2821.70
  61   0.0363     98.890  0.0122    99.582  2868.64
  62   0.0367     99.040  0.0118    99.578  2915.52
  63   0.0425     98.850  0.0123    99.558  2962.46
  64   0.0436     98.660  0.0115    99.607  3009.42
  65   0.0406     98.760  0.0112    99.610  3056.35
  66   0.0426     98.730  0.0107    99.610  3103.27
  67   0.0356     98.920  0.0119    99.578  3150.16
  68   0.0420     98.760  0.0102    99.657  3197.10
  69   0.0433     98.650  0.0104    99.648  3244.01
  70   0.0382     98.820  0.0108    99.598  3290.94
  71   0.0445     98.750  0.0092    99.713  3337.89
  72   0.0386     98.910  0.0097    99.663  3384.83
  73   0.0474     98.640  0.0099    99.673  3431.75
  74   0.0405     98.840  0.0088    99.707  3478.69
  75   0.0490     98.600  0.0092    99.670  3525.64
  76   0.0398     98.800  0.0094    99.657  3572.62
  77   0.0345     99.060  0.0091    99.683  3619.56
  78   0.0418     98.750  0.0095    99.668  3666.46
  79   0.0405     98.810  0.0087    99.690  3713.36
  80   0.0412     98.870  0.0104    99.660  3760.26
  81   0.0538     98.680  0.0093    99.665  3807.21
  82   0.0351     99.020  0.0087    99.707  3854.15
  83   0.0382     98.950  0.0080    99.710  3901.13
  84   0.0384     98.910  0.0089    99.705  3948.09
  85   0.0362     99.030  0.0075    99.727  3995.04
  86   0.0634     98.400  0.0080    99.720  4042.00
  87   0.0403     98.900  0.0076    99.742  4088.95
  88   0.0549     98.760  0.0076    99.743  4135.82
  89   0.0462     98.880  0.0074    99.762  4182.75
  90   0.0508     98.690  0.0078    99.713  4229.70
