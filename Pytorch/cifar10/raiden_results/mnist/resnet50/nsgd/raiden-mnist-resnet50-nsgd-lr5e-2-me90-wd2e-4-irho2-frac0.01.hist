Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2173     18.190  3.5517    13.833  51.53
   2   0.9388     67.950  1.7194    38.838  98.30
   3   0.3447     89.720  0.5524    82.607  145.33
   4   0.2091     93.880  0.2392    92.907  192.10
   5   0.1012     96.780  0.1614    95.027  239.18
   6   0.1088     96.380  0.1218    96.225  286.23
   7   0.1058     96.490  0.1044    96.755  333.32
   8   0.0643     97.790  0.0872    97.305  380.42
   9   0.0751     97.810  0.0792    97.547  427.53
  10   0.0685     97.770  0.0719    97.767  474.25
  11   0.0538     98.250  0.0670    97.900  521.28
  12   0.0585     98.280  0.0614    98.085  568.00
  13   0.0547     98.260  0.0592    98.158  615.06
  14   0.0626     97.860  0.0557    98.272  662.14
  15   0.0555     98.180  0.0523    98.325  708.89
  16   0.0652     97.870  0.0473    98.527  755.95
  17   0.0417     98.670  0.0482    98.482  802.74
  18   0.0519     98.310  0.0446    98.558  849.77
  19   0.0436     98.540  0.0423    98.667  896.77
  20   0.0442     98.510  0.0399    98.772  943.86
  21   0.0440     98.430  0.0395    98.760  990.95
  22   0.0447     98.560  0.0394    98.717  1038.04
  23   0.0456     98.580  0.0365    98.827  1085.12
  24   0.0533     98.420  0.0367    98.817  1131.92
  25   0.0550     98.310  0.0362    98.858  1178.99
  26   0.0435     98.410  0.0345    98.878  1226.06
  27   0.0436     98.630  0.0340    98.897  1273.14
  28   0.0367     98.850  0.0318    99.022  1320.17
  29   0.0403     98.720  0.0313    98.993  1366.89
  30   0.0489     98.510  0.0306    99.023  1413.92
  31   0.0661     97.780  0.0290    99.025  1461.00
  32   0.0459     98.570  0.0289    99.030  1508.09
  33   0.0473     98.550  0.0278    99.095  1554.86
  34   0.0291     99.040  0.0290    99.060  1601.91
  35   0.0347     98.920  0.0272    99.082  1648.97
  36   0.0591     98.250  0.0253    99.210  1695.67
  37   0.0331     98.910  0.0255    99.148  1742.37
  38   0.0330     98.880  0.0245    99.205  1789.46
  39   0.0347     98.990  0.0233    99.263  1836.55
  40   0.0446     98.780  0.0226    99.268  1883.63
  41   0.0356     98.810  0.0223    99.272  1930.39
  42   0.0369     98.890  0.0214    99.302  1977.46
  43   0.0417     98.560  0.0204    99.313  2024.70
  44   0.0338     98.920  0.0198    99.360  2071.71
  45   0.0358     98.830  0.0203    99.343  2118.42
  46   0.0375     98.800  0.0176    99.380  2165.45
  47   0.0390     98.680  0.0200    99.352  2212.53
  48   0.0315     98.960  0.0184    99.392  2259.62
  49   0.0381     98.690  0.0163    99.468  2306.36
  50   0.0303     99.060  0.0169    99.463  2353.42
  51   0.0294     99.010  0.0147    99.477  2400.49
  52   0.0392     98.760  0.0144    99.537  2447.61
  53   0.0300     99.030  0.0150    99.520  2494.67
  54   0.0454     98.610  0.0142    99.528  2541.70
  55   0.0357     98.900  0.0144    99.525  2588.92
  56   0.0312     99.030  0.0126    99.605  2636.02
  57   0.0370     98.830  0.0131    99.568  2683.12
  58   0.0376     98.840  0.0117    99.605  2730.18
  59   0.0321     98.930  0.0114    99.638  2777.22
  60   0.0423     98.730  0.0114    99.615  2824.29
  61   0.0367     98.970  0.0096    99.680  2871.42
  62   0.0450     98.690  0.0089    99.693  2918.48
  63   0.0328     98.920  0.0089    99.717  2965.49
  64   0.0453     98.720  0.0084    99.730  3012.51
  65   0.0374     98.910  0.0090    99.715  3059.56
  66   0.0348     98.940  0.0076    99.745  3106.66
  67   0.0309     99.130  0.0069    99.797  3153.75
  68   0.0342     98.920  0.0066    99.770  3200.85
  69   0.0370     98.980  0.0064    99.798  3247.95
  70   0.0422     98.810  0.0063    99.775  3294.99
  71   0.0402     98.800  0.0055    99.828  3342.02
  72   0.0394     98.830  0.0053    99.847  3388.73
  73   0.0407     98.880  0.0049    99.853  3435.79
  74   0.0360     98.850  0.0046    99.863  3482.87
  75   0.0420     98.680  0.0044    99.882  3529.99
  76   0.0393     98.950  0.0039    99.893  3577.08
  77   0.0372     98.890  0.0034    99.897  3624.16
  78   0.0376     98.870  0.0038    99.888  3671.26
  79   0.0372     98.920  0.0036    99.878  3718.31
  80   0.0394     98.850  0.0037    99.875  3765.34
  81   0.0409     98.850  0.0033    99.913  3812.43
  82   0.0367     98.990  0.0029    99.917  3859.48
  83   0.0355     99.000  0.0027    99.923  3906.61
  84   0.0353     98.970  0.0029    99.920  3953.69
  85   0.0501     98.750  0.0026    99.932  4000.74
  86   0.0456     98.830  0.0029    99.913  4047.77
  87   0.0342     98.980  0.0024    99.935  4094.79
  88   0.0490     98.670  0.0022    99.948  4141.87
  89   0.0358     98.990  0.0025    99.928  4188.89
  90   0.0477     98.680  0.0027    99.922  4236.02
