Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.7942     32.300  2.9916    16.078  52.93
   2   0.5433     87.730  0.7317    74.635  100.14
   3   79.4107     58.200  0.2203    93.130  147.03
   4   0.0879     97.060  0.1443    95.510  193.93
   5   0.0905     97.320  0.0986    96.950  240.86
   6   0.0720     97.660  0.0788    97.530  287.81
   7   0.0747     97.480  0.0704    97.792  334.66
   8   0.0619     97.890  0.0615    98.022  381.51
   9   0.0584     98.090  0.0558    98.290  428.52
  10   0.0669     97.780  0.0517    98.342  475.46
  11   0.0464     98.240  0.0488    98.487  522.38
  12   0.0455     98.290  0.0453    98.593  569.30
  13   0.0557     98.260  0.0437    98.565  616.31
  14   0.0781     97.920  0.0428    98.640  663.20
  15   0.0412     98.590  0.0385    98.760  710.07
  16   0.0413     98.640  0.0366    98.813  756.98
  17   0.0377     98.710  0.0373    98.790  803.94
  18   0.0479     98.280  0.0357    98.843  850.85
  19   0.0469     98.570  0.0314    98.997  897.75
  20   0.0471     98.490  0.0322    98.977  944.66
  21   0.0468     98.480  0.0323    98.995  991.59
  22   0.0378     98.830  0.0283    99.063  1038.50
  23   0.0358     98.870  0.0290    99.055  1085.43
  24   0.0469     98.490  0.0276    99.095  1132.36
  25   0.0837     98.250  0.0269    99.127  1179.29
  26   0.0443     98.660  0.0254    99.152  1226.20
  27   0.0468     98.470  0.0249    99.177  1273.12
  28   0.0413     98.550  0.0239    99.240  1320.07
  29   0.0310     98.950  0.0231    99.203  1367.00
  30   0.0283     99.030  0.0227    99.233  1413.94
  31   0.0312     98.940  0.0218    99.277  1460.89
  32   0.0330     98.840  0.0214    99.290  1507.79
  33   0.0306     98.960  0.0202    99.335  1554.71
  34   0.0545     98.270  0.0191    99.370  1601.84
  35   0.0361     98.740  0.0196    99.348  1648.77
  36   0.0274     99.070  0.0181    99.335  1695.66
  37   0.0358     98.920  0.0181    99.410  1742.58
  38   0.0465     98.590  0.0173    99.412  1789.53
  39   0.0297     98.950  0.0160    99.463  1836.49
  40   0.0304     99.040  0.0154    99.493  1883.42
  41   0.0279     99.160  0.0162    99.473  1930.33
  42   0.0328     99.060  0.0150    99.478  1977.24
  43   0.0283     99.100  0.0146    99.513  2024.14
  44   0.0266     99.210  0.0144    99.520  2071.11
  45   0.0608     98.430  0.0137    99.547  2118.06
  46   0.0771     98.490  0.0122    99.573  2165.07
  47   0.0333     99.000  0.0136    99.537  2212.02
  48   0.0296     99.050  0.0120    99.595  2259.00
  49   0.0404     98.790  0.0121    99.585  2305.91
  50   0.0290     99.090  0.0114    99.600  2352.77
  51   0.0442     98.670  0.0112    99.618  2399.68
  52   0.1214     97.810  0.0108    99.642  2446.58
  53   0.0293     99.060  0.0100    99.682  2493.52
  54   0.0324     99.000  0.0098    99.693  2540.47
  55   0.0290     99.110  0.0093    99.702  2587.39
  56   0.0250     99.220  0.0086    99.702  2634.34
  57   0.0259     99.220  0.0103    99.655  2681.31
  58   0.0318     99.060  0.0092    99.688  2728.24
  59   0.0293     99.110  0.0086    99.700  2775.12
  60   0.0359     98.970  0.0085    99.722  2822.04
  61   0.0447     98.720  0.0081    99.727  2868.97
  62   0.0290     99.150  0.0080    99.723  2916.14
  63   0.0289     99.180  0.0080    99.745  2963.10
  64   0.0331     99.050  0.0073    99.765  3010.05
  65   0.0334     99.050  0.0071    99.757  3057.01
  66   0.0287     99.150  0.0062    99.797  3103.91
  67   0.0382     99.030  0.0067    99.762  3150.82
  68   0.0351     98.970  0.0058    99.815  3197.75
  69   0.0309     99.120  0.0065    99.788  3244.65
  70   0.0427     98.870  0.0058    99.818  3291.60
  71   0.0339     99.070  0.0054    99.838  3338.52
  72   0.0335     99.080  0.0055    99.825  3385.47
  73   0.0327     99.110  0.0053    99.848  3432.43
  74   0.0372     99.010  0.0051    99.845  3479.34
  75   0.0282     99.190  0.0048    99.857  3526.28
  76   0.0283     99.180  0.0048    99.835  3573.24
  77   0.0326     99.070  0.0045    99.863  3620.13
  78   0.0345     99.010  0.0043    99.855  3667.02
  79   0.0379     99.190  0.0049    99.833  3713.93
  80   0.0363     99.130  0.0046    99.867  3760.82
  81   0.0345     99.020  0.0040    99.890  3807.95
  82   0.0298     99.220  0.0038    99.882  3855.05
  83   0.0288     99.270  0.0038    99.890  3901.99
  84   0.0514     98.880  0.0033    99.908  3948.96
  85   0.0315     99.190  0.0034    99.903  3995.91
  86   0.0336     99.120  0.0031    99.910  4042.82
  87   0.0318     99.040  0.0035    99.898  4089.70
  88   0.0418     99.000  0.0034    99.900  4136.65
  89   0.0307     99.190  0.0035    99.885  4183.57
  90   0.0354     99.050  0.0033    99.925  4230.56
