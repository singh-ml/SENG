Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.8075     30.820  3.4139    16.308  51.55
   2   0.3397     88.790  0.9138    66.700  98.59
   3   0.1563     94.920  0.2945    90.328  145.73
   4   0.1416     95.370  0.1528    95.192  192.82
   5   0.0944     96.930  0.1087    96.558  239.95
   6   0.0799     97.340  0.0870    97.310  287.08
   7   0.0855     97.250  0.0766    97.593  334.19
   8   0.0517     98.420  0.0680    97.922  381.28
   9   0.0596     98.070  0.0618    98.112  428.33
  10   0.0422     98.600  0.0574    98.183  475.41
  11   0.0450     98.540  0.0514    98.363  522.48
  12   0.0496     98.390  0.0495    98.438  569.55
  13   0.0405     98.700  0.0462    98.562  616.67
  14   0.0492     98.450  0.0459    98.542  663.81
  15   0.0441     98.490  0.0431    98.625  710.92
  16   0.0429     98.510  0.0406    98.693  757.99
  17   0.0520     98.120  0.0391    98.753  805.08
  18   0.0439     98.500  0.0375    98.813  852.16
  19   0.0363     98.750  0.0368    98.835  899.42
  20   0.0392     98.620  0.0369    98.827  946.53
  21   0.0525     98.260  0.0342    98.883  993.32
  22   0.0374     98.710  0.0315    98.978  1040.40
  23   0.0364     98.850  0.0312    99.000  1087.52
  24   0.0439     98.430  0.0308    99.017  1134.61
  25   0.0500     98.290  0.0304    98.998  1181.69
  26   0.0323     98.980  0.0292    99.052  1228.76
  27   0.0376     98.910  0.0273    99.150  1275.88
  28   0.0378     98.850  0.0266    99.145  1322.97
  29   0.0383     98.710  0.0257    99.157  1370.09
  30   0.0348     98.970  0.0260    99.170  1417.30
  31   0.0401     98.650  0.0249    99.200  1464.38
  32   0.0335     98.940  0.0246    99.222  1511.53
  33   0.0371     98.880  0.0236    99.205  1558.36
  34   0.0408     98.660  0.0241    99.183  1605.46
  35   0.0329     98.870  0.0225    99.233  1652.56
  36   0.0405     98.650  0.0220    99.260  1699.61
  37   0.0365     98.760  0.0204    99.332  1746.68
  38   0.0258     99.190  0.0198    99.365  1793.81
  39   0.0348     98.780  0.0188    99.358  1840.92
  40   0.0332     98.960  0.0186    99.403  1888.00
  41   0.0339     98.880  0.0173    99.412  1935.10
  42   0.0312     98.970  0.0201    99.310  1982.16
  43   0.0330     98.960  0.0177    99.450  2029.22
  44   0.0367     98.620  0.0165    99.385  2076.30
  45   0.0288     99.060  0.0169    99.450  2123.41
  46   0.0263     99.180  0.0164    99.457  2170.48
  47   0.0565     98.160  0.0159    99.475  2217.58
  48   0.0279     99.070  0.0156    99.483  2264.73
  49   0.0326     98.980  0.0144    99.507  2311.82
  50   0.0407     98.750  0.0141    99.537  2358.92
  51   0.0435     98.720  0.0139    99.512  2406.02
  52   0.0374     98.770  0.0133    99.552  2453.07
  53   0.0331     98.840  0.0133    99.567  2500.14
  54   0.0362     98.870  0.0128    99.555  2547.16
  55   0.0297     99.100  0.0122    99.598  2594.25
  56   0.0304     99.060  0.0119    99.630  2641.34
  57   0.0318     99.010  0.0120    99.590  2688.46
  58   0.0396     98.700  0.0107    99.640  2735.61
  59   0.0361     98.910  0.0109    99.640  2782.70
  60   0.0339     99.030  0.0098    99.683  2829.77
  61   0.0353     98.980  0.0099    99.670  2876.85
  62   0.0223     99.180  0.0102    99.658  2923.94
  63   0.0308     98.990  0.0092    99.707  2971.10
  64   0.0293     99.030  0.0092    99.707  3018.16
  65   0.0387     99.010  0.0093    99.703  3065.25
  66   0.0322     99.020  0.0088    99.712  3112.36
  67   0.0339     98.970  0.0084    99.712  3159.49
  68   0.0266     99.230  0.0081    99.732  3206.68
  69   0.0315     98.920  0.0081    99.732  3253.84
  70   0.0294     99.180  0.0083    99.715  3300.93
  71   0.0372     98.980  0.0070    99.777  3347.66
  72   0.0270     99.170  0.0067    99.800  3394.72
  73   0.0316     99.010  0.0075    99.758  3441.83
  74   0.0390     98.730  0.0072    99.753  3488.97
  75   0.0272     99.030  0.0078    99.718  3536.06
  76   0.0297     99.080  0.0064    99.778  3583.19
  77   0.0318     99.050  0.0066    99.790  3630.29
  78   0.0302     99.010  0.0066    99.785  3677.39
  79   0.0298     99.160  0.0055    99.833  3724.49
  80   0.0414     98.890  0.0061    99.820  3771.58
  81   0.0347     99.120  0.0051    99.845  3818.70
  82   0.0345     98.970  0.0053    99.838  3865.83
  83   0.0381     98.910  0.0056    99.823  3912.97
  84   0.0338     98.980  0.0053    99.840  3960.10
  85   0.0293     99.050  0.0051    99.837  4007.23
  86   0.0388     98.960  0.0052    99.845  4054.29
  87   0.0341     99.110  0.0049    99.848  4101.39
  88   0.0337     99.000  0.0051    99.827  4148.46
  89   0.0314     99.110  0.0047    99.852  4195.82
  90   0.0310     99.130  0.0047    99.845  4243.01
