Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2988     11.360  3.8238    10.575  51.71
   2   2.3038     12.780  2.3026    11.073  98.44
   3   1.5300     42.020  2.1161    19.380  145.12
   4   1.0350     66.940  1.2028    57.387  192.13
   5   0.4244     86.330  0.6693    77.980  239.12
   6   0.2825     91.210  0.3439    89.268  286.08
   7   0.2229     92.990  0.2229    93.160  333.08
   8   0.1920     94.140  0.1743    94.687  380.05
   9   0.2316     94.630  0.1538    95.267  426.69
  10   0.1224     95.970  0.1377    95.733  473.84
  11   0.1943     95.400  0.1189    96.252  520.82
  12   0.1030     96.800  0.1091    96.545  567.80
  13   0.1568     95.290  0.1047    96.713  614.48
  14   0.1367     96.700  0.0983    96.928  661.44
  15   0.2233     96.340  0.0953    97.005  708.45
  16   0.1031     96.570  0.0899    97.140  755.42
  17   0.0845     97.240  0.0829    97.390  802.36
  18   0.0900     97.070  0.0800    97.462  849.40
  19   0.0594     98.040  0.0751    97.615  896.62
  20   0.1008     96.780  0.0710    97.768  943.66
  21   3.0475     95.550  0.0704    97.832  990.68
  22   0.0720     97.580  0.0651    97.888  1037.68
  23   0.5714     95.920  0.0706    97.728  1084.66
  24   0.0615     97.840  0.0633    97.960  1131.63
  25   0.0715     97.540  0.0573    98.180  1178.62
  26   0.0730     97.800  0.0576    98.172  1225.55
  27   0.3833     96.380  0.0549    98.275  1272.57
  28   0.0451     98.480  0.0536    98.278  1319.24
  29   0.0614     98.020  0.0531    98.360  1366.27
  30   0.0704     97.620  0.0514    98.387  1413.29
  31   0.0512     98.300  0.0531    98.240  1460.32
  32   0.0601     98.080  0.0503    98.355  1507.33
  33   0.0590     98.070  0.0479    98.438  1554.30
  34   0.0379     98.790  0.0492    98.385  1601.25
  35   0.0649     97.960  0.0450    98.577  1648.25
  36   0.0472     98.510  0.0451    98.525  1695.23
  37   0.0485     98.380  0.0419    98.660  1742.18
  38   0.0592     98.000  0.0428    98.607  1789.14
  39   0.0339     98.770  0.0411    98.633  1836.11
  40   0.0540     98.340  0.0405    98.703  1883.12
  41   0.0498     98.260  0.0388    98.713  1930.08
  42   0.0560     98.150  0.0389    98.753  1976.74
  43   0.0472     98.360  0.0386    98.757  2023.68
  44   0.0373     98.770  0.0359    98.795  2070.64
  45   0.0415     98.630  0.0368    98.803  2117.79
  46   0.0416     98.610  0.0343    98.905  2164.74
  47   0.0405     98.550  0.0353    98.815  2211.78
  48   0.0440     98.560  0.0332    98.927  2258.92
  49   0.0436     98.500  0.0315    98.982  2305.95
  50   0.0441     98.580  0.0306    99.017  2352.95
  51   0.0461     98.490  0.0308    99.000  2399.90
  52   0.0403     98.740  0.0303    98.997  2446.87
  53   0.0354     98.860  0.0296    99.068  2493.87
  54   0.0294     99.020  0.0275    99.107  2540.91
  55   0.0479     98.350  0.0274    99.128  2587.90
  56   0.0313     98.910  0.0270    99.115  2634.91
  57   0.0403     98.700  0.0244    99.185  2681.94
  58   0.0425     98.560  0.0248    99.178  2728.93
  59   0.0378     98.700  0.0231    99.223  2775.90
  60   0.0339     98.760  0.0232    99.247  2822.89
  61   0.0302     98.940  0.0221    99.270  2869.88
  62   0.0400     98.600  0.0210    99.295  2916.88
  63   0.0321     98.900  0.0193    99.350  2963.84
  64   0.0303     98.930  0.0192    99.373  3010.79
  65   0.0304     99.060  0.0190    99.378  3057.78
  66   0.0409     98.690  0.0182    99.408  3104.80
  67   0.0325     98.960  0.0168    99.442  3151.85
  68   0.0359     98.810  0.0158    99.487  3198.81
  69   0.0420     98.630  0.0144    99.537  3245.79
  70   0.0295     99.040  0.0156    99.497  3292.76
  71   0.0302     99.050  0.0137    99.552  3339.91
  72   0.0417     98.680  0.0128    99.602  3386.92
  73   0.0327     98.990  0.0134    99.570  3433.91
  74   0.0296     99.100  0.0124    99.585  3480.91
  75   1.7783     96.830  0.0118    99.602  3527.92
  76   0.0325     99.050  0.0109    99.653  3574.93
  77   0.0290     99.090  0.0113    99.627  3621.91
  78   0.0364     98.870  0.0103    99.672  3668.88
  79   0.0342     99.010  0.0101    99.668  3715.91
  80   0.0368     98.940  0.0092    99.705  3762.90
  81   0.0302     99.150  0.0091    99.707  3809.89
  82   0.0318     99.060  0.0088    99.737  3856.90
  83   0.0355     99.010  0.0084    99.750  3903.91
  84   0.0293     99.170  0.0081    99.738  3951.22
  85   0.0326     99.040  0.0080    99.732  3998.24
  86   0.0307     99.140  0.0075    99.762  4045.21
  87   0.0369     98.880  0.0076    99.763  4092.29
  88   0.0300     99.130  0.0077    99.775  4139.31
  89   0.0357     98.830  0.0077    99.757  4186.35
  90   0.0328     99.010  0.0076    99.767  4233.39
