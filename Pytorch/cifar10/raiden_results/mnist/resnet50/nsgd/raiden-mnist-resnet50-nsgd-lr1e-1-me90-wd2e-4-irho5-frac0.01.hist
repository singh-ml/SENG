Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2705     14.820  3.7572    11.430  51.45
   2   1.6401     35.080  2.0486    22.745  98.07
   3   0.9408     70.390  1.4004    48.152  144.42
   4   0.6807     77.520  0.8773    72.420  190.68
   5   0.4754     86.870  0.5016    84.688  237.31
   6   0.2986     91.220  0.2879    91.755  283.62
   7   0.1377     95.690  0.1834    94.567  330.28
   8   0.1156     96.480  0.1387    95.825  376.95
   9   0.1225     96.420  0.1145    96.495  423.57
  10   0.0771     97.590  0.1005    96.998  470.26
  11   0.0639     97.840  0.0909    97.178  516.90
  12   0.0935     97.140  0.0815    97.515  563.56
  13   0.0682     97.960  0.0775    97.730  610.16
  14   0.0775     97.510  0.0735    97.742  656.80
  15   0.0721     97.730  0.0678    97.945  703.40
  16   0.0583     98.260  0.0665    97.970  749.68
  17   0.0658     98.120  0.0611    98.145  796.33
  18   0.0606     98.220  0.0585    98.232  843.01
  19   0.0641     97.980  0.0572    98.265  889.69
  20   0.0672     97.960  0.0536    98.353  936.31
  21   0.0575     98.290  0.0508    98.408  982.96
  22   0.0707     97.850  0.0505    98.395  1029.61
  23   0.0472     98.550  0.0486    98.488  1076.21
  24   0.0484     98.440  0.0459    98.603  1122.84
  25   0.0497     98.500  0.0464    98.565  1169.42
  26   0.0477     98.400  0.0482    98.482  1216.07
  27   0.0405     98.690  0.0425    98.640  1262.69
  28   0.0461     98.490  0.0447    98.620  1309.66
  29   0.0430     98.600  0.0415    98.697  1356.31
  30   0.0552     98.260  0.0392    98.768  1402.97
  31   0.0403     98.560  0.0394    98.793  1449.61
  32   0.0477     98.340  0.0378    98.792  1496.25
  33   0.0453     98.690  0.0378    98.773  1542.84
  34   0.0388     98.790  0.0364    98.822  1589.48
  35   0.0409     98.660  0.0344    98.878  1636.10
  36   0.0334     98.880  0.0329    98.945  1682.74
  37   0.0497     98.400  0.0339    98.925  1729.41
  38   0.0456     98.510  0.0327    98.925  1776.10
  39   0.0506     98.370  0.0350    98.938  1822.79
  40   0.0378     98.780  0.0310    99.013  1869.46
  41   0.0386     98.740  0.0313    99.027  1916.10
  42   0.0358     98.780  0.0303    99.030  1962.71
  43   0.0326     98.860  0.0279    99.107  2009.33
  44   0.0372     98.760  0.0289    99.082  2056.32
  45   0.0313     99.090  0.0277    99.110  2102.97
  46   0.0334     98.860  0.0269    99.135  2149.60
  47   0.0422     98.740  0.0249    99.188  2196.28
  48   0.0435     98.530  0.0258    99.163  2242.94
  49   0.0468     98.530  0.0257    99.168  2289.59
  50   0.0350     98.710  0.0246    99.198  2336.34
  51   0.0322     99.000  0.0241    99.228  2382.95
  52   0.0345     98.930  0.0218    99.270  2429.58
  53   0.0368     98.760  0.0212    99.310  2476.24
  54   0.0342     98.970  0.0195    99.372  2522.91
  55   0.0388     98.800  0.0186    99.408  2569.56
  56   0.0443     98.750  0.0208    99.305  2616.23
  57   0.0339     98.850  0.0180    99.452  2662.89
  58   0.0277     99.130  0.0185    99.392  2709.60
  59   0.0351     98.830  0.0160    99.483  2756.26
  60   0.0443     98.690  0.0169    99.452  2802.87
  61   0.0298     99.070  0.0150    99.493  2849.51
  62   0.0276     99.110  0.0140    99.525  2896.20
  63   0.0343     98.990  0.0133    99.572  2942.88
  64   0.0311     99.040  0.0124    99.602  2989.57
  65   0.0310     98.910  0.0115    99.623  3036.22
  66   0.0315     99.070  0.0111    99.642  3082.89
  67   0.0315     98.950  0.0095    99.690  3129.54
  68   0.0300     99.030  0.0098    99.673  3176.17
  69   0.0338     98.990  0.0087    99.722  3222.82
  70   0.0340     98.950  0.0088    99.737  3269.47
  71   0.0339     98.960  0.0076    99.757  3316.08
  72   0.0325     99.080  0.0072    99.775  3362.98
  73   0.0358     98.870  0.0063    99.805  3409.62
  74   0.0390     98.910  0.0056    99.818  3456.28
  75   0.0363     98.970  0.0060    99.822  3502.96
  76   0.0331     99.070  0.0050    99.850  3549.64
  77   0.0399     98.930  0.0046    99.858  3596.25
  78   0.0330     98.940  0.0044    99.857  3642.83
  79   0.0334     99.030  0.0043    99.848  3689.45
  80   0.0309     99.090  0.0039    99.868  3736.16
  81   0.0329     99.080  0.0036    99.893  3782.82
  82   0.0315     99.070  0.0034    99.905  3829.49
  83   0.0321     99.110  0.0031    99.923  3876.16
  84   0.0346     98.990  0.0030    99.912  3922.79
  85   0.0333     99.050  0.0029    99.917  3969.60
  86   0.0344     99.000  0.0027    99.923  4016.26
  87   0.0327     99.020  0.0026    99.930  4062.86
  88   0.0322     99.000  0.0025    99.937  4109.51
  89   0.0371     98.960  0.0029    99.913  4156.13
  90   0.0368     98.990  0.0026    99.937  4202.80
