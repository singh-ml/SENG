Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2611     14.120  3.6074    13.155  51.37
   2   1.3563     52.220  1.8855    30.267  98.33
   3   0.3906     88.490  0.7485    75.088  145.26
   4   0.2548     92.470  0.2934    90.925  192.16
   5   0.1538     95.110  0.1837    94.302  239.07
   6   0.0935     97.060  0.1307    96.000  286.29
   7   0.0802     97.420  0.1059    96.698  333.28
   8   0.0875     97.200  0.0872    97.275  380.21
   9   0.0704     97.650  0.0761    97.650  427.15
  10   0.0769     97.590  0.0685    97.860  474.07
  11   0.0560     98.100  0.0629    98.092  520.97
  12   0.0604     98.170  0.0563    98.218  567.90
  13   0.0537     97.990  0.0545    98.287  614.86
  14   0.0430     98.530  0.0513    98.353  661.79
  15   0.0506     98.370  0.0511    98.353  708.72
  16   0.0393     98.540  0.0446    98.563  755.67
  17   0.0531     98.140  0.0433    98.563  802.69
  18   0.0656     98.010  0.0418    98.673  849.28
  19   0.0408     98.460  0.0405    98.710  896.25
  20   0.0581     98.330  0.0384    98.780  943.15
  21   0.0516     98.320  0.0350    98.877  990.08
  22   0.1295     97.440  0.0373    98.785  1036.68
  23   0.0426     98.580  0.0365    98.870  1083.61
  24   0.0519     98.460  0.0329    98.985  1130.54
  25   0.0841     98.250  0.0333    98.920  1177.50
  26   0.0481     98.450  0.0319    98.973  1224.14
  27   0.0468     98.500  0.0293    99.045  1271.09
  28   0.0384     98.610  0.0297    99.008  1318.01
  29   0.0337     98.870  0.0284    99.083  1364.93
  30   0.0460     98.630  0.0275    99.098  1411.83
  31   0.0505     98.500  0.0287    99.063  1458.72
  32   0.0473     98.420  0.0255    99.165  1505.68
  33   0.0373     98.650  0.0263    99.125  1552.63
  34   0.0371     98.770  0.0248    99.190  1599.59
  35   0.0353     98.780  0.0232    99.238  1646.51
  36   0.0349     98.780  0.0235    99.230  1693.41
  37   0.0382     98.750  0.0233    99.248  1740.34
  38   0.0364     98.720  0.0220    99.257  1787.24
  39   0.0354     98.870  0.0217    99.272  1834.36
  40   0.0363     98.950  0.0216    99.277  1881.53
  41   0.0370     98.770  0.0208    99.305  1928.50
  42   0.0428     98.550  0.0200    99.322  1975.41
  43   0.0347     98.790  0.0196    99.325  2022.33
  44   0.0420     98.820  0.0173    99.445  2069.23
  45   0.0397     98.720  0.0186    99.363  2116.14
  46   0.0342     98.870  0.0166    99.465  2163.10
  47   0.0394     98.780  0.0171    99.417  2209.66
  48   0.0337     98.790  0.0167    99.445  2256.68
  49   0.0306     98.920  0.0153    99.470  2303.57
  50   0.0340     98.860  0.0157    99.477  2350.55
  51   0.0456     98.550  0.0152    99.497  2397.47
  52   0.0401     98.660  0.0133    99.543  2444.39
  53   0.0418     98.670  0.0133    99.573  2491.31
  54   0.0579     98.240  0.0135    99.535  2538.25
  55   0.0428     98.820  0.0143    99.507  2585.17
  56   0.0494     98.390  0.0134    99.575  2632.08
  57   0.0334     98.940  0.0124    99.600  2679.22
  58   0.0428     98.780  0.0129    99.573  2726.15
  59   0.0447     98.670  0.0114    99.620  2773.13
  60   0.0385     98.870  0.0111    99.620  2820.09
  61   0.0335     98.880  0.0110    99.628  2867.00
  62   0.0317     98.970  0.0106    99.642  2913.89
  63   0.0367     98.960  0.0100    99.663  2960.82
  64   0.0423     98.720  0.0102    99.637  3007.72
  65   0.0371     98.830  0.0095    99.653  3054.65
  66   0.0454     98.740  0.0096    99.690  3101.60
  67   0.0331     98.910  0.0094    99.690  3148.54
  68   0.0340     98.970  0.0084    99.728  3195.48
  69   0.0351     99.000  0.0085    99.755  3242.46
  70   0.0386     98.880  0.0088    99.703  3289.35
  71   0.0332     98.920  0.0078    99.747  3336.33
  72   0.0325     98.920  0.0078    99.742  3383.27
  73   0.0351     98.870  0.0078    99.727  3430.15
  74   0.0324     98.990  0.0074    99.753  3477.06
  75   0.0322     99.010  0.0073    99.743  3523.99
  76   0.0440     98.630  0.0061    99.790  3570.94
  77   0.0338     98.990  0.0069    99.788  3617.89
  78   0.0336     99.010  0.0065    99.773  3664.88
  79   0.0380     98.810  0.0064    99.773  3711.82
  80   0.0378     98.790  0.0064    99.792  3758.75
  81   0.0382     98.870  0.0057    99.807  3805.70
  82   0.0457     98.760  0.0059    99.797  3852.63
  83   0.0360     98.900  0.0061    99.807  3899.59
  84   0.0373     98.940  0.0059    99.805  3946.56
  85   0.0367     98.980  0.0055    99.835  3993.53
  86   0.0375     98.950  0.0053    99.835  4040.47
  87   0.0375     98.990  0.0057    99.810  4087.43
  88   0.0367     99.050  0.0052    99.828  4134.30
  89   0.0409     98.820  0.0055    99.818  4181.21
  90   0.0379     98.820  0.0053    99.813  4228.09
