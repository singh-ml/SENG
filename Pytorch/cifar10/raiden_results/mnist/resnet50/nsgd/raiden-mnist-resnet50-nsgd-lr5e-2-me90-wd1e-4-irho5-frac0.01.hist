Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.0762     20.480  3.5919    13.078  51.38
   2   1.7203     35.160  1.9708    26.510  98.02
   3   0.5869     79.490  1.1706    56.002  144.33
   4   0.3126     91.390  0.4323    86.668  190.94
   5   0.2071     93.670  0.2411    93.035  237.59
   6   0.1439     95.230  0.1743    94.827  284.21
   7   0.1242     96.280  0.1410    95.763  331.18
   8   0.1436     95.420  0.1137    96.497  377.79
   9   0.0822     97.380  0.0952    97.052  424.47
  10   0.0647     97.970  0.0861    97.378  471.40
  11   0.0777     97.570  0.0771    97.583  518.02
  12   0.0883     97.340  0.0698    97.842  564.59
  13   0.0642     97.860  0.0640    98.022  611.40
  14   0.0495     98.420  0.0606    98.118  658.01
  15   0.0561     98.330  0.0568    98.278  704.65
  16   0.0623     98.020  0.0538    98.312  751.28
  17   0.0509     98.390  0.0522    98.362  797.93
  18   0.0694     97.780  0.0479    98.475  844.56
  19   0.0467     98.430  0.0467    98.523  891.15
  20   0.0571     98.140  0.0444    98.597  937.75
  21   0.0452     98.470  0.0409    98.758  984.30
  22   0.0648     98.040  0.0416    98.672  1030.89
  23   0.0692     97.710  0.0403    98.702  1077.81
  24   0.0474     98.460  0.0380    98.828  1124.47
  25   0.0447     98.540  0.0384    98.787  1171.14
  26   0.0344     98.830  0.0362    98.810  1217.75
  27   0.0404     98.610  0.0348    98.893  1264.41
  28   0.0506     98.460  0.0351    98.923  1311.09
  29   0.0345     98.780  0.0321    98.993  1357.67
  30   0.0503     98.300  0.0337    98.938  1404.28
  31   0.0527     98.250  0.0309    99.008  1450.86
  32   0.0370     98.790  0.0315    98.997  1497.50
  33   0.0381     98.800  0.0305    99.038  1544.16
  34   0.0400     98.740  0.0277    99.112  1590.77
  35   0.0425     98.670  0.0292    99.057  1637.39
  36   0.0366     98.790  0.0281    99.103  1684.02
  37   0.0429     98.740  0.0273    99.122  1730.65
  38   0.0466     98.660  0.0264    99.175  1777.27
  39   0.0377     98.800  0.0268    99.115  1823.89
  40   0.0351     98.750  0.0261    99.152  1870.48
  41   0.0479     98.510  0.0237    99.247  1917.08
  42   0.0584     98.280  0.0237    99.213  1963.99
  43   0.0411     98.790  0.0219    99.317  2010.89
  44   0.0373     98.740  0.0222    99.260  2057.50
  45   0.0349     98.910  0.0226    99.242  2104.14
  46   0.0391     98.730  0.0203    99.340  2150.74
  47   0.0351     99.000  0.0206    99.323  2197.38
  48   0.0376     98.830  0.0206    99.350  2243.97
  49   0.0442     98.610  0.0199    99.337  2290.59
  50   0.0307     99.040  0.0180    99.430  2337.19
  51   0.0336     98.990  0.0173    99.455  2384.08
  52   0.0278     99.080  0.0175    99.455  2430.71
  53   0.0288     99.080  0.0167    99.453  2477.35
  54   0.0352     98.800  0.0168    99.428  2523.96
  55   0.0339     98.940  0.0159    99.467  2570.59
  56   0.0300     98.980  0.0151    99.515  2617.24
  57   0.0372     98.860  0.0149    99.523  2663.89
  58   0.0320     99.070  0.0146    99.520  2710.82
  59   0.0335     98.910  0.0146    99.532  2757.44
  60   0.0329     99.000  0.0137    99.553  2804.36
  61   0.0321     99.030  0.0131    99.602  2850.97
  62   0.0397     98.870  0.0131    99.563  2897.56
  63   0.0337     99.000  0.0120    99.620  2944.36
  64   0.0388     98.800  0.0126    99.592  2990.99
  65   0.0267     99.190  0.0117    99.623  3037.92
  66   0.0329     98.920  0.0106    99.652  3084.59
  67   0.0299     99.130  0.0103    99.682  3131.56
  68   0.0298     99.010  0.0103    99.687  3178.15
  69   0.0373     98.790  0.0105    99.683  3224.73
  70   0.0386     98.760  0.0095    99.698  3271.31
  71   0.0353     98.970  0.0099    99.678  3317.92
  72   0.0365     98.900  0.0087    99.705  3364.72
  73   0.0292     99.050  0.0085    99.727  3411.54
  74   0.0333     98.990  0.0085    99.742  3458.18
  75   0.0307     98.960  0.0081    99.763  3504.78
  76   0.0335     98.990  0.0078    99.775  3551.42
  77   0.0329     99.050  0.0083    99.743  3598.01
  78   0.0310     99.130  0.0079    99.767  3644.62
  79   0.0359     98.930  0.0074    99.775  3691.24
  80   0.0363     98.950  0.0072    99.780  3737.82
  81   0.0330     99.030  0.0072    99.770  3784.63
  82   0.0401     98.940  0.0076    99.765  3831.45
  83   0.0349     98.980  0.0073    99.773  3878.08
  84   0.0342     98.970  0.0071    99.773  3924.72
  85   0.0329     99.020  0.0069    99.792  3971.34
  86   0.0371     98.910  0.0074    99.765  4017.96
  87   0.0356     98.940  0.0067    99.793  4064.57
  88   0.0359     98.950  0.0068    99.810  4111.48
  89   0.0431     98.750  0.0064    99.800  4158.07
  90   0.0348     98.980  0.0062    99.813  4204.64
