Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4649     85.560  2.0817    48.688  51.61
   2   0.1391     95.390  0.2272    92.972  98.65
   3   0.0973     96.850  0.1258    96.082  145.70
   4   0.0799     97.380  0.0927    97.147  192.70
   5   0.0740     97.700  0.0786    97.610  239.69
   6   0.0684     97.840  0.0676    97.913  286.71
   7   0.0648     97.800  0.0592    98.137  333.74
   8   0.0528     98.320  0.0532    98.302  380.75
   9   0.0577     98.240  0.0522    98.308  427.76
  10   0.0569     98.250  0.0462    98.568  474.85
  11   0.0493     98.440  0.0434    98.620  521.90
  12   0.0474     98.500  0.0421    98.692  568.91
  13   0.0480     98.470  0.0392    98.772  615.94
  14   0.0432     98.640  0.0356    98.860  662.98
  15   0.0433     98.680  0.0348    98.902  710.16
  16   0.0442     98.610  0.0345    98.870  757.17
  17   0.0425     98.660  0.0314    99.025  804.35
  18   0.0436     98.640  0.0323    98.972  851.40
  19   0.0393     98.770  0.0295    99.045  898.42
  20   0.0539     98.310  0.0288    99.070  945.53
  21   0.0384     98.780  0.0277    99.083  992.56
  22   0.0432     98.620  0.0254    99.163  1039.61
  23   0.0364     98.900  0.0253    99.175  1086.78
  24   0.0488     98.430  0.0230    99.257  1133.80
  25   0.0477     98.490  0.0240    99.213  1180.87
  26   0.0407     98.660  0.0231    99.243  1228.01
  27   0.0469     98.500  0.0220    99.257  1275.00
  28   0.0388     98.770  0.0205    99.327  1322.01
  29   0.0376     98.830  0.0214    99.247  1369.03
  30   0.0402     98.750  0.0200    99.342  1416.05
  31   0.0355     98.820  0.0178    99.435  1463.09
  32   0.0380     98.900  0.0187    99.385  1510.12
  33   0.0312     99.020  0.0178    99.417  1557.17
  34   0.0395     98.770  0.0184    99.400  1604.22
  35   0.0371     98.720  0.0167    99.423  1651.24
  36   0.0539     98.440  0.0164    99.438  1698.25
  37   0.0372     98.930  0.0159    99.480  1745.26
  38   0.0347     98.920  0.0153    99.507  1792.29
  39   0.0419     98.700  0.0141    99.538  1839.33
  40   0.0501     98.450  0.0139    99.532  1886.40
  41   0.0365     98.850  0.0131    99.590  1933.47
  42   0.0411     98.820  0.0135    99.543  1980.52
  43   0.0365     98.930  0.0138    99.562  2027.63
  44   0.0383     98.890  0.0115    99.618  2074.67
  45   0.0349     98.930  0.0119    99.577  2121.72
  46   0.0437     98.790  0.0116    99.638  2168.74
  47   0.0533     98.580  0.0109    99.615  2215.76
  48   0.0457     98.660  0.0105    99.657  2263.00
  49   0.0442     98.740  0.0098    99.638  2310.25
  50   0.0356     98.870  0.0099    99.668  2357.30
  51   0.0371     98.900  0.0090    99.708  2404.38
  52   0.0375     98.880  0.0086    99.705  2451.39
  53   0.0375     98.880  0.0088    99.717  2498.43
  54   0.0393     98.810  0.0081    99.738  2545.45
  55   0.0441     98.750  0.0087    99.693  2592.47
  56   0.0370     98.910  0.0079    99.748  2639.56
  57   0.0424     98.850  0.0079    99.737  2686.57
  58   0.0371     98.860  0.0068    99.785  2733.67
  59   0.0419     98.780  0.0066    99.773  2780.74
  60   0.0392     98.880  0.0068    99.775  2827.84
  61   0.0401     98.710  0.0063    99.792  2874.95
  62   0.0345     99.020  0.0059    99.823  2922.01
  63   0.0465     98.660  0.0062    99.805  2969.05
  64   0.0436     98.820  0.0058    99.820  3016.09
  65   0.0383     98.820  0.0053    99.835  3063.13
  66   0.0452     98.840  0.0059    99.825  3110.19
  67   0.0459     98.710  0.0049    99.853  3157.25
  68   0.0450     98.810  0.0053    99.828  3204.28
  69   0.0430     98.790  0.0050    99.833  3251.34
  70   0.0393     98.880  0.0049    99.842  3298.35
  71   0.0382     98.920  0.0044    99.878  3345.37
  72   0.0386     98.880  0.0043    99.885  3392.41
  73   0.0420     98.830  0.0043    99.865  3439.45
  74   0.0372     98.970  0.0039    99.887  3486.56
  75   0.0409     98.970  0.0048    99.858  3533.64
  76   0.0418     98.890  0.0044    99.857  3580.72
  77   0.0326     98.990  0.0038    99.878  3627.79
  78   0.0439     98.820  0.0042    99.877  3674.89
  79   0.0406     98.960  0.0034    99.913  3721.99
  80   0.0436     98.830  0.0041    99.887  3769.04
  81   0.0371     98.990  0.0040    99.888  3816.10
  82   0.0446     98.820  0.0036    99.902  3863.19
  83   0.0444     98.800  0.0034    99.900  3910.25
  84   0.0450     98.810  0.0036    99.902  3957.34
  85   0.0416     98.970  0.0036    99.893  4004.43
  86   0.0383     99.070  0.0033    99.920  4051.47
  87   0.0431     98.850  0.0032    99.920  4098.58
  88   0.0425     98.880  0.0032    99.903  4145.56
  89   0.0414     98.890  0.0035    99.890  4192.57
  90   0.0477     98.780  0.0032    99.908  4239.72
