Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3194     11.980  3.4403    11.423  51.65
   2   2.2943     12.300  2.2972    11.645  97.95
   3   2.2437     17.620  2.2772    13.722  144.59
   4   1.6508     35.090  1.9322    27.223  191.25
   5   1.0904     61.480  1.2226    56.197  237.82
   6   0.8919     77.040  0.8269    72.642  284.79
   7   0.5049     86.610  0.5474    82.708  331.39
   8   0.2693     92.520  0.3080    90.957  378.21
   9   0.4972     91.720  0.2097    93.863  424.86
  10   0.1294     95.810  0.1608    95.245  471.51
  11   0.5561     93.310  0.1351    95.828  518.12
  12   0.0914     97.220  0.1163    96.465  564.78
  13   0.1610     95.990  0.1007    96.952  611.39
  14   0.0858     97.270  0.0930    97.240  657.98
  15   0.0756     97.670  0.0819    97.453  704.60
  16   0.0756     97.670  0.0743    97.735  751.23
  17   0.0700     97.880  0.0707    97.772  797.89
  18   0.0622     98.140  0.0633    98.032  844.50
  19   0.0716     97.870  0.0670    97.897  891.19
  20   0.0884     97.320  0.0579    98.177  937.81
  21   0.0888     97.270  0.0542    98.298  984.45
  22   0.0530     98.340  0.0516    98.402  1031.21
  23   0.1802     96.570  0.0499    98.377  1078.13
  24   0.0491     98.430  0.0504    98.393  1124.72
  25   0.0467     98.370  0.0454    98.602  1171.29
  26   0.7571     95.450  0.0430    98.655  1218.23
  27   0.0529     98.300  0.0437    98.628  1264.85
  28   0.0483     98.530  0.0423    98.690  1311.47
  29   0.0464     98.460  0.0403    98.742  1358.09
  30   0.0391     98.750  0.0399    98.713  1404.74
  31   0.0444     98.620  0.0370    98.815  1451.37
  32   0.0518     98.340  0.0348    98.877  1498.04
  33   0.0619     98.020  0.0352    98.890  1544.98
  34   0.0412     98.610  0.0333    98.960  1591.57
  35   0.1295     97.630  0.0337    98.903  1638.14
  36   0.0496     98.450  0.0313    99.043  1684.75
  37   0.0409     98.580  0.0321    98.972  1731.71
  38   0.0372     98.780  0.0315    98.982  1778.33
  39   0.0423     98.560  0.0324    98.980  1824.94
  40   0.3116     96.750  0.0291    99.053  1871.97
  41   0.1150     97.730  0.0277    99.147  1918.54
  42   0.0410     98.720  0.0272    99.090  1965.15
  43   0.0386     98.700  0.0263    99.153  2011.77
  44   0.0453     98.560  0.0255    99.168  2058.36
  45   0.0660     98.030  0.0240    99.195  2104.95
  46   0.0339     98.920  0.0248    99.180  2151.88
  47   0.0396     98.720  0.0233    99.215  2198.52
  48   0.0507     98.280  0.0230    99.228  2245.13
  49   0.0360     98.860  0.0235    99.238  2291.70
  50   0.0343     98.840  0.0216    99.310  2338.61
  51   0.0395     98.520  0.0208    99.358  2385.19
  52   0.0755     98.140  0.0213    99.323  2432.35
  53   0.4127     96.720  0.0210    99.305  2479.44
  54   0.0391     98.630  0.0202    99.320  2526.42
  55   0.0381     98.810  0.0187    99.377  2573.04
  56   0.0485     98.380  0.0175    99.423  2619.67
  57   0.0455     98.580  0.0190    99.350  2666.30
  58   0.0382     98.840  0.0195    99.360  2712.93
  59   0.0349     98.770  0.0167    99.408  2759.86
  60   0.0601     98.300  0.0174    99.445  2806.47
  61   0.0368     98.920  0.0167    99.465  2853.10
  62   0.0457     98.620  0.0155    99.483  2899.70
  63   0.0465     98.530  0.0148    99.510  2946.63
  64   0.0389     98.810  0.0147    99.482  2993.45
  65   0.0387     98.760  0.0149    99.493  3040.11
  66   0.0354     98.970  0.0141    99.538  3086.70
  67   0.0328     99.040  0.0142    99.532  3133.32
  68   0.0464     98.600  0.0142    99.543  3180.25
  69   0.0467     98.720  0.0132    99.573  3226.85
  70   0.0367     98.880  0.0125    99.593  3273.43
  71   0.0401     98.820  0.0131    99.538  3320.04
  72   0.0485     98.470  0.0127    99.552  3366.64
  73   0.0491     98.760  0.0122    99.590  3413.25
  74   0.0430     98.710  0.0118    99.608  3459.91
  75   0.0459     98.610  0.0123    99.562  3506.55
  76   0.0400     98.790  0.0108    99.662  3553.17
  77   0.0382     98.710  0.0112    99.622  3599.81
  78   0.0419     98.740  0.0106    99.657  3646.41
  79   0.0385     98.840  0.0101    99.670  3692.99
  80   0.0381     98.850  0.0104    99.667  3739.58
  81   0.0417     98.770  0.0103    99.652  3786.54
  82   0.0459     98.740  0.0101    99.665  3833.18
  83   0.0455     98.780  0.0096    99.682  3879.83
  84   0.0845     98.100  0.0097    99.677  3926.49
  85   0.0451     98.600  0.0095    99.692  3973.16
  86   0.0435     98.760  0.0088    99.710  4019.78
  87   0.0388     98.790  0.0090    99.702  4066.39
  88   0.0430     98.720  0.0093    99.682  4113.01
  89   0.0407     98.790  0.0090    99.705  4159.61
  90   0.0607     98.450  0.0091    99.713  4206.28
