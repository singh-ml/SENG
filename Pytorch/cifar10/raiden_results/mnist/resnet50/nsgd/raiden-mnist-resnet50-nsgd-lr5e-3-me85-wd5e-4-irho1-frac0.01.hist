Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3848     86.690  1.1575    58.850  51.67
   2   0.1637     94.700  0.2551    91.805  98.75
   3   0.1224     95.860  0.1466    95.370  145.81
   4   0.0904     97.110  0.1096    96.510  192.93
   5   0.1016     96.780  0.0915    97.098  240.02
   6   0.0733     97.520  0.0769    97.582  287.13
   7   0.0742     97.610  0.0678    97.843  334.18
   8   0.0654     97.990  0.0625    98.017  381.26
   9   0.0673     97.790  0.0554    98.283  428.33
  10   0.0631     97.870  0.0519    98.358  475.37
  11   0.0715     97.810  0.0483    98.495  522.44
  12   0.0497     98.390  0.0466    98.525  569.50
  13   0.0475     98.520  0.0420    98.642  616.63
  14   0.0451     98.620  0.0389    98.797  663.75
  15   0.0460     98.510  0.0384    98.745  710.85
  16   0.0473     98.380  0.0375    98.785  757.93
  17   0.0468     98.420  0.0348    98.885  805.07
  18   0.0651     98.210  0.0344    98.893  852.11
  19   0.0425     98.650  0.0319    98.988  899.19
  20   0.0490     98.380  0.0307    98.997  946.27
  21   0.0533     98.440  0.0300    99.055  993.37
  22   0.0370     98.900  0.0282    99.073  1040.46
  23   0.0556     98.290  0.0264    99.138  1087.54
  24   0.0408     98.840  0.0270    99.117  1134.63
  25   0.0368     98.830  0.0264    99.118  1181.79
  26   0.0429     98.700  0.0256    99.180  1228.96
  27   0.0328     98.970  0.0236    99.245  1276.06
  28   0.0413     98.680  0.0236    99.207  1323.13
  29   0.0495     98.470  0.0235    99.252  1370.17
  30   0.0447     98.610  0.0222    99.278  1417.23
  31   0.0417     98.700  0.0215    99.303  1464.31
  32   0.0420     98.700  0.0215    99.283  1511.41
  33   0.0425     98.650  0.0209    99.288  1558.53
  34   0.0368     98.820  0.0199    99.350  1605.72
  35   0.0372     98.840  0.0195    99.363  1652.76
  36   0.0412     98.790  0.0178    99.455  1699.83
  37   0.0359     98.840  0.0175    99.408  1746.86
  38   0.0410     98.720  0.0177    99.412  1793.96
  39   0.0417     98.800  0.0170    99.492  1841.06
  40   0.0307     99.000  0.0160    99.437  1888.17
  41   0.0327     98.880  0.0160    99.508  1935.24
  42   0.0347     98.940  0.0166    99.420  1982.32
  43   0.0438     98.410  0.0150    99.492  2029.39
  44   0.0368     98.790  0.0143    99.517  2076.42
  45   0.0298     99.070  0.0147    99.522  2123.47
  46   0.0383     98.810  0.0139    99.560  2170.54
  47   0.0384     98.690  0.0148    99.522  2217.65
  48   0.0324     98.990  0.0132    99.587  2264.73
  49   0.0379     98.820  0.0119    99.593  2311.81
  50   0.0364     98.900  0.0128    99.588  2358.94
  51   0.0338     98.940  0.0120    99.617  2406.03
  52   0.0302     99.080  0.0115    99.617  2453.13
  53   0.0373     98.800  0.0122    99.598  2500.23
  54   0.0328     99.030  0.0116    99.632  2547.32
  55   0.0355     98.830  0.0104    99.677  2594.37
  56   0.0479     98.620  0.0105    99.660  2641.66
  57   0.0303     99.070  0.0100    99.673  2688.71
  58   0.0319     98.980  0.0100    99.685  2735.80
  59   0.0357     98.900  0.0097    99.677  2782.88
  60   0.0320     99.020  0.0097    99.685  2829.99
  61   0.0411     98.770  0.0085    99.732  2877.08
  62   0.0327     98.960  0.0088    99.707  2924.12
  63   0.0319     99.060  0.0093    99.707  2971.16
  64   0.0355     98.890  0.0084    99.757  3018.46
  65   0.0323     99.010  0.0083    99.707  3065.75
  66   0.0334     99.040  0.0085    99.733  3112.85
  67   0.0387     98.880  0.0080    99.738  3159.92
  68   0.0364     98.850  0.0076    99.755  3206.98
  69   0.0322     98.970  0.0071    99.780  3254.05
  70   0.0346     98.950  0.0072    99.787  3301.18
  71   0.0380     98.880  0.0074    99.772  3348.24
  72   0.0339     98.930  0.0070    99.780  3395.30
  73   0.0355     98.970  0.0068    99.795  3442.46
  74   0.0359     98.960  0.0069    99.803  3489.56
  75   0.0324     99.000  0.0063    99.812  3536.59
  76   0.0396     98.890  0.0067    99.787  3583.85
  77   0.0325     99.030  0.0065    99.807  3630.93
  78   0.0340     99.010  0.0062    99.833  3677.97
  79   0.0371     98.830  0.0056    99.838  3725.00
  80   0.0359     98.870  0.0059    99.817  3772.05
  81   0.0363     98.940  0.0064    99.808  3819.33
  82   0.0399     98.840  0.0058    99.813  3866.42
  83   0.0418     98.730  0.0059    99.838  3913.52
  84   0.0339     98.930  0.0058    99.828  3960.62
  85   0.0485     98.570  0.0054    99.847  4007.72
