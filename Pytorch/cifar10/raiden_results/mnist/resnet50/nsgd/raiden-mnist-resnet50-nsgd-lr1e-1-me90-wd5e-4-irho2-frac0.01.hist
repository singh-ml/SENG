Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.8969     26.610  5.0361    17.257  51.61
   2   1.3264     50.570  1.7146    35.797  98.38
   3   0.5502     79.510  0.9493    67.002  145.11
   4   0.2913     90.520  0.4747    84.588  191.85
   5   0.1780     94.400  0.2717    91.645  238.58
   6   0.1853     94.080  0.1866    94.335  285.37
   7   0.1128     96.420  0.1482    95.523  332.17
   8   0.0967     96.830  0.1186    96.395  379.00
   9   0.0970     96.900  0.1032    96.802  425.81
  10   0.0967     96.830  0.0904    97.207  472.61
  11   0.0765     97.460  0.0824    97.522  519.35
  12   0.0779     97.590  0.0780    97.600  566.11
  13   0.0734     97.510  0.0741    97.738  612.85
  14   0.0669     97.810  0.0701    97.807  659.54
  15   0.0587     98.090  0.0663    97.947  706.28
  16   0.0680     97.920  0.0617    98.137  753.07
  17   0.0576     98.010  0.0631    98.078  799.86
  18   0.0615     97.910  0.0610    98.185  846.62
  19   0.0567     98.110  0.0599    98.155  893.39
  20   0.0644     98.040  0.0572    98.240  940.15
  21   0.0590     98.110  0.0556    98.317  986.90
  22   0.0562     98.270  0.0552    98.275  1033.63
  23   0.0726     97.650  0.0583    98.182  1080.39
  24   0.0630     98.060  0.0568    98.253  1127.12
  25   0.0465     98.600  0.0544    98.318  1173.84
  26   0.0520     98.270  0.0514    98.385  1220.59
  27   0.0399     98.750  0.0523    98.377  1267.34
  28   0.0445     98.410  0.0508    98.405  1314.32
  29   0.0809     97.350  0.0505    98.373  1361.08
  30   0.0468     98.410  0.0537    98.362  1407.84
  31   0.0609     98.120  0.0495    98.465  1454.63
  32   0.0508     98.440  0.0488    98.412  1501.42
  33   0.0451     98.440  0.0474    98.532  1548.20
  34   0.0491     98.460  0.0466    98.530  1594.94
  35   0.0536     98.260  0.0479    98.483  1641.63
  36   0.0566     98.220  0.0467    98.488  1688.55
  37   0.0808     97.440  0.0447    98.593  1735.33
  38   0.0575     98.170  0.0436    98.680  1782.13
  39   0.0536     98.260  0.0433    98.690  1829.03
  40   0.0552     98.220  0.0410    98.723  1875.86
  41   0.0469     98.540  0.0427    98.568  1922.65
  42   0.0401     98.780  0.0414    98.745  1969.38
  43   0.0570     98.140  0.0380    98.855  2016.12
  44   0.0494     98.500  0.0377    98.808  2062.83
  45   0.0490     98.550  0.0382    98.830  2109.51
  46   0.0484     98.510  0.0382    98.805  2156.49
  47   0.0551     98.160  0.0348    98.913  2203.50
  48   0.0377     98.770  0.0356    98.860  2250.31
  49   0.0541     98.370  0.0362    98.865  2297.12
  50   0.0492     98.400  0.0348    98.873  2343.91
  51   0.0440     98.550  0.0338    98.948  2390.70
  52   0.0440     98.490  0.0325    98.957  2437.45
  53   0.0501     98.370  0.0318    99.022  2484.17
  54   0.0448     98.560  0.0303    99.083  2530.93
  55   0.0435     98.670  0.0294    99.068  2577.92
  56   0.0541     98.260  0.0296    99.045  2624.90
  57   0.0430     98.510  0.0270    99.117  2671.73
  58   0.0362     98.850  0.0274    99.158  2718.52
  59   0.0401     98.750  0.0256    99.175  2765.00
  60   0.0374     98.780  0.0251    99.220  2811.75
  61   0.0403     98.690  0.0233    99.275  2858.48
  62   0.0326     99.060  0.0218    99.305  2905.24
  63   0.0371     98.810  0.0214    99.345  2952.20
  64   0.0344     99.000  0.0197    99.375  2998.95
  65   0.0351     98.780  0.0202    99.363  3045.69
  66   0.0283     99.120  0.0182    99.473  3092.49
  67   0.0366     98.920  0.0167    99.457  3139.30
  68   0.0509     98.340  0.0171    99.443  3186.12
  69   0.0417     98.770  0.0159    99.492  3233.09
  70   0.0364     98.940  0.0154    99.507  3279.80
  71   0.0274     99.200  0.0136    99.563  3326.56
  72   0.0596     98.160  0.0130    99.587  3373.32
  73   0.0257     99.140  0.0118    99.637  3420.30
  74   0.0352     98.930  0.0109    99.650  3467.12
  75   0.0272     99.160  0.0104    99.688  3513.91
  76   0.0297     99.020  0.0095    99.705  3560.69
  77   0.0389     98.920  0.0083    99.742  3607.13
  78   0.0323     99.010  0.0078    99.757  3653.96
  79   0.0295     99.100  0.0071    99.758  3700.69
  80   0.0283     99.110  0.0069    99.802  3747.49
  81   0.0373     98.850  0.0064    99.817  3794.22
  82   0.0296     99.030  0.0060    99.820  3840.67
  83   0.0331     98.950  0.0056    99.818  3887.42
  84   0.0347     98.970  0.0046    99.888  3934.16
  85   0.0325     99.060  0.0047    99.858  3980.98
  86   0.0322     99.040  0.0047    99.872  4027.78
  87   0.0308     99.110  0.0045    99.888  4074.51
  88   0.0301     99.070  0.0043    99.893  4121.23
  89   0.0297     99.060  0.0042    99.897  4167.95
  90   0.0307     98.990  0.0037    99.905  4214.78
