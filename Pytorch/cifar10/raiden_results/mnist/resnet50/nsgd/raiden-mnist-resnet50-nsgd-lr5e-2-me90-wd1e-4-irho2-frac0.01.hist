Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.1063     20.080  3.4653    15.553  51.81
   2   0.6711     75.370  1.5679    42.580  98.70
   3   0.3648     88.130  0.4566    84.835  145.62
   4   0.1769     94.160  0.2639    91.748  192.45
   5   0.1698     94.670  0.1761    94.595  239.31
   6   0.1000     96.940  0.1354    95.813  286.13
   7   0.1309     96.280  0.1100    96.598  332.95
   8   0.0811     97.610  0.0966    96.988  380.10
   9   0.0868     97.250  0.0855    97.347  427.29
  10   0.0698     97.920  0.0764    97.628  474.18
  11   0.0713     97.600  0.0745    97.690  521.08
  12   0.0544     98.280  0.0673    97.848  567.91
  13   0.0587     98.140  0.0633    98.097  614.70
  14   0.0615     97.960  0.0597    98.108  661.52
  15   0.0539     98.280  0.0582    98.153  708.36
  16   0.0636     97.900  0.0540    98.300  755.21
  17   0.0662     97.740  0.0515    98.382  802.02
  18   0.0513     98.260  0.0510    98.405  848.92
  19   0.0713     97.640  0.0473    98.530  896.13
  20   0.0478     98.400  0.0455    98.562  943.03
  21   0.0562     98.090  0.0442    98.613  989.90
  22   0.0621     98.030  0.0439    98.648  1037.04
  23   0.0477     98.450  0.0413    98.713  1083.85
  24   0.0502     98.310  0.0395    98.723  1130.69
  25   0.0500     98.360  0.0372    98.777  1177.53
  26   0.0490     98.460  0.0372    98.815  1224.38
  27   0.0537     98.170  0.0364    98.865  1271.22
  28   0.0527     98.230  0.0350    98.867  1318.05
  29   0.0403     98.890  0.0344    98.910  1365.26
  30   0.0461     98.530  0.0342    98.867  1412.19
  31   0.0730     97.620  0.0332    98.940  1459.08
  32   0.0508     98.390  0.0324    98.960  1505.94
  33   0.0480     98.300  0.0298    99.012  1552.79
  34   0.0442     98.640  0.0291    99.080  1599.61
  35   0.0396     98.580  0.0293    99.012  1646.62
  36   0.0433     98.630  0.0300    99.027  1693.43
  37   0.0352     98.870  0.0297    99.040  1740.78
  38   0.0425     98.530  0.0269    99.112  1787.98
  39   0.0351     98.840  0.0270    99.173  1835.20
  40   0.0479     98.490  0.0252    99.202  1882.05
  41   0.0343     98.930  0.0241    99.207  1929.27
  42   0.0331     98.920  0.0241    99.203  1976.06
  43   0.0427     98.690  0.0246    99.207  2022.88
  44   0.0387     98.740  0.0231    99.267  2070.06
  45   0.0338     98.920  0.0223    99.253  2116.89
  46   0.0283     99.070  0.0222    99.268  2164.07
  47   0.0371     98.860  0.0224    99.303  2210.91
  48   0.0348     98.890  0.0193    99.373  2258.08
  49   0.0374     98.970  0.0209    99.332  2305.27
  50   0.0417     98.770  0.0195    99.350  2352.40
  51   0.0346     98.850  0.0186    99.375  2399.22
  52   0.0380     98.870  0.0181    99.418  2446.05
  53   0.0416     98.720  0.0188    99.363  2492.87
  54   0.0356     98.920  0.0173    99.422  2539.68
  55   0.0387     98.850  0.0164    99.472  2586.73
  56   0.0336     99.070  0.0160    99.433  2633.56
  57   0.0331     99.020  0.0159    99.467  2680.34
  58   0.0396     98.780  0.0155    99.488  2727.16
  59   0.0277     99.110  0.0151    99.502  2774.27
  60   0.0387     98.860  0.0141    99.527  2821.35
  61   0.0324     99.040  0.0136    99.542  2868.16
  62   0.0375     98.890  0.0135    99.560  2915.29
  63   0.0417     98.790  0.0128    99.572  2962.62
  64   0.0380     98.910  0.0123    99.580  3009.48
  65   0.0339     98.930  0.0118    99.622  3056.33
  66   0.0323     99.070  0.0124    99.593  3103.17
  67   0.0318     99.100  0.0108    99.648  3149.98
  68   0.0362     99.090  0.0112    99.662  3196.87
  69   0.0366     98.820  0.0106    99.633  3243.96
  70   0.0500     98.910  0.0107    99.635  3290.75
  71   0.0364     98.920  0.0097    99.675  3337.53
  72   0.0360     99.050  0.0097    99.682  3384.35
  73   0.0400     99.090  0.0095    99.717  3431.50
  74   0.0370     98.980  0.0089    99.718  3478.33
  75   0.0460     98.690  0.0090    99.688  3525.52
  76   0.0349     98.990  0.0089    99.710  3572.37
  77   0.0336     98.970  0.0083    99.730  3619.19
  78   0.0326     99.080  0.0085    99.717  3666.02
  79   0.0389     99.030  0.0075    99.748  3712.86
  80   0.0368     99.030  0.0076    99.763  3759.65
  81   0.0375     98.890  0.0076    99.762  3806.44
  82   0.0345     98.950  0.0073    99.757  3853.69
  83   0.0347     99.030  0.0074    99.762  3900.56
  84   0.0415     99.090  0.0075    99.775  3947.69
  85   0.0342     99.130  0.0071    99.790  3994.55
  86   0.0353     99.020  0.0071    99.770  4041.37
  87   0.0339     99.090  0.0070    99.768  4088.21
  88   0.0349     98.980  0.0070    99.780  4135.03
  89   0.0320     99.130  0.0072    99.778  4182.18
  90   0.0332     99.070  0.0071    99.778  4230.18
