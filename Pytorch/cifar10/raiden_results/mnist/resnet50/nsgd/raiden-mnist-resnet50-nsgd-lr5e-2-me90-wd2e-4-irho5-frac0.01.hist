Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.0438     25.060  3.4928    13.932  51.57
   2   1.9658     26.600  2.1161    20.778  98.33
   3   1.4052     58.610  1.5280    43.033  145.02
   4   3.1193     44.400  0.5668    81.135  191.88
   5   0.3157     89.760  0.3897    87.740  238.60
   6   0.1450     95.070  0.2150    93.445  284.93
   7   0.1617     94.690  0.1586    95.225  331.77
   8   0.1133     96.400  0.1310    96.027  378.51
   9   0.1264     96.070  0.1143    96.503  425.28
  10   0.0811     97.470  0.0976    96.997  472.02
  11   0.0785     97.550  0.0895    97.248  518.80
  12   0.0548     98.080  0.0836    97.407  565.53
  13   0.0681     97.640  0.0785    97.552  612.34
  14   0.0540     98.300  0.0771    97.618  659.10
  15   0.1170     96.380  0.0697    97.898  705.83
  16   0.0478     98.440  0.0704    97.835  752.54
  17   0.0586     98.030  0.0632    98.022  799.25
  18   0.0660     97.780  0.0616    98.058  846.03
  19   0.0738     97.500  0.0590    98.172  892.81
  20   0.0480     98.440  0.0568    98.227  939.58
  21   0.0553     98.160  0.0561    98.283  986.37
  22   0.0606     97.910  0.0538    98.333  1033.11
  23   0.0545     98.030  0.0509    98.423  1079.80
  24   0.0596     97.980  0.0495    98.493  1126.48
  25   0.0578     98.040  0.0477    98.470  1173.26
  26   0.0504     98.300  0.0461    98.580  1219.99
  27   0.0447     98.470  0.0461    98.523  1267.04
  28   0.0383     98.660  0.0452    98.542  1313.96
  29   0.0487     98.400  0.0456    98.558  1361.06
  30   0.0405     98.670  0.0442    98.615  1407.83
  31   0.0520     98.230  0.0414    98.612  1454.58
  32   0.0314     98.890  0.0400    98.777  1501.33
  33   0.0362     98.720  0.0389    98.780  1548.02
  34   0.0581     97.920  0.0388    98.723  1595.03
  35   0.0279     99.060  0.0389    98.772  1641.73
  36   0.0389     98.630  0.0354    98.900  1688.47
  37   0.0330     98.960  0.0358    98.857  1735.27
  38   0.0352     98.970  0.0340    98.932  1782.38
  39   0.0376     98.800  0.0339    98.895  1829.48
  40   0.0311     98.970  0.0337    98.948  1876.59
  41   0.0497     98.480  0.0333    98.905  1923.31
  42   0.0376     98.810  0.0329    98.897  1970.04
  43   0.0331     98.810  0.0310    99.013  2016.73
  44   0.0368     98.890  0.0302    99.020  2063.78
  45   0.0378     98.680  0.0296    99.042  2110.69
  46   0.0355     98.800  0.0286    99.118  2157.44
  47   0.0442     98.520  0.0282    99.080  2204.21
  48   0.0327     98.840  0.0256    99.212  2251.04
  49   0.0246     99.100  0.0260    99.172  2297.79
  50   0.0306     98.960  0.0247    99.190  2344.50
  51   0.0335     98.810  0.0249    99.208  2391.20
  52   0.0327     98.950  0.0252    99.153  2438.22
  53   0.0331     98.740  0.0238    99.273  2485.18
  54   0.0251     99.180  0.0221    99.297  2531.91
  55   0.0294     98.990  0.0207    99.332  2578.67
  56   0.0336     99.090  0.0216    99.307  2625.41
  57   0.0297     99.040  0.0205    99.340  2672.17
  58   0.0330     98.870  0.0203    99.318  2718.91
  59   0.0319     98.870  0.0204    99.283  2766.00
  60   0.0323     98.930  0.0188    99.393  2812.71
  61   0.0415     98.840  0.0178    99.447  2859.40
  62   0.0288     99.010  0.0180    99.407  2906.45
  63   0.0323     99.000  0.0171    99.450  2953.14
  64   0.0340     98.950  0.0163    99.490  2999.93
  65   0.0315     98.940  0.0159    99.453  3047.00
  66   0.0268     99.120  0.0152    99.472  3094.07
  67   0.0261     99.180  0.0147    99.517  3140.79
  68   0.0290     99.130  0.0144    99.533  3187.54
  69   0.0288     99.190  0.0132    99.552  3234.60
  70   0.0386     98.900  0.0133    99.538  3281.61
  71   0.0352     98.920  0.0122    99.615  3328.33
  72   0.0274     99.110  0.0124    99.587  3375.32
  73   0.0292     98.960  0.0120    99.622  3422.41
  74   0.0339     98.990  0.0113    99.648  3469.19
  75   0.0273     99.110  0.0112    99.628  3515.97
  76   0.0276     99.080  0.0108    99.655  3562.74
  77   0.0352     98.830  0.0107    99.658  3609.48
  78   0.0267     99.190  0.0096    99.697  3656.18
  79   0.0287     99.120  0.0100    99.663  3703.18
  80   0.0270     99.040  0.0097    99.678  3749.92
  81   0.0333     98.850  0.0097    99.682  3797.02
  82   0.0265     99.190  0.0094    99.700  3844.09
  83   0.0281     99.210  0.0087    99.715  3890.82
  84   0.0245     99.160  0.0087    99.700  3937.99
  85   0.0267     99.200  0.0084    99.753  3984.73
  86   0.0254     99.190  0.0092    99.700  4031.41
  87   0.0265     99.200  0.0083    99.740  4078.12
  88   0.0346     99.070  0.0081    99.770  4124.82
  89   0.0312     99.040  0.0081    99.755  4171.91
  90   0.0282     99.180  0.0084    99.727  4218.67
