Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.0208     29.650  3.9948    14.468  51.55
   2   0.8954     70.350  1.4409    49.295  98.33
   3   0.3427     89.030  0.6121    80.010  145.07
   4   0.2159     93.670  0.3187    89.955  191.84
   5   0.1304     95.810  0.1945    94.107  238.60
   6   0.1114     96.520  0.1404    95.713  285.33
   7   0.0890     97.120  0.1141    96.415  332.01
   8   0.0843     97.200  0.0972    96.940  378.73
   9   0.0718     97.670  0.0849    97.365  425.73
  10   0.0770     97.370  0.0799    97.590  472.41
  11   0.0743     97.610  0.0699    97.837  519.11
  12   0.0856     97.150  0.0675    97.937  565.83
  13   0.0738     97.550  0.0602    98.150  612.61
  14   0.0602     98.100  0.0571    98.207  659.30
  15   0.0718     97.670  0.0580    98.157  706.02
  16   0.0556     98.130  0.0539    98.302  752.82
  17   0.0523     98.260  0.0503    98.443  799.54
  18   0.0564     98.210  0.0487    98.487  846.21
  19   0.0470     98.490  0.0477    98.525  892.91
  20   0.0472     98.490  0.0471    98.532  939.57
  21   0.0473     98.440  0.0445    98.590  986.25
  22   0.0564     98.150  0.0447    98.553  1032.98
  23   0.0461     98.360  0.0422    98.632  1079.69
  24   0.0423     98.510  0.0408    98.693  1126.40
  25   0.0632     97.780  0.0407    98.720  1173.12
  26   0.0360     98.830  0.0388    98.788  1219.83
  27   0.0517     98.280  0.0351    98.875  1266.54
  28   0.0518     98.210  0.0375    98.842  1313.20
  29   0.0515     98.300  0.0352    98.898  1360.21
  30   0.0493     98.350  0.0350    98.905  1407.28
  31   0.0565     98.290  0.0336    98.882  1454.03
  32   0.0503     98.320  0.0326    98.988  1500.77
  33   0.0457     98.530  0.0307    98.997  1547.52
  34   0.0448     98.650  0.0329    98.920  1594.25
  35   0.0457     98.460  0.0289    99.080  1640.95
  36   0.0352     98.740  0.0300    99.030  1687.66
  37   0.0352     98.840  0.0277    99.127  1734.72
  38   0.0490     98.430  0.0280    99.098  1781.44
  39   0.0311     98.980  0.0272    99.125  1828.22
  40   0.0474     98.310  0.0269    99.132  1874.99
  41   0.0452     98.430  0.0252    99.232  1922.05
  42   0.0444     98.790  0.0247    99.225  1968.81
  43   0.0419     98.650  0.0252    99.147  2015.50
  44   0.0419     98.600  0.0239    99.217  2062.20
  45   0.0403     98.800  0.0212    99.335  2109.48
  46   0.0378     98.740  0.0230    99.247  2156.21
  47   0.0477     98.560  0.0218    99.277  2202.94
  48   0.0406     98.740  0.0205    99.298  2249.66
  49   0.0384     98.750  0.0205    99.337  2296.46
  50   0.0314     98.980  0.0196    99.337  2343.15
  51   0.0345     98.980  0.0185    99.378  2389.86
  52   0.0387     98.850  0.0185    99.370  2436.54
  53   0.0358     98.920  0.0181    99.392  2483.56
  54   0.0452     98.560  0.0156    99.492  2530.26
  55   0.0484     98.350  0.0157    99.498  2577.33
  56   0.0336     98.890  0.0145    99.543  2623.99
  57   0.0421     98.750  0.0145    99.507  2670.68
  58   0.0384     98.750  0.0144    99.522  2717.74
  59   0.0339     98.920  0.0141    99.518  2764.50
  60   0.0417     98.660  0.0134    99.570  2811.25
  61   0.0370     98.880  0.0123    99.593  2858.31
  62   0.0410     98.740  0.0124    99.587  2905.15
  63   0.0318     99.050  0.0114    99.615  2951.88
  64   0.0365     98.890  0.0114    99.610  2998.56
  65   0.0368     98.860  0.0105    99.677  3045.23
  66   0.0374     98.950  0.0099    99.660  3091.91
  67   0.0355     98.900  0.0103    99.672  3138.71
  68   0.0417     98.880  0.0092    99.683  3185.47
  69   0.0409     98.800  0.0080    99.755  3232.19
  70   0.0410     98.730  0.0078    99.752  3279.26
  71   0.0396     98.880  0.0074    99.778  3325.94
  72   0.0312     99.050  0.0074    99.743  3372.63
  73   0.0384     98.860  0.0069    99.768  3419.34
  74   0.0409     98.810  0.0065    99.782  3466.05
  75   0.0380     98.890  0.0064    99.782  3512.78
  76   0.0430     98.780  0.0059    99.807  3559.55
  77   0.0398     98.890  0.0058    99.817  3606.34
  78   0.0384     98.980  0.0056    99.802  3653.10
  79   0.0387     98.870  0.0054    99.825  3699.82
  80   0.0437     98.760  0.0048    99.868  3746.54
  81   0.0395     98.870  0.0048    99.865  3793.23
  82   0.0408     98.860  0.0050    99.838  3839.99
  83   0.0512     98.710  0.0050    99.848  3886.76
  84   0.0433     98.830  0.0043    99.850  3933.84
  85   0.0458     98.840  0.0044    99.858  3980.57
  86   0.0405     98.940  0.0043    99.860  4027.69
  87   0.0410     98.850  0.0042    99.877  4074.73
  88   0.0409     98.880  0.0043    99.875  4121.43
  89   0.0574     98.430  0.0038    99.907  4168.13
  90   0.0433     98.830  0.0042    99.875  4215.18
