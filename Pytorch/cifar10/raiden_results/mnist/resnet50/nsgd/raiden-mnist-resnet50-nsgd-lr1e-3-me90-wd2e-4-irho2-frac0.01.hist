Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.9873     68.470  1.6389    41.215  51.38
   2   0.3414     89.180  0.5729    81.817  98.41
   3   0.2404     92.390  0.2872    91.087  145.45
   4   0.1649     94.620  0.2030    93.730  192.51
   5   0.1494     95.370  0.1579    95.070  239.88
   6   0.1195     96.310  0.1331    95.837  286.94
   7   0.1237     95.980  0.1120    96.525  334.03
   8   0.1047     96.590  0.0989    96.895  381.14
   9   0.0804     97.380  0.0911    97.120  428.19
  10   0.1144     96.620  0.0856    97.347  475.31
  11   0.0884     97.270  0.0746    97.650  522.33
  12   0.0746     97.720  0.0716    97.730  569.37
  13   0.0702     97.710  0.0676    97.902  616.47
  14   0.0707     97.750  0.0620    98.042  663.78
  15   0.0735     97.680  0.0601    98.162  710.86
  16   0.0567     98.120  0.0571    98.208  757.94
  17   0.0592     98.140  0.0532    98.337  805.02
  18   0.0550     98.300  0.0514    98.338  852.08
  19   0.0537     98.240  0.0504    98.398  899.07
  20   0.0587     98.110  0.0483    98.477  946.13
  21   0.0634     97.960  0.0459    98.517  993.19
  22   0.0715     97.800  0.0439    98.605  1040.26
  23   0.0560     98.330  0.0435    98.570  1087.31
  24   0.0607     98.030  0.0421    98.645  1134.34
  25   0.0483     98.400  0.0411    98.693  1181.38
  26   0.0525     98.220  0.0394    98.758  1228.42
  27   0.0585     98.150  0.0363    98.820  1275.67
  28   0.0556     98.260  0.0361    98.835  1322.72
  29   0.0441     98.510  0.0356    98.848  1369.93
  30   0.0540     98.280  0.0361    98.858  1417.03
  31   0.0472     98.450  0.0340    98.885  1464.08
  32   0.0559     98.170  0.0317    98.930  1511.14
  33   0.0510     98.280  0.0318    98.997  1558.19
  34   0.0505     98.320  0.0319    98.957  1605.48
  35   0.0407     98.620  0.0311    98.967  1652.53
  36   0.0443     98.550  0.0293    99.038  1699.59
  37   0.0507     98.320  0.0286    99.032  1746.70
  38   0.0499     98.360  0.0282    99.078  1793.75
  39   0.0397     98.650  0.0279    99.100  1840.84
  40   0.0432     98.640  0.0284    99.063  1887.86
  41   0.0485     98.320  0.0275    99.103  1934.90
  42   0.0506     98.290  0.0274    99.148  1981.95
  43   0.0415     98.530  0.0253    99.143  2028.96
  44   0.0508     98.330  0.0237    99.247  2076.28
  45   0.0403     98.640  0.0251    99.148  2123.34
  46   0.0477     98.420  0.0252    99.217  2170.39
  47   0.0376     98.730  0.0228    99.303  2217.52
  48   0.0404     98.640  0.0232    99.198  2264.55
  49   0.0472     98.450  0.0233    99.233  2311.60
  50   0.0451     98.540  0.0216    99.278  2358.65
  51   0.0451     98.460  0.0212    99.287  2405.68
  52   0.0394     98.760  0.0224    99.258  2452.76
  53   0.0385     98.720  0.0216    99.285  2499.82
  54   0.0448     98.640  0.0224    99.288  2546.92
  55   0.0450     98.550  0.0213    99.293  2593.95
  56   0.0480     98.460  0.0193    99.360  2641.15
  57   0.0484     98.530  0.0196    99.353  2688.21
  58   0.0510     98.370  0.0198    99.308  2735.29
  59   0.0494     98.440  0.0185    99.375  2782.30
  60   0.0461     98.610  0.0181    99.400  2829.34
  61   0.0435     98.570  0.0176    99.388  2876.41
  62   0.0462     98.670  0.0179    99.417  2923.47
  63   0.0427     98.610  0.0168    99.460  2970.54
  64   0.0372     98.780  0.0162    99.457  3017.65
  65   0.0520     98.390  0.0172    99.417  3064.73
  66   0.0408     98.710  0.0171    99.435  3111.75
  67   0.0472     98.520  0.0165    99.457  3158.78
  68   0.0416     98.660  0.0166    99.450  3205.83
  69   0.0464     98.570  0.0165    99.457  3253.06
  70   0.0418     98.700  0.0153    99.500  3300.09
  71   0.0360     98.870  0.0160    99.473  3347.18
  72   0.0513     98.490  0.0151    99.503  3394.23
  73   0.0381     98.740  0.0156    99.493  3441.31
  74   0.0394     98.660  0.0164    99.438  3488.33
  75   0.0433     98.590  0.0147    99.523  3535.41
  76   0.0399     98.740  0.0137    99.558  3582.43
  77   0.0524     98.470  0.0138    99.545  3629.46
  78   0.0476     98.610  0.0137    99.547  3676.71
  79   0.0507     98.530  0.0142    99.517  3723.77
  80   0.0421     98.780  0.0138    99.542  3770.81
  81   0.0454     98.600  0.0137    99.530  3817.91
  82   0.0384     98.820  0.0121    99.582  3864.96
  83   0.0516     98.480  0.0126    99.557  3912.04
  84   0.0505     98.630  0.0126    99.573  3959.14
  85   0.0451     98.560  0.0129    99.568  4006.14
  86   0.0372     98.860  0.0110    99.625  4053.15
  87   0.0428     98.710  0.0121    99.617  4100.37
  88   0.0447     98.680  0.0124    99.577  4147.59
  89   0.0437     98.710  0.0125    99.602  4194.65
  90   0.0420     98.690  0.0117    99.603  4241.74
