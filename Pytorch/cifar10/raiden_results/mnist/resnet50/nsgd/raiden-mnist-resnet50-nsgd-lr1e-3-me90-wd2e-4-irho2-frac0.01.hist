Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.8437     73.980  1.6343    41.387  51.46
   2   0.3596     89.340  0.5933    80.607  98.54
   3   0.2287     92.610  0.3003    90.607  145.54
   4   0.1656     94.940  0.2118    93.357  192.59
   5   0.1334     95.610  0.1681    94.672  239.65
   6   0.1281     95.750  0.1424    95.608  286.68
   7   0.1110     96.340  0.1204    96.262  333.67
   8   0.0989     96.930  0.1056    96.713  380.68
   9   0.0801     97.480  0.0953    97.048  427.75
  10   0.0758     97.460  0.0859    97.303  474.78
  11   0.0731     97.680  0.0795    97.520  521.95
  12   0.0757     97.560  0.0734    97.727  569.02
  13   0.0700     97.670  0.0683    97.797  616.07
  14   0.0774     97.510  0.0659    97.905  663.11
  15   0.0694     97.690  0.0613    98.057  710.11
  16   0.0593     98.100  0.0580    98.220  757.13
  17   0.0564     98.080  0.0555    98.297  804.21
  18   0.0561     98.170  0.0552    98.302  851.21
  19   0.0597     98.190  0.0496    98.437  898.25
  20   0.0548     98.240  0.0489    98.473  945.26
  21   0.0502     98.410  0.0473    98.508  992.29
  22   0.0502     98.520  0.0450    98.557  1039.33
  23   0.0477     98.460  0.0430    98.610  1086.41
  24   0.0504     98.270  0.0430    98.668  1133.47
  25   0.0487     98.380  0.0406    98.712  1180.55
  26   0.0477     98.390  0.0386    98.748  1227.61
  27   0.0472     98.430  0.0394    98.782  1274.69
  28   0.0538     98.320  0.0374    98.857  1321.71
  29   0.0496     98.450  0.0359    98.837  1368.75
  30   0.0602     98.030  0.0354    98.850  1415.83
  31   0.0458     98.420  0.0336    98.885  1462.84
  32   0.0530     98.330  0.0331    98.957  1509.90
  33   0.0552     98.320  0.0321    98.965  1556.95
  34   0.0422     98.520  0.0325    98.955  1604.01
  35   0.0482     98.370  0.0314    98.958  1651.02
  36   0.0521     98.290  0.0307    99.047  1698.05
  37   0.0579     98.150  0.0289    99.085  1745.06
  38   0.0557     98.090  0.0288    99.133  1792.07
  39   0.0538     98.230  0.0289    99.068  1839.09
  40   0.0420     98.620  0.0278    99.098  1886.14
  41   0.0445     98.480  0.0272    99.093  1933.22
  42   0.0495     98.450  0.0261    99.172  1980.31
  43   0.0471     98.560  0.0246    99.173  2027.36
  44   0.0450     98.390  0.0251    99.180  2074.44
  45   0.0505     98.370  0.0236    99.240  2121.45
  46   0.0462     98.520  0.0258    99.163  2168.43
  47   0.0476     98.440  0.0246    99.195  2215.44
  48   0.0443     98.710  0.0220    99.308  2262.48
  49   0.0446     98.630  0.0231    99.210  2309.79
  50   0.0470     98.600  0.0230    99.238  2356.83
  51   0.0443     98.530  0.0228    99.257  2403.91
  52   0.0512     98.400  0.0225    99.240  2450.97
  53   0.0501     98.510  0.0206    99.347  2498.00
  54   0.0451     98.580  0.0197    99.313  2545.00
  55   0.0402     98.690  0.0211    99.333  2591.97
  56   0.0453     98.610  0.0203    99.337  2638.97
  57   0.0532     98.380  0.0214    99.300  2686.01
  58   0.0445     98.620  0.0198    99.385  2733.05
  59   0.0604     98.290  0.0187    99.380  2780.10
  60   0.0410     98.790  0.0185    99.403  2827.17
  61   0.0441     98.660  0.0185    99.393  2874.25
  62   0.0428     98.740  0.0173    99.418  2921.28
  63   0.0353     98.960  0.0179    99.375  2968.28
  64   0.0453     98.590  0.0172    99.423  3015.25
  65   0.0364     98.920  0.0173    99.428  3062.27
  66   0.0391     98.910  0.0168    99.462  3109.28
  67   0.0456     98.660  0.0170    99.410  3156.36
  68   0.0503     98.600  0.0170    99.427  3203.45
  69   0.0354     98.920  0.0160    99.485  3250.52
  70   0.0403     98.830  0.0166    99.447  3297.57
  71   0.0318     98.960  0.0161    99.483  3344.58
  72   0.0308     98.990  0.0159    99.460  3391.61
  73   0.0342     98.890  0.0156    99.470  3438.60
  74   0.0410     98.740  0.0145    99.533  3485.70
  75   0.0398     98.860  0.0139    99.525  3532.73
  76   0.0409     98.790  0.0149    99.483  3579.82
  77   0.0404     98.780  0.0136    99.535  3626.87
  78   0.0365     98.960  0.0139    99.538  3673.94
  79   0.0392     98.830  0.0128    99.563  3720.94
  80   0.0427     98.600  0.0130    99.583  3767.96
  81   0.0387     98.930  0.0129    99.570  3815.02
  82   0.0467     98.650  0.0131    99.565  3862.05
  83   0.0398     98.680  0.0129    99.590  3909.11
  84   0.0387     98.830  0.0136    99.517  3956.19
  85   0.0384     98.760  0.0121    99.572  4003.26
  86   0.0371     98.920  0.0126    99.593  4050.36
  87   0.0413     98.780  0.0126    99.560  4097.41
  88   0.0474     98.660  0.0127    99.595  4144.41
  89   0.0369     98.810  0.0120    99.575  4191.49
  90   0.0486     98.570  0.0120    99.597  4238.52
