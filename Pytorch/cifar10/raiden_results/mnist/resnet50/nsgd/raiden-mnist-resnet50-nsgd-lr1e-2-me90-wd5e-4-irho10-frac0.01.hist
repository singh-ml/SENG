Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.4061     50.930  3.4792    30.610  51.48
   2   0.7154     76.680  1.0630    64.358  98.43
   3   0.4125     87.560  0.5495    82.350  145.40
   4   0.2442     92.390  0.3210    90.235  192.01
   5   0.1588     95.220  0.1885    94.267  239.01
   6   0.1656     94.710  0.1442    95.498  285.92
   7   0.0869     97.270  0.1143    96.403  332.88
   8   0.0955     96.770  0.0976    96.907  379.82
   9   0.0607     98.020  0.0889    97.187  426.44
  10   0.0636     97.790  0.0790    97.492  473.37
  11   0.0624     97.950  0.0754    97.625  520.50
  12   0.0861     97.320  0.0691    97.793  567.43
  13   0.0579     97.930  0.0668    97.837  614.09
  14   0.0729     97.480  0.0603    98.058  661.04
  15   0.0813     97.400  0.0609    98.048  707.72
  16   0.0560     98.150  0.0606    98.145  754.68
  17   0.1119     96.460  0.0613    98.133  801.64
  18   0.0622     97.910  0.0658    97.883  848.59
  19   0.0663     97.730  0.0547    98.233  895.49
  20   0.0510     98.260  0.0532    98.350  942.30
  21   0.0691     97.570  0.0488    98.448  989.24
  22   0.0546     98.190  0.0464    98.483  1036.23
  23   0.0471     98.320  0.0450    98.548  1083.21
  24   0.0627     98.190  0.0414    98.662  1130.14
  25   0.0470     98.360  0.0419    98.645  1177.11
  26   0.0832     97.200  0.0376    98.788  1224.08
  27   0.0435     98.460  0.0421    98.643  1271.03
  28   0.0488     98.330  0.0375    98.792  1317.62
  29   0.0463     98.430  0.0355    98.883  1364.23
  30   0.0518     98.400  0.0352    98.883  1411.22
  31   0.0416     98.650  0.0439    98.567  1457.89
  32   0.0556     98.190  0.0373    98.785  1504.92
  33   0.0444     98.310  0.0329    98.940  1551.92
  34   0.0474     98.390  0.0321    98.980  1598.82
  35   0.0440     98.430  0.0341    98.880  1645.82
  36   0.0498     98.380  0.0309    98.983  1692.76
  37   0.0495     98.390  0.0288    99.060  1739.67
  38   0.0607     98.020  0.0285    99.135  1786.63
  39   0.0489     98.350  0.0272    99.093  1833.57
  40   0.0465     98.530  0.0261    99.125  1880.53
  41   0.0451     98.510  0.0255    99.155  1927.16
  42   0.0442     98.570  0.0249    99.170  1974.12
  43   0.0412     98.560  0.0239    99.212  2020.79
  44   0.0435     98.670  0.0232    99.245  2067.72
  45   0.0360     98.710  0.0236    99.230  2114.77
  46   0.0444     98.670  0.0227    99.225  2161.70
  47   0.0439     98.520  0.0213    99.300  2208.61
  48   0.0494     98.460  0.0288    99.058  2255.59
  49   0.0358     98.820  0.0232    99.255  2302.56
  50   0.0389     98.710  0.0203    99.320  2349.51
  51   0.0380     98.700  0.0194    99.378  2396.16
  52   0.0430     98.590  0.0217    99.288  2442.81
  53   0.0405     98.660  0.0189    99.347  2489.40
  54   0.0422     98.690  0.0167    99.433  2536.34
  55   0.0410     98.730  0.0164    99.463  2583.26
  56   0.0374     98.790  0.0166    99.467  2629.83
  57   0.0380     98.720  0.0162    99.450  2677.02
  58   0.0398     98.690  0.0141    99.545  2723.99
  59   0.0426     98.690  0.0144    99.527  2770.99
  60   0.0371     98.870  0.0143    99.520  2818.01
  61   0.0392     98.670  0.0130    99.588  2864.68
  62   0.0345     98.900  0.0125    99.580  2911.35
  63   0.0460     98.430  0.0130    99.543  2958.27
  64   0.0432     98.680  0.0122    99.597  3005.23
  65   0.0391     98.790  0.0116    99.625  3052.18
  66   0.0392     98.880  0.0114    99.643  3098.84
  67   0.0412     98.800  0.0108    99.633  3145.81
  68   0.0386     98.800  0.0102    99.678  3192.75
  69   0.0394     98.730  0.0103    99.647  3239.78
  70   0.0407     98.770  0.0105    99.640  3286.45
  71   0.0524     98.400  0.0091    99.707  3333.38
  72   0.0420     98.730  0.0089    99.707  3380.01
  73   0.0345     98.910  0.0086    99.710  3426.66
  74   0.0410     98.770  0.0082    99.742  3473.64
  75   0.0365     98.890  0.0081    99.762  3520.54
  76   0.0426     98.850  0.0083    99.715  3567.52
  77   0.0407     98.800  0.0080    99.723  3614.21
  78   0.0437     98.690  0.0076    99.753  3661.22
  79   0.0382     98.820  0.0072    99.778  3707.89
  80   0.0406     98.830  0.0071    99.767  3754.83
  81   0.0455     98.660  0.0066    99.795  3801.77
  82   0.0444     98.730  0.0069    99.783  3848.42
  83   0.0424     98.790  0.0066    99.782  3895.04
  84   0.0528     98.490  0.0070    99.790  3941.69
  85   0.0402     98.760  0.0064    99.793  3988.65
  86   0.0416     98.700  0.0063    99.808  4035.68
  87   0.0461     98.720  0.0058    99.825  4082.61
  88   0.0418     98.780  0.0057    99.837  4129.23
  89   0.0423     98.800  0.0056    99.833  4175.87
  90   0.0397     98.810  0.0058    99.818  4222.80
