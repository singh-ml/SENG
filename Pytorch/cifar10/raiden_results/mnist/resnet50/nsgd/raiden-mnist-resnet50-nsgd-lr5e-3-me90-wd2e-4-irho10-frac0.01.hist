Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.6208     42.370  3.4529    20.862  51.54
   2   0.4751     84.010  1.0402    64.245  98.61
   3   0.2492     92.050  0.3613    88.732  145.75
   4   0.1842     93.900  0.2009    93.865  192.87
   5   0.1278     96.150  0.1395    95.680  239.95
   6   0.0925     97.090  0.1150    96.380  287.03
   7   0.0772     97.550  0.0973    96.983  334.22
   8   0.0751     97.570  0.0875    97.175  381.30
   9   0.0994     96.860  0.0799    97.520  428.35
  10   0.0670     97.750  0.0733    97.730  475.08
  11   0.0560     98.100  0.0670    97.835  522.15
  12   0.0672     97.770  0.0623    98.042  569.28
  13   0.0879     97.310  0.0606    98.090  616.39
  14   0.0667     97.780  0.0556    98.282  663.50
  15   0.0484     98.330  0.0559    98.165  710.55
  16   0.0609     97.960  0.0525    98.325  757.61
  17   0.0824     97.270  0.0495    98.422  804.69
  18   0.0524     98.200  0.0480    98.468  851.50
  19   0.0407     98.590  0.0460    98.557  898.58
  20   0.0528     98.400  0.0409    98.665  945.68
  21   0.0450     98.450  0.0413    98.655  992.72
  22   0.0454     98.590  0.0400    98.747  1039.79
  23   0.0559     98.180  0.0395    98.752  1086.84
  24   0.0540     98.190  0.0376    98.790  1133.91
  25   0.0496     98.370  0.0379    98.732  1180.99
  26   0.0484     98.220  0.0371    98.795  1228.09
  27   0.0524     98.330  0.0341    98.922  1275.19
  28   0.0416     98.710  0.0337    98.898  1322.40
  29   0.0366     98.750  0.0316    98.973  1369.46
  30   0.0348     98.840  0.0311    98.990  1416.51
  31   0.0397     98.720  0.0292    99.052  1463.55
  32   0.0367     98.780  0.0309    99.027  1510.79
  33   0.0380     98.660  0.0290    99.035  1558.10
  34   0.0361     98.700  0.0282    99.083  1605.19
  35   0.0410     98.590  0.0264    99.137  1652.29
  36   0.0397     98.710  0.0250    99.187  1699.39
  37   0.0483     98.360  0.0259    99.150  1746.44
  38   0.0431     98.500  0.0246    99.187  1793.52
  39   0.0299     98.950  0.0244    99.190  1840.58
  40   0.0401     98.670  0.0243    99.180  1887.90
  41   0.0360     98.840  0.0220    99.258  1934.66
  42   0.0448     98.330  0.0221    99.277  1981.74
  43   0.0303     98.960  0.0213    99.298  2028.84
  44   0.0443     98.580  0.0211    99.335  2075.96
  45   0.0320     98.890  0.0209    99.302  2123.07
  46   0.0390     98.830  0.0198    99.358  2170.13
  47   0.0404     98.710  0.0188    99.373  2217.17
  48   0.0376     98.780  0.0189    99.360  2264.26
  49   0.0410     98.690  0.0181    99.392  2311.33
  50   0.0343     98.920  0.0180    99.418  2358.42
  51   0.0408     98.820  0.0183    99.373  2405.53
  52   0.0425     98.650  0.0177    99.442  2452.60
  53   0.0360     98.780  0.0161    99.472  2499.68
  54   0.0361     98.850  0.0166    99.457  2546.77
  55   0.0486     98.660  0.0155    99.465  2593.84
  56   0.0364     98.870  0.0155    99.473  2640.92
  57   0.0359     98.830  0.0134    99.542  2687.97
  58   0.0369     98.860  0.0144    99.482  2735.06
  59   0.0365     98.860  0.0143    99.515  2782.14
  60   0.0321     98.950  0.0131    99.562  2829.26
  61   0.0356     98.830  0.0136    99.573  2876.36
  62   0.0335     98.900  0.0119    99.595  2923.47
  63   0.0383     98.870  0.0131    99.585  2970.59
  64   0.0350     98.890  0.0125    99.585  3017.66
  65   0.0348     98.920  0.0111    99.633  3064.72
  66   0.0376     98.730  0.0116    99.603  3111.78
  67   0.0474     98.470  0.0111    99.638  3159.11
  68   0.0340     98.960  0.0110    99.642  3206.17
  69   0.0420     98.780  0.0109    99.650  3253.24
  70   0.0389     98.910  0.0106    99.658  3300.32
  71   0.0344     99.000  0.0099    99.662  3347.42
  72   0.0425     98.690  0.0097    99.685  3394.55
  73   0.0399     98.710  0.0093    99.710  3441.61
  74   0.0332     99.060  0.0094    99.682  3488.66
  75   0.0390     98.810  0.0092    99.688  3535.71
  76   0.0383     98.820  0.0088    99.697  3582.78
  77   0.0367     98.870  0.0089    99.695  3630.05
  78   0.0363     98.980  0.0090    99.690  3677.11
  79   0.0374     98.900  0.0086    99.742  3724.17
  80   0.0347     98.970  0.0077    99.768  3771.26
  81   0.0346     99.000  0.0082    99.722  3818.28
  82   0.0322     99.040  0.0080    99.728  3865.31
  83   0.0313     99.050  0.0077    99.725  3912.34
  84   0.0369     98.910  0.0072    99.740  3959.43
  85   0.0366     98.830  0.0080    99.735  4006.55
  86   0.0430     98.780  0.0080    99.735  4053.31
  87   0.0387     98.920  0.0075    99.732  4100.42
  88   0.0375     98.810  0.0073    99.747  4147.49
  89   0.0336     99.070  0.0074    99.752  4194.56
  90   0.0395     98.790  0.0071    99.773  4241.65
