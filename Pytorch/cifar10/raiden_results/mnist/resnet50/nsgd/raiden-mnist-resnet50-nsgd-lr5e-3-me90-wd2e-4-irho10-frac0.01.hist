Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.0270     65.900  3.2993    28.390  51.68
   2   0.3437     89.750  0.6139    80.328  98.88
   3   0.1727     94.530  0.2616    92.267  146.08
   4   0.1381     95.630  0.1549    95.267  193.23
   5   0.1166     96.280  0.1133    96.455  240.38
   6   0.0879     97.100  0.0962    96.982  287.53
   7   0.0854     97.220  0.0847    97.377  334.69
   8   0.0606     98.030  0.0746    97.670  381.62
   9   0.0728     97.670  0.0674    97.882  428.85
  10   0.0659     97.810  0.0615    98.015  476.05
  11   0.0683     97.710  0.0575    98.220  523.24
  12   0.0539     98.330  0.0532    98.347  570.43
  13   0.0546     98.160  0.0511    98.345  617.64
  14   0.0481     98.320  0.0474    98.525  664.82
  15   0.0563     98.130  0.0452    98.605  712.01
  16   0.0582     98.110  0.0432    98.637  759.19
  17   0.0492     98.330  0.0401    98.780  806.35
  18   0.0537     98.010  0.0390    98.773  853.50
  19   0.0545     98.130  0.0384    98.778  900.68
  20   0.0481     98.360  0.0355    98.825  947.86
  21   0.0407     98.680  0.0358    98.885  995.03
  22   0.0462     98.450  0.0350    98.870  1042.21
  23   0.0349     98.950  0.0323    98.942  1089.44
  24   0.0475     98.530  0.0323    98.920  1136.64
  25   0.0601     98.300  0.0311    99.018  1183.79
  26   0.0585     98.080  0.0292    99.065  1230.97
  27   0.0539     98.360  0.0277    99.078  1278.14
  28   0.0406     98.700  0.0272    99.113  1325.33
  29   0.0395     98.680  0.0267    99.125  1372.51
  30   0.0519     98.370  0.0255    99.163  1419.70
  31   0.0436     98.610  0.0261    99.142  1466.94
  32   0.0503     98.410  0.0249    99.187  1514.13
  33   0.0338     98.800  0.0237    99.192  1561.33
  34   0.0403     98.660  0.0224    99.242  1608.47
  35   0.0347     98.950  0.0215    99.300  1655.62
  36   0.0491     98.530  0.0216    99.270  1702.77
  37   0.0428     98.700  0.0194    99.347  1750.05
  38   0.0427     98.720  0.0213    99.243  1797.25
  39   0.0411     98.790  0.0200    99.322  1844.45
  40   0.0456     98.590  0.0210    99.317  1891.69
  41   0.0492     98.610  0.0189    99.357  1938.86
  42   0.0411     98.740  0.0189    99.370  1986.06
  43   0.0427     98.740  0.0168    99.465  2033.23
  44   0.0350     98.880  0.0168    99.468  2080.40
  45   0.0505     98.510  0.0163    99.472  2127.61
  46   0.0387     98.820  0.0155    99.467  2174.78
  47   0.0429     98.660  0.0149    99.498  2221.99
  48   0.0425     98.670  0.0152    99.483  2269.21
  49   0.0446     98.740  0.0144    99.540  2316.39
  50   0.0405     98.890  0.0147    99.522  2363.56
  51   0.0439     98.690  0.0124    99.597  2410.69
  52   0.0435     98.770  0.0130    99.535  2457.87
  53   0.0366     98.920  0.0125    99.590  2505.06
  54   0.0426     98.720  0.0116    99.605  2552.24
  55   0.0558     98.510  0.0110    99.655  2599.43
  56   0.0348     98.960  0.0113    99.603  2646.61
  57   0.0421     98.790  0.0112    99.613  2693.80
  58   0.0486     98.560  0.0107    99.638  2740.95
  59   0.0470     98.760  0.0114    99.630  2788.08
  60   0.0495     98.460  0.0098    99.668  2835.19
  61   0.0442     98.830  0.0101    99.662  2882.38
  62   0.0352     99.070  0.0092    99.697  2929.27
  63   0.0421     98.870  0.0091    99.695  2976.46
  64   0.0413     98.870  0.0085    99.715  3023.70
  65   0.0416     98.810  0.0083    99.730  3070.90
  66   0.0478     98.740  0.0081    99.740  3118.09
  67   0.0427     98.890  0.0074    99.763  3165.24
  68   0.0469     98.730  0.0077    99.752  3212.41
  69   0.0433     98.890  0.0078    99.740  3259.59
  70   0.0428     98.880  0.0073    99.747  3306.73
  71   0.0412     98.980  0.0075    99.757  3353.92
  72   0.0468     98.880  0.0065    99.783  3401.11
  73   0.0454     98.830  0.0064    99.795  3448.31
  74   0.0407     98.910  0.0065    99.778  3495.51
  75   0.0459     98.890  0.0065    99.778  3542.67
  76   0.0424     98.890  0.0056    99.830  3589.82
  77   0.0489     98.790  0.0058    99.802  3636.96
  78   0.0468     98.890  0.0059    99.805  3684.21
  79   0.0447     98.790  0.0055    99.823  3731.42
  80   0.0490     98.870  0.0050    99.845  3778.61
  81   0.0698     98.370  0.0054    99.833  3825.83
  82   0.0449     98.920  0.0051    99.822  3873.02
  83   0.0409     99.000  0.0049    99.843  3920.21
  84   0.0485     98.890  0.0052    99.832  3967.43
  85   0.0511     98.650  0.0054    99.833  4014.55
  86   0.0445     98.920  0.0051    99.827  4061.75
  87   0.0474     98.870  0.0051    99.822  4108.93
  88   0.0509     98.780  0.0044    99.877  4156.17
  89   0.0416     98.980  0.0041    99.875  4203.35
  90   0.0457     98.920  0.0042    99.852  4250.49
