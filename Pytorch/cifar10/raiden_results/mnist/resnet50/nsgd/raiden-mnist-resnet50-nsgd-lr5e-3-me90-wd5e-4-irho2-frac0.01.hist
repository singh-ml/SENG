Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3150     90.420  1.6280    53.287  51.46
   2   0.1272     96.000  0.1990    93.893  98.49
   3   0.1025     96.730  0.1152    96.377  145.49
   4   0.0818     97.510  0.0847    97.342  192.49
   5   0.0676     97.740  0.0725    97.758  239.54
   6   0.0700     97.780  0.0603    98.102  286.50
   7   0.0521     98.370  0.0545    98.220  333.45
   8   0.0603     98.100  0.0507    98.408  380.42
   9   0.0605     98.200  0.0451    98.568  427.42
  10   0.0451     98.600  0.0422    98.610  474.46
  11   0.0408     98.680  0.0409    98.740  521.47
  12   0.0484     98.350  0.0357    98.845  568.46
  13   0.0437     98.710  0.0366    98.833  615.48
  14   0.0384     98.720  0.0325    98.955  662.48
  15   0.0374     98.800  0.0327    98.948  709.47
  16   0.0428     98.600  0.0304    99.020  756.43
  17   0.0339     98.830  0.0301    99.030  803.41
  18   0.0502     98.420  0.0281    99.117  850.37
  19   0.0378     98.710  0.0269    99.098  897.34
  20   0.0286     99.110  0.0248    99.198  944.35
  21   0.0322     98.910  0.0251    99.163  991.37
  22   0.0313     98.930  0.0227    99.240  1038.41
  23   0.0467     98.250  0.0229    99.243  1085.44
  24   0.0415     98.500  0.0224    99.265  1132.44
  25   0.0462     98.540  0.0204    99.352  1179.40
  26   0.0356     98.840  0.0207    99.307  1226.38
  27   0.0330     98.990  0.0203    99.300  1273.38
  28   0.0371     98.730  0.0197    99.325  1320.35
  29   0.0314     99.090  0.0182    99.403  1367.40
  30   0.0393     98.790  0.0202    99.295  1414.41
  31   0.0329     98.980  0.0175    99.428  1461.44
  32   0.0365     98.860  0.0172    99.437  1508.44
  33   0.0386     98.800  0.0157    99.477  1555.46
  34   0.0292     99.040  0.0169    99.418  1602.48
  35   0.0319     99.010  0.0155    99.450  1649.49
  36   0.0276     99.070  0.0148    99.517  1696.49
  37   0.0360     98.910  0.0135    99.553  1743.51
  38   0.0350     98.870  0.0141    99.528  1790.55
  39   0.0456     98.570  0.0129    99.593  1837.60
  40   0.0258     99.140  0.0129    99.562  1884.72
  41   0.0327     98.960  0.0126    99.565  1931.74
  42   0.0290     98.990  0.0127    99.587  1978.69
  43   0.0269     99.170  0.0121    99.593  2025.68
  44   0.0295     99.080  0.0108    99.648  2072.66
  45   0.0363     98.940  0.0106    99.645  2119.64
  46   0.0276     99.190  0.0109    99.660  2166.59
  47   0.0311     99.010  0.0096    99.672  2213.61
  48   0.0275     99.130  0.0095    99.708  2260.62
  49   0.0327     98.980  0.0093    99.698  2307.63
  50   0.0324     99.140  0.0091    99.680  2354.77
  51   0.0352     98.920  0.0083    99.732  2401.81
  52   0.0320     99.060  0.0085    99.723  2448.82
  53   0.0234     99.280  0.0084    99.748  2495.78
  54   0.0296     99.110  0.0078    99.753  2542.82
  55   0.0342     99.010  0.0072    99.770  2589.83
  56   0.0282     99.110  0.0069    99.795  2636.83
  57   0.0336     99.090  0.0072    99.753  2683.85
  58   0.0300     99.090  0.0066    99.788  2730.87
  59   0.0419     98.880  0.0064    99.765  2777.96
  60   0.0392     98.840  0.0065    99.782  2824.90
  61   0.0389     98.860  0.0062    99.803  2871.87
  62   0.0375     98.840  0.0065    99.792  2918.87
  63   0.0365     98.930  0.0055    99.840  2965.88
  64   0.0273     99.120  0.0055    99.820  3012.90
  65   0.0294     99.260  0.0051    99.843  3059.93
  66   0.0307     99.130  0.0054    99.823  3106.91
  67   0.0286     99.130  0.0051    99.833  3153.90
  68   0.0370     99.070  0.0049    99.850  3200.86
  69   0.0298     99.150  0.0047    99.853  3247.83
  70   0.0308     99.220  0.0046    99.867  3294.79
  71   0.0343     99.160  0.0047    99.838  3341.76
  72   0.0300     99.220  0.0042    99.873  3388.88
  73   0.0288     99.220  0.0039    99.895  3435.86
  74   0.0288     99.170  0.0039    99.860  3482.92
  75   0.0329     99.190  0.0041    99.870  3529.92
  76   0.0420     98.920  0.0037    99.873  3576.90
  77   0.0317     99.220  0.0031    99.908  3623.89
  78   0.0271     99.280  0.0039    99.877  3670.90
  79   0.0370     99.030  0.0035    99.895  3717.90
  80   0.0363     99.170  0.0031    99.917  3765.02
  81   0.0326     99.040  0.0032    99.898  3812.02
  82   0.0396     98.960  0.0030    99.913  3859.14
  83   0.0325     99.040  0.0030    99.918  3906.18
  84   0.0402     99.010  0.0029    99.912  3953.17
  85   0.0393     98.950  0.0032    99.903  4000.15
  86   0.0388     98.970  0.0030    99.917  4047.16
  87   0.0348     98.960  0.0027    99.922  4094.14
  88   0.0475     98.910  0.0027    99.918  4141.37
  89   0.0423     98.820  0.0029    99.923  4188.41
  90   0.0497     98.820  0.0029    99.922  4235.48
