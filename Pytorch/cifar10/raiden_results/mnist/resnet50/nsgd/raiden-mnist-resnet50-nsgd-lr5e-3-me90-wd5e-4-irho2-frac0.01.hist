Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2640     91.760  1.6661    60.090  53.01
   2   0.1222     96.120  0.1805    94.400  100.25
   3   0.0839     97.370  0.1164    96.360  147.31
   4   0.0634     97.840  0.0861    97.278  194.35
   5   0.0661     97.710  0.0724    97.728  241.36
   6   0.0689     97.810  0.0636    97.995  288.36
   7   0.0560     98.180  0.0570    98.207  335.35
   8   0.0572     98.160  0.0520    98.412  382.36
   9   0.0627     98.030  0.0470    98.490  429.55
  10   0.0585     98.160  0.0452    98.575  476.59
  11   0.0532     98.330  0.0420    98.652  523.63
  12   0.0369     98.810  0.0405    98.728  570.64
  13   0.0433     98.620  0.0362    98.833  617.69
  14   0.0567     98.300  0.0369    98.813  664.69
  15   0.0436     98.560  0.0340    98.945  711.70
  16   0.0451     98.550  0.0329    98.895  758.82
  17   0.0499     98.360  0.0311    99.040  805.86
  18   0.0385     98.750  0.0294    99.028  852.91
  19   0.0463     98.440  0.0283    99.072  899.97
  20   0.0466     98.400  0.0273    99.110  946.99
  21   0.0360     98.810  0.0276    99.100  994.00
  22   0.0361     98.720  0.0246    99.202  1041.01
  23   0.0450     98.490  0.0240    99.187  1088.03
  24   0.0347     98.860  0.0231    99.220  1135.07
  25   0.0391     98.780  0.0242    99.208  1182.06
  26   0.0435     98.650  0.0228    99.227  1229.07
  27   0.0400     98.750  0.0226    99.248  1276.07
  28   0.0481     98.590  0.0190    99.372  1323.09
  29   0.0335     98.920  0.0198    99.375  1370.14
  30   0.0457     98.600  0.0191    99.400  1417.16
  31   0.0372     98.680  0.0196    99.328  1464.23
  32   0.0384     98.850  0.0175    99.440  1511.24
  33   0.0371     98.890  0.0163    99.463  1558.27
  34   0.0377     98.800  0.0163    99.448  1605.29
  35   0.0394     98.700  0.0158    99.475  1652.32
  36   0.0479     98.580  0.0164    99.457  1699.38
  37   0.0431     98.620  0.0139    99.533  1746.41
  38   0.0364     98.860  0.0140    99.542  1793.47
  39   0.0402     98.770  0.0126    99.568  1840.50
  40   0.0328     98.990  0.0129    99.578  1887.51
  41   0.0361     98.860  0.0118    99.592  1934.51
  42   0.0585     98.290  0.0128    99.547  1981.50
  43   0.0334     98.890  0.0122    99.592  2028.54
  44   0.0335     98.950  0.0114    99.613  2075.58
  45   0.0296     99.040  0.0122    99.595  2122.60
  46   0.0374     98.800  0.0110    99.643  2169.63
  47   0.0329     99.020  0.0123    99.567  2216.63
  48   0.0444     98.660  0.0104    99.657  2263.66
  49   0.0340     99.010  0.0103    99.647  2310.68
  50   0.0394     98.840  0.0089    99.715  2357.73
  51   0.0382     98.650  0.0088    99.697  2404.78
  52   0.0410     98.770  0.0094    99.693  2451.84
  53   0.0384     98.840  0.0086    99.730  2498.87
  54   0.0427     98.660  0.0079    99.745  2545.92
  55   0.0421     98.810  0.0082    99.752  2592.98
  56   0.0513     98.530  0.0076    99.737  2639.99
  57   0.0357     98.950  0.0066    99.792  2687.02
  58   0.0453     98.570  0.0074    99.752  2734.05
  59   0.0390     98.880  0.0071    99.780  2781.08
  60   0.0355     98.890  0.0068    99.767  2828.14
  61   0.0336     98.940  0.0069    99.775  2875.20
  62   0.0392     98.810  0.0069    99.778  2922.24
  63   0.0441     98.700  0.0062    99.832  2969.30
  64   0.0364     98.940  0.0061    99.817  3016.33
  65   0.0419     98.710  0.0056    99.840  3063.33
  66   0.0360     98.950  0.0047    99.848  3110.33
  67   0.0383     98.870  0.0048    99.867  3157.40
  68   0.0365     99.010  0.0049    99.862  3204.41
  69   0.0478     98.770  0.0042    99.870  3251.42
  70   0.0427     98.830  0.0048    99.858  3298.49
  71   0.0441     98.790  0.0040    99.882  3345.53
  72   0.0381     98.970  0.0038    99.897  3392.58
  73   0.0464     98.860  0.0046    99.852  3439.57
  74   0.0433     98.730  0.0041    99.872  3486.72
  75   0.0391     98.850  0.0042    99.862  3533.74
  76   0.0437     98.810  0.0035    99.902  3580.77
  77   0.0394     98.910  0.0035    99.912  3627.79
  78   0.0430     98.800  0.0033    99.910  3674.79
  79   0.0391     99.000  0.0035    99.913  3721.82
  80   0.0487     98.750  0.0031    99.913  3768.86
  81   0.0420     98.810  0.0030    99.902  3816.09
  82   0.0410     98.970  0.0029    99.915  3863.15
  83   0.0430     98.850  0.0029    99.913  3910.21
  84   0.0480     98.660  0.0027    99.928  3957.25
  85   0.0429     98.920  0.0028    99.917  4004.27
  86   0.0410     98.910  0.0026    99.937  4051.30
  87   0.0507     98.620  0.0032    99.895  4098.31
  88   0.0557     98.560  0.0032    99.908  4145.37
  89   0.0425     98.860  0.0028    99.922  4192.43
  90   0.0451     98.680  0.0028    99.913  4239.49
