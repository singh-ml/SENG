Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.9569     65.800  2.9484    22.920  52.81
   2   0.1861     93.970  0.3735    87.997  99.98
   3   0.0957     96.850  0.1401    95.695  147.00
   4   0.0866     97.060  0.1027    96.843  193.99
   5   0.0575     98.120  0.0856    97.373  241.00
   6   0.0728     97.610  0.0709    97.842  288.00
   7   0.0513     98.340  0.0617    98.083  335.01
   8   0.0488     98.310  0.0554    98.307  382.26
   9   0.0446     98.470  0.0535    98.305  429.30
  10   0.0619     97.880  0.0503    98.347  476.32
  11   0.0556     98.140  0.0462    98.520  523.37
  12   0.0379     98.640  0.0440    98.623  570.53
  13   0.0493     98.320  0.0416    98.693  617.56
  14   0.0426     98.510  0.0407    98.702  664.58
  15   0.0683     97.750  0.0371    98.802  711.60
  16   0.0585     98.120  0.0353    98.913  758.63
  17   0.0473     98.460  0.0334    98.907  805.69
  18   0.0443     98.550  0.0305    98.980  852.76
  19   0.0386     98.760  0.0297    99.007  899.87
  20   0.0342     98.920  0.0284    99.055  946.88
  21   0.0421     98.740  0.0263    99.122  993.94
  22   0.0362     98.740  0.0264    99.142  1040.99
  23   0.0395     98.780  0.0251    99.188  1088.06
  24   0.0479     98.560  0.0241    99.233  1135.10
  25   0.0371     98.710  0.0248    99.208  1182.05
  26   0.0433     98.710  0.0236    99.203  1229.14
  27   0.0412     98.710  0.0208    99.308  1276.20
  28   0.0304     98.970  0.0202    99.365  1323.22
  29   0.0484     98.560  0.0196    99.348  1370.26
  30   0.0301     99.060  0.0189    99.408  1417.28
  31   0.0389     98.810  0.0194    99.340  1464.34
  32   0.0380     98.890  0.0178    99.388  1511.38
  33   0.0331     98.930  0.0169    99.437  1558.46
  34   0.0334     98.920  0.0178    99.403  1605.55
  35   0.0414     98.870  0.0155    99.472  1652.53
  36   0.0317     98.890  0.0159    99.477  1699.55
  37   0.0411     98.820  0.0144    99.507  1746.54
  38   0.0315     98.980  0.0146    99.475  1793.73
  39   0.0453     98.760  0.0132    99.563  1840.75
  40   0.0312     99.020  0.0131    99.557  1887.80
  41   0.0414     98.680  0.0112    99.637  1934.83
  42   0.0327     99.010  0.0123    99.590  1981.88
  43   0.0418     98.690  0.0113    99.620  2028.91
  44   0.0363     98.910  0.0114    99.625  2075.91
  45   0.0338     98.980  0.0107    99.658  2122.92
  46   0.0388     98.880  0.0116    99.592  2169.92
  47   0.0273     99.100  0.0103    99.647  2217.11
  48   0.0369     98.880  0.0100    99.680  2264.17
  49   0.0382     98.840  0.0100    99.658  2311.25
  50   0.0326     99.060  0.0083    99.738  2358.28
  51   0.0309     99.030  0.0089    99.673  2405.42
  52   0.0370     98.920  0.0075    99.743  2452.43
  53   0.0438     98.820  0.0076    99.742  2499.48
  54   0.0342     99.000  0.0075    99.748  2546.48
  55   0.0310     99.120  0.0067    99.778  2593.74
  56   0.0435     98.850  0.0070    99.768  2640.77
  57   0.0340     98.970  0.0065    99.773  2687.82
  58   0.0284     99.180  0.0069    99.758  2734.89
  59   0.0393     98.840  0.0059    99.815  2781.97
  60   0.0391     98.920  0.0052    99.832  2828.98
  61   0.0354     98.980  0.0052    99.853  2875.99
  62   0.0300     99.090  0.0054    99.842  2923.01
  63   0.0378     98.900  0.0051    99.847  2970.06
  64   0.0360     98.940  0.0045    99.860  3017.13
  65   0.0310     99.040  0.0045    99.863  3064.18
  66   0.0332     99.070  0.0042    99.865  3111.24
  67   0.0422     98.920  0.0044    99.872  3158.24
  68   0.0371     99.030  0.0044    99.858  3205.24
  69   0.0344     98.950  0.0039    99.880  3252.27
  70   0.0360     99.080  0.0038    99.888  3299.30
  71   0.0364     98.880  0.0034    99.898  3346.37
  72   0.0376     98.940  0.0039    99.887  3393.43
  73   0.0390     98.890  0.0038    99.880  3440.47
  74   0.0392     98.920  0.0039    99.893  3487.51
  75   0.0319     99.000  0.0035    99.882  3534.56
  76   0.0396     98.920  0.0038    99.873  3581.62
  77   0.0416     98.890  0.0034    99.885  3628.67
  78   0.0389     98.910  0.0032    99.898  3675.64
  79   0.0410     98.830  0.0031    99.907  3722.65
  80   0.0389     98.970  0.0035    99.897  3769.65
  81   0.0375     98.890  0.0028    99.922  3816.77
  82   0.0352     98.970  0.0027    99.922  3863.81
  83   0.0385     98.960  0.0028    99.920  3910.96
  84   0.0388     98.850  0.0028    99.915  3958.04
  85   0.0403     98.930  0.0027    99.923  4005.12
