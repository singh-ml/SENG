Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2755     15.510  3.9339    15.728  51.13
   2   2.0376     25.490  2.0590    24.360  97.45
   3   0.6366     75.730  1.2750    53.473  144.08
   4   0.3381     89.030  0.4718    84.620  190.76
   5   0.2314     92.690  0.2952    90.797  237.38
   6   0.1868     93.910  0.2150    93.407  284.01
   7   0.1527     95.120  0.1600    95.192  330.61
   8   0.1574     95.030  0.1446    95.582  377.22
   9   0.1461     95.120  0.1220    96.348  423.84
  10   0.0823     97.390  0.1084    96.705  470.17
  11   0.0800     97.190  0.0952    97.027  516.84
  12   0.0641     97.800  0.0890    97.183  563.51
  13   0.0856     97.180  0.0823    97.432  610.13
  14   0.0560     98.060  0.0787    97.538  656.80
  15   0.0667     97.810  0.0737    97.737  703.41
  16   0.0565     98.010  0.0695    97.825  749.74
  17   0.0682     97.610  0.0672    97.893  796.37
  18   0.0577     97.970  0.0631    97.960  842.98
  19   0.0540     98.050  0.0621    98.033  889.86
  20   0.0596     97.940  0.0601    98.135  936.52
  21   0.0456     98.460  0.0578    98.183  983.14
  22   0.0614     98.070  0.0567    98.222  1029.85
  23   0.0700     97.710  0.0535    98.320  1076.52
  24   0.0433     98.540  0.0525    98.318  1123.13
  25   0.0568     98.040  0.0495    98.432  1169.74
  26   0.0663     97.660  0.0506    98.423  1216.37
  27   0.0518     98.300  0.0481    98.505  1263.04
  28   0.0444     98.460  0.0458    98.602  1309.74
  29   0.0524     98.340  0.0457    98.518  1356.44
  30   0.0471     98.390  0.0440    98.603  1403.10
  31   0.0471     98.400  0.0421    98.637  1449.78
  32   0.0538     98.210  0.0428    98.605  1496.43
  33   0.0415     98.580  0.0413    98.690  1543.08
  34   0.0413     98.740  0.0391    98.740  1589.71
  35   0.0364     98.720  0.0386    98.760  1636.31
  36   0.0397     98.700  0.0362    98.862  1682.94
  37   0.0418     98.670  0.0367    98.832  1729.53
  38   0.0433     98.710  0.0352    98.872  1776.17
  39   0.0465     98.430  0.0343    98.932  1822.90
  40   0.0284     99.030  0.0329    98.980  1869.56
  41   0.0455     98.460  0.0333    98.947  1916.23
  42   0.0438     98.620  0.0329    98.935  1962.91
  43   0.0382     98.700  0.0317    98.948  2009.31
  44   0.0371     98.790  0.0321    99.012  2055.96
  45   0.0317     98.820  0.0317    99.017  2102.28
  46   0.0447     98.550  0.0294    99.058  2149.02
  47   0.0451     98.600  0.0285    99.090  2195.70
  48   0.0379     98.720  0.0281    99.115  2242.41
  49   0.0377     98.750  0.0271    99.138  2289.04
  50   0.0340     98.860  0.0268    99.133  2335.68
  51   0.0437     98.650  0.0261    99.153  2382.38
  52   0.0305     99.040  0.0246    99.212  2428.98
  53   0.0329     98.960  0.0249    99.220  2475.61
  54   0.0299     98.840  0.0239    99.210  2522.24
  55   0.0335     98.890  0.0248    99.197  2568.57
  56   0.0329     99.030  0.0231    99.243  2615.26
  57   0.0350     98.970  0.0231    99.272  2661.89
  58   0.0403     98.720  0.0216    99.255  2708.55
  59   0.0333     98.930  0.0214    99.275  2755.26
  60   0.0330     98.910  0.0208    99.348  2801.85
  61   0.0369     98.720  0.0211    99.338  2848.44
  62   0.0341     98.910  0.0200    99.330  2895.09
  63   0.0368     98.750  0.0197    99.317  2941.75
  64   0.0426     98.570  0.0183    99.415  2988.08
  65   0.0349     98.850  0.0191    99.328  3034.73
  66   0.0323     98.830  0.0188    99.377  3081.38
  67   0.0374     98.780  0.0175    99.447  3128.03
  68   0.0308     98.930  0.0173    99.410  3174.67
  69   0.0422     98.770  0.0158    99.508  3221.32
  70   0.0309     98.970  0.0169    99.462  3268.02
  71   0.0322     98.990  0.0153    99.527  3314.65
  72   0.0355     98.880  0.0157    99.472  3361.31
  73   0.0264     99.150  0.0152    99.512  3407.90
  74   0.0348     98.960  0.0152    99.505  3454.56
  75   0.0364     98.750  0.0150    99.517  3501.22
  76   0.0312     99.000  0.0149    99.530  3547.92
  77   0.0305     99.010  0.0147    99.517  3594.60
  78   0.0296     98.960  0.0142    99.532  3641.29
  79   0.0333     98.940  0.0146    99.557  3687.98
  80   0.0356     98.920  0.0133    99.588  3734.71
  81   0.0289     98.990  0.0137    99.568  3781.43
  82   0.0331     98.860  0.0133    99.598  3828.07
  83   0.0334     98.920  0.0132    99.562  3874.72
  84   0.0292     98.940  0.0139    99.572  3921.37
  85   0.0346     98.860  0.0129    99.587  3968.07
  86   0.0294     98.940  0.0129    99.582  4014.77
  87   0.0289     99.040  0.0121    99.575  4061.47
  88   0.0309     98.920  0.0126    99.603  4108.10
  89   0.0309     98.870  0.0127    99.598  4154.74
  90   0.0394     98.780  0.0132    99.592  4201.74
