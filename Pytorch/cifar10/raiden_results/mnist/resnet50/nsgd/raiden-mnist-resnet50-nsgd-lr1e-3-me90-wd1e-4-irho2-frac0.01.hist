Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.9686     67.800  1.6533    40.572  51.50
   2   0.3367     89.240  0.5970    80.752  98.93
   3   0.2187     93.100  0.2905    90.882  146.17
   4   0.1607     94.910  0.1962    93.967  193.47
   5   0.1393     95.600  0.1527    95.248  240.77
   6   0.1083     96.830  0.1287    95.958  288.03
   7   0.0991     96.880  0.1082    96.630  335.42
   8   0.1005     96.790  0.0979    96.940  382.76
   9   0.0884     97.230  0.0876    97.297  430.08
  10   0.0825     97.320  0.0798    97.453  477.36
  11   0.0744     97.780  0.0746    97.662  524.63
  12   0.0737     97.670  0.0695    97.753  571.90
  13   0.0620     97.850  0.0645    97.978  619.16
  14   0.0689     97.800  0.0621    98.023  666.45
  15   0.0715     97.710  0.0596    98.087  713.78
  16   0.0632     97.940  0.0569    98.195  761.13
  17   0.0571     98.370  0.0530    98.310  808.48
  18   0.0515     98.360  0.0490    98.403  855.81
  19   0.0557     98.270  0.0500    98.370  903.16
  20   0.0641     97.970  0.0472    98.515  950.40
  21   0.0524     98.290  0.0469    98.500  997.69
  22   0.0641     97.930  0.0431    98.623  1045.05
  23   0.0501     98.430  0.0429    98.648  1092.36
  24   0.0512     98.330  0.0422    98.677  1139.68
  25   0.0521     98.380  0.0398    98.712  1187.00
  26   0.0501     98.450  0.0391    98.737  1234.34
  27   0.0586     98.220  0.0368    98.788  1281.65
  28   0.0547     98.210  0.0374    98.822  1328.93
  29   0.0474     98.400  0.0353    98.867  1376.24
  30   0.0482     98.480  0.0349    98.920  1423.52
  31   0.0540     98.400  0.0345    98.888  1470.85
  32   0.0513     98.460  0.0333    98.942  1518.41
  33   0.0483     98.400  0.0322    98.943  1565.76
  34   0.0436     98.410  0.0326    98.970  1613.13
  35   0.0458     98.520  0.0322    99.000  1660.40
  36   0.0444     98.690  0.0297    99.022  1707.66
  37   0.0568     98.230  0.0290    99.075  1754.94
  38   0.0405     98.700  0.0294    99.057  1802.27
  39   0.0451     98.650  0.0283    99.078  1849.61
  40   0.0490     98.500  0.0279    99.065  1896.93
  41   0.0394     98.820  0.0269    99.095  1944.27
  42   0.0470     98.450  0.0269    99.153  1991.61
  43   0.0450     98.490  0.0255    99.197  2038.88
  44   0.0472     98.510  0.0251    99.170  2086.16
  45   0.0429     98.620  0.0260    99.175  2133.50
  46   0.0545     98.340  0.0251    99.185  2180.82
  47   0.0461     98.510  0.0234    99.210  2228.12
  48   0.0414     98.650  0.0242    99.237  2275.51
  49   0.0370     98.800  0.0236    99.212  2322.84
  50   0.0491     98.400  0.0221    99.283  2370.22
  51   0.0427     98.680  0.0230    99.197  2417.51
  52   0.0406     98.600  0.0214    99.322  2464.80
  53   0.0367     98.820  0.0211    99.303  2512.13
  54   0.0403     98.730  0.0210    99.328  2559.48
  55   0.0410     98.750  0.0208    99.300  2606.80
  56   0.0421     98.640  0.0199    99.338  2654.14
  57   0.0454     98.520  0.0194    99.363  2701.52
  58   0.0405     98.750  0.0188    99.383  2748.84
  59   0.0367     98.770  0.0183    99.408  2796.10
  60   0.0372     98.790  0.0187    99.360  2843.37
  61   0.0497     98.440  0.0187    99.392  2890.91
  62   0.0431     98.590  0.0192    99.348  2938.22
  63   0.0333     98.940  0.0171    99.418  2985.53
  64   0.0468     98.540  0.0184    99.408  3032.85
  65   0.0406     98.680  0.0184    99.393  3080.15
  66   0.0402     98.790  0.0171    99.437  3127.41
  67   0.0460     98.570  0.0170    99.422  3174.70
  68   0.0414     98.720  0.0175    99.447  3221.98
  69   0.0463     98.510  0.0170    99.432  3269.26
  70   0.0410     98.590  0.0166    99.435  3316.56
  71   0.0385     98.730  0.0160    99.443  3363.93
  72   0.0455     98.520  0.0168    99.468  3411.24
  73   0.0413     98.730  0.0157    99.462  3458.52
  74   0.0376     98.820  0.0149    99.492  3505.79
  75   0.0449     98.790  0.0149    99.483  3553.09
  76   0.0397     98.690  0.0148    99.498  3600.39
  77   0.0443     98.600  0.0145    99.512  3647.71
  78   0.0397     98.780  0.0139    99.542  3695.07
  79   0.0390     98.750  0.0139    99.558  3742.45
  80   0.0412     98.730  0.0140    99.523  3789.83
  81   0.0472     98.580  0.0147    99.532  3837.23
  82   0.0415     98.840  0.0122    99.597  3884.55
  83   0.0417     98.840  0.0128    99.555  3931.81
  84   0.0382     98.780  0.0127    99.603  3979.04
  85   0.0386     98.810  0.0132    99.553  4026.56
  86   0.0439     98.700  0.0118    99.603  4073.94
  87   0.0468     98.550  0.0115    99.613  4121.25
  88   0.0356     98.840  0.0115    99.630  4168.59
  89   0.0506     98.440  0.0128    99.578  4215.90
  90   0.0373     98.820  0.0122    99.588  4263.16
