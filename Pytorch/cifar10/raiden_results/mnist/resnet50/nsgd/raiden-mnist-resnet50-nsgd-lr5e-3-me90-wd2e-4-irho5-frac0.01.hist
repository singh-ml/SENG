Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.2324     58.660  2.9967    20.402  51.38
   2   0.2538     91.800  0.5127    82.788  98.31
   3   0.1201     96.280  0.1735    94.567  145.21
   4   0.1026     96.520  0.1151    96.390  192.14
   5   0.0888     96.890  0.0970    96.897  239.20
   6   0.0713     97.790  0.0797    97.483  286.20
   7   0.0607     98.100  0.0734    97.725  333.14
   8   0.0497     98.370  0.0660    97.883  380.10
   9   0.0734     97.550  0.0582    98.155  427.00
  10   0.0521     98.260  0.0529    98.327  473.90
  11   0.0521     98.190  0.0526    98.307  520.80
  12   0.0519     98.360  0.0477    98.497  567.81
  13   0.0522     98.220  0.0453    98.523  614.80
  14   0.0412     98.520  0.0435    98.593  661.77
  15   0.0464     98.320  0.0406    98.685  708.78
  16   0.0400     98.600  0.0395    98.715  755.68
  17   0.0466     98.420  0.0378    98.773  802.58
  18   0.0456     98.300  0.0357    98.860  849.53
  19   0.0437     98.470  0.0346    98.860  896.46
  20   0.0560     98.220  0.0314    98.985  943.37
  21   0.0394     98.660  0.0330    98.930  990.32
  22   0.0419     98.610  0.0300    99.043  1037.28
  23   0.0499     98.450  0.0292    99.018  1084.19
  24   0.0301     98.950  0.0273    99.105  1131.09
  25   0.0439     98.570  0.0277    99.063  1178.02
  26   0.0403     98.690  0.0269    99.105  1224.99
  27   0.0303     98.920  0.0255    99.142  1271.90
  28   0.0300     98.950  0.0273    99.092  1318.89
  29   0.0453     98.380  0.0246    99.160  1365.89
  30   0.0322     98.840  0.0234    99.247  1412.87
  31   0.0297     98.990  0.0224    99.243  1459.76
  32   0.0357     98.950  0.0226    99.262  1506.71
  33   0.0367     98.830  0.0205    99.305  1553.66
  34   0.0297     99.030  0.0221    99.250  1600.61
  35   0.0376     98.740  0.0207    99.338  1647.59
  36   0.0393     98.700  0.0195    99.362  1694.57
  37   0.0324     98.830  0.0196    99.365  1741.54
  38   0.0374     98.760  0.0182    99.385  1788.54
  39   0.0335     98.810  0.0174    99.427  1835.46
  40   0.0388     98.680  0.0160    99.463  1882.34
  41   0.0322     98.960  0.0170    99.427  1929.25
  42   0.0372     98.800  0.0175    99.367  1976.14
  43   0.0353     98.790  0.0177    99.420  2023.02
  44   0.0306     98.960  0.0148    99.492  2069.91
  45   0.0440     98.630  0.0148    99.508  2116.89
  46   0.0440     98.540  0.0144    99.505  2163.81
  47   0.0495     98.570  0.0138    99.537  2210.74
  48   0.0456     98.590  0.0136    99.530  2257.75
  49   0.0403     98.850  0.0143    99.508  2304.67
  50   0.0305     99.020  0.0139    99.510  2351.58
  51   0.0389     98.780  0.0118    99.605  2398.46
  52   0.0337     98.940  0.0122    99.600  2445.39
  53   0.0305     98.970  0.0111    99.648  2492.38
  54   0.0303     99.010  0.0117    99.605  2539.31
  55   0.0623     98.140  0.0110    99.600  2586.22
  56   0.0278     99.090  0.0110    99.633  2633.16
  57   0.0299     99.040  0.0095    99.677  2680.07
  58   0.0334     98.930  0.0095    99.693  2726.97
  59   0.0381     98.860  0.0096    99.672  2773.91
  60   0.0402     98.810  0.0091    99.697  2820.85
  61   0.0336     99.020  0.0084    99.737  2867.84
  62   0.0357     98.880  0.0080    99.705  2914.76
  63   0.0473     98.740  0.0080    99.728  2961.74
  64   0.0430     98.780  0.0080    99.728  3008.65
  65   0.0383     98.970  0.0081    99.723  3055.58
  66   0.0305     98.990  0.0078    99.747  3102.57
  67   0.0343     99.040  0.0074    99.787  3149.48
  68   0.0429     98.860  0.0068    99.768  3196.33
  69   0.0389     98.850  0.0060    99.802  3243.21
  70   0.0404     98.790  0.0063    99.790  3290.14
  71   0.0367     98.860  0.0063    99.795  3337.05
  72   0.0409     98.790  0.0060    99.802  3384.04
  73   0.0349     99.010  0.0057    99.800  3430.98
  74   0.0427     98.830  0.0058    99.792  3477.89
  75   0.0395     98.890  0.0060    99.808  3524.89
  76   0.0341     98.990  0.0050    99.840  3571.84
  77   0.0409     98.870  0.0053    99.822  3618.83
  78   0.0404     98.870  0.0050    99.838  3665.73
  79   0.0360     98.950  0.0050    99.833  3712.64
  80   0.0353     98.990  0.0047    99.842  3759.60
  81   0.0372     98.870  0.0052    99.817  3806.56
  82   0.0387     98.950  0.0048    99.848  3853.51
  83   0.0420     98.940  0.0051    99.828  3900.50
  84   0.0404     98.870  0.0048    99.845  3947.40
  85   0.0386     99.020  0.0047    99.853  3994.32
  86   0.0475     98.930  0.0044    99.845  4041.24
  87   0.0375     98.980  0.0044    99.847  4088.17
  88   0.0377     99.030  0.0043    99.867  4135.16
  89   0.0367     98.890  0.0040    99.862  4182.10
  90   0.0410     98.870  0.0039    99.880  4229.04
