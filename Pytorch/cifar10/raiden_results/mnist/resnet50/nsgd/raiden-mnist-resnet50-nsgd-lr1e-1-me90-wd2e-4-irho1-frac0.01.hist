Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.0553     26.810  3.5852    16.925  52.10
   2   0.8718     69.170  1.6298    41.277  98.78
   3   0.2175     93.410  0.4667    85.282  145.46
   4   0.1490     95.720  0.2342    92.915  192.13
   5   0.1137     96.530  0.1702    94.973  238.80
   6   0.1599     94.830  0.1352    95.968  285.55
   7   0.0948     96.940  0.1206    96.307  332.57
   8   0.1073     96.680  0.1036    96.818  379.26
   9   0.0855     97.470  0.0962    97.040  426.02
  10   0.0709     97.630  0.0916    97.170  472.98
  11   0.0670     97.690  0.0817    97.493  519.63
  12   0.0776     97.520  0.0804    97.493  566.62
  13   0.0713     97.660  0.0737    97.733  613.62
  14   0.0833     97.400  0.0723    97.753  660.66
  15   0.0900     97.530  0.0675    97.895  707.32
  16   0.0718     97.740  0.0661    97.902  754.34
  17   0.0475     98.420  0.0648    97.947  801.04
  18   0.0931     96.930  0.0673    97.915  848.04
  19   0.0531     98.280  0.0629    98.097  895.07
  20   0.0627     97.850  0.0576    98.213  941.75
  21   0.0469     98.500  0.0546    98.263  988.41
  22   0.0614     97.990  0.0538    98.260  1035.06
  23   0.0504     98.220  0.0506    98.395  1082.07
  24   0.0449     98.490  0.0506    98.432  1128.77
  25   0.0418     98.460  0.0480    98.443  1175.46
  26   0.0569     98.100  0.0484    98.483  1222.47
  27   0.0470     98.310  0.0474    98.473  1269.18
  28   0.0408     98.620  0.0472    98.540  1316.16
  29   0.0409     98.610  0.0476    98.513  1362.82
  30   0.0570     98.270  0.0431    98.592  1409.53
  31   0.0460     98.490  0.0429    98.623  1456.49
  32   0.0455     98.440  0.0417    98.658  1503.49
  33   0.0687     97.950  0.0404    98.707  1550.53
  34   0.0459     98.520  0.0399    98.712  1597.20
  35   0.0393     98.610  0.0371    98.792  1643.87
  36   0.0431     98.490  0.0389    98.777  1690.86
  37   0.0541     98.390  0.0372    98.820  1737.97
  38   0.0496     98.390  0.0374    98.840  1784.90
  39   0.0450     98.550  0.0377    98.803  1831.89
  40   0.0393     98.780  0.0345    98.870  1878.86
  41   0.0522     98.540  0.0330    98.988  1925.51
  42   0.0287     98.970  0.0340    98.948  1972.18
  43   0.0547     98.280  0.0324    98.945  2018.87
  44   0.0371     98.840  0.0323    98.948  2065.86
  45   0.0409     98.730  0.0324    98.948  2112.56
  46   0.0417     98.590  0.0310    99.020  2159.20
  47   0.0498     98.360  0.0318    98.990  2206.17
  48   0.0392     98.790  0.0292    99.087  2253.14
  49   0.0355     98.740  0.0292    99.057  2299.77
  50   0.0354     98.790  0.0266    99.102  2346.41
  51   0.0352     98.860  0.0275    99.118  2393.61
  52   0.0335     98.900  0.0255    99.173  2440.64
  53   0.0380     98.860  0.0245    99.200  2487.31
  54   0.0317     98.870  0.0255    99.182  2534.31
  55   0.0381     98.760  0.0231    99.235  2580.96
  56   0.0408     98.690  0.0227    99.257  2627.94
  57   0.0271     99.100  0.0216    99.297  2674.96
  58   0.0341     98.830  0.0213    99.313  2721.59
  59   0.0378     98.860  0.0207    99.330  2768.25
  60   0.0338     98.860  0.0191    99.367  2815.26
  61   0.0332     98.960  0.0178    99.395  2861.99
  62   0.0326     99.010  0.0175    99.418  2909.01
  63   0.0246     99.160  0.0162    99.480  2955.64
  64   0.0297     99.050  0.0161    99.500  3002.63
  65   0.0267     99.050  0.0154    99.493  3049.62
  66   0.0330     98.880  0.0150    99.547  3096.32
  67   0.0302     98.970  0.0138    99.588  3143.01
  68   0.0257     99.140  0.0130    99.595  3189.68
  69   0.0250     99.120  0.0118    99.618  3236.35
  70   0.0434     98.720  0.0114    99.637  3283.38
  71   0.0271     99.090  0.0109    99.647  3330.39
  72   0.0283     99.090  0.0108    99.660  3377.42
  73   0.0232     99.220  0.0093    99.712  3424.42
  74   0.0294     99.020  0.0088    99.738  3471.43
  75   0.0317     98.990  0.0087    99.717  3518.45
  76   0.0310     98.970  0.0089    99.725  3565.10
  77   0.0264     99.150  0.0082    99.750  3611.78
  78   0.0312     98.920  0.0072    99.797  3658.83
  79   0.0302     99.120  0.0073    99.773  3705.88
  80   0.0288     99.180  0.0066    99.802  3752.52
  81   0.0253     99.140  0.0061    99.830  3799.50
  82   0.0381     98.860  0.0064    99.825  3846.49
  83   0.0260     99.150  0.0061    99.823  3893.54
  84   0.0309     99.010  0.0059    99.830  3940.58
  85   0.0285     99.120  0.0058    99.843  3987.30
  86   0.0301     99.090  0.0057    99.837  4034.32
  87   0.0327     99.060  0.0056    99.837  4081.00
  88   0.0291     99.090  0.0056    99.852  4127.97
  89   0.0302     99.120  0.0055    99.853  4174.95
  90   0.0307     98.940  0.0053    99.860  4221.95
