Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5690     81.960  2.4245    36.073  51.73
   2   0.1931     93.600  0.2780    91.190  98.94
   3   0.1186     96.610  0.1347    95.778  146.08
   4   0.0752     97.550  0.0945    97.050  193.19
   5   0.0932     97.020  0.0774    97.650  240.33
   6   0.0543     98.290  0.0641    97.958  287.47
   7   0.0575     98.100  0.0564    98.213  334.62
   8   0.0467     98.520  0.0531    98.282  381.82
   9   0.0763     97.570  0.0500    98.413  428.95
  10   0.0738     97.520  0.0456    98.520  476.12
  11   0.0514     98.350  0.0428    98.640  523.29
  12   0.0484     98.470  0.0373    98.793  570.42
  13   0.0489     98.540  0.0349    98.860  617.56
  14   0.0402     98.670  0.0343    98.890  664.86
  15   0.0499     98.360  0.0342    98.913  712.03
  16   0.0437     98.560  0.0309    99.022  759.15
  17   0.0449     98.630  0.0296    99.057  806.30
  18   0.0448     98.570  0.0297    99.067  853.43
  19   0.0384     98.640  0.0282    99.053  900.60
  20   0.0368     98.730  0.0275    99.113  947.81
  21   0.0410     98.610  0.0254    99.230  994.95
  22   0.0402     98.750  0.0244    99.215  1042.13
  23   0.0462     98.550  0.0225    99.255  1089.28
  24   0.0352     98.890  0.0238    99.200  1136.38
  25   0.0452     98.730  0.0220    99.265  1183.52
  26   0.0402     98.740  0.0212    99.290  1230.68
  27   0.0534     98.420  0.0209    99.317  1277.83
  28   0.0540     98.420  0.0208    99.337  1324.99
  29   0.0522     98.460  0.0211    99.292  1372.29
  30   0.0351     98.930  0.0186    99.380  1419.48
  31   0.0407     98.790  0.0176    99.410  1466.61
  32   0.0325     98.870  0.0172    99.443  1513.70
  33   0.0432     98.710  0.0174    99.395  1560.86
  34   0.0397     98.750  0.0169    99.455  1608.00
  35   0.0364     98.820  0.0155    99.467  1655.23
  36   0.0381     98.830  0.0151    99.498  1702.36
  37   0.0464     98.600  0.0139    99.505  1749.56
  38   0.0396     98.820  0.0139    99.533  1796.72
  39   0.0381     98.790  0.0138    99.520  1843.86
  40   0.0280     99.120  0.0128    99.560  1891.01
  41   0.0339     98.850  0.0130    99.568  1938.15
  42   0.0292     99.120  0.0126    99.592  1985.30
  43   0.0397     98.860  0.0120    99.607  2032.45
  44   0.0336     98.890  0.0113    99.633  2079.62
  45   0.0401     98.950  0.0106    99.630  2126.84
  46   0.0432     98.780  0.0093    99.703  2174.04
  47   0.0424     98.730  0.0106    99.682  2221.24
  48   0.0403     98.780  0.0097    99.672  2268.47
  49   0.0411     98.780  0.0089    99.727  2315.60
  50   0.0329     98.920  0.0100    99.687  2362.75
  51   0.0369     98.730  0.0094    99.688  2409.89
  52   0.0403     98.710  0.0094    99.690  2457.28
  53   0.0367     98.970  0.0096    99.677  2504.42
  54   0.0307     99.040  0.0085    99.707  2551.62
  55   0.0358     98.990  0.0081    99.718  2598.81
  56   0.0365     98.960  0.0076    99.770  2646.01
  57   0.0467     98.750  0.0080    99.720  2693.24
  58   0.0439     98.790  0.0081    99.757  2740.39
  59   0.0333     99.120  0.0072    99.768  2787.54
  60   0.0368     98.950  0.0068    99.767  2834.77
  61   0.0399     99.030  0.0067    99.760  2881.94
  62   0.0343     99.030  0.0055    99.843  2929.13
  63   0.0369     98.850  0.0057    99.823  2976.29
  64   0.0437     98.910  0.0056    99.813  3023.45
  65   0.0400     98.760  0.0051    99.842  3070.65
  66   0.0389     98.830  0.0061    99.798  3117.78
  67   0.0433     98.970  0.0050    99.858  3164.92
  68   0.0350     99.010  0.0047    99.857  3212.08
  69   0.0467     98.760  0.0052    99.838  3259.27
  70   0.0391     98.940  0.0048    99.855  3306.49
  71   0.0369     98.970  0.0045    99.853  3353.69
  72   0.0377     98.960  0.0049    99.835  3400.98
  73   0.0357     98.970  0.0042    99.870  3448.12
  74   0.0340     99.070  0.0046    99.853  3495.31
  75   0.0395     98.960  0.0036    99.897  3542.44
  76   0.0386     98.950  0.0042    99.863  3589.62
  77   0.0419     98.860  0.0039    99.883  3636.83
  78   0.0414     98.950  0.0040    99.877  3684.06
  79   0.0386     98.850  0.0035    99.887  3731.25
  80   0.0410     98.960  0.0037    99.885  3778.49
  81   0.0403     99.030  0.0035    99.898  3825.66
  82   0.0344     99.000  0.0037    99.887  3872.83
  83   0.0430     98.900  0.0040    99.875  3919.98
  84   0.0462     98.640  0.0029    99.908  3967.16
  85   0.0409     98.920  0.0032    99.902  4014.34
  86   0.0402     98.960  0.0032    99.900  4061.56
  87   0.0385     98.980  0.0028    99.920  4108.75
  88   0.0390     98.980  0.0028    99.918  4155.99
  89   0.0383     98.970  0.0034    99.885  4203.25
  90   0.0400     98.950  0.0027    99.915  4250.39
