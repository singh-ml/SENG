Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5503     83.320  2.2161    38.547  51.73
   2   0.1718     94.340  0.2560    92.042  99.06
   3   0.1061     96.600  0.1277    96.015  146.38
   4   0.0916     97.160  0.0927    97.075  193.66
   5   0.0642     97.880  0.0804    97.452  240.91
   6   0.0590     98.130  0.0672    97.862  288.25
   7   0.0561     98.150  0.0574    98.205  335.61
   8   0.0453     98.450  0.0534    98.320  382.93
   9   0.0534     98.170  0.0501    98.377  430.22
  10   0.0502     98.250  0.0437    98.652  477.53
  11   0.0457     98.510  0.0422    98.673  524.82
  12   0.0469     98.530  0.0416    98.683  572.12
  13   0.0470     98.520  0.0371    98.790  619.44
  14   0.0456     98.530  0.0363    98.825  666.74
  15   0.0400     98.770  0.0329    98.935  714.04
  16   0.0402     98.710  0.0315    98.998  761.38
  17   0.0419     98.660  0.0298    98.995  808.63
  18   0.0398     98.830  0.0277    99.113  855.94
  19   0.0354     98.910  0.0290    99.030  903.29
  20   0.0381     98.840  0.0264    99.113  950.58
  21   0.0506     98.350  0.0270    99.145  997.89
  22   0.0476     98.510  0.0242    99.192  1045.15
  23   0.0427     98.710  0.0231    99.247  1092.42
  24   0.0525     98.550  0.0227    99.263  1139.67
  25   0.0356     98.810  0.0220    99.265  1186.96
  26   0.0341     98.960  0.0216    99.270  1234.49
  27   0.0335     98.980  0.0202    99.313  1281.83
  28   0.0346     98.950  0.0206    99.310  1329.20
  29   0.0432     98.600  0.0188    99.363  1376.69
  30   0.0433     98.740  0.0179    99.377  1424.02
  31   0.0415     98.800  0.0174    99.430  1471.29
  32   0.0301     99.150  0.0180    99.442  1518.57
  33   0.0389     98.800  0.0168    99.452  1566.07
  34   0.0360     99.010  0.0153    99.468  1613.37
  35   0.0337     99.000  0.0151    99.513  1660.72
  36   0.0495     98.470  0.0147    99.517  1708.07
  37   0.0404     98.740  0.0148    99.495  1755.37
  38   0.0381     98.960  0.0150    99.515  1802.63
  39   0.0450     98.650  0.0141    99.555  1849.89
  40   0.0430     98.810  0.0131    99.567  1897.15
  41   0.0413     98.590  0.0128    99.565  1944.42
  42   0.0343     98.900  0.0114    99.633  1991.76
  43   0.0471     98.530  0.0125    99.580  2039.08
  44   0.0390     98.930  0.0121    99.595  2086.37
  45   0.0420     98.740  0.0114    99.612  2133.67
  46   0.0352     98.930  0.0111    99.603  2181.02
  47   0.0336     98.960  0.0097    99.683  2228.29
  48   0.0358     98.940  0.0101    99.650  2275.57
  49   0.0439     98.580  0.0092    99.707  2322.83
  50   0.0400     98.930  0.0097    99.685  2370.15
  51   0.0368     98.900  0.0091    99.698  2417.44
  52   0.0481     98.660  0.0086    99.707  2464.76
  53   0.0367     98.990  0.0084    99.718  2512.08
  54   0.0418     98.890  0.0080    99.745  2559.52
  55   0.0413     98.920  0.0083    99.718  2606.82
  56   0.0338     98.950  0.0077    99.755  2654.16
  57   0.0335     99.010  0.0069    99.773  2701.41
  58   0.0386     98.880  0.0065    99.773  2748.68
  59   0.0492     98.730  0.0064    99.803  2796.04
  60   0.0374     98.930  0.0065    99.793  2843.40
  61   0.0392     98.940  0.0068    99.767  2890.73
  62   0.0371     98.960  0.0058    99.807  2938.07
  63   0.0509     98.730  0.0058    99.807  2985.37
  64   0.0425     98.930  0.0057    99.810  3032.66
  65   0.0415     98.870  0.0049    99.853  3079.98
  66   0.0366     98.990  0.0052    99.848  3127.25
  67   0.0412     98.940  0.0048    99.828  3174.58
  68   0.0364     98.960  0.0052    99.800  3221.89
  69   0.0449     98.700  0.0047    99.862  3269.20
  70   0.0418     98.830  0.0047    99.843  3316.55
  71   0.0387     98.900  0.0052    99.823  3363.87
  72   0.0414     98.900  0.0044    99.857  3411.16
  73   0.0463     98.840  0.0042    99.868  3458.44
  74   0.0474     98.760  0.0040    99.868  3505.73
  75   0.0356     99.060  0.0038    99.862  3553.04
  76   0.0425     98.820  0.0041    99.863  3600.38
  77   0.0373     98.960  0.0036    99.907  3647.74
  78   0.0433     98.920  0.0042    99.865  3695.08
  79   0.0366     98.960  0.0036    99.885  3742.38
  80   0.0405     98.890  0.0039    99.880  3789.68
  81   0.0393     98.990  0.0035    99.910  3836.96
  82   0.0498     98.690  0.0032    99.903  3884.54
  83   0.0390     99.010  0.0031    99.895  3931.90
  84   0.0466     99.010  0.0031    99.897  3979.19
  85   0.0354     99.120  0.0033    99.915  4026.52
  86   0.0387     98.970  0.0031    99.898  4073.81
  87   0.0418     99.010  0.0032    99.900  4121.05
  88   0.0415     98.860  0.0026    99.927  4168.35
  89   0.0334     99.130  0.0027    99.920  4215.64
  90   0.0443     98.890  0.0027    99.935  4262.97
