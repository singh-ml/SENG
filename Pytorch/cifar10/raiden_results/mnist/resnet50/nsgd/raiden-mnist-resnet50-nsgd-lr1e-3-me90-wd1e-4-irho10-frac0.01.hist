Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2552     91.550  1.4208    64.082  51.61
   2   0.1128     96.620  0.1720    94.598  98.68
   3   0.0787     97.530  0.1067    96.733  145.74
   4   0.0527     98.160  0.0843    97.272  192.78
   5   0.0753     97.640  0.0692    97.810  239.88
   6   0.0643     97.950  0.0616    98.082  286.96
   7   0.0661     97.950  0.0558    98.233  334.00
   8   0.0551     98.310  0.0512    98.462  381.04
   9   0.0644     97.980  0.0465    98.507  428.09
  10   0.0459     98.410  0.0435    98.598  475.12
  11   0.0532     98.200  0.0420    98.645  522.13
  12   0.0716     97.740  0.0395    98.742  569.17
  13   0.0457     98.590  0.0392    98.768  616.24
  14   0.0461     98.590  0.0333    98.962  663.32
  15   0.0565     98.190  0.0328    98.922  710.40
  16   0.0364     98.810  0.0332    98.930  757.44
  17   0.0490     98.440  0.0311    99.027  804.52
  18   0.0378     98.730  0.0290    99.047  851.56
  19   0.0404     98.670  0.0285    99.050  898.62
  20   0.0408     98.820  0.0250    99.158  945.67
  21   0.0391     98.700  0.0275    99.103  992.77
  22   0.0416     98.640  0.0253    99.147  1039.88
  23   0.0315     98.970  0.0248    99.192  1086.95
  24   0.0382     98.820  0.0234    99.233  1134.06
  25   0.0332     98.970  0.0234    99.263  1181.17
  26   0.0334     99.030  0.0217    99.253  1228.18
  27   0.0440     98.530  0.0215    99.280  1275.19
  28   0.0321     98.950  0.0211    99.303  1322.21
  29   0.0384     98.800  0.0201    99.332  1369.21
  30   0.0394     98.870  0.0211    99.327  1416.28
  31   0.0335     98.990  0.0197    99.340  1463.36
  32   0.0472     98.580  0.0189    99.360  1510.45
  33   0.0394     98.760  0.0180    99.377  1557.55
  34   0.0418     98.710  0.0190    99.370  1604.62
  35   0.0312     99.020  0.0162    99.467  1651.70
  36   0.0437     98.790  0.0183    99.388  1698.77
  37   0.0342     99.020  0.0173    99.445  1745.86
  38   0.0539     98.540  0.0173    99.423  1792.96
  39   0.0494     98.520  0.0153    99.470  1840.04
  40   0.0460     98.770  0.0166    99.422  1887.14
  41   0.0388     98.850  0.0151    99.532  1934.21
  42   0.0343     99.000  0.0146    99.507  1981.27
  43   0.0384     98.910  0.0151    99.505  2028.47
  44   0.0459     98.860  0.0135    99.525  2075.50
  45   0.0364     98.840  0.0133    99.543  2122.49
  46   0.0376     98.960  0.0124    99.585  2169.51
  47   0.0424     98.700  0.0138    99.537  2216.56
  48   0.0314     99.120  0.0134    99.558  2263.66
  49   0.0428     98.800  0.0116    99.578  2310.77
  50   0.0510     98.670  0.0123    99.602  2357.88
  51   0.0448     98.840  0.0121    99.608  2404.91
  52   0.0430     98.860  0.0123    99.585  2451.95
  53   0.0397     98.880  0.0104    99.648  2498.98
  54   0.0410     98.990  0.0115    99.615  2546.05
  55   0.0399     98.880  0.0113    99.620  2593.09
  56   0.0389     98.920  0.0116    99.575  2640.15
  57   0.0431     98.740  0.0119    99.610  2687.21
  58   0.0428     98.890  0.0093    99.667  2734.28
  59   0.0312     99.090  0.0099    99.672  2781.35
  60   0.0349     99.110  0.0108    99.612  2828.43
  61   0.0403     98.960  0.0105    99.628  2875.52
  62   0.0329     99.150  0.0093    99.688  2922.64
  63   0.0382     99.040  0.0091    99.688  2969.72
  64   0.0368     99.130  0.0082    99.728  3016.77
  65   0.0338     99.010  0.0092    99.702  3063.78
  66   0.0484     98.780  0.0085    99.707  3110.77
  67   0.0488     98.670  0.0087    99.687  3157.85
  68   0.0463     98.780  0.0092    99.705  3204.92
  69   0.0370     99.100  0.0081    99.712  3251.96
  70   0.0374     98.970  0.0077    99.740  3299.03
  71   0.0449     98.660  0.0084    99.732  3346.06
  72   0.0547     98.690  0.0083    99.723  3393.13
  73   0.0407     98.950  0.0074    99.745  3440.17
  74   0.0503     98.860  0.0078    99.752  3487.16
  75   0.0472     98.710  0.0080    99.737  3534.17
  76   0.0474     98.930  0.0072    99.740  3581.24
  77   0.0395     98.950  0.0075    99.748  3628.31
  78   0.0495     98.860  0.0081    99.733  3675.39
  79   0.0431     98.880  0.0076    99.732  3722.44
  80   0.0386     98.960  0.0078    99.720  3769.46
  81   0.0583     98.410  0.0068    99.785  3816.55
  82   0.0546     98.790  0.0078    99.738  3863.60
  83   0.0431     98.990  0.0070    99.740  3910.64
  84   0.0392     99.020  0.0067    99.758  3957.69
  85   0.0492     98.740  0.0075    99.733  4004.77
  86   0.0419     98.970  0.0070    99.778  4051.87
  87   0.0495     98.800  0.0067    99.778  4098.94
  88   0.0556     98.820  0.0067    99.758  4145.94
  89   0.0374     99.130  0.0063    99.765  4192.97
  90   0.0595     98.730  0.0053    99.802  4240.03
