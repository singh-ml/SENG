Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2858     90.810  1.7417    50.693  51.93
   2   0.1459     95.400  0.1788    94.493  99.18
   3   0.0891     97.120  0.1065    96.625  146.42
   4   0.0834     97.410  0.0826    97.447  193.70
   5   0.0687     97.710  0.0683    97.902  240.93
   6   0.0793     97.460  0.0619    98.047  288.12
   7   0.0562     98.150  0.0539    98.315  335.36
   8   0.0623     98.190  0.0510    98.410  382.64
   9   0.0638     98.060  0.0444    98.618  429.89
  10   0.0531     98.140  0.0440    98.615  477.07
  11   0.0762     97.760  0.0388    98.748  524.32
  12   0.0390     98.640  0.0382    98.777  571.56
  13   0.0458     98.520  0.0380    98.818  618.89
  14   0.0479     98.520  0.0352    98.827  666.08
  15   0.0480     98.620  0.0331    98.963  713.30
  16   0.0377     98.670  0.0327    98.970  760.52
  17   0.0505     98.460  0.0284    99.105  807.75
  18   0.0544     98.110  0.0297    99.028  855.02
  19   0.0379     98.670  0.0289    99.083  902.28
  20   0.0391     98.680  0.0281    99.083  949.59
  21   0.0466     98.490  0.0252    99.220  996.81
  22   0.0653     97.990  0.0234    99.258  1044.04
  23   0.0419     98.630  0.0263    99.138  1091.27
  24   0.0534     98.210  0.0236    99.252  1138.54
  25   0.0472     98.550  0.0229    99.197  1185.77
  26   0.0317     98.870  0.0242    99.208  1233.03
  27   0.0383     98.710  0.0215    99.308  1280.28
  28   0.0392     98.780  0.0214    99.267  1327.53
  29   0.0403     98.740  0.0232    99.248  1374.78
  30   0.0467     98.710  0.0195    99.367  1422.05
  31   0.0381     98.800  0.0184    99.353  1469.28
  32   0.0388     98.780  0.0184    99.398  1516.50
  33   0.0451     98.580  0.0176    99.407  1563.76
  34   0.0348     98.890  0.0194    99.357  1611.03
  35   0.0489     98.600  0.0172    99.440  1658.26
  36   0.0343     98.880  0.0175    99.413  1705.53
  37   0.0514     98.440  0.0164    99.447  1752.80
  38   0.0412     98.820  0.0158    99.477  1800.08
  39   0.0428     98.770  0.0149    99.498  1847.30
  40   0.0407     98.760  0.0154    99.483  1894.75
  41   0.0329     99.040  0.0154    99.490  1942.25
  42   0.0351     98.950  0.0150    99.468  1989.53
  43   0.0339     98.930  0.0136    99.547  2036.79
  44   0.0326     98.980  0.0137    99.543  2084.06
  45   0.0375     98.790  0.0138    99.525  2131.30
  46   0.0412     98.620  0.0142    99.507  2178.53
  47   0.0363     98.930  0.0133    99.560  2225.77
  48   0.0419     98.750  0.0132    99.537  2273.04
  49   0.0346     98.970  0.0134    99.545  2320.32
  50   0.0332     98.900  0.0129    99.567  2367.59
  51   0.0310     99.070  0.0125    99.560  2414.83
  52   0.0320     99.050  0.0111    99.637  2462.08
  53   0.0324     99.050  0.0119    99.602  2509.36
  54   0.0335     98.970  0.0121    99.582  2556.62
  55   0.0555     98.550  0.0116    99.615  2603.80
  56   0.0362     98.970  0.0117    99.597  2651.03
  57   0.0282     99.080  0.0104    99.638  2698.35
  58   0.0425     98.920  0.0104    99.635  2745.60
  59   0.0352     98.900  0.0105    99.642  2792.86
  60   0.0477     98.650  0.0106    99.647  2840.14
  61   0.0435     98.710  0.0103    99.647  2887.38
  62   0.0324     99.060  0.0106    99.657  2934.62
  63   0.0355     98.980  0.0102    99.667  2981.84
  64   0.0405     98.860  0.0096    99.660  3029.11
  65   0.0344     98.960  0.0097    99.677  3076.32
  66   0.0491     98.820  0.0094    99.675  3123.58
  67   0.0319     99.090  0.0093    99.665  3170.84
  68   0.0411     98.900  0.0084    99.688  3218.09
  69   0.0396     98.800  0.0088    99.700  3265.29
  70   0.0352     99.010  0.0085    99.708  3312.51
  71   0.0365     99.110  0.0081    99.733  3359.73
  72   0.0401     99.070  0.0093    99.640  3407.09
  73   0.0393     99.040  0.0069    99.767  3454.33
  74   0.0433     98.800  0.0075    99.733  3501.58
  75   0.0331     99.040  0.0082    99.708  3548.85
  76   0.0435     98.720  0.0071    99.750  3596.10
  77   0.0421     99.000  0.0068    99.778  3643.33
  78   0.0376     99.120  0.0081    99.697  3690.51
  79   0.0476     98.780  0.0074    99.748  3737.74
  80   0.0344     99.120  0.0078    99.728  3784.94
  81   0.0433     98.950  0.0065    99.795  3832.43
  82   0.0385     99.080  0.0059    99.783  3879.70
  83   0.0367     98.970  0.0058    99.803  3927.01
  84   0.0397     99.020  0.0066    99.792  3974.23
  85   0.0459     98.880  0.0060    99.790  4021.49
  86   0.0376     99.020  0.0066    99.765  4068.71
  87   0.0472     98.820  0.0054    99.807  4115.94
  88   0.0415     98.870  0.0060    99.807  4163.22
  89   0.0357     99.110  0.0056    99.798  4210.45
  90   0.0394     98.890  0.0066    99.740  4257.79
