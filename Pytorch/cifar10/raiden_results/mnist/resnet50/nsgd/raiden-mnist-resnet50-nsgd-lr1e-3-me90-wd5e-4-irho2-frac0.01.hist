Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.9066     69.330  1.6309    41.047  51.80
   2   0.3756     88.340  0.6248    79.522  99.11
   3   0.2307     92.870  0.3129    90.297  146.32
   4   0.1793     94.480  0.2106    93.503  193.53
   5   0.1401     95.490  0.1658    94.812  240.67
   6   0.1205     96.060  0.1357    95.708  287.81
   7   0.1036     96.830  0.1202    96.277  334.99
   8   0.1067     96.750  0.1030    96.770  382.16
   9   0.0981     96.740  0.0930    97.102  429.32
  10   0.0851     97.190  0.0848    97.310  476.51
  11   0.0802     97.250  0.0782    97.530  523.70
  12   0.0663     97.930  0.0712    97.727  570.90
  13   0.0774     97.560  0.0675    97.830  618.14
  14   0.0665     97.910  0.0631    97.988  665.29
  15   0.0678     97.680  0.0613    98.027  712.44
  16   0.0603     98.130  0.0572    98.135  759.60
  17   0.0586     98.160  0.0536    98.257  806.78
  18   0.0606     98.010  0.0518    98.373  853.99
  19   0.0559     98.170  0.0511    98.380  901.19
  20   0.0518     98.270  0.0480    98.485  948.38
  21   0.0526     98.260  0.0458    98.537  995.51
  22   0.0557     98.130  0.0446    98.582  1042.89
  23   0.0420     98.640  0.0426    98.637  1090.31
  24   0.0539     98.320  0.0419    98.690  1137.50
  25   0.0637     97.890  0.0412    98.735  1184.69
  26   0.0495     98.550  0.0395    98.727  1231.86
  27   0.0446     98.570  0.0385    98.773  1279.06
  28   0.0452     98.550  0.0362    98.813  1326.22
  29   0.0502     98.450  0.0363    98.800  1373.34
  30   0.0575     98.280  0.0338    98.883  1420.48
  31   0.0538     98.390  0.0332    98.935  1467.68
  32   0.0416     98.720  0.0326    98.980  1514.85
  33   0.0405     98.690  0.0308    99.053  1562.03
  34   0.0497     98.430  0.0312    99.030  1609.21
  35   0.0434     98.540  0.0300    99.007  1656.40
  36   0.0498     98.370  0.0288    99.020  1703.57
  37   0.0456     98.640  0.0281    99.117  1750.68
  38   0.0428     98.560  0.0275    99.113  1797.84
  39   0.0450     98.580  0.0269    99.122  1844.97
  40   0.0402     98.650  0.0280    99.077  1892.10
  41   0.0482     98.360  0.0267    99.153  1939.39
  42   0.0397     98.690  0.0258    99.115  1986.54
  43   0.0395     98.750  0.0256    99.122  2033.75
  44   0.0364     98.830  0.0245    99.193  2080.94
  45   0.0442     98.490  0.0240    99.247  2128.14
  46   0.0480     98.450  0.0238    99.245  2175.34
  47   0.0450     98.650  0.0213    99.293  2222.52
  48   0.0449     98.590  0.0243    99.198  2269.72
  49   0.0396     98.730  0.0220    99.298  2316.87
  50   0.0430     98.620  0.0214    99.312  2364.01
  51   0.0408     98.770  0.0222    99.305  2411.16
  52   0.0438     98.570  0.0219    99.245  2458.34
  53   0.0551     98.360  0.0209    99.333  2505.49
  54   0.0371     98.840  0.0206    99.302  2552.67
  55   0.0421     98.620  0.0211    99.252  2599.86
  56   0.0428     98.650  0.0200    99.310  2647.07
  57   0.0437     98.650  0.0196    99.348  2694.22
  58   0.0465     98.690  0.0189    99.393  2741.36
  59   0.0488     98.310  0.0175    99.420  2788.51
  60   0.0440     98.680  0.0191    99.360  2835.98
  61   0.0345     98.800  0.0177    99.422  2883.20
  62   0.0414     98.750  0.0179    99.410  2930.39
  63   0.0366     98.940  0.0179    99.430  2977.59
  64   0.0429     98.850  0.0181    99.407  3024.80
  65   0.0377     98.920  0.0167    99.438  3071.98
  66   0.0382     98.830  0.0157    99.493  3119.13
  67   0.0370     98.820  0.0170    99.420  3166.32
  68   0.0389     98.880  0.0154    99.482  3213.48
  69   0.0369     98.810  0.0156    99.498  3260.66
  70   0.0397     98.710  0.0157    99.470  3307.85
  71   0.0530     98.360  0.0156    99.497  3355.05
  72   0.0418     98.710  0.0141    99.525  3402.27
  73   0.0436     98.620  0.0151    99.498  3449.40
  74   0.0419     98.800  0.0139    99.558  3496.58
  75   0.0436     98.690  0.0141    99.543  3543.71
  76   0.0451     98.700  0.0132    99.553  3590.95
  77   0.0364     98.790  0.0137    99.542  3638.19
  78   0.0411     98.680  0.0137    99.528  3685.38
  79   0.0450     98.700  0.0136    99.548  3732.59
  80   0.0492     98.510  0.0128    99.582  3779.98
  81   0.0398     98.750  0.0133    99.555  3827.09
  82   0.0310     99.010  0.0126    99.588  3874.24
  83   0.0447     98.660  0.0131    99.558  3921.39
  84   0.0439     98.680  0.0125    99.543  3968.64
  85   0.0355     98.930  0.0126    99.593  4015.87
  86   0.0465     98.610  0.0125    99.555  4063.07
  87   0.0402     98.770  0.0135    99.540  4110.25
  88   0.0504     98.660  0.0114    99.640  4157.44
  89   0.0465     98.700  0.0112    99.637  4204.60
  90   0.0385     98.740  0.0115    99.607  4251.74
