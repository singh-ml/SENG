Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.9307     70.550  1.6362    41.595  51.42
   2   0.3485     88.340  0.5505    82.265  98.51
   3   0.2234     93.130  0.2787    91.408  145.53
   4   0.1701     94.680  0.1972    93.882  192.58
   5   0.1373     96.000  0.1516    95.298  239.67
   6   0.1075     96.820  0.1240    96.157  286.66
   7   0.0996     97.070  0.1068    96.618  333.69
   8   0.0850     97.510  0.0951    96.973  380.74
   9   0.1029     96.860  0.0879    97.227  427.73
  10   0.0826     97.390  0.0808    97.432  474.84
  11   0.1063     96.830  0.0717    97.730  521.87
  12   0.0753     97.760  0.0679    97.825  568.90
  13   0.0625     98.080  0.0634    97.938  615.99
  14   0.0659     97.880  0.0602    98.065  663.05
  15   0.0639     97.990  0.0566    98.222  710.09
  16   0.0651     97.960  0.0543    98.277  757.15
  17   0.0602     98.050  0.0516    98.320  804.17
  18   0.0600     98.160  0.0478    98.460  851.21
  19   0.0566     98.170  0.0468    98.507  898.21
  20   0.0672     97.950  0.0471    98.503  945.23
  21   0.0613     98.130  0.0459    98.535  992.32
  22   0.0529     98.260  0.0431    98.633  1039.38
  23   0.0500     98.430  0.0415    98.672  1086.41
  24   0.0493     98.500  0.0396    98.720  1133.45
  25   0.0523     98.280  0.0396    98.767  1180.52
  26   0.0497     98.440  0.0367    98.833  1227.49
  27   0.0659     98.000  0.0366    98.832  1274.47
  28   0.0514     98.400  0.0346    98.872  1321.49
  29   0.0535     98.280  0.0343    98.890  1368.58
  30   0.0417     98.760  0.0329    98.947  1415.64
  31   0.0446     98.510  0.0332    98.937  1462.73
  32   0.0488     98.420  0.0308    98.977  1509.79
  33   0.0493     98.430  0.0314    98.995  1556.93
  34   0.0530     98.330  0.0289    99.082  1603.95
  35   0.0660     98.020  0.0312    99.020  1650.96
  36   0.0528     98.370  0.0295    99.077  1697.93
  37   0.0532     98.420  0.0278    99.128  1745.20
  38   0.0437     98.670  0.0269    99.123  1792.25
  39   0.0486     98.490  0.0270    99.077  1839.32
  40   0.0499     98.400  0.0250    99.197  1886.39
  41   0.0493     98.560  0.0253    99.208  1933.40
  42   0.0500     98.490  0.0240    99.252  1980.45
  43   0.0445     98.760  0.0250    99.147  2027.54
  44   0.0516     98.450  0.0228    99.247  2074.60
  45   0.0773     97.860  0.0236    99.265  2121.69
  46   0.0489     98.530  0.0224    99.255  2168.73
  47   0.0500     98.480  0.0221    99.282  2215.72
  48   0.0512     98.540  0.0218    99.298  2262.74
  49   0.0414     98.580  0.0217    99.262  2309.86
  50   0.0402     98.720  0.0209    99.297  2356.93
  51   0.0439     98.530  0.0207    99.338  2403.91
  52   0.0478     98.620  0.0195    99.333  2451.17
  53   0.0440     98.790  0.0206    99.340  2498.22
  54   0.0489     98.640  0.0198    99.335  2545.27
  55   0.0496     98.630  0.0188    99.358  2592.36
  56   0.0458     98.610  0.0184    99.385  2639.41
  57   0.0427     98.780  0.0181    99.393  2686.48
  58   0.0425     98.720  0.0176    99.418  2733.48
  59   0.0378     98.800  0.0180    99.400  2780.52
  60   0.0421     98.730  0.0173    99.435  2827.59
  61   0.0500     98.490  0.0175    99.435  2874.63
  62   0.0391     98.870  0.0169    99.440  2921.67
  63   0.0398     98.740  0.0156    99.472  2968.74
  64   0.0468     98.540  0.0155    99.477  3015.86
  65   0.0485     98.680  0.0150    99.517  3062.93
  66   0.0457     98.690  0.0155    99.453  3109.95
  67   0.0392     98.800  0.0164    99.477  3157.03
  68   0.0417     98.790  0.0157    99.462  3204.07
  69   0.0409     98.870  0.0152    99.478  3251.10
  70   0.0477     98.580  0.0149    99.497  3298.11
  71   0.0514     98.590  0.0141    99.505  3345.08
  72   0.0364     98.920  0.0139    99.552  3392.18
  73   0.0409     98.750  0.0143    99.523  3439.26
  74   0.0398     98.730  0.0140    99.522  3486.31
  75   0.0398     98.880  0.0130    99.580  3533.39
  76   0.0393     98.850  0.0139    99.560  3580.45
  77   0.0341     98.940  0.0132    99.548  3627.47
  78   0.0490     98.600  0.0128    99.557  3674.50
  79   0.0396     98.870  0.0130    99.578  3721.52
  80   0.0470     98.720  0.0127    99.575  3768.69
  81   0.0414     98.850  0.0125    99.587  3816.11
  82   0.0407     98.810  0.0130    99.547  3863.14
  83   0.0413     98.910  0.0121    99.607  3910.26
  84   0.0466     98.690  0.0111    99.617  3957.30
  85   0.0503     98.600  0.0110    99.633  4004.35
  86   0.0449     98.600  0.0114    99.615  4051.42
  87   0.0546     98.490  0.0111    99.663  4098.45
  88   0.0414     98.780  0.0107    99.635  4145.47
  89   0.0476     98.630  0.0110    99.617  4192.53
  90   0.0472     98.730  0.0116    99.602  4239.60
