Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.6207     79.830  2.4878    33.625  54.17
   2   0.1331     95.730  0.2943    90.505  101.25
   3   0.1151     96.220  0.1365    95.705  148.26
   4   0.0858     97.240  0.0923    97.157  195.30
   5   0.0573     98.120  0.0786    97.498  242.36
   6   0.0540     98.140  0.0665    97.910  289.37
   7   0.0571     98.230  0.0570    98.193  336.36
   8   0.0619     97.910  0.0522    98.422  383.40
   9   0.0582     98.090  0.0493    98.460  430.49
  10   0.0477     98.370  0.0455    98.572  477.54
  11   0.0491     98.450  0.0424    98.652  524.54
  12   0.0410     98.510  0.0394    98.743  571.55
  13   0.0491     98.340  0.0394    98.767  618.53
  14   0.0622     97.940  0.0355    98.877  665.55
  15   0.0425     98.530  0.0341    98.898  712.54
  16   0.0380     98.650  0.0326    98.932  759.54
  17   0.0387     98.650  0.0327    98.948  806.60
  18   0.0448     98.550  0.0306    99.000  853.66
  19   0.0385     98.750  0.0292    99.058  900.71
  20   0.0449     98.640  0.0285    99.090  947.76
  21   0.0358     98.850  0.0274    99.092  994.78
  22   0.0462     98.550  0.0266    99.127  1041.82
  23   0.0362     98.790  0.0248    99.178  1088.86
  24   0.0458     98.610  0.0239    99.255  1135.86
  25   0.0443     98.750  0.0238    99.210  1182.89
  26   0.0366     98.840  0.0232    99.232  1229.91
  27   0.0385     98.770  0.0229    99.248  1276.95
  28   0.0342     98.910  0.0208    99.302  1323.94
  29   0.0364     98.830  0.0210    99.257  1371.10
  30   0.0396     98.730  0.0223    99.263  1418.08
  31   0.0411     98.690  0.0203    99.357  1465.08
  32   0.0405     98.810  0.0191    99.355  1512.14
  33   0.0326     98.960  0.0192    99.340  1559.12
  34   0.0427     98.690  0.0197    99.337  1606.36
  35   0.0405     98.630  0.0185    99.377  1653.38
  36   0.0345     98.800  0.0169    99.467  1700.39
  37   0.0327     98.880  0.0173    99.395  1747.41
  38   0.0408     98.850  0.0171    99.457  1794.53
  39   0.0373     98.900  0.0166    99.460  1841.50
  40   0.0345     98.910  0.0157    99.485  1888.52
  41   0.0364     98.840  0.0161    99.483  1935.50
  42   0.0319     98.960  0.0157    99.450  1982.53
  43   0.0368     98.830  0.0153    99.503  2029.61
  44   0.0339     98.990  0.0151    99.487  2076.59
  45   0.0419     98.610  0.0145    99.510  2123.66
  46   0.0280     99.060  0.0134    99.530  2170.70
  47   0.0425     98.760  0.0133    99.577  2217.67
  48   0.0356     98.830  0.0141    99.522  2264.68
  49   0.0391     98.800  0.0142    99.498  2311.67
  50   0.0467     98.640  0.0138    99.520  2358.69
  51   0.0429     98.750  0.0123    99.590  2405.68
  52   0.0541     98.540  0.0123    99.555  2452.69
  53   0.0435     98.860  0.0127    99.583  2499.73
  54   0.0461     98.680  0.0121    99.587  2546.74
  55   0.0365     98.940  0.0118    99.605  2593.79
  56   0.0386     98.910  0.0122    99.568  2640.81
  57   0.0481     98.510  0.0132    99.560  2687.88
  58   0.0465     98.710  0.0127    99.582  2734.90
  59   0.0358     98.890  0.0115    99.637  2781.90
  60   0.0304     99.060  0.0104    99.640  2828.88
  61   0.0350     98.960  0.0100    99.658  2875.87
  62   0.0416     98.860  0.0097    99.652  2922.97
  63   0.0482     98.760  0.0109    99.608  2969.99
  64   0.0440     98.820  0.0097    99.648  3017.01
  65   0.0529     98.460  0.0101    99.662  3064.17
  66   0.0436     98.700  0.0112    99.623  3111.19
  67   0.0511     98.640  0.0082    99.712  3158.19
  68   0.0324     99.000  0.0111    99.640  3205.16
  69   0.0393     98.890  0.0097    99.678  3252.19
  70   0.0366     98.910  0.0082    99.722  3299.20
  71   0.0385     98.970  0.0080    99.708  3346.21
  72   0.0348     99.050  0.0087    99.712  3393.25
  73   0.0427     98.670  0.0087    99.715  3440.30
  74   0.0356     99.000  0.0086    99.695  3487.36
  75   0.0317     99.040  0.0078    99.748  3534.38
  76   0.0412     98.920  0.0083    99.688  3581.44
  77   0.0528     98.590  0.0080    99.720  3628.46
  78   0.0380     98.990  0.0073    99.753  3675.59
  79   0.0410     98.960  0.0078    99.735  3722.62
  80   0.0450     98.740  0.0086    99.715  3769.64
  81   0.0424     98.800  0.0078    99.725  3817.06
  82   0.0320     98.990  0.0087    99.695  3864.15
  83   0.0361     98.900  0.0074    99.745  3911.19
  84   0.0325     99.030  0.0076    99.743  3958.21
  85   0.0329     99.060  0.0073    99.753  4005.23
