Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3025     89.010  1.1408    59.503  51.57
   2   0.1460     95.230  0.2085    93.462  98.67
   3   0.1195     96.310  0.1300    95.905  145.78
   4   0.1040     96.770  0.1003    96.795  192.82
   5   0.0902     97.130  0.0797    97.460  239.90
   6   0.0669     97.890  0.0710    97.743  287.16
   7   0.0728     97.810  0.0628    97.963  334.32
   8   0.0657     97.790  0.0571    98.190  381.40
   9   0.0476     98.500  0.0527    98.372  428.42
  10   0.0573     98.160  0.0495    98.435  475.51
  11   0.0534     98.210  0.0458    98.490  522.59
  12   0.0724     97.730  0.0426    98.633  569.64
  13   0.0524     98.330  0.0432    98.653  616.73
  14   0.0547     98.270  0.0391    98.775  664.01
  15   0.0493     98.440  0.0356    98.873  711.07
  16   0.0393     98.690  0.0353    98.893  758.18
  17   0.0480     98.450  0.0356    98.860  805.30
  18   0.0493     98.340  0.0328    98.970  852.43
  19   0.0407     98.730  0.0324    98.970  899.53
  20   0.0418     98.600  0.0308    98.985  946.61
  21   0.0482     98.530  0.0287    99.082  993.69
  22   0.0400     98.690  0.0298    99.020  1040.77
  23   0.0457     98.470  0.0273    99.112  1087.84
  24   0.0435     98.600  0.0266    99.152  1134.95
  25   0.0400     98.650  0.0254    99.125  1182.10
  26   0.0546     98.250  0.0251    99.217  1229.23
  27   0.0377     98.710  0.0237    99.237  1276.28
  28   0.0353     98.800  0.0230    99.257  1323.35
  29   0.0365     98.860  0.0222    99.253  1370.46
  30   0.0432     98.590  0.0219    99.308  1417.55
  31   0.0328     98.940  0.0212    99.273  1464.66
  32   0.0357     98.850  0.0215    99.327  1511.75
  33   0.0392     98.600  0.0182    99.448  1558.87
  34   0.0568     98.290  0.0200    99.287  1605.94
  35   0.0344     98.920  0.0184    99.412  1652.98
  36   0.0413     98.760  0.0189    99.400  1700.06
  37   0.0318     98.980  0.0172    99.453  1747.18
  38   0.0397     98.690  0.0175    99.412  1794.24
  39   0.0353     98.880  0.0164    99.442  1841.34
  40   0.0365     98.800  0.0154    99.475  1888.43
  41   0.0322     98.930  0.0154    99.475  1935.54
  42   0.0339     98.800  0.0151    99.517  1982.65
  43   0.0383     98.810  0.0145    99.548  2029.72
  44   0.0397     98.730  0.0141    99.538  2076.82
  45   0.0414     98.640  0.0148    99.488  2123.88
  46   0.0299     99.030  0.0135    99.567  2170.90
  47   0.0349     98.810  0.0141    99.513  2218.23
  48   0.0363     98.800  0.0123    99.602  2265.35
  49   0.0339     98.920  0.0131    99.585  2312.50
  50   0.0339     98.780  0.0124    99.617  2359.65
  51   0.0321     98.960  0.0111    99.638  2406.80
  52   0.0324     98.950  0.0109    99.647  2453.85
  53   0.0401     98.770  0.0110    99.633  2500.92
  54   0.0322     98.970  0.0108    99.648  2548.03
  55   0.0349     98.950  0.0108    99.633  2595.15
  56   0.0328     98.940  0.0098    99.675  2642.23
  57   0.0326     98.930  0.0107    99.660  2689.32
  58   0.0400     98.710  0.0106    99.620  2736.44
  59   0.0364     98.900  0.0102    99.655  2783.56
  60   0.0375     98.790  0.0102    99.653  2830.64
  61   0.0360     98.940  0.0097    99.660  2877.71
  62   0.0412     98.710  0.0089    99.718  2924.79
  63   0.0388     98.810  0.0088    99.722  2971.90
  64   0.0358     98.910  0.0086    99.715  3019.03
  65   0.0327     99.010  0.0088    99.735  3066.09
  66   0.0316     99.020  0.0076    99.768  3113.19
  67   0.0331     99.040  0.0077    99.765  3160.35
  68   0.0346     98.980  0.0069    99.780  3207.54
  69   0.0347     98.890  0.0085    99.740  3254.61
  70   0.0309     99.040  0.0073    99.765  3301.74
  71   0.0344     98.930  0.0068    99.778  3348.88
  72   0.0336     98.990  0.0077    99.747  3395.98
  73   0.0364     98.830  0.0072    99.772  3443.09
  74   0.0389     98.750  0.0059    99.827  3490.22
  75   0.0406     98.760  0.0063    99.800  3537.35
  76   0.0401     98.790  0.0068    99.773  3584.49
  77   0.0364     98.950  0.0074    99.763  3631.58
  78   0.0361     98.890  0.0066    99.783  3678.61
  79   0.0382     98.900  0.0062    99.817  3725.66
  80   0.0309     98.990  0.0057    99.827  3772.83
  81   0.0362     98.800  0.0060    99.805  3819.91
  82   0.0467     98.530  0.0059    99.810  3867.06
  83   0.0314     99.080  0.0065    99.790  3914.13
  84   0.0388     98.800  0.0064    99.808  3961.24
  85   0.0311     99.020  0.0062    99.788  4008.36
  86   0.0359     98.860  0.0056    99.838  4055.42
