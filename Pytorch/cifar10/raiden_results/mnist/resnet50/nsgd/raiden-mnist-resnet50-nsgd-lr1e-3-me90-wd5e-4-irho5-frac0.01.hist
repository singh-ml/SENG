Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4542     84.570  1.1925    57.583  51.65
   2   0.1544     94.880  0.2461    92.253  98.79
   3   0.1025     96.500  0.1384    95.512  145.81
   4   0.0913     96.990  0.1055    96.715  192.82
   5   0.0828     97.260  0.0837    97.422  240.12
   6   0.0633     97.970  0.0719    97.730  287.17
   7   0.0662     97.850  0.0645    97.955  334.23
   8   0.0561     98.170  0.0598    98.095  381.28
   9   0.0807     97.640  0.0539    98.295  428.33
  10   0.0499     98.460  0.0489    98.453  475.33
  11   0.0442     98.620  0.0480    98.517  522.34
  12   0.0522     98.290  0.0431    98.642  569.38
  13   0.0479     98.570  0.0416    98.692  616.43
  14   0.0434     98.600  0.0393    98.763  663.47
  15   0.0420     98.590  0.0372    98.792  710.50
  16   0.0518     98.270  0.0362    98.858  757.62
  17   0.0518     98.310  0.0354    98.873  804.66
  18   0.0414     98.610  0.0339    98.875  851.71
  19   0.0443     98.460  0.0318    98.988  898.76
  20   0.0433     98.560  0.0317    98.982  945.82
  21   0.0363     98.800  0.0292    99.088  992.87
  22   0.0441     98.650  0.0290    99.065  1039.90
  23   0.0393     98.740  0.0289    99.045  1086.90
  24   0.0398     98.740  0.0272    99.110  1133.92
  25   0.0401     98.650  0.0263    99.110  1181.01
  26   0.0336     98.840  0.0261    99.138  1228.02
  27   0.0422     98.730  0.0260    99.178  1275.01
  28   0.0392     98.770  0.0229    99.237  1322.04
  29   0.0544     98.290  0.0235    99.227  1369.09
  30   0.0372     98.850  0.0244    99.183  1416.14
  31   0.0318     98.970  0.0213    99.297  1463.23
  32   0.0519     98.450  0.0229    99.262  1510.29
  33   0.0381     98.660  0.0212    99.290  1557.32
  34   0.0397     98.780  0.0190    99.383  1604.43
  35   0.0367     98.840  0.0203    99.325  1651.47
  36   0.0432     98.670  0.0192    99.378  1698.44
  37   0.0508     98.520  0.0191    99.383  1745.48
  38   0.0385     98.710  0.0188    99.403  1792.52
  39   0.0559     98.440  0.0176    99.427  1839.53
  40   0.0466     98.600  0.0180    99.373  1886.71
  41   0.0480     98.530  0.0183    99.390  1933.77
  42   0.0595     98.200  0.0169    99.442  1980.83
  43   0.0467     98.550  0.0162    99.477  2027.98
  44   0.0388     98.860  0.0169    99.403  2075.03
  45   0.0429     98.690  0.0154    99.493  2122.00
  46   0.0485     98.540  0.0151    99.510  2169.04
  47   0.0371     98.910  0.0154    99.465  2216.04
  48   0.0412     98.740  0.0143    99.525  2263.04
  49   0.0439     98.690  0.0145    99.522  2310.02
  50   0.0421     98.780  0.0148    99.515  2357.24
  51   0.0398     98.810  0.0149    99.508  2404.35
  52   0.0454     98.690  0.0138    99.540  2451.40
  53   0.0401     98.840  0.0140    99.555  2498.46
  54   0.0417     98.770  0.0131    99.555  2545.46
  55   0.0395     98.800  0.0130    99.543  2592.45
  56   0.0384     98.780  0.0131    99.545  2639.50
  57   0.0528     98.490  0.0132    99.538  2686.48
  58   0.0469     98.600  0.0115    99.602  2733.73
  59   0.0361     98.750  0.0127    99.573  2780.77
  60   0.0367     98.960  0.0118    99.620  2827.85
  61   0.0554     98.420  0.0124    99.577  2874.91
  62   0.0391     98.900  0.0125    99.585  2921.90
  63   0.0427     98.820  0.0114    99.597  2968.94
  64   0.0484     98.710  0.0107    99.647  3015.93
  65   0.0369     99.020  0.0113    99.598  3063.02
  66   0.0443     98.810  0.0122    99.577  3109.98
  67   0.0565     98.490  0.0092    99.693  3157.13
  68   0.0416     98.740  0.0097    99.668  3204.13
  69   0.0453     98.760  0.0100    99.653  3251.16
  70   0.0451     98.760  0.0095    99.685  3298.20
  71   0.0390     98.840  0.0099    99.643  3345.31
  72   0.0412     98.910  0.0095    99.675  3392.31
  73   0.0302     99.140  0.0097    99.683  3439.28
  74   0.0409     98.880  0.0101    99.663  3486.31
  75   0.0464     98.650  0.0090    99.715  3533.53
  76   0.0490     98.740  0.0098    99.665  3580.54
  77   0.0466     98.860  0.0090    99.720  3627.61
  78   0.0371     98.950  0.0093    99.687  3674.68
  79   0.0424     98.810  0.0088    99.683  3721.70
  80   0.0433     98.850  0.0088    99.690  3768.75
  81   0.0432     98.880  0.0087    99.703  3815.73
  82   0.0479     98.790  0.0089    99.700  3862.77
  83   0.0431     98.960  0.0090    99.702  3909.85
  84   0.0442     98.800  0.0095    99.673  3956.90
  85   0.0566     98.720  0.0097    99.688  4003.95
  86   0.0478     98.700  0.0078    99.740  4051.03
  87   0.0392     98.840  0.0079    99.727  4098.08
  88   0.0462     98.780  0.0078    99.732  4145.10
  89   0.0456     98.830  0.0068    99.782  4192.11
  90   0.0454     98.840  0.0071    99.755  4239.08
