Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3181     89.060  1.1432    58.950  51.72
   2   0.1458     95.310  0.2270    92.857  99.21
   3   0.1096     96.460  0.1318    95.905  146.48
   4   0.0986     96.750  0.1017    96.813  193.78
   5   0.0675     97.770  0.0818    97.428  241.02
   6   0.0881     97.220  0.0723    97.703  288.28
   7   0.0687     97.860  0.0645    97.980  335.63
   8   0.0527     98.320  0.0572    98.212  382.96
   9   0.0549     98.290  0.0563    98.197  430.25
  10   0.0529     98.260  0.0500    98.460  477.55
  11   0.0466     98.460  0.0492    98.413  524.86
  12   0.0519     98.240  0.0440    98.597  572.17
  13   0.0557     98.120  0.0423    98.693  619.49
  14   0.0495     98.390  0.0405    98.658  666.73
  15   0.0498     98.440  0.0378    98.772  713.99
  16   0.0444     98.470  0.0360    98.845  761.23
  17   0.0409     98.600  0.0355    98.858  808.47
  18   0.0464     98.500  0.0330    98.980  855.77
  19   0.0426     98.660  0.0322    98.965  903.07
  20   0.0443     98.580  0.0317    98.985  950.34
  21   0.0491     98.260  0.0301    99.013  997.62
  22   0.0421     98.590  0.0280    99.052  1044.86
  23   0.0378     98.770  0.0274    99.127  1092.08
  24   0.0438     98.730  0.0261    99.155  1139.31
  25   0.0397     98.870  0.0258    99.195  1186.54
  26   0.0370     98.800  0.0252    99.170  1233.81
  27   0.0339     98.870  0.0248    99.168  1281.06
  28   0.0364     98.790  0.0250    99.182  1328.35
  29   0.0465     98.450  0.0234    99.210  1375.64
  30   0.0398     98.770  0.0226    99.278  1422.86
  31   0.0421     98.780  0.0226    99.290  1470.11
  32   0.0372     98.790  0.0219    99.278  1517.36
  33   0.0367     98.850  0.0190    99.347  1564.64
  34   0.0407     98.750  0.0204    99.322  1611.97
  35   0.0371     98.880  0.0211    99.273  1659.27
  36   0.0436     98.770  0.0200    99.315  1706.61
  37   0.0454     98.700  0.0193    99.410  1753.83
  38   0.0372     98.800  0.0193    99.330  1801.05
  39   0.0330     98.970  0.0171    99.413  1848.32
  40   0.0424     98.780  0.0183    99.408  1895.82
  41   0.0425     98.740  0.0181    99.395  1943.10
  42   0.0386     98.850  0.0185    99.358  1990.44
  43   0.0444     98.660  0.0163    99.458  2037.67
  44   0.0388     98.850  0.0157    99.482  2084.93
  45   0.0400     98.870  0.0161    99.480  2132.25
  46   0.0329     98.970  0.0154    99.480  2179.57
  47   0.0376     98.960  0.0144    99.503  2226.87
  48   0.0353     98.920  0.0152    99.493  2274.22
  49   0.0517     98.510  0.0148    99.518  2321.49
  50   0.0423     98.760  0.0144    99.528  2368.79
  51   0.0488     98.490  0.0138    99.512  2416.10
  52   0.0422     98.800  0.0143    99.530  2463.34
  53   0.0390     98.870  0.0139    99.512  2510.59
  54   0.0339     98.960  0.0129    99.578  2558.09
  55   0.0370     98.870  0.0131    99.568  2605.43
  56   0.0396     98.770  0.0134    99.543  2652.71
  57   0.0426     98.660  0.0123    99.588  2700.00
  58   0.0378     98.830  0.0119    99.615  2747.30
  59   0.0358     99.070  0.0114    99.622  2794.60
  60   0.0421     98.890  0.0115    99.590  2841.87
  61   0.0337     99.050  0.0118    99.613  2889.15
  62   0.0346     99.060  0.0116    99.588  2936.44
  63   0.0385     98.780  0.0115    99.610  2983.74
  64   0.0389     98.930  0.0118    99.610  3031.03
  65   0.0535     98.550  0.0101    99.640  3078.34
  66   0.0422     98.890  0.0102    99.620  3125.67
  67   0.0392     98.830  0.0109    99.595  3172.93
  68   0.0383     98.820  0.0100    99.667  3220.22
  69   0.0364     98.920  0.0101    99.647  3267.45
  70   0.0574     98.450  0.0107    99.627  3314.71
  71   0.0409     98.860  0.0111    99.640  3361.96
  72   0.0423     98.800  0.0093    99.663  3409.23
  73   0.0447     98.770  0.0095    99.670  3456.77
  74   0.0378     98.920  0.0094    99.660  3504.07
  75   0.0365     98.930  0.0082    99.715  3551.34
  76   0.0520     98.780  0.0087    99.683  3598.64
  77   0.0336     99.060  0.0092    99.690  3645.97
  78   0.0431     98.790  0.0085    99.730  3693.25
  79   0.0335     99.110  0.0083    99.725  3740.48
  80   0.0380     98.960  0.0075    99.740  3787.86
  81   0.0387     99.010  0.0075    99.750  3835.51
  82   0.0418     98.930  0.0086    99.705  3882.77
  83   0.0441     98.910  0.0084    99.715  3930.07
  84   0.0392     99.080  0.0078    99.730  3977.41
  85   0.0483     98.840  0.0078    99.743  4024.69
  86   0.0487     98.850  0.0075    99.757  4072.01
  87   0.0392     98.930  0.0085    99.693  4119.25
  88   0.0377     98.980  0.0074    99.733  4166.50
  89   0.0386     99.050  0.0070    99.742  4213.80
  90   0.0387     99.000  0.0071    99.773  4261.13
