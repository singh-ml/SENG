Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.9989     26.950  3.5765    16.730  51.47
   2   0.6441     76.060  1.3867    49.058  98.23
   3   0.2374     92.710  0.3613    88.517  144.92
   4   0.1598     94.960  0.1782    94.672  191.91
   5   0.1354     96.120  0.1302    96.158  238.59
   6   0.1019     96.650  0.1055    96.762  285.64
   7   0.0903     97.200  0.0904    97.232  332.67
   8   0.0721     97.630  0.0800    97.498  379.68
   9   0.0485     98.390  0.0706    97.782  426.71
  10   0.0655     97.740  0.0659    97.942  473.67
  11   0.0656     97.840  0.0616    98.078  520.67
  12   0.0482     98.270  0.0589    98.130  567.67
  13   0.0460     98.390  0.0541    98.338  614.67
  14   0.0547     98.160  0.0532    98.358  661.62
  15   0.0591     98.020  0.0501    98.390  708.61
  16   0.0472     98.440  0.0465    98.513  755.58
  17   0.0417     98.580  0.0447    98.578  802.29
  18   0.0496     98.350  0.0439    98.627  849.29
  19   0.0435     98.580  0.0426    98.653  896.27
  20   0.0469     98.360  0.0417    98.648  943.29
  21   0.0448     98.460  0.0385    98.787  989.94
  22   0.0532     98.080  0.0376    98.795  1036.94
  23   0.0410     98.730  0.0366    98.817  1083.92
  24   0.0476     98.450  0.0379    98.790  1130.90
  25   0.0423     98.680  0.0327    98.910  1177.95
  26   0.0537     98.190  0.0338    98.873  1225.01
  27   0.0382     98.680  0.0328    98.938  1272.01
  28   0.0490     98.340  0.0329    98.942  1318.94
  29   0.0386     98.570  0.0321    98.963  1365.94
  30   0.0456     98.440  0.0292    99.067  1412.91
  31   0.0446     98.590  0.0295    99.047  1459.85
  32   0.0408     98.600  0.0293    99.052  1506.99
  33   0.0393     98.640  0.0275    99.100  1554.03
  34   0.0374     98.860  0.0262    99.172  1601.04
  35   0.0400     98.680  0.0267    99.153  1648.06
  36   0.0358     98.720  0.0270    99.122  1695.10
  37   0.0547     98.060  0.0271    99.115  1742.12
  38   0.0329     98.900  0.0259    99.157  1789.10
  39   0.0345     98.880  0.0247    99.198  1836.09
  40   0.0322     98.880  0.0233    99.223  1883.17
  41   0.0258     99.070  0.0227    99.250  1930.18
  42   0.0305     99.040  0.0225    99.282  1977.18
  43   0.0245     99.140  0.0223    99.293  2024.23
  44   0.0345     98.850  0.0214    99.257  2071.24
  45   0.0307     98.970  0.0210    99.317  2118.20
  46   0.0368     98.770  0.0192    99.362  2165.20
  47   0.0385     98.660  0.0190    99.382  2212.19
  48   0.0291     99.090  0.0196    99.358  2259.18
  49   0.0333     98.910  0.0183    99.373  2306.22
  50   0.0394     98.750  0.0175    99.412  2353.25
  51   0.0320     98.960  0.0182    99.412  2400.26
  52   0.0283     99.050  0.0161    99.473  2447.31
  53   0.0270     99.170  0.0162    99.477  2494.37
  54   0.0369     98.780  0.0157    99.493  2541.35
  55   0.0367     98.690  0.0160    99.457  2588.31
  56   0.0271     99.030  0.0154    99.480  2635.32
  57   0.0284     99.070  0.0140    99.540  2682.31
  58   0.0341     98.880  0.0138    99.555  2729.34
  59   0.0363     98.880  0.0143    99.517  2776.38
  60   0.0281     99.000  0.0125    99.583  2823.41
  61   0.0304     99.000  0.0121    99.602  2870.46
  62   0.0249     99.180  0.0126    99.603  2917.49
  63   0.0319     99.010  0.0114    99.628  2964.60
  64   0.0434     98.700  0.0119    99.615  3011.62
  65   0.0308     99.050  0.0116    99.630  3058.63
  66   0.0236     99.240  0.0103    99.648  3105.64
  67   0.0305     98.990  0.0103    99.665  3152.61
  68   0.0329     98.920  0.0107    99.645  3199.66
  69   0.0350     98.920  0.0098    99.702  3246.69
  70   0.0348     98.810  0.0101    99.667  3293.72
  71   0.0280     99.050  0.0094    99.705  3340.76
  72   0.0418     98.770  0.0099    99.698  3387.76
  73   0.0358     98.930  0.0087    99.720  3434.78
  74   0.0329     98.930  0.0093    99.702  3481.77
  75   0.0307     99.080  0.0080    99.753  3528.60
  76   0.0346     98.860  0.0082    99.727  3575.60
  77   0.0355     98.930  0.0077    99.738  3622.64
  78   0.0379     98.950  0.0079    99.745  3669.66
  79   0.0364     98.940  0.0080    99.732  3716.70
  80   0.0351     98.950  0.0073    99.775  3763.73
  81   0.0320     98.920  0.0073    99.777  3810.97
  82   0.0269     99.140  0.0071    99.767  3858.03
  83   0.0296     99.050  0.0066    99.798  3905.04
  84   0.0288     99.090  0.0068    99.807  3952.10
  85   0.0337     98.880  0.0066    99.792  3999.14
  86   0.0381     98.940  0.0060    99.802  4046.18
  87   0.0363     98.820  0.0065    99.797  4093.25
  88   0.0285     99.080  0.0059    99.805  4140.25
  89   0.0323     98.990  0.0055    99.823  4187.31
  90   0.0340     99.020  0.0055    99.840  4234.52
