Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.3903     44.080  3.0315    27.350  51.59
   2   0.2909     90.320  0.6749    77.183  98.66
   3   0.1355     95.570  0.2319    92.853  145.76
   4   0.1130     96.240  0.1381    95.807  192.87
   5   0.1037     96.740  0.1047    96.862  239.93
   6   0.0603     98.010  0.0852    97.428  286.99
   7   0.0827     97.270  0.0747    97.685  334.06
   8   0.0719     97.530  0.0649    97.955  381.19
   9   0.0601     98.050  0.0605    98.088  428.31
  10   0.0346     98.750  0.0553    98.263  475.38
  11   0.0409     98.620  0.0503    98.448  522.47
  12   0.0519     98.340  0.0477    98.518  569.59
  13   0.0638     97.720  0.0437    98.668  616.66
  14   0.0339     98.860  0.0413    98.718  663.71
  15   0.0427     98.670  0.0418    98.662  710.76
  16   0.0444     98.440  0.0362    98.858  757.83
  17   0.0430     98.620  0.0365    98.848  805.08
  18   0.0346     98.850  0.0357    98.860  852.17
  19   0.0349     98.870  0.0330    98.967  899.26
  20   0.0408     98.510  0.0324    98.990  946.31
  21   0.0436     98.500  0.0291    99.082  993.39
  22   0.0577     97.980  0.0308    99.040  1040.48
  23   0.0380     98.580  0.0287    99.073  1087.58
  24   0.0432     98.550  0.0288    99.090  1134.64
  25   0.0399     98.720  0.0271    99.128  1181.67
  26   0.0357     98.810  0.0264    99.157  1228.71
  27   0.0304     98.990  0.0254    99.168  1275.80
  28   0.0374     98.870  0.0246    99.200  1322.90
  29   0.0265     99.020  0.0237    99.225  1369.95
  30   0.0381     98.690  0.0244    99.210  1417.05
  31   0.0368     98.770  0.0214    99.315  1464.13
  32   0.0425     98.640  0.0216    99.318  1511.21
  33   0.0408     98.780  0.0216    99.305  1558.24
  34   0.0302     99.010  0.0189    99.408  1605.49
  35   0.0378     98.760  0.0198    99.365  1652.54
  36   0.0445     98.550  0.0192    99.400  1699.61
  37   0.0413     98.800  0.0196    99.347  1746.72
  38   0.0413     98.710  0.0176    99.417  1793.84
  39   0.0452     98.630  0.0167    99.493  1840.89
  40   0.0360     98.890  0.0172    99.432  1888.00
  41   0.0377     98.860  0.0162    99.487  1935.05
  42   0.0411     98.800  0.0170    99.397  1982.10
  43   0.0459     98.490  0.0154    99.498  2029.20
  44   0.0321     99.050  0.0150    99.535  2076.24
  45   0.0347     98.900  0.0152    99.518  2123.31
  46   0.0358     98.850  0.0147    99.497  2170.38
  47   0.0302     98.960  0.0150    99.513  2217.49
  48   0.0411     98.700  0.0131    99.558  2264.57
  49   0.0282     98.970  0.0126    99.573  2311.63
  50   0.0467     98.720  0.0119    99.585  2358.70
  51   0.0313     98.930  0.0116    99.607  2405.74
  52   0.0281     99.090  0.0130    99.540  2452.86
  53   0.0376     98.810  0.0102    99.678  2499.92
  54   0.0319     99.030  0.0106    99.655  2547.03
  55   0.0306     99.050  0.0105    99.628  2594.11
  56   0.0278     99.140  0.0111    99.622  2641.12
  57   0.0303     98.990  0.0097    99.695  2688.20
  58   0.0235     99.260  0.0089    99.715  2735.26
  59   0.0358     98.990  0.0082    99.725  2782.35
  60   0.0382     98.940  0.0082    99.745  2829.41
  61   0.0298     99.090  0.0083    99.695  2876.50
  62   0.0369     98.920  0.0077    99.743  2923.60
  63   0.0305     99.040  0.0074    99.715  2970.68
  64   0.0340     99.050  0.0077    99.722  3017.76
  65   0.0479     98.830  0.0068    99.758  3064.83
  66   0.0356     98.940  0.0064    99.768  3111.86
  67   0.0346     98.930  0.0055    99.825  3158.89
  68   0.0373     98.960  0.0052    99.835  3205.95
  69   0.0369     98.950  0.0054    99.822  3253.24
  70   0.0377     98.890  0.0060    99.788  3300.31
  71   0.0297     99.090  0.0055    99.802  3347.41
  72   0.0365     99.080  0.0055    99.800  3394.65
  73   0.0306     99.090  0.0052    99.817  3441.73
  74   0.0361     98.930  0.0044    99.858  3488.79
  75   0.0361     99.030  0.0045    99.835  3535.86
  76   0.0408     98.870  0.0044    99.870  3582.95
  77   0.0415     99.040  0.0041    99.863  3630.04
  78   0.0372     99.090  0.0039    99.870  3677.11
  79   0.0375     98.920  0.0036    99.893  3724.22
  80   0.0363     99.030  0.0037    99.880  3771.31
  81   0.0347     99.080  0.0033    99.892  3818.40
  82   0.0338     98.980  0.0031    99.908  3865.40
  83   0.0393     98.950  0.0032    99.898  3912.48
  84   0.0438     98.960  0.0033    99.898  3959.53
  85   0.0373     98.920  0.0029    99.913  4006.64
  86   0.0363     98.970  0.0027    99.922  4053.70
  87   0.0471     98.810  0.0026    99.915  4100.79
  88   0.0318     99.200  0.0025    99.920  4147.89
  89   0.0377     99.080  0.0027    99.923  4194.95
  90   0.0429     98.970  0.0023    99.942  4242.01
