Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.0408     65.790  1.6579    39.825  51.87
   2   0.4024     86.800  0.6508    78.300  99.21
   3   0.2589     91.910  0.3222    89.907  146.69
   4   0.2066     92.920  0.2174    93.198  194.02
   5   0.1381     95.570  0.1669    94.757  241.26
   6   0.1272     95.690  0.1403    95.605  288.56
   7   0.1217     95.950  0.1202    96.272  335.86
   8   0.1050     96.550  0.1050    96.685  383.18
   9   0.1007     96.760  0.0964    96.992  430.53
  10   0.0888     97.220  0.0854    97.302  477.88
  11   0.0724     97.740  0.0796    97.485  525.21
  12   0.0727     97.580  0.0719    97.723  572.51
  13   0.0807     97.470  0.0688    97.893  619.74
  14   0.0669     97.790  0.0623    98.052  666.99
  15   0.0671     97.790  0.0615    98.068  714.24
  16   0.0579     98.060  0.0585    98.137  761.53
  17   0.0612     98.060  0.0551    98.287  808.84
  18   0.0568     98.070  0.0519    98.365  856.17
  19   0.0650     98.070  0.0496    98.392  903.52
  20   0.0544     98.170  0.0482    98.448  950.83
  21   0.0600     98.020  0.0464    98.560  998.10
  22   0.0485     98.350  0.0458    98.532  1045.40
  23   0.0548     98.260  0.0421    98.678  1092.69
  24   0.0451     98.550  0.0414    98.693  1139.96
  25   0.0498     98.330  0.0402    98.705  1187.29
  26   0.0553     98.100  0.0391    98.755  1234.58
  27   0.0406     98.600  0.0381    98.767  1281.88
  28   0.0512     98.360  0.0377    98.825  1329.17
  29   0.0419     98.600  0.0356    98.878  1376.46
  30   0.0430     98.610  0.0353    98.823  1423.68
  31   0.0466     98.480  0.0339    98.940  1470.91
  32   0.0516     98.410  0.0329    98.942  1518.19
  33   0.0413     98.630  0.0321    98.978  1565.47
  34   0.0412     98.700  0.0307    99.008  1612.75
  35   0.0527     98.320  0.0317    99.002  1660.05
  36   0.0510     98.480  0.0310    98.997  1707.38
  37   0.0441     98.640  0.0296    99.025  1754.67
  38   0.0546     98.320  0.0279    99.083  1801.95
  39   0.0453     98.500  0.0271    99.097  1849.25
  40   0.0430     98.570  0.0277    99.082  1896.52
  41   0.0405     98.590  0.0269    99.140  1943.83
  42   0.0415     98.630  0.0265    99.127  1991.16
  43   0.0418     98.680  0.0261    99.182  2038.49
  44   0.0556     98.340  0.0259    99.162  2085.76
  45   0.0467     98.710  0.0251    99.172  2133.06
  46   0.0511     98.580  0.0245    99.238  2180.34
  47   0.0421     98.650  0.0246    99.180  2227.62
  48   0.0408     98.580  0.0234    99.213  2274.91
  49   0.0416     98.760  0.0238    99.238  2322.38
  50   0.0445     98.630  0.0226    99.238  2369.68
  51   0.0474     98.490  0.0219    99.253  2416.93
  52   0.0469     98.690  0.0210    99.320  2464.24
  53   0.0443     98.570  0.0209    99.347  2511.57
  54   0.0401     98.760  0.0209    99.300  2558.89
  55   0.0391     98.810  0.0201    99.347  2606.15
  56   0.0371     98.800  0.0204    99.308  2653.38
  57   0.0401     98.690  0.0195    99.347  2700.68
  58   0.0371     98.770  0.0194    99.368  2748.00
  59   0.0430     98.620  0.0190    99.403  2795.31
  60   0.0466     98.610  0.0187    99.395  2842.57
  61   0.0481     98.590  0.0187    99.360  2889.84
  62   0.0382     98.820  0.0186    99.372  2937.11
  63   0.0455     98.590  0.0183    99.375  2984.49
  64   0.0387     98.870  0.0182    99.383  3031.78
  65   0.0393     98.770  0.0181    99.405  3079.08
  66   0.0389     98.900  0.0174    99.403  3126.40
  67   0.0361     98.960  0.0170    99.440  3173.67
  68   0.0406     98.790  0.0166    99.438  3220.98
  69   0.0476     98.570  0.0167    99.448  3268.26
  70   0.0428     98.630  0.0158    99.472  3315.55
  71   0.0455     98.580  0.0158    99.448  3362.88
  72   0.0352     98.950  0.0153    99.507  3410.17
  73   0.0444     98.630  0.0154    99.493  3457.50
  74   0.0424     98.770  0.0145    99.525  3504.81
  75   0.0463     98.600  0.0147    99.515  3552.03
  76   0.0434     98.690  0.0143    99.492  3599.33
  77   0.0420     98.700  0.0140    99.520  3646.60
  78   0.0423     98.700  0.0136    99.538  3693.92
  79   0.0489     98.650  0.0137    99.522  3741.16
  80   0.0417     98.810  0.0141    99.555  3788.77
  81   0.0387     98.790  0.0132    99.558  3836.10
  82   0.0376     98.940  0.0138    99.560  3883.43
  83   0.0362     98.870  0.0124    99.582  3930.74
  84   0.0411     98.710  0.0131    99.548  3978.05
  85   0.0402     98.890  0.0123    99.612  4025.42
