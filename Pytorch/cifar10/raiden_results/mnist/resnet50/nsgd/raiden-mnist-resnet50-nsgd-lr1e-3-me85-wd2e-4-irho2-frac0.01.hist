Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.8491     71.770  1.6030    43.422  51.57
   2   0.3394     88.870  0.5452    82.270  98.63
   3   0.2250     93.250  0.2730    91.583  145.89
   4   0.1911     94.050  0.1976    93.855  192.98
   5   0.1343     95.640  0.1506    95.275  240.09
   6   0.1155     96.300  0.1285    95.955  287.14
   7   0.1081     96.700  0.1109    96.533  334.17
   8   0.0918     96.960  0.0979    96.918  381.21
   9   0.0970     96.960  0.0878    97.287  428.29
  10   0.0889     97.160  0.0801    97.515  475.40
  11   0.0714     97.590  0.0751    97.597  522.42
  12   0.0811     97.350  0.0686    97.828  569.48
  13   0.0673     97.720  0.0653    97.967  616.58
  14   0.0614     98.110  0.0601    98.155  663.65
  15   0.0623     97.860  0.0585    98.148  710.68
  16   0.0631     98.040  0.0562    98.220  757.75
  17   0.0624     98.110  0.0530    98.345  804.82
  18   0.0714     97.720  0.0523    98.355  851.88
  19   0.0608     98.070  0.0505    98.413  898.93
  20   0.0676     98.070  0.0478    98.450  945.96
  21   0.0507     98.450  0.0459    98.563  993.02
  22   0.0564     98.290  0.0448    98.533  1040.09
  23   0.0517     98.270  0.0422    98.642  1087.17
  24   0.0541     98.170  0.0416    98.668  1134.23
  25   0.0531     98.270  0.0394    98.708  1181.30
  26   0.0535     98.290  0.0391    98.773  1228.37
  27   0.0506     98.330  0.0383    98.750  1275.44
  28   0.0680     97.920  0.0373    98.822  1322.49
  29   0.0557     98.240  0.0353    98.865  1369.48
  30   0.0503     98.300  0.0337    98.922  1416.73
  31   0.0588     98.230  0.0330    98.935  1463.80
  32   0.0457     98.530  0.0333    98.930  1510.87
  33   0.0500     98.390  0.0320    98.973  1557.92
  34   0.0504     98.390  0.0309    99.007  1604.97
  35   0.0561     98.250  0.0308    99.055  1652.07
  36   0.0470     98.610  0.0291    99.048  1699.12
  37   0.0487     98.480  0.0293    99.058  1746.17
  38   0.0461     98.570  0.0276    99.115  1793.21
  39   0.0417     98.640  0.0299    99.028  1840.28
  40   0.0515     98.410  0.0265    99.150  1887.31
  41   0.0495     98.550  0.0270    99.112  1934.36
  42   0.0451     98.540  0.0255    99.157  1981.42
  43   0.0498     98.350  0.0247    99.198  2028.49
  44   0.0523     98.480  0.0246    99.233  2075.54
  45   0.0468     98.430  0.0241    99.210  2122.58
  46   0.0473     98.460  0.0245    99.237  2169.62
  47   0.0504     98.380  0.0239    99.222  2216.66
  48   0.0440     98.730  0.0226    99.272  2263.75
  49   0.0489     98.430  0.0211    99.307  2310.81
  50   0.0443     98.570  0.0212    99.320  2357.90
  51   0.0561     98.410  0.0216    99.287  2404.94
  52   0.0377     98.800  0.0213    99.298  2452.03
  53   0.0487     98.480  0.0215    99.292  2499.08
  54   0.0369     98.850  0.0203    99.317  2546.15
  55   0.0495     98.490  0.0198    99.360  2593.21
  56   0.0392     98.730  0.0198    99.332  2640.26
  57   0.0411     98.710  0.0195    99.345  2687.32
  58   0.0344     98.930  0.0194    99.395  2734.34
  59   0.0417     98.640  0.0192    99.395  2781.39
  60   0.0415     98.670  0.0183    99.377  2828.46
  61   0.0399     98.710  0.0183    99.397  2875.50
  62   0.0478     98.580  0.0175    99.382  2922.55
  63   0.0472     98.640  0.0170    99.452  2969.62
  64   0.0476     98.540  0.0162    99.473  3016.72
  65   0.0382     98.820  0.0167    99.457  3063.78
  66   0.0464     98.510  0.0162    99.473  3110.79
  67   0.0438     98.750  0.0163    99.427  3157.84
  68   0.0399     98.700  0.0163    99.477  3205.16
  69   0.0379     98.810  0.0162    99.473  3252.23
  70   0.0385     98.900  0.0155    99.493  3299.30
  71   0.0406     98.720  0.0152    99.493  3346.36
  72   0.0505     98.570  0.0147    99.517  3393.38
  73   0.0434     98.750  0.0142    99.517  3440.47
  74   0.0424     98.690  0.0143    99.523  3487.53
  75   0.0416     98.790  0.0149    99.493  3534.59
  76   0.0507     98.640  0.0144    99.520  3581.71
  77   0.0394     98.760  0.0137    99.538  3628.79
  78   0.0403     98.750  0.0128    99.575  3675.85
  79   0.0354     98.870  0.0131    99.593  3722.89
  80   0.0385     98.840  0.0134    99.538  3769.95
  81   0.0425     98.690  0.0126    99.595  3817.35
  82   0.0452     98.570  0.0130    99.587  3864.40
  83   0.0350     98.910  0.0127    99.547  3911.42
  84   0.0342     98.940  0.0134    99.553  3958.47
  85   0.0371     98.880  0.0117    99.612  4005.75
