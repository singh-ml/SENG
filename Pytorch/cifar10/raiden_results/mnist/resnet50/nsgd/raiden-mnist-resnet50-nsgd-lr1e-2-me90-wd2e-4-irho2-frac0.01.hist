Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.7240     75.810  2.9378    32.278  51.73
   2   0.1555     95.210  0.3695    87.967  99.17
   3   0.1129     96.610  0.1456    95.562  146.38
   4   0.0857     97.260  0.0984    96.985  193.55
   5   0.0712     97.510  0.0803    97.433  240.83
   6   0.0953     97.000  0.0669    97.938  288.02
   7   0.0561     98.150  0.0628    98.070  335.20
   8   0.0545     98.090  0.0566    98.237  382.35
   9   0.0523     98.220  0.0522    98.375  429.74
  10   0.0620     97.840  0.0492    98.470  476.92
  11   0.0480     98.340  0.0469    98.483  524.09
  12   0.0484     98.300  0.0433    98.603  571.33
  13   0.0562     98.120  0.0389    98.720  618.48
  14   0.0593     98.040  0.0380    98.742  665.64
  15   0.0478     98.550  0.0346    98.878  712.81
  16   0.0394     98.790  0.0349    98.868  760.00
  17   0.0423     98.660  0.0321    98.947  807.22
  18   0.0408     98.630  0.0311    98.995  854.41
  19   0.0382     98.730  0.0295    99.057  901.64
  20   0.0344     98.770  0.0313    98.952  948.82
  21   0.0516     98.250  0.0288    99.067  996.05
  22   0.0451     98.620  0.0269    99.112  1043.23
  23   0.0436     98.670  0.0279    99.052  1090.39
  24   0.0474     98.610  0.0256    99.140  1137.56
  25   0.0378     98.830  0.0252    99.138  1184.72
  26   0.0444     98.540  0.0232    99.250  1231.87
  27   0.0399     98.670  0.0229    99.250  1279.10
  28   0.0385     98.770  0.0216    99.243  1326.30
  29   0.0354     98.920  0.0224    99.267  1373.56
  30   0.0386     98.780  0.0207    99.298  1420.73
  31   0.0381     98.800  0.0198    99.380  1467.88
  32   0.0312     98.940  0.0186    99.397  1515.07
  33   0.0315     99.070  0.0169    99.433  1562.24
  34   0.0239     99.210  0.0174    99.423  1609.45
  35   0.0308     98.960  0.0164    99.443  1656.63
  36   0.0403     98.830  0.0166    99.458  1703.83
  37   0.0364     98.830  0.0167    99.443  1751.05
  38   0.0354     98.910  0.0150    99.475  1798.21
  39   0.0339     98.980  0.0154    99.495  1845.41
  40   0.0346     98.890  0.0148    99.502  1892.56
  41   0.0298     98.980  0.0143    99.547  1939.78
  42   0.0270     99.050  0.0132    99.560  1986.99
  43   0.0366     98.880  0.0130    99.555  2034.22
  44   0.0345     98.950  0.0125    99.573  2081.43
  45   0.0292     99.120  0.0127    99.570  2128.61
  46   0.0364     98.870  0.0108    99.643  2175.78
  47   0.0237     99.270  0.0109    99.640  2222.97
  48   0.0293     99.110  0.0111    99.628  2270.18
  49   0.0355     99.000  0.0099    99.660  2317.39
  50   0.0306     99.080  0.0095    99.688  2364.65
  51   0.0300     99.110  0.0106    99.645  2411.87
  52   0.0311     99.000  0.0090    99.708  2459.12
  53   0.0293     99.110  0.0087    99.725  2506.30
  54   0.0267     99.180  0.0083    99.735  2553.48
  55   0.0381     98.850  0.0079    99.753  2600.65
  56   0.0326     99.040  0.0074    99.767  2647.86
  57   0.0333     99.090  0.0078    99.740  2695.06
  58   0.0293     99.120  0.0067    99.783  2742.28
  59   0.0397     98.880  0.0068    99.792  2789.51
  60   0.0366     98.940  0.0065    99.785  2836.84
  61   0.0323     98.940  0.0060    99.813  2884.04
  62   0.0349     98.920  0.0064    99.817  2931.28
  63   0.0392     98.910  0.0060    99.805  2978.51
  64   0.0421     98.850  0.0061    99.805  3025.70
  65   0.0362     98.980  0.0052    99.845  3072.84
  66   0.0343     99.040  0.0057    99.797  3120.25
  67   0.0294     99.130  0.0055    99.820  3167.42
  68   0.0319     99.030  0.0046    99.857  3214.65
  69   0.0454     98.770  0.0044    99.858  3261.91
  70   0.0413     98.880  0.0042    99.868  3309.08
  71   0.0352     98.930  0.0041    99.862  3356.30
  72   0.0353     98.940  0.0039    99.880  3403.50
  73   0.0362     98.930  0.0044    99.853  3450.68
  74   0.0350     99.030  0.0035    99.897  3497.84
  75   0.0409     98.850  0.0041    99.865  3545.06
  76   0.0349     99.010  0.0035    99.895  3592.29
  77   0.0372     99.050  0.0032    99.898  3639.52
  78   0.0385     98.980  0.0037    99.885  3686.76
  79   0.0350     98.950  0.0032    99.892  3733.93
  80   0.0418     98.770  0.0039    99.875  3781.08
  81   0.0275     99.210  0.0028    99.927  3828.29
  82   0.0392     98.870  0.0030    99.915  3875.48
  83   0.0324     99.030  0.0031    99.890  3922.70
  84   0.0325     99.030  0.0034    99.893  3969.91
  85   0.0313     99.060  0.0028    99.915  4017.24
  86   0.0368     98.990  0.0025    99.925  4064.41
  87   0.0396     99.000  0.0024    99.932  4111.58
  88   0.0342     99.030  0.0028    99.922  4158.77
  89   0.0435     98.840  0.0027    99.932  4205.97
  90   0.0439     98.850  0.0025    99.938  4253.19
