Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.5478     81.770  2.6725    37.398  51.45
   2   0.1755     94.730  0.3116    89.842  98.49
   3   0.0883     97.230  0.1319    96.018  145.54
   4   0.0922     96.900  0.0945    97.052  192.55
   5   0.0842     97.150  0.0777    97.575  239.55
   6   0.0718     97.810  0.0671    97.882  286.53
   7   0.0742     97.550  0.0596    98.128  333.52
   8   0.0564     98.200  0.0541    98.265  380.61
   9   0.0550     98.240  0.0487    98.510  427.66
  10   0.0566     98.250  0.0439    98.603  474.72
  11   0.0402     98.730  0.0427    98.652  521.74
  12   0.0429     98.610  0.0419    98.687  568.76
  13   0.0542     98.140  0.0371    98.817  615.76
  14   0.0485     98.350  0.0358    98.845  662.75
  15   0.0495     98.310  0.0343    98.872  709.73
  16   0.0401     98.710  0.0336    98.922  756.74
  17   0.0416     98.590  0.0319    98.983  803.74
  18   0.0415     98.730  0.0301    99.053  851.01
  19   0.0358     98.910  0.0291    99.060  898.04
  20   0.0454     98.450  0.0293    99.058  945.05
  21   0.0430     98.630  0.0264    99.137  992.06
  22   0.0350     98.800  0.0252    99.195  1039.09
  23   0.0392     98.730  0.0261    99.168  1086.08
  24   0.0503     98.510  0.0245    99.220  1133.07
  25   0.0327     98.950  0.0243    99.187  1180.05
  26   0.0423     98.670  0.0222    99.278  1227.08
  27   0.0378     98.680  0.0221    99.280  1274.07
  28   0.0378     98.820  0.0213    99.292  1321.08
  29   0.0428     98.660  0.0204    99.325  1368.07
  30   0.0290     99.050  0.0203    99.350  1415.07
  31   0.0304     99.050  0.0203    99.367  1462.05
  32   0.0399     98.720  0.0188    99.378  1509.02
  33   0.0426     98.660  0.0187    99.400  1555.66
  34   0.0318     99.040  0.0178    99.395  1602.61
  35   0.0418     98.660  0.0167    99.485  1649.57
  36   0.0357     98.840  0.0176    99.400  1696.56
  37   0.0303     99.020  0.0163    99.438  1743.58
  38   0.0335     98.940  0.0150    99.490  1790.59
  39   0.0317     98.860  0.0148    99.480  1837.64
  40   0.0329     98.910  0.0133    99.572  1884.66
  41   0.0337     98.970  0.0131    99.558  1931.68
  42   0.0341     98.960  0.0127    99.577  1978.67
  43   0.0390     98.770  0.0121    99.610  2025.75
  44   0.0344     98.830  0.0124    99.607  2072.75
  45   0.0298     99.010  0.0122    99.610  2119.79
  46   0.0477     98.600  0.0122    99.597  2166.81
  47   0.0335     99.000  0.0114    99.615  2213.86
  48   0.0355     98.890  0.0106    99.672  2260.84
  49   0.0415     98.800  0.0090    99.713  2307.81
  50   0.0337     98.940  0.0091    99.702  2354.79
  51   0.0381     98.850  0.0086    99.705  2401.75
  52   0.0314     99.000  0.0094    99.708  2448.74
  53   0.0370     98.810  0.0093    99.703  2495.78
  54   0.0367     98.790  0.0082    99.728  2542.80
  55   0.0319     99.110  0.0075    99.747  2589.76
  56   0.0415     98.760  0.0073    99.762  2636.79
  57   0.0320     99.040  0.0075    99.752  2683.83
  58   0.0329     98.910  0.0067    99.772  2730.77
  59   0.0335     98.960  0.0065    99.797  2777.74
  60   0.0365     98.890  0.0062    99.800  2824.73
  61   0.0354     99.020  0.0057    99.832  2871.76
  62   0.0338     98.970  0.0056    99.820  2918.78
  63   0.0315     99.010  0.0053    99.823  2965.82
  64   0.0367     98.980  0.0050    99.847  3012.89
  65   0.0387     98.890  0.0046    99.878  3059.90
  66   0.0365     98.990  0.0047    99.845  3106.95
  67   0.0328     99.050  0.0049    99.845  3153.92
  68   0.0370     98.920  0.0048    99.853  3200.93
  69   0.0364     98.870  0.0046    99.852  3247.93
  70   0.0390     98.880  0.0042    99.870  3294.89
  71   0.0340     99.000  0.0045    99.853  3341.89
  72   0.0301     99.000  0.0040    99.877  3388.92
  73   0.0379     98.840  0.0039    99.867  3435.94
  74   0.0313     99.080  0.0033    99.905  3482.97
  75   0.0292     99.080  0.0036    99.893  3529.98
  76   0.0368     98.910  0.0032    99.908  3576.96
  77   0.0393     98.910  0.0032    99.918  3623.93
  78   0.0356     98.970  0.0032    99.912  3670.92
  79   0.0307     99.060  0.0033    99.897  3717.98
  80   0.0322     99.020  0.0030    99.915  3765.01
  81   0.0352     98.940  0.0028    99.913  3812.04
  82   0.0334     98.890  0.0028    99.913  3859.05
  83   0.0367     98.980  0.0021    99.955  3906.09
  84   0.0405     98.890  0.0028    99.913  3953.08
  85   0.0296     99.130  0.0025    99.938  4000.05
  86   0.0380     98.820  0.0024    99.918  4047.03
  87   0.0368     98.940  0.0024    99.925  4094.02
  88   0.0406     98.900  0.0024    99.938  4141.09
  89   0.0357     98.910  0.0021    99.952  4188.12
  90   0.0383     99.010  0.0020    99.957  4235.14
