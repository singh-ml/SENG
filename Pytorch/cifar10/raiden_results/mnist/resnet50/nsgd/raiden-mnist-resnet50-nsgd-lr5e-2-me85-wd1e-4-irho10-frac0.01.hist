Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.1774     15.710  3.8259    11.808  51.98
   2   1.7342     30.380  2.1020    19.547  98.89
   3   0.9077     65.480  1.3274    48.925  145.78
   4   0.6355     77.590  0.7968    70.195  192.27
   5   0.3409     90.140  0.4866    83.268  239.13
   6   0.2240     93.650  0.3083    90.540  285.92
   7   0.1878     94.590  0.2126    93.782  332.78
   8   0.1598     95.360  0.1605    95.243  379.62
   9   0.1286     95.930  0.1315    96.095  426.45
  10   0.0738     97.720  0.1063    96.863  472.92
  11   0.0996     96.950  0.0882    97.355  519.78
  12   0.0733     97.760  0.0830    97.447  566.64
  13   0.1323     95.940  0.0779    97.677  613.22
  14   0.0728     97.540  0.0723    97.835  660.09
  15   0.0506     98.250  0.0698    97.878  706.87
  16   0.0632     97.990  0.0614    98.080  753.66
  17   0.0668     97.850  0.0610    98.092  800.44
  18   0.0746     97.680  0.0580    98.230  847.39
  19   0.0612     97.950  0.0545    98.357  894.30
  20   0.0695     97.770  0.0527    98.373  941.16
  21   0.0621     98.010  0.0524    98.427  988.02
  22   0.0586     98.150  0.0495    98.487  1034.92
  23   0.0608     98.170  0.0476    98.528  1081.80
  24   0.0586     98.140  0.0456    98.600  1128.72
  25   0.0481     98.290  0.0449    98.605  1175.60
  26   0.0426     98.710  0.0423    98.668  1222.14
  27   0.0432     98.570  0.0401    98.725  1268.97
  28   0.0431     98.610  0.0382    98.800  1315.83
  29   0.0458     98.580  0.0393    98.773  1362.30
  30   0.0532     98.260  0.0374    98.838  1409.14
  31   0.0497     98.250  0.0374    98.852  1456.04
  32   0.0409     98.700  0.0351    98.927  1502.92
  33   0.0482     98.310  0.0357    98.877  1549.81
  34   0.0402     98.710  0.0334    98.977  1596.65
  35   0.0450     98.520  0.0325    98.992  1643.20
  36   0.0446     98.460  0.0311    98.980  1690.02
  37   0.0417     98.670  0.0303    99.022  1736.86
  38   0.0439     98.470  0.0304    99.047  1783.70
  39   0.0345     98.750  0.0302    99.025  1830.58
  40   0.0400     98.700  0.0298    99.037  1877.49
  41   0.0455     98.540  0.0283    99.088  1924.30
  42   0.0560     98.120  0.0273    99.098  1971.18
  43   0.0326     98.980  0.0258    99.162  2018.00
  44   0.0565     98.430  0.0270    99.128  2064.85
  45   0.0311     99.020  0.0256    99.187  2111.38
  46   0.0367     98.850  0.0243    99.215  2158.21
  47   0.0318     98.920  0.0221    99.302  2205.04
  48   0.0430     98.680  0.0223    99.295  2251.88
  49   0.0371     98.860  0.0214    99.308  2298.68
  50   0.0378     99.000  0.0194    99.368  2345.81
  51   0.0344     98.930  0.0198    99.345  2392.71
  52   0.0373     98.900  0.0189    99.348  2439.59
  53   0.0317     98.880  0.0189    99.383  2486.14
  54   0.0392     98.790  0.0178    99.422  2533.01
  55   0.0327     98.940  0.0181    99.393  2579.80
  56   0.0279     99.080  0.0158    99.492  2626.27
  57   0.0380     98.820  0.0181    99.422  2672.77
  58   0.0304     99.060  0.0162    99.468  2719.64
  59   0.0342     98.850  0.0157    99.492  2766.50
  60   0.0385     98.780  0.0156    99.508  2813.35
  61   0.0319     99.080  0.0147    99.515  2860.20
  62   0.0349     98.850  0.0141    99.543  2907.08
  63   0.0341     98.870  0.0140    99.533  2953.90
  64   0.0359     98.880  0.0123    99.612  3000.76
  65   0.0380     98.810  0.0132    99.567  3047.58
  66   0.0314     99.100  0.0121    99.592  3094.71
  67   0.0348     98.880  0.0123    99.582  3141.54
  68   0.0352     98.930  0.0110    99.635  3188.08
  69   0.0371     98.890  0.0110    99.663  3234.92
  70   0.0421     98.780  0.0105    99.653  3281.55
  71   0.0324     98.970  0.0106    99.657  3328.44
  72   0.0366     98.920  0.0098    99.680  3375.32
  73   0.0413     98.850  0.0095    99.687  3421.80
  74   0.0476     98.700  0.0102    99.637  3468.65
  75   0.0335     98.950  0.0096    99.692  3515.46
  76   0.0325     99.020  0.0092    99.713  3561.97
  77   0.0404     98.840  0.0092    99.690  3608.84
  78   0.0312     99.040  0.0092    99.718  3655.66
  79   0.0348     98.910  0.0091    99.718  3702.53
  80   0.0390     98.840  0.0083    99.727  3749.39
  81   0.0290     99.120  0.0087    99.730  3796.24
  82   0.0292     99.130  0.0083    99.748  3843.16
  83   0.0291     99.110  0.0084    99.718  3889.97
  84   0.0351     98.980  0.0085    99.730  3936.82
  85   0.0291     99.170  0.0082    99.743  3983.70
