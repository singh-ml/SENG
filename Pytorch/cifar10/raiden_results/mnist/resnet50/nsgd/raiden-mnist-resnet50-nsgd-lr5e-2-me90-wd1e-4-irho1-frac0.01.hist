Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.7668     33.150  3.5880    20.287  51.58
   2   0.4973     82.760  0.9961    64.712  98.22
   3   0.2218     93.500  0.3574    88.682  145.22
   4   0.1154     96.410  0.1848    94.492  192.15
   5   0.0894     97.180  0.1291    96.068  239.34
   6   0.0844     97.310  0.1035    96.833  286.30
   7   0.0580     98.150  0.0916    97.238  333.33
   8   0.0750     97.610  0.0794    97.552  380.32
   9   0.0486     98.400  0.0700    97.855  426.92
  10   0.0761     97.520  0.0666    97.928  473.61
  11   0.0702     97.720  0.0617    98.133  520.26
  12   0.0399     98.730  0.0579    98.168  567.40
  13   0.0584     98.140  0.0534    98.307  614.08
  14   0.0416     98.680  0.0505    98.398  661.08
  15   0.0517     98.260  0.0476    98.553  708.03
  16   0.0490     98.310  0.0460    98.542  754.99
  17   0.0472     98.390  0.0462    98.583  801.95
  18   0.0500     98.320  0.0414    98.697  848.88
  19   0.0451     98.610  0.0426    98.707  895.81
  20   0.0365     98.730  0.0387    98.792  942.75
  21   0.0400     98.630  0.0368    98.825  989.97
  22   0.0477     98.490  0.0353    98.903  1036.96
  23   0.0585     98.100  0.0355    98.880  1083.96
  24   0.0422     98.620  0.0346    98.932  1130.96
  25   0.0300     98.970  0.0341    98.907  1177.92
  26   0.0334     98.970  0.0325    98.992  1224.87
  27   0.0320     98.970  0.0330    98.938  1271.83
  28   0.0378     98.810  0.0306    99.053  1318.74
  29   0.0403     98.600  0.0323    98.958  1365.37
  30   0.0387     98.810  0.0297    99.067  1412.53
  31   0.0406     98.780  0.0283    99.075  1459.53
  32   0.0502     98.220  0.0278    99.092  1506.53
  33   0.0468     98.420  0.0267    99.097  1553.51
  34   0.0408     98.780  0.0241    99.240  1600.48
  35   0.0289     99.050  0.0256    99.172  1647.45
  36   0.0381     98.750  0.0257    99.165  1694.41
  37   0.0344     98.770  0.0236    99.208  1741.40
  38   0.0344     98.940  0.0242    99.177  1788.40
  39   0.0349     98.960  0.0235    99.235  1835.39
  40   0.0391     98.790  0.0206    99.332  1882.08
  41   0.0441     98.560  0.0222    99.273  1929.04
  42   0.0309     98.970  0.0219    99.252  1976.04
  43   0.0358     98.820  0.0200    99.385  2022.99
  44   0.0362     98.930  0.0192    99.375  2069.99
  45   0.0300     99.030  0.0187    99.385  2116.94
  46   0.0320     98.990  0.0198    99.327  2163.88
  47   0.0435     98.680  0.0175    99.403  2210.81
  48   0.0383     98.890  0.0188    99.355  2257.75
  49   0.0373     98.820  0.0186    99.385  2304.79
  50   0.0356     98.920  0.0154    99.487  2351.74
  51   0.0302     99.030  0.0155    99.493  2398.37
  52   0.0330     98.950  0.0147    99.532  2445.36
  53   0.0381     98.790  0.0146    99.515  2492.34
  54   0.0310     98.980  0.0139    99.535  2539.24
  55   0.0458     98.560  0.0140    99.535  2586.16
  56   0.0291     99.170  0.0131    99.590  2633.09
  57   0.0325     99.060  0.0122    99.597  2680.05
  58   0.0328     98.940  0.0114    99.627  2727.26
  59   0.0345     99.100  0.0125    99.590  2774.23
  60   0.0314     99.070  0.0117    99.623  2821.24
  61   0.0341     98.940  0.0108    99.625  2868.25
  62   0.0420     98.770  0.0103    99.658  2915.21
  63   0.0352     98.980  0.0101    99.660  2962.14
  64   0.0342     99.010  0.0095    99.687  3008.75
  65   0.0341     99.100  0.0091    99.707  3055.69
  66   0.0301     99.130  0.0089    99.712  3102.91
  67   0.0329     99.110  0.0088    99.702  3149.94
  68   0.0359     98.910  0.0075    99.765  3196.93
  69   0.0375     98.980  0.0077    99.738  3243.93
  70   0.0315     99.130  0.0075    99.778  3290.94
  71   0.0304     99.090  0.0076    99.758  3337.93
  72   0.0306     99.080  0.0077    99.772  3384.89
  73   0.0327     99.030  0.0070    99.787  3431.89
  74   0.0320     99.070  0.0075    99.755  3478.82
  75   0.0315     98.990  0.0063    99.807  3525.78
  76   0.0317     99.070  0.0070    99.777  3572.78
  77   0.0337     98.990  0.0061    99.800  3619.45
  78   0.0378     99.000  0.0063    99.797  3666.39
  79   0.0358     99.040  0.0054    99.845  3713.40
  80   0.0315     99.140  0.0061    99.805  3760.39
  81   0.0347     99.040  0.0057    99.818  3807.35
  82   0.0328     99.130  0.0055    99.828  3854.26
  83   0.0347     99.060  0.0053    99.848  3901.17
  84   0.0337     98.980  0.0056    99.825  3948.11
  85   0.0368     99.030  0.0054    99.825  3995.34
  86   0.0307     99.100  0.0054    99.850  4042.36
  87   0.0283     99.170  0.0053    99.817  4089.39
  88   0.0341     99.060  0.0053    99.860  4136.54
  89   0.0314     99.200  0.0052    99.842  4183.17
  90   0.0326     99.000  0.0051    99.843  4230.16
