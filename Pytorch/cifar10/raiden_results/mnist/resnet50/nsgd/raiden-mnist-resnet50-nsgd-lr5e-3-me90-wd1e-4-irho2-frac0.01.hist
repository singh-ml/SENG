Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2801     90.710  1.9062    51.707  51.48
   2   0.1086     96.470  0.1904    94.038  98.52
   3   0.0926     97.030  0.1124    96.472  145.58
   4   0.0556     98.160  0.0840    97.420  192.60
   5   0.0721     97.830  0.0703    97.840  239.57
   6   0.0786     97.350  0.0614    98.083  286.55
   7   0.0783     97.600  0.0559    98.302  333.55
   8   0.0522     98.230  0.0514    98.368  380.58
   9   0.0732     97.860  0.0472    98.497  427.66
  10   0.0470     98.480  0.0406    98.687  474.70
  11   0.0547     98.060  0.0407    98.652  521.72
  12   0.0463     98.530  0.0381    98.787  568.78
  13   0.0578     98.100  0.0363    98.845  615.77
  14   0.0580     98.140  0.0340    98.897  662.82
  15   0.0449     98.530  0.0334    98.960  709.86
  16   0.0451     98.650  0.0320    98.952  757.13
  17   0.0400     98.760  0.0313    99.003  804.18
  18   0.0515     98.320  0.0279    99.082  851.26
  19   0.0347     98.940  0.0275    99.070  898.35
  20   0.0583     98.050  0.0267    99.153  945.40
  21   0.0342     98.880  0.0250    99.197  992.48
  22   0.0431     98.720  0.0239    99.232  1039.54
  23   0.0496     98.290  0.0234    99.210  1086.58
  24   0.0367     98.870  0.0216    99.280  1133.63
  25   0.0559     98.260  0.0217    99.313  1180.73
  26   0.0373     98.860  0.0209    99.323  1227.81
  27   0.0452     98.650  0.0205    99.313  1274.79
  28   0.0399     98.680  0.0190    99.392  1321.88
  29   0.0413     98.530  0.0198    99.365  1368.93
  30   0.0397     98.750  0.0172    99.437  1415.94
  31   0.0403     98.830  0.0174    99.445  1463.00
  32   0.0334     99.000  0.0169    99.452  1510.03
  33   0.0315     99.000  0.0161    99.448  1557.07
  34   0.0414     98.750  0.0164    99.452  1604.40
  35   0.0400     98.810  0.0148    99.498  1651.49
  36   0.0365     98.940  0.0159    99.512  1698.57
  37   0.0335     98.910  0.0143    99.497  1745.67
  38   0.0376     98.990  0.0145    99.508  1792.70
  39   0.0446     98.800  0.0137    99.572  1839.76
  40   0.0322     99.080  0.0138    99.542  1886.88
  41   0.0377     98.860  0.0121    99.607  1933.93
  42   0.0403     99.000  0.0122    99.592  1980.96
  43   0.0403     98.890  0.0124    99.575  2028.03
  44   0.0388     98.750  0.0111    99.622  2075.14
  45   0.0348     99.020  0.0105    99.633  2122.21
  46   0.0373     98.900  0.0106    99.630  2169.29
  47   0.0383     98.870  0.0106    99.658  2216.38
  48   0.0378     98.840  0.0102    99.657  2263.48
  49   0.0419     98.800  0.0098    99.672  2310.53
  50   0.0336     99.030  0.0088    99.708  2357.55
  51   0.0337     98.850  0.0088    99.687  2404.56
  52   0.0398     98.900  0.0094    99.715  2451.63
  53   0.0405     98.930  0.0093    99.698  2498.68
  54   0.0381     98.790  0.0080    99.730  2545.95
  55   0.0336     98.890  0.0072    99.770  2593.05
  56   0.0417     98.720  0.0078    99.757  2640.15
  57   0.0410     98.860  0.0072    99.750  2687.23
  58   0.0519     98.490  0.0072    99.763  2734.29
  59   0.0349     98.970  0.0065    99.772  2781.32
  60   0.0336     99.100  0.0067    99.770  2828.35
  61   0.0349     98.970  0.0064    99.782  2875.40
  62   0.0334     99.070  0.0056    99.813  2922.43
  63   0.0382     99.010  0.0063    99.795  2969.52
  64   0.0380     99.030  0.0051    99.835  3016.57
  65   0.0410     98.900  0.0053    99.830  3063.65
  66   0.0441     98.800  0.0055    99.833  3110.90
  67   0.0393     98.880  0.0052    99.828  3157.93
  68   0.0379     99.020  0.0053    99.820  3204.95
  69   0.0391     98.990  0.0051    99.820  3251.98
  70   0.0368     99.010  0.0046    99.855  3299.03
  71   0.0419     99.030  0.0044    99.847  3346.08
  72   0.0358     99.010  0.0047    99.853  3393.15
  73   0.0357     99.040  0.0042    99.867  3440.26
  74   0.0347     99.140  0.0042    99.868  3487.35
  75   0.0330     99.140  0.0042    99.865  3534.37
  76   0.0349     98.980  0.0042    99.877  3581.37
  77   0.0342     99.020  0.0041    99.860  3628.41
  78   0.0338     98.960  0.0039    99.880  3675.42
  79   0.0367     98.950  0.0038    99.882  3722.50
  80   0.0400     98.960  0.0037    99.875  3769.58
  81   0.0438     98.900  0.0035    99.893  3816.67
  82   0.0483     98.800  0.0037    99.875  3863.75
  83   0.0398     99.030  0.0034    99.883  3910.80
  84   0.0311     99.130  0.0036    99.895  3957.84
  85   0.0492     98.870  0.0035    99.882  4004.87
  86   0.0391     99.030  0.0036    99.882  4051.91
  87   0.0462     98.910  0.0031    99.902  4099.02
  88   0.0409     98.840  0.0032    99.897  4146.08
  89   0.0343     99.050  0.0034    99.897  4193.18
  90   0.0525     98.650  0.0030    99.912  4240.28
