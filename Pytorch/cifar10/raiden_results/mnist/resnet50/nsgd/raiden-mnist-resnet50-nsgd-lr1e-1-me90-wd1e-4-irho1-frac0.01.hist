Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2588     15.650  3.4483    12.062  51.43
   2   2.0811     20.850  2.1553    19.280  98.15
   3   0.8480     68.990  1.4849    43.953  144.82
   4   0.4612     84.780  0.6854    75.845  191.58
   5   0.2652     92.350  0.3721    88.500  238.34
   6   0.1640     95.230  0.2506    92.683  285.09
   7   0.1300     96.030  0.1755    94.828  331.83
   8   0.1543     95.370  0.1444    95.637  378.59
   9   0.1238     96.090  0.1264    96.323  425.30
  10   0.1103     96.600  0.1115    96.590  471.99
  11   0.0719     98.010  0.0986    97.002  518.67
  12   0.0826     97.590  0.0893    97.285  565.49
  13   0.0899     97.350  0.0811    97.528  612.24
  14   0.0697     97.730  0.0772    97.603  658.95
  15   0.0871     97.380  0.0713    97.815  705.71
  16   0.0578     98.020  0.0662    97.928  752.49
  17   0.0517     98.260  0.0620    98.073  799.21
  18   0.0600     98.190  0.0595    98.135  845.96
  19   0.0661     97.790  0.0581    98.180  892.64
  20   0.0403     98.660  0.0573    98.200  939.33
  21   0.0669     97.910  0.0507    98.367  986.04
  22   0.0519     98.170  0.0523    98.388  1032.74
  23   0.0492     98.450  0.0502    98.438  1079.65
  24   0.0760     97.510  0.0471    98.523  1126.40
  25   0.0398     98.780  0.0469    98.548  1173.12
  26   0.0401     98.720  0.0436    98.645  1219.88
  27   0.0451     98.580  0.0437    98.618  1266.63
  28   0.0495     98.320  0.0427    98.603  1313.35
  29   0.0642     97.970  0.0422    98.672  1360.35
  30   0.0523     98.320  0.0402    98.742  1407.34
  31   0.0426     98.680  0.0410    98.667  1454.08
  32   0.0439     98.450  0.0385    98.755  1500.80
  33   0.0435     98.460  0.0345    98.958  1547.50
  34   0.0436     98.500  0.0375    98.807  1594.22
  35   0.0447     98.550  0.0341    98.953  1640.97
  36   0.0532     98.370  0.0337    98.943  1687.72
  37   0.0376     98.880  0.0317    98.995  1734.46
  38   0.0417     98.590  0.0326    98.932  1781.54
  39   0.0505     98.450  0.0297    99.072  1828.23
  40   0.0384     98.830  0.0314    99.020  1874.92
  41   0.0476     98.470  0.0301    99.058  1921.61
  42   0.0435     98.690  0.0300    99.042  1968.29
  43   0.0354     98.920  0.0284    99.127  2015.06
  44   0.0420     98.630  0.0277    99.107  2061.84
  45   0.0375     98.730  0.0273    99.147  2108.56
  46   0.0356     98.840  0.0254    99.195  2155.33
  47   0.0389     98.780  0.0271    99.128  2202.33
  48   0.0512     98.360  0.0237    99.263  2249.01
  49   0.0346     98.920  0.0228    99.248  2295.70
  50   0.0395     98.690  0.0232    99.248  2342.40
  51   0.0359     98.900  0.0211    99.337  2389.09
  52   0.0343     98.800  0.0219    99.305  2435.78
  53   0.0404     98.740  0.0220    99.292  2482.51
  54   0.0373     98.730  0.0208    99.322  2529.21
  55   0.0399     98.810  0.0203    99.333  2575.90
  56   0.0321     98.970  0.0189    99.408  2622.61
  57   0.0351     98.850  0.0199    99.318  2669.40
  58   0.0344     98.850  0.0172    99.447  2716.11
  59   0.0327     98.990  0.0162    99.505  2763.14
  60   0.0286     99.060  0.0159    99.477  2809.85
  61   0.0395     98.830  0.0159    99.458  2856.60
  62   0.0386     98.780  0.0157    99.498  2903.30
  63   0.0365     98.870  0.0142    99.502  2950.03
  64   0.0277     99.130  0.0138    99.575  2996.78
  65   0.0265     99.180  0.0130    99.548  3043.54
  66   0.0300     99.080  0.0125    99.595  3090.29
  67   0.0332     98.980  0.0116    99.630  3137.05
  68   0.0321     98.950  0.0115    99.637  3184.04
  69   0.0374     98.830  0.0112    99.668  3230.71
  70   0.0331     98.950  0.0108    99.647  3277.39
  71   0.0284     99.130  0.0105    99.683  3324.34
  72   0.0334     98.980  0.0099    99.677  3371.45
  73   0.0331     99.040  0.0096    99.690  3418.20
  74   0.0272     99.110  0.0100    99.690  3464.94
  75   0.0292     99.060  0.0085    99.763  3511.67
  76   0.0308     99.040  0.0088    99.723  3558.72
  77   0.0304     99.080  0.0083    99.745  3605.49
  78   0.0274     99.170  0.0081    99.750  3652.19
  79   0.0291     99.030  0.0081    99.745  3698.91
  80   0.0280     99.120  0.0073    99.785  3745.94
  81   0.0373     98.830  0.0081    99.745  3792.68
  82   0.0276     99.160  0.0069    99.790  3839.36
  83   0.0318     99.060  0.0073    99.792  3886.07
  84   0.0276     99.090  0.0069    99.778  3932.77
  85   0.0288     99.180  0.0069    99.800  3979.81
  86   0.0297     99.140  0.0072    99.780  4026.82
  87   0.0317     99.080  0.0065    99.805  4073.98
  88   0.0288     99.100  0.0070    99.782  4120.70
  89   0.0285     99.100  0.0064    99.805  4167.40
  90   0.0256     99.270  0.0065    99.808  4214.12
