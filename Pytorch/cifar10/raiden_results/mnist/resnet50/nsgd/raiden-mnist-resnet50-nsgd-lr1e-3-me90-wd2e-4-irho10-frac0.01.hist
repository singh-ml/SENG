Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4015     86.820  1.7135    57.658  51.51
   2   0.1730     94.570  0.1891    94.030  98.43
   3   0.0929     97.080  0.1088    96.635  145.32
   4   0.0788     97.360  0.0829    97.383  192.25
   5   0.0693     97.680  0.0678    97.910  239.13
   6   0.0518     98.180  0.0593    98.122  285.98
   7   0.0551     98.370  0.0540    98.255  332.84
   8   0.0474     98.540  0.0497    98.455  379.74
   9   0.0473     98.490  0.0461    98.530  426.89
  10   0.0648     97.900  0.0431    98.667  473.78
  11   0.0468     98.610  0.0396    98.750  520.80
  12   0.0536     98.350  0.0392    98.770  567.70
  13   0.0397     98.710  0.0365    98.860  614.58
  14   0.0463     98.480  0.0342    98.925  661.46
  15   0.0346     98.910  0.0327    98.943  708.40
  16   0.0483     98.430  0.0310    99.008  755.33
  17   0.0464     98.570  0.0292    99.017  802.25
  18   0.0472     98.520  0.0287    99.072  849.20
  19   0.0429     98.760  0.0284    99.070  896.15
  20   0.0498     98.400  0.0272    99.077  943.07
  21   0.0428     98.600  0.0262    99.153  989.97
  22   0.0524     98.460  0.0254    99.130  1036.97
  23   0.0433     98.650  0.0230    99.218  1083.90
  24   0.0472     98.670  0.0228    99.267  1130.84
  25   0.0368     98.950  0.0221    99.287  1177.72
  26   0.0372     98.900  0.0213    99.285  1224.61
  27   0.0467     98.690  0.0219    99.275  1271.48
  28   0.0439     98.720  0.0222    99.258  1318.35
  29   0.0482     98.530  0.0195    99.342  1365.29
  30   0.0360     98.960  0.0193    99.378  1412.19
  31   0.0417     98.850  0.0174    99.418  1459.11
  32   0.0387     98.890  0.0175    99.422  1506.04
  33   0.0407     98.800  0.0170    99.437  1552.99
  34   0.0428     98.720  0.0169    99.452  1599.93
  35   0.0392     98.850  0.0173    99.423  1646.82
  36   0.0396     98.810  0.0168    99.438  1693.67
  37   0.0453     98.830  0.0167    99.420  1740.77
  38   0.0475     98.740  0.0159    99.450  1787.91
  39   0.0355     99.020  0.0163    99.443  1834.78
  40   0.0433     98.780  0.0155    99.468  1881.70
  41   0.0475     98.640  0.0142    99.533  1928.65
  42   0.0429     98.890  0.0138    99.517  1975.54
  43   0.0562     98.580  0.0142    99.530  2022.46
  44   0.0386     98.980  0.0143    99.495  2069.37
  45   0.0530     98.510  0.0147    99.525  2116.27
  46   0.0415     98.780  0.0137    99.540  2163.18
  47   0.0362     98.870  0.0141    99.527  2210.14
  48   0.0336     98.860  0.0130    99.545  2257.06
  49   0.0474     98.700  0.0121    99.582  2304.00
  50   0.0418     98.940  0.0111    99.638  2350.92
  51   0.0366     99.020  0.0133    99.567  2397.85
  52   0.0352     99.080  0.0113    99.588  2444.73
  53   0.0429     98.820  0.0116    99.598  2491.64
  54   0.0358     98.960  0.0108    99.622  2538.52
  55   0.0368     98.870  0.0107    99.627  2585.37
  56   0.0542     98.650  0.0117    99.587  2632.22
  57   0.0361     99.020  0.0109    99.622  2679.34
  58   0.0513     98.800  0.0099    99.670  2726.26
  59   0.0347     99.060  0.0090    99.702  2773.18
  60   0.0428     98.970  0.0090    99.677  2820.12
  61   0.0494     98.740  0.0092    99.672  2867.07
  62   0.0536     98.650  0.0088    99.680  2913.96
  63   0.0366     99.070  0.0088    99.697  2960.85
  64   0.0461     98.870  0.0091    99.665  3007.69
  65   0.0451     98.940  0.0092    99.647  3054.60
  66   0.0460     98.850  0.0096    99.672  3101.52
  67   0.0416     98.980  0.0087    99.707  3148.45
  68   0.0436     98.900  0.0085    99.705  3195.35
  69   0.0394     98.960  0.0087    99.677  3242.27
  70   0.0474     98.790  0.0080    99.715  3289.16
  71   0.0429     98.930  0.0083    99.710  3336.05
  72   0.0487     98.830  0.0080    99.718  3382.92
  73   0.0493     98.770  0.0093    99.663  3429.81
  74   0.0393     98.950  0.0085    99.728  3476.70
  75   0.0435     98.850  0.0077    99.742  3523.63
  76   0.0540     98.740  0.0065    99.785  3570.53
  77   0.0415     98.970  0.0074    99.762  3617.45
  78   0.0677     98.240  0.0066    99.753  3664.35
  79   0.0429     99.100  0.0070    99.767  3711.24
  80   0.0401     99.060  0.0060    99.798  3758.14
  81   0.0439     99.040  0.0067    99.767  3805.03
  82   0.0433     98.940  0.0069    99.765  3851.97
  83   0.0408     98.930  0.0076    99.710  3898.86
  84   0.0393     98.980  0.0072    99.745  3945.77
  85   0.0400     98.930  0.0058    99.785  3992.67
  86   0.0492     98.810  0.0058    99.802  4039.57
  87   0.0526     98.690  0.0068    99.772  4086.51
  88   0.0527     98.770  0.0068    99.778  4133.39
  89   0.0436     99.020  0.0064    99.772  4180.23
  90   0.0381     99.160  0.0050    99.817  4227.14
