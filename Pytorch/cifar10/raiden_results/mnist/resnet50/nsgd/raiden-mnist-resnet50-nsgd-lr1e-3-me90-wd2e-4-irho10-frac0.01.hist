Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3134     89.560  1.5568    59.200  51.52
   2   0.0918     96.940  0.1854    94.157  98.56
   3   0.0963     96.880  0.1083    96.597  145.59
   4   0.0792     97.360  0.0794    97.548  192.61
   5   0.0668     97.870  0.0697    97.905  239.67
   6   0.0476     98.470  0.0613    98.093  286.75
   7   0.0487     98.290  0.0526    98.343  333.80
   8   0.0636     97.990  0.0483    98.475  380.84
   9   0.0437     98.500  0.0457    98.555  427.84
  10   0.0467     98.570  0.0415    98.683  474.87
  11   0.0643     97.900  0.0380    98.773  521.87
  12   0.0373     98.670  0.0380    98.783  568.91
  13   0.0513     98.440  0.0369    98.795  615.96
  14   0.0461     98.530  0.0345    98.898  663.02
  15   0.0539     98.310  0.0332    98.927  710.02
  16   0.0496     98.320  0.0307    99.052  757.09
  17   0.0421     98.720  0.0294    99.058  804.10
  18   0.0394     98.890  0.0291    99.063  851.10
  19   0.0408     98.740  0.0282    99.102  898.18
  20   0.0430     98.670  0.0281    99.060  945.24
  21   0.0338     98.900  0.0264    99.147  992.29
  22   0.0337     98.930  0.0243    99.215  1039.27
  23   0.0350     98.920  0.0240    99.230  1086.28
  24   0.0386     98.850  0.0228    99.280  1133.26
  25   0.0371     98.840  0.0223    99.298  1180.29
  26   0.0416     98.640  0.0203    99.313  1227.34
  27   0.0534     98.510  0.0208    99.287  1274.34
  28   0.0420     98.740  0.0196    99.335  1321.35
  29   0.0548     98.460  0.0199    99.322  1368.36
  30   0.0463     98.780  0.0179    99.410  1415.39
  31   0.0425     98.830  0.0188    99.365  1462.41
  32   0.0379     98.930  0.0175    99.390  1509.42
  33   0.0373     98.850  0.0195    99.342  1556.47
  34   0.0390     98.910  0.0184    99.367  1603.53
  35   0.0358     99.010  0.0169    99.460  1650.57
  36   0.0336     98.880  0.0173    99.413  1697.63
  37   0.0322     98.980  0.0164    99.473  1744.62
  38   0.0479     98.580  0.0147    99.508  1791.61
  39   0.0407     98.650  0.0155    99.467  1838.61
  40   0.0440     98.570  0.0171    99.422  1885.64
  41   0.0480     98.560  0.0153    99.490  1932.72
  42   0.0370     98.900  0.0138    99.523  1979.80
  43   0.0469     98.590  0.0150    99.485  2026.84
  44   0.0394     98.890  0.0141    99.537  2073.94
  45   0.0321     99.120  0.0122    99.603  2120.97
  46   0.0351     98.950  0.0116    99.632  2167.97
  47   0.0414     98.800  0.0128    99.553  2214.98
  48   0.0376     99.070  0.0136    99.522  2261.98
  49   0.0303     99.090  0.0111    99.647  2309.01
  50   0.0317     99.100  0.0122    99.610  2356.08
  51   0.0423     98.930  0.0124    99.540  2403.13
  52   0.0405     98.960  0.0126    99.578  2450.19
  53   0.0370     98.970  0.0116    99.597  2497.23
  54   0.0413     98.850  0.0105    99.632  2544.23
  55   0.0483     98.720  0.0116    99.610  2591.25
  56   0.0420     98.660  0.0100    99.647  2638.26
  57   0.0463     98.800  0.0104    99.655  2685.28
  58   0.0373     99.050  0.0102    99.645  2732.29
  59   0.0283     99.260  0.0084    99.725  2779.38
  60   0.0420     98.830  0.0096    99.688  2826.42
  61   0.0397     98.980  0.0096    99.670  2873.42
  62   0.0331     99.110  0.0087    99.712  2920.48
  63   0.0337     99.080  0.0091    99.678  2967.50
  64   0.0421     98.900  0.0090    99.730  3014.51
  65   0.0394     98.920  0.0094    99.670  3061.52
  66   0.0390     98.940  0.0088    99.695  3108.54
  67   0.0455     98.720  0.0088    99.707  3155.62
  68   0.0419     98.960  0.0085    99.713  3202.67
  69   0.0421     98.890  0.0078    99.747  3249.70
  70   0.0397     98.980  0.0091    99.675  3296.72
  71   0.0420     98.900  0.0096    99.672  3343.72
  72   0.0467     98.740  0.0076    99.713  3390.80
  73   0.0326     99.170  0.0083    99.718  3437.83
  74   0.0467     98.790  0.0077    99.742  3484.86
  75   0.0382     99.030  0.0080    99.723  3531.88
  76   0.0494     98.810  0.0064    99.775  3578.95
  77   0.0435     98.980  0.0083    99.720  3626.03
  78   0.0427     98.910  0.0070    99.770  3673.14
  79   0.0421     98.870  0.0060    99.785  3720.18
  80   0.0367     99.050  0.0065    99.780  3767.20
  81   0.0395     99.140  0.0065    99.773  3814.27
  82   0.0361     99.030  0.0064    99.783  3861.33
  83   0.0379     99.020  0.0055    99.792  3908.41
  84   0.0393     99.060  0.0064    99.772  3955.45
  85   0.0429     98.900  0.0058    99.798  4002.43
  86   0.0404     99.010  0.0056    99.800  4049.48
  87   0.0407     99.010  0.0053    99.832  4096.55
  88   0.0370     99.110  0.0057    99.812  4143.57
  89   0.0430     98.890  0.0057    99.813  4190.66
  90   0.0315     99.230  0.0061    99.788  4237.65
