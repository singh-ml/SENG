Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.4504     84.820  2.0371    48.920  51.47
   2   0.1354     95.690  0.2528    92.053  98.49
   3   0.1032     96.690  0.1291    95.955  145.54
   4   0.0826     97.340  0.0956    97.008  192.59
   5   0.0639     97.980  0.0772    97.513  239.63
   6   0.0567     98.160  0.0671    97.865  286.67
   7   0.0585     98.180  0.0613    98.062  333.70
   8   0.0556     98.190  0.0546    98.283  380.68
   9   0.0454     98.500  0.0499    98.420  427.68
  10   0.0448     98.450  0.0470    98.465  474.76
  11   0.0455     98.500  0.0438    98.582  521.83
  12   0.0470     98.480  0.0432    98.670  568.87
  13   0.0494     98.250  0.0379    98.793  615.93
  14   0.0449     98.550  0.0360    98.850  663.01
  15   0.0533     98.180  0.0356    98.837  710.07
  16   0.0423     98.610  0.0347    98.940  757.11
  17   0.0449     98.740  0.0308    99.005  804.10
  18   0.0429     98.590  0.0319    98.982  851.13
  19   0.0386     98.820  0.0284    99.062  898.14
  20   0.0428     98.700  0.0283    99.085  945.31
  21   0.0423     98.580  0.0261    99.145  992.29
  22   0.0377     98.740  0.0272    99.142  1039.35
  23   0.0474     98.490  0.0245    99.195  1086.39
  24   0.0422     98.530  0.0255    99.140  1133.41
  25   0.0298     99.000  0.0235    99.207  1180.39
  26   0.0368     98.830  0.0228    99.205  1227.38
  27   0.0400     98.640  0.0227    99.220  1274.41
  28   0.0423     98.720  0.0219    99.297  1321.39
  29   0.0375     98.830  0.0230    99.257  1368.63
  30   0.0431     98.750  0.0218    99.258  1415.72
  31   0.0459     98.580  0.0215    99.275  1462.74
  32   0.0393     98.820  0.0210    99.295  1509.80
  33   0.0388     98.850  0.0197    99.338  1556.85
  34   0.0368     98.930  0.0204    99.333  1603.86
  35   0.0417     98.560  0.0184    99.410  1650.85
  36   0.0392     98.890  0.0183    99.390  1697.81
  37   0.0439     98.640  0.0171    99.453  1744.82
  38   0.0361     98.920  0.0163    99.450  1791.88
  39   0.0367     98.870  0.0170    99.427  1838.97
  40   0.0476     98.400  0.0149    99.512  1885.97
  41   0.0406     98.780  0.0162    99.477  1932.99
  42   0.0370     98.790  0.0148    99.520  1980.02
  43   0.0395     98.850  0.0154    99.500  2027.06
  44   0.0345     98.930  0.0155    99.487  2074.08
  45   0.0497     98.470  0.0141    99.512  2121.09
  46   0.0353     99.020  0.0150    99.475  2168.19
  47   0.0469     98.730  0.0138    99.532  2215.21
  48   0.0303     99.160  0.0137    99.528  2262.27
  49   0.0378     98.920  0.0133    99.543  2309.27
  50   0.0608     98.380  0.0128    99.555  2356.32
  51   0.0389     98.870  0.0126    99.543  2403.31
  52   0.0499     98.740  0.0123    99.580  2450.27
  53   0.0371     99.000  0.0116    99.620  2497.28
  54   0.0492     98.610  0.0117    99.613  2544.27
  55   0.0409     98.910  0.0125    99.565  2591.32
  56   0.0412     98.930  0.0109    99.652  2638.35
  57   0.0431     98.880  0.0100    99.655  2685.38
  58   0.0448     98.910  0.0107    99.623  2732.43
  59   0.0338     99.050  0.0108    99.617  2779.45
  60   0.0469     98.820  0.0100    99.663  2826.45
  61   0.0388     98.880  0.0110    99.632  2873.47
  62   0.0386     98.830  0.0095    99.683  2920.49
  63   0.0395     98.930  0.0094    99.685  2967.54
  64   0.0386     98.950  0.0102    99.672  3014.56
  65   0.0362     99.020  0.0092    99.690  3061.61
  66   0.0477     98.830  0.0087    99.713  3108.63
  67   0.0453     98.690  0.0100    99.657  3155.66
  68   0.0472     98.830  0.0092    99.680  3202.63
  69   0.0381     98.930  0.0085    99.730  3249.65
  70   0.0380     98.870  0.0090    99.707  3296.68
  71   0.0494     98.640  0.0094    99.685  3343.74
  72   0.0445     98.930  0.0084    99.717  3390.79
  73   0.0509     98.720  0.0081    99.723  3437.83
  74   0.0379     99.010  0.0072    99.770  3484.87
  75   0.0296     99.260  0.0080    99.740  3531.88
  76   0.0362     98.970  0.0078    99.733  3578.89
  77   0.0392     98.890  0.0072    99.753  3625.92
  78   0.0536     98.740  0.0075    99.715  3672.93
  79   0.0406     98.960  0.0073    99.763  3719.98
  80   0.0508     98.660  0.0070    99.733  3767.01
  81   0.0418     98.910  0.0067    99.783  3814.22
  82   0.0382     98.920  0.0063    99.787  3861.34
  83   0.0432     99.000  0.0061    99.783  3908.39
  84   0.0321     99.070  0.0065    99.798  3955.42
  85   0.0348     99.020  0.0069    99.753  4002.49
