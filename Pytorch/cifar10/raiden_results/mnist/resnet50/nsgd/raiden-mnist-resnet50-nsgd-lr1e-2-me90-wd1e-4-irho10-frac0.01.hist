Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.0667     62.630  3.4026    28.630  51.56
   2   0.3551     88.620  0.6600    77.752  98.67
   3   0.2168     93.350  0.2993    91.025  145.52
   4   0.4372     95.190  0.1899    94.202  192.39
   5   0.1086     96.410  0.1372    95.752  239.26
   6   0.1187     96.220  0.1181    96.335  286.13
   7   0.2618     91.430  0.1669    95.368  333.26
   8   0.1454     95.480  0.1715    94.822  380.12
   9   0.1428     95.620  0.1375    96.265  426.99
  10   0.0933     96.970  0.1056    96.727  473.84
  11   0.0716     97.560  0.0896    97.227  520.98
  12   0.0729     97.560  0.0860    97.330  567.76
  13   0.0630     97.910  0.0765    97.613  614.61
  14   0.0642     97.860  0.0707    97.800  661.48
  15   0.0680     97.740  0.0664    97.902  708.31
  16   0.0654     97.740  0.0654    97.942  755.19
  17   0.0678     97.740  0.0594    98.103  802.05
  18   0.0540     98.210  0.0575    98.155  848.92
  19   0.0431     98.410  0.0552    98.203  895.79
  20   0.1253     98.050  0.0530    98.300  942.60
  21   0.0624     97.750  0.0670    98.122  989.76
  22   0.0612     97.930  0.0610    98.097  1036.56
  23   0.0515     98.170  0.0540    98.365  1083.67
  24   0.0507     98.280  0.0483    98.455  1130.54
  25   0.0445     98.430  0.0455    98.567  1177.39
  26   0.6837     98.100  0.0450    98.613  1224.23
  27   0.0481     98.350  0.0466    98.547  1271.04
  28   0.0507     98.200  0.0447    98.542  1318.21
  29   0.0600     98.100  0.0435    98.637  1365.04
  30   0.0345     98.750  0.0410    98.720  1411.82
  31   0.0476     98.350  0.0397    98.743  1458.96
  32   0.6723     98.390  0.0385    98.755  1505.81
  33   0.0923     98.300  0.0376    98.752  1552.67
  34   0.0358     98.710  0.0359    98.842  1599.53
  35   0.0417     98.550  0.0343    98.878  1646.53
  36   0.0644     98.350  0.0351    98.877  1693.65
  37   0.0376     98.670  0.0330    99.002  1740.45
  38   0.0378     98.670  0.0323    98.972  1787.26
  39   0.0457     98.510  0.0308    99.012  1834.48
  40   0.0455     98.460  0.0316    98.997  1881.32
  41   0.0387     98.560  0.0294    99.047  1928.19
  42   0.0383     98.690  0.0302    99.010  1975.36
  43   0.0359     98.750  0.0283    99.088  2022.21
  44   0.0432     98.490  0.0287    99.070  2069.39
  45   0.0382     98.630  0.0261    99.173  2116.58
  46   0.1038     98.680  0.0271    99.147  2163.73
  47   0.0321     98.860  0.0264    99.125  2210.57
  48   0.0346     98.780  0.0249    99.168  2257.71
  49   0.0340     98.800  0.0238    99.257  2304.87
  50   0.0377     98.730  0.0239    99.218  2352.02
  51   0.0444     98.530  0.0230    99.252  2399.20
  52   0.0377     98.590  0.0235    99.232  2446.03
  53   0.0310     98.900  0.0231    99.255  2493.22
  54   0.0358     98.770  0.0231    99.265  2540.08
  55   0.0326     98.930  0.0222    99.288  2587.29
  56   0.0335     98.890  0.0216    99.293  2634.46
  57   0.0404     98.660  0.0198    99.330  2681.69
  58   0.0340     98.830  0.0194    99.373  2728.50
  59   0.0391     98.650  0.0197    99.352  2775.31
  60   0.0314     98.910  0.0202    99.363  2822.12
  61   0.0296     98.930  0.0188    99.392  2869.30
  62   0.0401     98.690  0.0185    99.405  2916.16
  63   0.0328     98.880  0.0179    99.423  2963.00
  64   0.0356     98.720  0.0176    99.465  3009.80
  65   0.0409     98.610  0.0169    99.460  3057.04
  66   0.0327     98.860  0.0160    99.487  3104.19
  67   0.1000     98.840  0.0157    99.477  3150.99
  68   0.0399     98.760  0.0162    99.470  3198.12
  69   0.0476     98.510  0.0161    99.493  3245.25
  70   0.0332     98.890  0.0149    99.537  3292.44
  71   0.0343     98.860  0.0162    99.487  3339.59
  72   0.0398     98.650  0.0151    99.513  3386.47
  73   0.0342     98.840  0.0153    99.545  3433.44
  74   0.0321     98.940  0.0151    99.508  3480.24
  75   0.0341     98.810  0.0140    99.545  3527.36
  76   0.0291     98.930  0.0146    99.528  3574.49
  77   0.0351     98.770  0.0147    99.533  3621.32
  78   0.0348     98.870  0.0138    99.540  3668.51
  79   0.1507     98.650  0.0431    99.545  3715.65
  80   0.0352     98.830  0.0146    99.545  3762.51
  81   0.0311     98.980  0.0138    99.558  3809.70
  82   0.0333     98.890  0.0126    99.610  3856.86
  83   0.0337     98.950  0.0125    99.592  3904.00
  84   0.0334     98.850  0.0131    99.577  3951.14
  85   0.0353     98.860  0.0131    99.590  3998.52
  86   0.0324     98.870  0.0129    99.583  4045.71
  87   0.0331     98.930  0.0128    99.593  4092.56
  88   0.0453     98.730  0.0122    99.607  4139.48
  89   0.0346     98.890  0.0125    99.598  4186.31
  90   0.0319     98.880  0.0124    99.585  4233.18
