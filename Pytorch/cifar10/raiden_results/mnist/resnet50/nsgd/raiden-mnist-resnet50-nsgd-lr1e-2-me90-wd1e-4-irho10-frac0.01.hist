Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2958     12.860  3.5606    11.798  51.43
   2   1.9113     26.200  2.1352    21.193  98.13
   3   1.0422     60.730  1.4819    41.498  144.69
   4   0.6004     79.910  0.8005    69.952  191.26
   5   2.4330     83.570  0.4151    86.198  237.82
   6   0.1528     95.210  0.2310    92.970  284.38
   7   0.1634     95.420  0.1605    95.113  330.91
   8   0.0946     96.910  0.1336    95.868  377.78
   9   0.2282     94.780  0.1092    96.593  424.40
  10   0.1706     95.580  0.1007    96.903  471.03
  11   0.1637     96.810  0.0922    97.082  517.68
  12   0.3552     96.130  0.0846    97.282  564.29
  13   0.3000     96.520  0.0778    97.597  611.18
  14   0.1174     97.630  0.0725    97.682  657.77
  15   0.0564     98.060  0.0678    97.865  704.69
  16   0.0588     98.000  0.0641    97.917  751.26
  17   0.0654     97.800  0.0612    98.053  797.88
  18   0.2193     97.570  0.0591    98.142  844.47
  19   0.0575     98.110  0.0571    98.138  891.09
  20   0.1902     97.650  0.0558    98.205  938.07
  21   0.0489     98.320  0.0519    98.338  984.63
  22   0.0530     98.190  0.0505    98.393  1031.16
  23   0.2019     97.770  0.0498    98.403  1077.78
  24   0.0608     98.150  0.0463    98.547  1124.76
  25   0.0758     98.130  0.0455    98.548  1171.39
  26   0.6781     96.630  0.0448    98.570  1218.02
  27   0.0392     98.560  0.0448    98.583  1264.65
  28   0.0704     98.040  0.0445    98.540  1311.31
  29   0.2551     97.460  0.0423    98.643  1358.27
  30   0.0523     98.530  0.0405    98.658  1404.88
  31   0.0413     98.650  0.0387    98.718  1451.43
  32   0.0753     98.350  0.0386    98.732  1497.99
  33   0.0430     98.600  0.0364    98.812  1544.59
  34   0.3695     97.070  0.0365    98.805  1591.17
  35   0.0439     98.510  0.0355    98.845  1638.17
  36   0.0481     98.560  0.0338    98.925  1684.75
  37   0.9211     97.360  0.0334    98.925  1731.39
  38   0.0398     98.690  0.0329    98.933  1778.01
  39   0.0496     98.330  0.0316    98.962  1824.67
  40   0.1637     98.030  0.0309    99.008  1871.21
  41   0.0526     98.530  0.0307    99.005  1917.78
  42   0.0714     97.950  0.0305    98.972  1964.34
  43   0.0475     98.600  0.0288    99.028  2011.21
  44   0.0487     98.660  0.0287    99.093  2057.85
  45   0.0972     98.390  0.0266    99.133  2104.48
  46   0.0380     98.690  0.0265    99.122  2151.10
  47   0.1883     97.900  0.0256    99.132  2197.70
  48   0.1082     97.890  0.0254    99.157  2244.36
  49   3.4010     92.860  0.0251    99.202  2291.30
  50   0.3494     97.480  0.0260    99.137  2337.90
  51   3.9308     96.110  0.0232    99.215  2384.82
  52   0.0505     98.720  0.0231    99.232  2431.38
  53   0.0647     98.300  0.0221    99.250  2477.99
  54   0.0418     98.580  0.0217    99.312  2524.61
  55   0.0337     98.880  0.0221    99.257  2571.26
  56   0.0328     98.920  0.0202    99.355  2617.85
  57   0.0988     98.380  0.0209    99.267  2664.44
  58   0.2967     97.730  0.0202    99.335  2711.01
  59   0.1670     97.750  0.0200    99.353  2757.57
  60   0.1336     98.110  0.0190    99.360  2804.44
  61   0.0456     98.600  0.0182    99.383  2851.07
  62   0.0487     98.450  0.0176    99.390  2897.66
  63   0.0347     98.800  0.0177    99.407  2944.49
  64   0.0560     98.490  0.0170    99.448  2991.11
  65   0.2416     97.700  0.0160    99.450  3037.69
  66   0.0362     98.900  0.0164    99.437  3084.30
  67   0.0347     98.860  0.0156    99.498  3130.93
  68   0.0358     98.830  0.0157    99.460  3177.83
  69   0.0328     98.960  0.0162    99.433  3224.36
  70   0.0348     98.930  0.0153    99.507  3270.93
  71   0.0473     98.640  0.0143    99.508  3317.72
  72   0.1777     98.100  0.0143    99.540  3364.28
  73   0.0328     98.990  0.0140    99.553  3410.84
  74   0.1516     98.530  0.0140    99.527  3457.44
  75   0.0352     98.870  0.0141    99.523  3504.08
  76   0.0337     98.890  0.0135    99.562  3551.02
  77   0.0369     98.860  0.0133    99.567  3597.57
  78   0.0472     98.760  0.0125    99.568  3644.44
  79   0.0589     98.390  0.0128    99.567  3690.99
  80   0.1674     97.830  0.0121    99.630  3737.85
  81   0.0603     98.500  0.0118    99.590  3784.47
  82   0.1540     97.500  0.0123    99.598  3831.08
  83   0.5831     96.820  0.0111    99.602  3877.72
  84   0.0374     98.820  0.0121    99.588  3924.30
  85   0.6600     96.700  0.0115    99.622  3970.93
  86   0.1891     98.010  0.0108    99.642  4017.56
  87   0.0489     98.730  0.0114    99.623  4064.49
  88   0.1345     98.260  0.0112    99.660  4111.27
  89   2.5975     96.020  0.0112    99.617  4158.16
  90   0.0736     98.070  0.0112    99.632  4204.79
