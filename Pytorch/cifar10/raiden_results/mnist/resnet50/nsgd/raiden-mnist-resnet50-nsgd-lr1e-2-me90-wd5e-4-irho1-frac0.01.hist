Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2533     91.840  1.5166    60.572  51.44
   2   0.1638     94.840  0.1757    94.427  98.48
   3   0.0963     96.970  0.1050    96.677  145.51
   4   0.0756     97.740  0.0763    97.568  192.57
   5   0.0554     98.310  0.0659    97.940  239.64
   6   0.0631     97.990  0.0563    98.215  286.75
   7   0.0717     97.640  0.0508    98.413  333.78
   8   0.0442     98.590  0.0482    98.482  380.80
   9   0.0445     98.490  0.0443    98.570  427.79
  10   0.0399     98.730  0.0408    98.690  474.82
  11   0.0645     97.870  0.0396    98.745  521.82
  12   0.0582     98.220  0.0366    98.842  568.83
  13   0.0500     98.350  0.0354    98.868  615.83
  14   0.0418     98.640  0.0326    98.948  662.83
  15   0.0504     98.490  0.0313    98.965  709.88
  16   0.0405     98.650  0.0295    99.030  756.89
  17   0.0430     98.690  0.0286    99.072  803.91
  18   0.0421     98.690  0.0257    99.148  850.94
  19   0.0369     98.860  0.0266    99.122  897.94
  20   0.0474     98.500  0.0246    99.180  944.97
  21   0.0458     98.420  0.0253    99.222  991.96
  22   0.0425     98.780  0.0221    99.268  1039.08
  23   0.0431     98.570  0.0234    99.247  1086.11
  24   0.0429     98.570  0.0220    99.287  1133.21
  25   0.0317     98.920  0.0203    99.333  1180.22
  26   0.0459     98.530  0.0214    99.302  1227.21
  27   0.0452     98.480  0.0200    99.338  1274.23
  28   0.0453     98.450  0.0181    99.372  1321.30
  29   0.0345     98.890  0.0174    99.437  1368.35
  30   0.0351     98.860  0.0192    99.365  1415.38
  31   0.0424     98.600  0.0178    99.398  1462.43
  32   0.0420     98.730  0.0165    99.478  1509.47
  33   0.0302     98.940  0.0161    99.453  1556.51
  34   0.0321     98.980  0.0152    99.527  1603.46
  35   0.0311     98.960  0.0141    99.535  1650.49
  36   0.0366     98.810  0.0155    99.528  1697.53
  37   0.0286     99.100  0.0153    99.498  1744.17
  38   0.0322     98.960  0.0129    99.592  1791.45
  39   0.0361     98.800  0.0138    99.535  1838.52
  40   0.0354     98.820  0.0127    99.590  1885.59
  41   0.0319     99.010  0.0127    99.578  1932.63
  42   0.0418     98.780  0.0114    99.627  1979.66
  43   0.0320     98.940  0.0111    99.642  2026.68
  44   0.0366     98.890  0.0109    99.655  2073.69
  45   0.0429     98.780  0.0105    99.650  2120.78
  46   0.0373     98.820  0.0101    99.680  2167.80
  47   0.0313     99.050  0.0089    99.725  2214.83
  48   0.0308     98.970  0.0084    99.718  2261.88
  49   0.0342     98.940  0.0091    99.700  2308.92
  50   0.0299     99.030  0.0083    99.745  2355.93
  51   0.0371     98.760  0.0083    99.725  2402.97
  52   0.0404     98.800  0.0079    99.735  2449.98
  53   0.0331     98.970  0.0076    99.765  2497.07
  54   0.0360     98.850  0.0070    99.775  2544.11
  55   0.0331     99.070  0.0072    99.775  2591.17
  56   0.0359     99.010  0.0063    99.795  2638.17
  57   0.0328     98.970  0.0063    99.812  2685.23
  58   0.0373     98.920  0.0068    99.772  2732.25
  59   0.0379     98.900  0.0051    99.845  2779.26
  60   0.0352     98.920  0.0056    99.832  2826.27
  61   0.0362     98.860  0.0052    99.857  2873.26
  62   0.0371     98.910  0.0057    99.825  2920.31
  63   0.0332     99.100  0.0044    99.868  2967.31
  64   0.0332     98.970  0.0048    99.855  3014.34
  65   0.0390     98.820  0.0045    99.868  3061.39
  66   0.0316     99.070  0.0040    99.887  3108.45
  67   0.0390     98.900  0.0039    99.902  3155.54
  68   0.0366     99.010  0.0037    99.905  3202.54
  69   0.0297     99.090  0.0034    99.902  3249.54
  70   0.0341     99.150  0.0034    99.900  3296.55
  71   0.0300     99.160  0.0037    99.890  3343.56
  72   0.0362     99.020  0.0031    99.925  3390.52
  73   0.0301     99.060  0.0029    99.927  3437.54
  74   0.0439     98.700  0.0030    99.912  3484.79
  75   0.0348     99.040  0.0030    99.930  3531.84
  76   0.0373     98.890  0.0028    99.940  3579.06
  77   0.0343     99.010  0.0030    99.922  3626.14
  78   0.0324     99.110  0.0021    99.950  3673.22
  79   0.0291     99.190  0.0024    99.927  3720.24
  80   0.0372     98.990  0.0023    99.937  3767.27
  81   0.0303     99.190  0.0025    99.932  3814.32
  82   0.0359     99.070  0.0020    99.963  3861.44
  83   0.0330     99.130  0.0019    99.965  3908.47
  84   0.0301     99.120  0.0021    99.952  3955.52
  85   0.0333     98.980  0.0024    99.947  4002.62
  86   0.0328     99.040  0.0023    99.935  4049.64
  87   0.0347     99.120  0.0020    99.957  4096.62
  88   0.0352     99.050  0.0020    99.952  4143.69
  89   0.0362     98.920  0.0018    99.958  4190.70
  90   0.0382     98.990  0.0020    99.948  4237.70
