Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.0373     23.670  4.3106    14.043  51.50
   2   1.5987     39.220  2.0374    22.788  98.06
   3   0.5282     79.970  1.0173    62.365  144.42
   4   0.3304     87.480  0.4282    83.530  191.05
   5   0.1858     94.300  0.2578    91.728  237.63
   6   0.1401     95.660  0.1612    95.073  284.20
   7   0.2172     93.750  0.1310    96.083  330.77
   8   0.0814     97.560  0.1130    96.658  377.31
   9   0.0724     97.560  0.0963    97.132  423.84
  10   0.1009     97.130  0.0916    97.295  470.56
  11   0.0737     97.860  0.0834    97.453  517.17
  12   0.0752     97.530  0.0791    97.532  563.75
  13   0.0842     97.460  0.0716    97.838  610.33
  14   0.0924     97.160  0.0694    97.875  656.93
  15   0.0682     97.840  0.0699    97.867  703.21
  16   0.0586     98.060  0.0659    98.012  749.73
  17   0.0586     98.100  0.0636    98.055  796.25
  18   0.0521     98.310  0.0621    98.092  842.79
  19   0.0578     98.370  0.0613    98.070  889.34
  20   0.0436     98.620  0.0589    98.183  935.89
  21   0.0482     98.480  0.0593    98.158  982.67
  22   0.0496     98.440  0.0576    98.217  1029.28
  23   0.0735     97.610  0.0566    98.283  1075.83
  24   0.0672     97.910  0.0562    98.282  1122.37
  25   0.0637     97.800  0.0554    98.300  1168.97
  26   0.0518     98.290  0.0552    98.358  1215.61
  27   0.0404     98.800  0.0533    98.352  1262.21
  28   0.0581     98.100  0.0554    98.223  1308.74
  29   0.0480     98.450  0.0536    98.288  1355.29
  30   0.0568     98.340  0.0523    98.402  1401.84
  31   0.0545     98.300  0.0482    98.487  1448.42
  32   0.0577     98.310  0.0485    98.440  1494.97
  33   0.0439     98.760  0.0501    98.477  1541.53
  34   0.0323     98.990  0.0469    98.513  1588.06
  35   0.0341     98.930  0.0472    98.532  1634.65
  36   0.0471     98.500  0.0462    98.587  1681.23
  37   0.0445     98.620  0.0495    98.468  1727.82
  38   0.0506     98.290  0.0426    98.702  1774.42
  39   0.0627     97.990  0.0440    98.590  1820.96
  40   0.0640     97.960  0.0434    98.640  1867.53
  41   0.0472     98.560  0.0429    98.652  1914.10
  42   0.0415     98.630  0.0419    98.712  1960.61
  43   0.0460     98.600  0.0387    98.747  2007.21
  44   0.0381     98.790  0.0410    98.727  2053.78
  45   0.0291     99.030  0.0380    98.815  2100.37
  46   0.0433     98.550  0.0373    98.823  2146.94
  47   0.0441     98.490  0.0368    98.857  2193.51
  48   0.0512     98.470  0.0374    98.823  2240.13
  49   0.0784     97.470  0.0343    98.890  2286.75
  50   0.0315     99.000  0.0355    98.868  2333.33
  51   0.0377     98.810  0.0337    98.933  2379.86
  52   0.0288     99.020  0.0320    99.050  2426.41
  53   0.0433     98.640  0.0312    99.002  2472.95
  54   0.0305     99.020  0.0317    99.022  2519.46
  55   0.0369     98.750  0.0308    98.995  2566.05
  56   0.0393     98.710  0.0296    99.037  2612.65
  57   0.0313     98.980  0.0290    99.095  2659.20
  58   0.0282     99.080  0.0261    99.135  2705.79
  59   0.0364     98.770  0.0273    99.163  2752.39
  60   0.0253     99.170  0.0256    99.180  2798.92
  61   0.0249     99.150  0.0247    99.213  2845.46
  62   0.0352     98.990  0.0230    99.292  2892.03
  63   0.0299     98.990  0.0217    99.317  2938.60
  64   0.0296     98.930  0.0224    99.280  2985.14
  65   0.0413     98.680  0.0195    99.383  3031.82
  66   0.0353     98.910  0.0182    99.393  3078.40
  67   0.0333     98.820  0.0192    99.357  3125.01
  68   0.0298     99.030  0.0189    99.368  3171.60
  69   0.0340     98.910  0.0167    99.442  3218.13
  70   0.0314     99.060  0.0161    99.480  3264.68
  71   0.0295     99.000  0.0153    99.525  3311.26
  72   0.0313     99.060  0.0141    99.555  3357.85
  73   0.0288     99.030  0.0141    99.552  3404.39
  74   0.0226     99.220  0.0126    99.590  3451.00
  75   0.0238     99.240  0.0109    99.658  3497.23
  76   0.0347     99.020  0.0103    99.687  3543.77
  77   0.0362     98.910  0.0113    99.613  3590.43
  78   0.0232     99.140  0.0092    99.725  3637.01
  79   0.0280     99.150  0.0078    99.735  3683.60
  80   0.0334     99.020  0.0082    99.747  3730.13
  81   0.0320     99.090  0.0075    99.760  3776.73
  82   0.0272     99.180  0.0066    99.785  3823.24
  83   0.0240     99.210  0.0066    99.797  3869.82
  84   0.0306     99.140  0.0064    99.800  3916.41
  85   0.0294     99.160  0.0053    99.853  3963.00
  86   0.0259     99.170  0.0054    99.833  4009.58
  87   0.0278     99.080  0.0052    99.827  4055.84
  88   0.0358     98.900  0.0051    99.842  4102.38
  89   0.0291     99.150  0.0047    99.855  4148.98
  90   0.0317     99.000  0.0050    99.842  4195.51
