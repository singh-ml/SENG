Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3031     11.450  3.7429    10.853  51.55
   2   2.3004     10.200  2.2983    11.712  98.35
   3   2.2555     15.590  2.2530    14.842  145.14
   4   1.1496     57.010  1.8106    33.220  191.60
   5   0.2975     90.620  0.7260    74.142  238.34
   6   0.1341     95.690  0.2305    92.842  285.14
   7   0.1338     95.700  0.1377    95.723  331.86
   8   0.0809     97.450  0.1116    96.548  378.62
   9   0.0577     98.090  0.0921    97.160  425.70
  10   0.0648     97.910  0.0823    97.515  472.79
  11   0.0780     97.600  0.0721    97.780  519.54
  12   0.0860     97.280  0.0656    97.925  566.59
  13   0.0537     98.250  0.0628    97.978  613.35
  14   0.0594     98.150  0.0604    98.160  660.50
  15   0.0510     98.360  0.0575    98.165  707.67
  16   0.0632     98.000  0.0536    98.328  754.72
  17   0.0615     98.080  0.0520    98.350  801.49
  18   0.0420     98.670  0.0538    98.333  848.26
  19   0.0682     97.820  0.0505    98.392  895.34
  20   0.0482     98.400  0.0496    98.473  942.59
  21   0.0574     98.300  0.0480    98.485  989.42
  22   0.0498     98.480  0.0446    98.625  1036.48
  23   0.0498     98.440  0.0453    98.522  1083.28
  24   0.0780     97.610  0.0438    98.615  1130.36
  25   0.0480     98.460  0.0429    98.680  1177.44
  26   0.0398     98.700  0.0439    98.627  1224.19
  27   0.0398     98.740  0.0416    98.683  1271.27
  28   0.0436     98.550  0.0423    98.678  1318.56
  29   0.0389     98.630  0.0407    98.663  1365.69
  30   0.0495     98.410  0.0382    98.790  1412.82
  31   0.0511     98.410  0.0383    98.772  1459.58
  32   0.0467     98.300  0.0387    98.788  1506.72
  33   0.0397     98.720  0.0382    98.768  1553.47
  34   0.0420     98.680  0.0372    98.850  1600.55
  35   0.0366     98.740  0.0348    98.937  1647.33
  36   0.0334     98.950  0.0382    98.788  1694.19
  37   0.0424     98.610  0.0343    98.918  1741.00
  38   0.0443     98.560  0.0341    98.932  1788.10
  39   0.0424     98.570  0.0349    98.877  1835.22
  40   0.0525     98.300  0.0328    98.960  1882.38
  41   0.0414     98.790  0.0336    98.907  1929.49
  42   0.0511     98.350  0.0310    99.033  1976.61
  43   0.0482     98.450  0.0302    99.050  2023.68
  44   0.0404     98.690  0.0306    99.013  2070.75
  45   0.0359     98.890  0.0281    99.110  2117.81
  46   0.0414     98.640  0.0291    99.048  2165.10
  47   0.0432     98.600  0.0282    99.108  2211.87
  48   0.0376     98.860  0.0283    99.098  2258.64
  49   0.0301     99.020  0.0280    99.123  2305.68
  50   0.0284     99.080  0.0269    99.123  2352.41
  51   0.0370     98.780  0.0248    99.232  2399.46
  52   0.0278     99.080  0.0256    99.145  2446.54
  53   0.0285     99.040  0.0245    99.200  2493.60
  54   0.0339     98.960  0.0240    99.218  2540.93
  55   0.0312     98.980  0.0233    99.222  2588.06
  56   0.0428     98.730  0.0217    99.287  2635.17
  57   0.0306     98.980  0.0220    99.292  2682.30
  58   0.0287     99.110  0.0189    99.398  2729.31
  59   0.0328     98.860  0.0189    99.360  2776.08
  60   0.0306     99.020  0.0195    99.363  2823.15
  61   0.0391     98.800  0.0178    99.408  2870.23
  62   0.0279     99.100  0.0183    99.387  2917.32
  63   0.0231     99.210  0.0163    99.447  2964.44
  64   0.0288     99.040  0.0160    99.497  3011.57
  65   0.0253     99.170  0.0140    99.565  3058.63
  66   0.0313     98.960  0.0131    99.578  3105.73
  67   0.0330     99.020  0.0122    99.600  3152.78
  68   0.0267     99.090  0.0135    99.565  3199.83
  69   0.0343     98.910  0.0118    99.623  3246.66
  70   0.0253     99.230  0.0111    99.655  3293.76
  71   0.0304     99.130  0.0105    99.658  3340.89
  72   0.0253     99.210  0.0099    99.712  3388.01
  73   0.0462     98.740  0.0092    99.710  3435.11
  74   0.0255     99.180  0.0088    99.710  3481.86
  75   0.0245     99.260  0.0077    99.757  3528.95
  76   0.0299     99.070  0.0072    99.757  3575.71
  77   0.0382     98.930  0.0069    99.788  3622.57
  78   0.0301     99.100  0.0062    99.827  3669.68
  79   0.0261     99.210  0.0061    99.818  3716.77
  80   0.0247     99.210  0.0061    99.817  3763.87
  81   0.0288     99.170  0.0053    99.845  3810.97
  82   0.0255     99.240  0.0053    99.820  3858.02
  83   0.0282     99.200  0.0049    99.857  3905.08
  84   0.0300     99.060  0.0049    99.860  3952.13
  85   0.0264     99.240  0.0046    99.885  3999.22
  86   0.0355     99.070  0.0044    99.875  4046.35
  87   0.0337     98.980  0.0041    99.870  4093.45
  88   0.0295     99.170  0.0038    99.873  4140.56
  89   0.0284     99.210  0.0038    99.880  4187.65
  90   0.0414     98.930  0.0043    99.860  4234.39
