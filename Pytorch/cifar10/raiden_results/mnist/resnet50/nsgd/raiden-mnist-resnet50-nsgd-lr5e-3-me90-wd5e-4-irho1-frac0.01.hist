Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '1', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3374     88.880  1.1070    60.198  53.01
   2   0.1414     95.480  0.2149    93.258  100.39
   3   0.1040     96.720  0.1293    95.922  147.52
   4   0.0742     97.390  0.0972    96.895  194.70
   5   0.0773     97.300  0.0815    97.403  241.88
   6   0.0557     98.130  0.0710    97.720  289.01
   7   0.0648     97.790  0.0647    97.960  336.14
   8   0.0570     98.040  0.0564    98.235  383.28
   9   0.0603     97.950  0.0530    98.337  430.42
  10   0.0478     98.330  0.0498    98.413  477.59
  11   0.0534     98.220  0.0451    98.608  524.74
  12   0.0509     98.290  0.0437    98.573  571.94
  13   0.0489     98.380  0.0400    98.698  619.11
  14   0.0567     98.070  0.0380    98.805  666.23
  15   0.0374     98.670  0.0386    98.738  713.39
  16   0.0425     98.600  0.0360    98.845  760.51
  17   0.0323     98.870  0.0344    98.888  807.66
  18   0.0401     98.670  0.0324    98.962  854.77
  19   0.0482     98.430  0.0306    98.997  901.90
  20   0.0599     98.070  0.0300    99.040  949.16
  21   0.0340     98.930  0.0289    99.063  996.31
  22   0.0425     98.700  0.0280    99.107  1043.40
  23   0.0368     98.730  0.0275    99.085  1090.52
  24   0.0464     98.430  0.0263    99.152  1137.64
  25   0.0387     98.730  0.0259    99.145  1184.77
  26   0.0360     98.740  0.0248    99.190  1231.96
  27   0.0476     98.420  0.0223    99.227  1279.13
  28   0.0378     98.720  0.0206    99.373  1326.30
  29   0.0368     98.710  0.0214    99.298  1373.42
  30   0.0409     98.610  0.0225    99.290  1420.60
  31   0.0419     98.590  0.0199    99.355  1467.75
  32   0.0335     98.860  0.0204    99.313  1514.88
  33   0.0535     98.360  0.0195    99.367  1562.01
  34   0.0380     98.810  0.0190    99.405  1609.18
  35   0.0335     98.820  0.0177    99.455  1656.35
  36   0.0339     98.920  0.0182    99.378  1703.50
  37   0.0341     98.810  0.0168    99.438  1750.78
  38   0.0444     98.580  0.0177    99.397  1797.92
  39   0.0323     98.900  0.0166    99.447  1845.04
  40   0.0298     99.010  0.0167    99.448  1892.12
  41   0.0354     98.950  0.0165    99.442  1939.21
  42   0.0354     98.840  0.0157    99.482  1986.37
  43   0.0368     98.880  0.0151    99.487  2033.54
  44   0.0309     99.020  0.0136    99.563  2080.66
  45   0.0244     99.140  0.0144    99.510  2127.82
  46   0.0316     98.840  0.0133    99.577  2174.95
  47   0.0373     98.900  0.0124    99.603  2222.04
  48   0.0355     98.800  0.0119    99.597  2269.21
  49   0.0383     98.790  0.0121    99.623  2316.35
  50   0.0311     98.960  0.0111    99.630  2363.52
  51   0.0404     98.760  0.0117    99.622  2410.67
  52   0.0301     99.080  0.0106    99.648  2457.82
  53   0.0366     98.850  0.0112    99.612  2504.98
  54   0.0363     98.920  0.0116    99.625  2552.11
  55   0.0369     98.960  0.0100    99.675  2599.22
  56   0.0306     99.030  0.0107    99.663  2646.36
  57   0.0390     98.730  0.0095    99.705  2693.47
  58   0.0292     98.980  0.0099    99.687  2740.64
  59   0.0448     98.690  0.0094    99.705  2787.75
  60   0.0261     99.060  0.0093    99.712  2834.92
  61   0.0369     98.970  0.0089    99.707  2882.11
  62   0.0302     99.110  0.0093    99.698  2929.23
  63   0.0355     98.850  0.0088    99.707  2976.37
  64   0.0321     98.970  0.0084    99.717  3023.46
  65   0.0328     98.870  0.0078    99.748  3070.61
  66   0.0373     98.860  0.0082    99.733  3117.77
  67   0.0406     98.840  0.0081    99.735  3164.88
  68   0.0351     99.030  0.0071    99.785  3212.02
  69   0.0303     99.100  0.0074    99.767  3259.19
  70   0.0397     98.860  0.0070    99.777  3306.29
  71   0.0321     99.030  0.0066    99.782  3353.48
  72   0.0333     99.020  0.0069    99.788  3400.62
  73   0.0410     98.780  0.0064    99.808  3447.69
  74   0.0324     99.000  0.0065    99.802  3494.80
  75   0.0383     98.850  0.0065    99.783  3541.89
  76   0.0327     98.930  0.0060    99.812  3589.03
  77   0.0312     99.000  0.0061    99.820  3636.40
  78   0.0339     98.990  0.0053    99.842  3683.58
  79   0.0375     98.820  0.0055    99.847  3730.75
  80   0.0295     99.050  0.0055    99.820  3777.90
  81   0.0289     99.040  0.0050    99.852  3825.11
  82   0.0333     98.970  0.0058    99.833  3872.27
  83   0.0403     98.780  0.0053    99.832  3919.37
  84   0.0309     99.050  0.0053    99.833  3966.49
  85   0.0334     99.010  0.0048    99.852  4013.63
  86   0.0308     99.020  0.0054    99.840  4060.81
  87   0.0332     98.990  0.0046    99.850  4108.00
  88   0.0358     98.990  0.0051    99.868  4155.17
  89   0.0315     99.020  0.0045    99.868  4202.36
  90   0.0319     98.980  0.0044    99.868  4249.51
