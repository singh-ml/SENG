Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2974     11.950  3.8638    16.367  51.64
   2   1.8326     31.830  1.9674    27.147  98.70
   3   0.6239     81.030  1.1769    59.428  145.69
   4   0.1743     94.730  0.3779    88.492  192.64
   5   0.1423     95.670  0.1990    93.997  239.99
   6   0.0943     96.820  0.1439    95.698  287.31
   7   0.0830     97.280  0.1107    96.562  334.24
   8   0.1220     96.100  0.1045    96.777  381.25
   9   0.0936     96.850  0.0890    97.278  428.57
  10   0.0950     96.940  0.0826    97.432  475.56
  11   0.0813     97.190  0.0836    97.407  522.60
  12   0.0868     97.660  0.0807    97.582  569.61
  13   0.1308     97.700  0.0689    97.843  616.61
  14   0.0695     97.770  0.0715    97.970  663.63
  15   0.0468     98.420  0.0593    98.082  710.62
  16   0.0513     98.360  0.0562    98.245  757.58
  17   0.0449     98.510  0.0533    98.270  804.88
  18   0.0410     98.590  0.0504    98.410  852.15
  19   0.0525     98.270  0.0483    98.465  899.39
  20   0.0500     98.420  0.0471    98.512  946.67
  21   0.0395     98.620  0.0448    98.562  993.69
  22   0.0446     98.560  0.0452    98.572  1040.68
  23   0.0552     98.160  0.0405    98.658  1087.97
  24   0.0393     98.670  0.0421    98.658  1135.31
  25   0.0337     98.920  0.0420    98.643  1182.30
  26   0.0408     98.650  0.0398    98.712  1229.64
  27   0.0361     98.810  0.0406    98.708  1276.62
  28   0.0381     98.780  0.0366    98.837  1323.64
  29   0.0482     98.400  0.0358    98.852  1370.66
  30   0.0386     98.810  0.0353    98.863  1417.98
  31   0.0421     98.730  0.0348    98.893  1465.30
  32   0.0403     98.700  0.0341    98.902  1512.34
  33   0.0414     98.660  0.0342    98.870  1559.33
  34   0.0338     98.940  0.0308    99.010  1606.62
  35   0.0352     98.810  0.0304    99.063  1653.90
  36   0.0370     98.700  0.0315    98.942  1701.22
  37   0.0461     98.500  0.0291    99.035  1748.19
  38   0.0493     98.460  0.0290    99.067  1795.18
  39   0.0378     98.790  0.0280    99.117  1842.15
  40   0.0372     98.740  0.0269    99.103  1889.53
  41   0.0339     98.920  0.0279    99.068  1936.56
  42   0.1696     98.350  0.0268    99.117  1983.54
  43   0.0444     98.510  0.0323    98.982  2030.50
  44   0.0476     98.550  0.0273    99.135  2077.46
  45   0.0320     98.900  0.0265    99.115  2124.44
  46   0.0308     99.000  0.0251    99.205  2171.83
  47   0.0321     98.890  0.0236    99.252  2219.18
  48   0.0352     98.920  0.0234    99.183  2266.17
  49   0.0425     98.660  0.0237    99.220  2313.51
  50   0.0328     98.950  0.0224    99.270  2360.45
  51   0.0384     98.770  0.0203    99.328  2407.74
  52   0.0312     98.970  0.0198    99.345  2454.72
  53   0.0225     99.310  0.0194    99.367  2501.97
  54   0.0329     98.980  0.0191    99.422  2548.97
  55   0.0317     99.060  0.0178    99.417  2595.98
  56   0.0242     99.170  0.0173    99.470  2643.31
  57   0.0332     99.010  0.0181    99.390  2690.66
  58   0.0375     98.830  0.0167    99.473  2737.68
  59   0.0289     99.040  0.0168    99.450  2785.02
  60   0.0302     99.020  0.0161    99.467  2832.30
  61   0.0300     99.110  0.0150    99.492  2879.32
  62   0.0322     99.010  0.0141    99.562  2926.63
  63   0.0255     99.220  0.0131    99.577  2973.66
  64   0.0353     98.870  0.0137    99.565  3020.72
  65   0.0270     99.110  0.0126    99.585  3067.73
  66   0.0324     98.950  0.0120    99.630  3114.80
  67   0.0306     99.000  0.0114    99.632  3162.13
  68   0.0335     99.030  0.0108    99.677  3209.48
  69   0.0251     99.220  0.0109    99.643  3256.48
  70   0.0418     98.770  0.0095    99.710  3303.41
  71   0.0246     99.280  0.0103    99.692  3350.45
  72   0.0317     99.010  0.0097    99.683  3397.79
  73   0.0274     99.230  0.0090    99.717  3445.09
  74   0.0219     99.310  0.0089    99.728  3492.11
  75   0.0275     99.180  0.0082    99.767  3539.15
  76   0.0280     99.160  0.0086    99.722  3586.11
  77   0.0373     99.010  0.0083    99.725  3633.45
  78   0.0315     99.030  0.0080    99.750  3680.78
  79   0.0308     99.050  0.0081    99.727  3727.82
  80   0.0325     99.070  0.0080    99.767  3774.83
  81   0.0262     99.190  0.0073    99.778  3822.03
  82   0.0261     99.220  0.0075    99.770  3869.06
  83   0.0321     99.130  0.0070    99.792  3916.22
  84   0.0264     99.210  0.0076    99.757  3963.20
  85   0.0338     99.100  0.0077    99.790  4010.15
  86   0.0241     99.170  0.0075    99.770  4057.15
  87   0.0308     99.110  0.0074    99.772  4104.26
  88   0.0291     99.070  0.0072    99.787  4151.60
  89   0.0346     98.970  0.0069    99.775  4198.62
  90   0.0324     99.080  0.0066    99.795  4245.92
