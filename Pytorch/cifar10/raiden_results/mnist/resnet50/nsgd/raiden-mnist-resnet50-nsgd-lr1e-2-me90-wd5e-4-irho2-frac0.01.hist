Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '2', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3965     18.920  3.2407    13.232  51.83
   2   0.3443     89.110  1.1442    59.377  99.11
   3   0.1847     94.870  0.2459    92.218  146.32
   4   1.0872     82.320  0.1359    95.785  193.62
   5   0.0811     97.290  0.0989    96.917  240.90
   6   0.0633     97.880  0.0766    97.583  288.18
   7   0.0785     97.580  0.0643    97.957  335.44
   8   0.0470     98.490  0.0599    98.160  382.80
   9   0.0581     98.090  0.0535    98.322  430.02
  10   0.1128     97.660  0.0495    98.440  477.29
  11   0.0412     98.720  0.0459    98.565  524.51
  12   0.0598     98.320  0.0440    98.620  571.78
  13   0.0981     97.840  0.0418    98.695  619.03
  14   0.0505     98.170  0.0375    98.815  666.33
  15   0.0490     98.430  0.0388    98.725  713.59
  16   0.0437     98.580  0.0344    98.907  760.90
  17   0.0453     98.460  0.0327    98.967  808.15
  18   9.6178     87.040  0.0300    99.068  855.45
  19   0.0316     98.880  0.0303    99.028  902.67
  20   0.0371     98.930  0.0301    99.037  949.92
  21   0.0429     98.610  0.0296    99.017  997.17
  22   0.0514     98.280  0.0276    99.127  1044.47
  23   0.0360     98.860  0.0262    99.155  1091.77
  24   0.0502     99.040  0.0240    99.222  1139.04
  25   0.0420     98.700  0.0250    99.163  1186.33
  26   0.0288     98.990  0.0233    99.238  1233.55
  27   0.0351     98.880  0.0240    99.208  1280.74
  28   0.0407     98.670  0.0243    99.230  1327.97
  29   0.0397     98.790  0.0211    99.297  1375.21
  30   0.0422     98.640  0.0201    99.365  1422.65
  31   0.0392     98.910  0.0217    99.277  1469.93
  32   0.0374     98.760  0.0203    99.327  1517.20
  33   0.0451     98.660  0.0185    99.427  1564.51
  34   0.0284     99.070  0.0186    99.392  1611.77
  35   0.0380     98.880  0.0186    99.370  1658.98
  36   0.0370     98.840  0.0181    99.430  1706.23
  37   0.0381     98.730  0.0167    99.457  1753.52
  38   0.0315     99.010  0.0167    99.445  1800.79
  39   0.0309     99.060  0.0158    99.478  1848.10
  40   0.0361     98.950  0.0156    99.513  1895.37
  41   0.0250     99.230  0.0165    99.437  1942.63
  42   0.0322     98.900  0.0148    99.530  1989.99
  43   0.0367     98.830  0.0142    99.547  2037.22
  44   0.0362     98.880  0.0139    99.550  2084.43
  45   0.0367     98.970  0.0127    99.577  2131.73
  46   0.0310     99.010  0.0123    99.598  2178.99
  47   0.0335     98.990  0.0123    99.602  2226.29
  48   0.0354     98.900  0.0117    99.633  2273.61
  49   0.0342     98.980  0.0123    99.612  2320.86
  50   0.0315     99.060  0.0113    99.622  2368.11
  51   0.0239     99.240  0.0108    99.658  2415.36
  52   0.0276     99.100  0.0092    99.705  2462.63
  53   0.0254     99.070  0.0098    99.683  2510.06
  54   0.0257     99.180  0.0090    99.710  2557.36
  55   0.0377     98.890  0.0080    99.745  2604.64
  56   0.0375     98.980  0.0086    99.717  2651.93
  57   0.0475     98.580  0.0093    99.690  2699.24
  58   0.0332     99.080  0.0078    99.752  2746.48
  59   0.0369     98.900  0.0082    99.732  2793.73
  60   0.0464     98.600  0.0069    99.778  2841.01
  61   0.0318     99.020  0.0067    99.782  2888.24
  62   0.0377     98.790  0.0063    99.792  2935.60
  63   0.0285     99.010  0.0060    99.813  2982.91
  64   0.0349     99.120  0.0062    99.802  3030.13
  65   0.0519     98.650  0.0058    99.822  3077.43
  66   0.0317     99.080  0.0052    99.852  3124.73
  67   0.0365     98.970  0.0046    99.863  3172.04
  68   0.0388     98.840  0.0048    99.863  3219.31
  69   0.0387     98.910  0.0047    99.857  3266.58
  70   0.0380     98.930  0.0043    99.868  3313.84
  71   0.0307     98.940  0.0044    99.867  3361.12
  72   0.0335     98.950  0.0046    99.863  3408.61
  73   0.0317     99.060  0.0037    99.898  3455.92
  74   0.0455     98.770  0.0041    99.880  3503.33
  75   0.0377     98.950  0.0034    99.902  3550.65
  76   0.0359     99.040  0.0033    99.892  3597.95
  77   0.0351     98.920  0.0031    99.913  3645.25
  78   0.0389     99.000  0.0029    99.918  3692.51
  79   0.0339     99.110  0.0029    99.935  3739.80
  80   0.0295     99.120  0.0027    99.915  3787.13
  81   0.0349     99.070  0.0031    99.910  3834.45
  82   0.0387     98.980  0.0021    99.950  3881.74
  83   0.0355     99.070  0.0026    99.935  3929.09
  84   0.0385     98.930  0.0025    99.943  3976.35
  85   0.0340     99.020  0.0026    99.927  4023.60
  86   0.0381     98.900  0.0023    99.942  4070.86
  87   0.0366     99.070  0.0025    99.927  4118.13
  88   0.0344     99.110  0.0025    99.938  4165.41
  89   0.0374     98.970  0.0022    99.950  4212.78
  90   0.0455     98.910  0.0023    99.940  4260.05
