Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3571     89.310  1.1539    58.563  51.54
   2   0.1382     95.490  0.2279    92.840  98.57
   3   0.1189     96.030  0.1366    95.672  145.59
   4   0.0809     97.220  0.1012    96.800  192.59
   5   0.0721     97.730  0.0852    97.423  239.63
   6   0.0678     97.770  0.0765    97.598  286.70
   7   0.0629     97.990  0.0656    97.930  333.80
   8   0.0730     97.450  0.0621    98.003  380.89
   9   0.0587     98.050  0.0552    98.275  427.93
  10   0.0568     98.240  0.0511    98.365  474.94
  11   0.0459     98.500  0.0490    98.425  521.97
  12   0.0519     98.290  0.0439    98.573  568.98
  13   0.0497     98.470  0.0421    98.620  616.03
  14   0.0552     98.080  0.0405    98.738  663.09
  15   0.0531     98.220  0.0398    98.680  710.18
  16   0.0418     98.690  0.0378    98.800  757.22
  17   0.0473     98.500  0.0347    98.865  804.28
  18   0.0507     98.270  0.0354    98.827  851.28
  19   0.0406     98.520  0.0331    98.915  898.30
  20   0.0505     98.440  0.0313    98.995  945.30
  21   0.0437     98.490  0.0314    98.983  992.35
  22   0.0510     98.340  0.0297    99.017  1039.42
  23   0.0351     98.720  0.0279    99.082  1086.48
  24   0.0348     98.870  0.0288    99.072  1133.57
  25   0.0491     98.390  0.0280    99.092  1180.59
  26   0.0523     98.160  0.0257    99.220  1227.67
  27   0.0406     98.720  0.0258    99.143  1274.77
  28   0.0334     98.830  0.0252    99.148  1321.76
  29   0.0396     98.670  0.0247    99.177  1368.80
  30   0.0304     98.970  0.0240    99.195  1415.86
  31   0.0424     98.720  0.0219    99.322  1462.89
  32   0.0457     98.730  0.0224    99.245  1509.97
  33   0.0457     98.610  0.0215    99.293  1557.03
  34   0.0455     98.570  0.0204    99.310  1604.08
  35   0.0376     98.760  0.0211    99.318  1651.11
  36   0.0319     99.010  0.0198    99.352  1698.12
  37   0.0348     98.880  0.0196    99.368  1745.15
  38   0.0323     99.100  0.0194    99.330  1792.16
  39   0.0378     98.930  0.0182    99.410  1839.19
  40   0.0359     98.910  0.0185    99.373  1886.26
  41   0.0340     99.020  0.0179    99.387  1933.32
  42   0.0358     98.890  0.0181    99.375  1980.41
  43   0.0322     98.950  0.0176    99.383  2027.43
  44   0.0475     98.750  0.0168    99.418  2074.59
  45   0.0273     99.130  0.0171    99.415  2121.62
  46   0.0363     98.920  0.0171    99.388  2168.67
  47   0.0375     98.880  0.0161    99.458  2215.71
  48   0.0318     99.060  0.0153    99.487  2262.76
  49   0.0280     99.140  0.0144    99.518  2309.83
  50   0.0331     99.030  0.0152    99.497  2356.86
  51   0.0304     99.170  0.0149    99.470  2403.91
  52   0.0363     98.870  0.0143    99.523  2450.95
  53   0.0325     99.070  0.0148    99.498  2498.00
  54   0.0387     98.780  0.0143    99.512  2545.02
  55   0.0270     99.190  0.0142    99.535  2592.00
  56   0.0338     98.970  0.0142    99.523  2639.05
  57   0.0372     98.920  0.0119    99.617  2686.08
  58   0.0420     98.790  0.0123    99.575  2733.12
  59   0.0379     98.900  0.0129    99.553  2780.14
  60   0.0419     98.880  0.0119    99.597  2827.29
  61   0.0329     98.980  0.0109    99.643  2874.31
  62   0.0404     98.970  0.0118    99.613  2921.38
  63   0.0404     98.900  0.0109    99.628  2968.45
  64   0.0380     98.970  0.0109    99.622  3015.54
  65   0.0344     98.990  0.0099    99.673  3062.59
  66   0.0368     98.980  0.0105    99.640  3109.63
  67   0.0386     98.920  0.0108    99.620  3156.64
  68   0.0348     98.990  0.0111    99.595  3203.64
  69   0.0425     98.680  0.0106    99.620  3250.67
  70   0.0434     98.810  0.0096    99.672  3297.69
  71   0.0339     98.940  0.0108    99.637  3344.78
  72   0.0393     98.940  0.0102    99.652  3391.84
  73   0.0409     98.830  0.0094    99.697  3438.92
  74   0.0357     98.960  0.0099    99.658  3485.99
  75   0.0513     98.770  0.0093    99.695  3533.03
  76   0.0457     98.850  0.0108    99.645  3580.07
  77   0.0346     98.920  0.0092    99.670  3627.09
  78   0.0408     98.950  0.0089    99.690  3674.09
  79   0.0323     99.020  0.0086    99.693  3721.17
  80   0.0346     99.100  0.0092    99.660  3768.28
  81   0.0347     99.100  0.0093    99.683  3815.34
  82   0.0367     98.960  0.0082    99.703  3862.42
  83   0.0335     99.030  0.0092    99.693  3909.46
  84   0.0395     99.050  0.0088    99.662  3956.49
  85   0.0380     98.940  0.0083    99.720  4003.49
  86   0.0429     98.840  0.0072    99.755  4050.53
  87   0.0438     98.810  0.0078    99.738  4097.55
  88   0.0411     98.850  0.0070    99.765  4144.63
  89   0.0311     99.170  0.0076    99.728  4191.65
  90   0.0333     99.120  0.0068    99.772  4238.72
