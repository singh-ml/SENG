Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--frac', '0.01', '--bh', '256', '--irho', '5', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3302     89.660  1.1393    59.517  51.54
   2   0.1658     94.740  0.2197    93.218  98.62
   3   0.1129     96.650  0.1358    95.773  145.72
   4   0.0929     97.000  0.1037    96.728  192.76
   5   0.0912     97.020  0.0863    97.262  239.78
   6   0.0763     97.590  0.0741    97.658  286.84
   7   0.0611     98.110  0.0658    97.997  334.11
   8   0.0720     97.740  0.0591    98.115  381.20
   9   0.0593     98.050  0.0551    98.210  428.24
  10   0.0554     98.090  0.0514    98.407  475.32
  11   0.0544     98.320  0.0466    98.485  522.41
  12   0.0509     98.380  0.0449    98.585  569.46
  13   0.0623     98.140  0.0434    98.603  616.47
  14   0.0516     98.400  0.0405    98.662  663.49
  15   0.0455     98.460  0.0399    98.663  710.54
  16   0.0377     98.810  0.0368    98.775  757.62
  17   0.0431     98.680  0.0373    98.792  804.72
  18   0.0572     98.200  0.0343    98.875  851.78
  19   0.0405     98.740  0.0308    99.018  898.86
  20   0.0415     98.730  0.0312    99.023  945.99
  21   0.0419     98.610  0.0308    99.037  993.09
  22   0.0436     98.600  0.0287    99.047  1040.13
  23   0.0471     98.490  0.0286    99.095  1087.14
  24   0.0551     98.480  0.0266    99.143  1134.23
  25   0.0461     98.560  0.0270    99.112  1181.31
  26   0.0333     98.940  0.0256    99.138  1228.38
  27   0.0387     98.680  0.0237    99.217  1275.45
  28   0.0431     98.630  0.0240    99.232  1322.52
  29   0.0432     98.590  0.0224    99.253  1369.62
  30   0.0400     98.730  0.0228    99.208  1416.75
  31   0.0353     98.810  0.0232    99.210  1463.77
  32   0.0377     98.820  0.0208    99.302  1510.81
  33   0.0378     98.910  0.0207    99.337  1557.86
  34   0.0327     99.020  0.0213    99.275  1604.96
  35   0.0357     98.930  0.0208    99.287  1652.05
  36   0.0341     98.940  0.0199    99.350  1699.12
  37   0.0340     98.870  0.0180    99.373  1746.18
  38   0.0399     98.740  0.0195    99.352  1793.21
  39   0.0412     98.760  0.0186    99.353  1840.25
  40   0.0354     98.870  0.0199    99.362  1887.27
  41   0.0420     98.790  0.0175    99.427  1934.39
  42   0.0327     99.030  0.0166    99.447  1981.43
  43   0.0326     98.970  0.0165    99.477  2028.52
  44   0.0346     98.880  0.0152    99.490  2075.60
  45   0.0397     98.710  0.0156    99.472  2122.67
  46   0.0423     98.630  0.0149    99.512  2169.75
  47   0.0473     98.710  0.0143    99.505  2216.79
  48   0.0512     98.490  0.0148    99.513  2263.86
  49   0.0364     98.860  0.0148    99.485  2311.17
  50   0.0451     98.730  0.0145    99.492  2358.22
  51   0.0343     98.990  0.0148    99.480  2405.29
  52   0.0460     98.700  0.0143    99.493  2452.39
  53   0.0519     98.470  0.0146    99.508  2499.48
  54   0.0412     98.770  0.0134    99.537  2546.57
  55   0.0429     98.620  0.0126    99.598  2593.61
  56   0.0418     98.760  0.0125    99.577  2640.67
  57   0.0349     98.980  0.0126    99.555  2687.74
  58   0.0466     98.690  0.0122    99.577  2734.84
  59   0.0432     98.720  0.0119    99.562  2781.90
  60   0.0368     98.910  0.0112    99.602  2829.00
  61   0.0361     98.920  0.0120    99.597  2876.19
  62   0.0335     98.940  0.0114    99.598  2923.26
  63   0.0388     98.860  0.0119    99.592  2970.29
  64   0.0311     99.030  0.0105    99.637  3017.33
  65   0.0432     98.660  0.0106    99.613  3064.33
  66   0.0515     98.620  0.0106    99.648  3111.40
  67   0.0382     98.960  0.0104    99.637  3158.43
  68   0.0460     98.670  0.0099    99.635  3205.49
  69   0.0647     98.320  0.0099    99.672  3252.57
  70   0.0390     98.860  0.0103    99.635  3299.65
  71   0.0556     98.480  0.0095    99.683  3346.68
  72   0.0357     98.950  0.0096    99.678  3393.73
  73   0.0362     99.060  0.0092    99.682  3440.76
  74   0.0392     98.850  0.0091    99.673  3487.93
  75   0.0511     98.650  0.0091    99.692  3535.05
  76   0.0392     98.840  0.0093    99.683  3582.10
  77   0.0386     98.930  0.0096    99.662  3629.20
  78   0.0384     98.870  0.0099    99.652  3676.29
  79   0.0494     98.610  0.0085    99.693  3723.41
  80   0.0396     98.900  0.0091    99.688  3770.46
  81   0.0440     98.710  0.0090    99.677  3817.49
  82   0.0393     98.940  0.0085    99.693  3864.55
  83   0.0417     98.860  0.0078    99.715  3911.65
  84   0.0401     98.970  0.0078    99.748  3958.77
  85   0.0319     99.190  0.0074    99.728  4005.89
  86   0.0372     99.000  0.0072    99.772  4052.99
  87   0.0451     98.660  0.0063    99.780  4100.06
  88   0.0425     98.800  0.0068    99.750  4147.14
  89   0.0379     99.010  0.0063    99.797  4194.21
  90   0.0473     98.740  0.0073    99.740  4241.26
