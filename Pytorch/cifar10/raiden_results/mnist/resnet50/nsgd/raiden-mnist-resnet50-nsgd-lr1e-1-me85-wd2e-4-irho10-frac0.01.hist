Use GPU: 0 for training
==> Running with ['main_nsgd.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '--frac', '0.01', '--bh', '256', '--irho', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 33533590528 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.6716     32.450  3.9843    18.043  51.67
   2   1.2938     49.250  1.4841    41.218  98.53
   3   1.0792     54.530  1.2792    49.405  145.38
   4   0.7063     72.750  0.9492    63.837  191.84
   5   0.7012     71.030  0.7097    73.030  238.66
   6   0.5757     79.600  0.5176    82.568  285.48
   7   0.3310     89.490  0.3614    88.942  332.29
   8   0.2363     92.680  0.2883    91.518  379.11
   9   0.1777     94.990  0.2127    93.788  425.65
  10   0.1424     95.780  0.1768    94.783  472.19
  11   0.1481     95.300  0.1549    95.385  518.73
  12   0.1570     95.810  0.1295    96.132  565.58
  13   0.0998     97.000  0.1185    96.458  612.08
  14   0.0851     97.390  0.1031    96.962  658.55
  15   0.0722     97.890  0.0957    97.102  705.47
  16   0.0956     97.090  0.0890    97.307  752.32
  17   0.0976     97.310  0.0823    97.582  798.85
  18   0.0639     98.020  0.0834    97.500  845.37
  19   0.0800     97.840  0.0782    97.612  892.35
  20   0.0460     98.600  0.0747    97.748  939.16
  21   0.0836     97.460  0.0700    97.892  986.01
  22   0.0886     97.400  0.0660    97.975  1033.01
  23   0.0741     97.680  0.0670    98.008  1079.49
  24   0.0646     97.970  0.0604    98.157  1126.01
  25   0.0480     98.620  0.0592    98.222  1172.53
  26   0.0589     98.300  0.0559    98.328  1219.04
  27   0.0552     98.230  0.0535    98.390  1265.91
  28   0.0800     97.680  0.0522    98.367  1312.36
  29   0.0542     98.210  0.0524    98.428  1359.16
  30   0.0585     98.290  0.0538    98.365  1405.71
  31   0.0485     98.490  0.0520    98.415  1452.49
  32   0.0464     98.550  0.0495    98.455  1499.36
  33   0.0499     98.360  0.0489    98.512  1545.89
  34   0.0480     98.650  0.0462    98.590  1592.42
  35   0.0452     98.540  0.0453    98.552  1638.92
  36   0.0460     98.670  0.0451    98.608  1685.79
  37   0.0647     98.110  0.0440    98.608  1732.68
  38   0.0506     98.400  0.0417    98.757  1779.53
  39   0.0429     98.730  0.0409    98.732  1826.03
  40   0.0548     98.410  0.0400    98.753  1872.52
  41   0.0381     98.760  0.0403    98.745  1919.34
  42   0.0534     98.190  0.0395    98.812  1965.87
  43   0.0557     98.190  0.0368    98.885  2012.38
  44   0.0389     98.870  0.0384    98.842  2058.88
  45   0.0544     98.360  0.0345    98.915  2105.42
  46   0.0564     98.150  0.0331    98.990  2152.28
  47   0.0597     98.400  0.0362    98.837  2199.15
  48   0.0388     98.780  0.0343    98.933  2245.62
  49   0.0346     98.850  0.0317    99.017  2292.46
  50   0.0360     98.950  0.0305    99.033  2339.34
  51   0.0370     98.820  0.0286    99.080  2385.85
  52   0.0324     98.990  0.0278    99.132  2432.38
  53   0.0506     98.440  0.0274    99.170  2478.92
  54   0.0370     98.840  0.0276    99.133  2525.52
  55   0.0313     99.190  0.0247    99.192  2572.36
  56   0.0364     98.840  0.0251    99.207  2619.23
  57   0.0320     98.990  0.0244    99.200  2665.71
  58   0.0330     98.970  0.0231    99.263  2712.56
  59   0.0339     98.930  0.0226    99.270  2759.39
  60   0.0266     99.200  0.0194    99.402  2805.97
  61   0.0465     98.640  0.0197    99.393  2852.53
  62   0.0454     98.670  0.0192    99.377  2899.44
  63   0.0337     99.000  0.0194    99.380  2945.96
  64   0.0462     98.710  0.0173    99.430  2992.43
  65   0.0319     99.040  0.0165    99.478  3038.94
  66   0.0326     99.010  0.0158    99.515  3085.36
  67   0.0328     98.960  0.0148    99.518  3131.91
  68   0.0343     98.940  0.0136    99.562  3178.40
  69   0.0279     99.210  0.0135    99.558  3225.42
  70   0.0301     99.090  0.0122    99.615  3272.25
  71   0.0309     99.090  0.0111    99.670  3319.18
  72   0.0346     99.010  0.0109    99.680  3365.98
  73   0.0383     98.920  0.0104    99.700  3412.79
  74   0.0325     99.000  0.0110    99.633  3459.61
  75   0.0355     99.030  0.0099    99.685  3506.11
  76   0.0318     99.040  0.0094    99.713  3552.58
  77   0.0301     99.080  0.0094    99.705  3599.08
  78   0.0353     99.010  0.0086    99.738  3645.70
  79   0.0315     99.020  0.0090    99.745  3692.23
  80   0.0289     99.120  0.0085    99.725  3739.04
  81   0.0344     99.090  0.0078    99.768  3786.14
  82   0.0287     99.120  0.0085    99.728  3832.96
  83   0.0453     98.780  0.0081    99.747  3879.84
  84   0.0314     99.100  0.0080    99.775  3926.71
  85   0.0396     98.890  0.0077    99.775  3973.22
