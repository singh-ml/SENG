Use GPU: 0 for training
==> Running with ['main_adahessian.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 32179693056 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   1.8591     34.340  2.0043    26.268  132.85
   2   1.6689     44.760  1.7989    37.497  261.13
   3   1.3985     56.630  1.6026    47.543  389.46
   4   1.0168     69.030  1.3098    58.882  517.88
   5   0.7618     75.000  0.9545    69.938  646.28
   6   0.5957     81.470  0.7289    76.580  774.58
   7   0.4882     84.100  0.5733    81.562  902.86
   8   0.4186     85.980  0.4806    84.060  1031.12
   9   0.3639     87.740  0.4142    86.218  1159.53
  10   0.3184     89.490  0.3611    88.037  1287.92
  11   0.2829     90.240  0.3192    89.485  1416.26
  12   0.2614     91.460  0.2809    90.835  1544.55
  13   0.2236     92.520  0.2436    92.120  1672.84
  14   0.2023     93.410  0.2144    93.052  1801.21
  15   0.1952     93.370  0.1871    94.113  1929.50
  16   0.1556     94.710  0.1670    94.700  2057.84
  17   0.1407     95.300  0.1503    95.225  2186.17
  18   0.1223     95.950  0.1355    95.745  2314.51
  19   0.1212     95.920  0.1223    96.153  2442.95
  20   0.1069     96.460  0.1155    96.295  2571.23
  21   0.1027     96.480  0.1054    96.675  2699.55
  22   0.0986     96.540  0.0979    96.867  2827.93
  23   0.1005     96.680  0.0902    97.140  2956.30
  24   0.0931     96.780  0.0859    97.253  3084.69
  25   0.0904     97.120  0.0801    97.452  3212.98
  26   0.0815     97.320  0.0773    97.562  3341.29
  27   0.0716     97.600  0.0708    97.753  3469.60
  28   0.0697     97.630  0.0699    97.815  3597.98
  29   0.0860     97.190  0.0662    97.918  3726.35
  30   0.0672     97.890  0.0629    98.052  3854.68
  31   0.0633     98.120  0.0619    98.078  3982.93
  32   0.0641     97.890  0.0574    98.132  4111.28
  33   0.0690     97.760  0.0537    98.295  4239.55
  34   0.0619     97.950  0.0539    98.310  4367.92
  35   0.0608     97.880  0.0524    98.340  4496.25
  36   0.0576     98.130  0.0494    98.407  4624.59
  37   0.0531     98.340  0.0467    98.508  4752.87
  38   0.0629     97.920  0.0457    98.588  4881.18
  39   0.0508     98.110  0.0437    98.617  5009.49
  40   0.0514     98.260  0.0441    98.588  5137.90
  41   0.0497     98.490  0.0413    98.757  5266.20
  42   0.0513     98.300  0.0400    98.698  5394.50
  43   0.0436     98.470  0.0378    98.777  5522.86
  44   0.0552     98.220  0.0389    98.755  5651.23
  45   0.0462     98.420  0.0361    98.875  5779.60
  46   0.0472     98.440  0.0354    98.892  5907.93
  47   0.0449     98.480  0.0347    98.882  6036.25
  48   0.0434     98.630  0.0337    98.928  6164.53
  49   0.0478     98.320  0.0325    99.007  6292.87
  50   0.0568     98.120  0.0314    98.985  6421.31
  51   0.0487     98.390  0.0314    99.027  6549.70
  52   0.0449     98.500  0.0313    99.042  6678.06
  53   0.0420     98.640  0.0285    99.128  6806.39
  54   0.0492     98.380  0.0291    99.048  6934.70
  55   0.0387     98.660  0.0293    99.067  7063.01
  56   0.0533     98.200  0.0271    99.115  7191.29
  57   0.0436     98.550  0.0271    99.120  7319.64
  58   0.0476     98.440  0.0254    99.148  7448.04
  59   0.0447     98.560  0.0257    99.167  7576.42
  60   0.0478     98.360  0.0249    99.210  7704.82
  61   0.0406     98.620  0.0243    99.222  7833.18
  62   0.0455     98.490  0.0248    99.213  7961.60
  63   0.0407     98.680  0.0232    99.238  8089.92
  64   0.0425     98.450  0.0229    99.268  8218.19
  65   0.0439     98.510  0.0226    99.267  8346.52
  66   0.0405     98.630  0.0219    99.307  8474.85
  67   0.0385     98.640  0.0218    99.290  8603.23
  68   0.0400     98.620  0.0207    99.322  8731.61
  69   0.0397     98.630  0.0216    99.323  8859.96
  70   0.0451     98.560  0.0192    99.388  8988.36
  71   0.0374     98.800  0.0204    99.315  9116.66
  72   0.0372     98.760  0.0192    99.373  9245.02
  73   0.0360     98.820  0.0182    99.403  9373.35
  74   0.0411     98.650  0.0188    99.365  9501.70
  75   0.0355     98.930  0.0185    99.417  9630.11
  76   0.0535     98.340  0.0182    99.395  9758.48
  77   0.0405     98.660  0.0177    99.448  9886.85
  78   0.0370     98.760  0.0185    99.392  10015.22
  79   0.0391     98.700  0.0175    99.420  10143.53
  80   0.0360     98.770  0.0174    99.438  10271.85
  81   0.0396     98.660  0.0170    99.458  10400.16
  82   0.0391     98.710  0.0171    99.452  10528.52
  83   0.0391     98.670  0.0164    99.472  10656.87
  84   0.0399     98.730  0.0158    99.487  10785.24
  85   0.0434     98.580  0.0154    99.500  10913.57
  86   0.0426     98.510  0.0157    99.498  11041.90
  87   0.0417     98.590  0.0152    99.515  11170.16
  88   0.0379     98.770  0.0146    99.532  11298.45
  89   0.0367     98.870  0.0140    99.567  11426.79
  90   0.0354     98.890  0.0149    99.520  11555.11
