Use GPU: 0 for training
==> Running with ['main_adahessian.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 32182314496 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3587     88.260  1.2170    64.498  132.60
   2   0.1623     94.600  0.2630    91.392  260.91
   3   0.1134     96.380  0.1412    95.483  389.12
   4   0.1066     96.630  0.1009    96.790  517.43
   5   0.0709     97.670  0.0821    97.357  645.68
   6   0.0762     97.660  0.0700    97.835  773.87
   7   0.0686     97.670  0.0659    97.947  902.18
   8   0.0602     98.050  0.0585    98.210  1030.46
   9   0.0536     98.290  0.0551    98.292  1158.72
  10   0.0545     98.220  0.0515    98.355  1287.00
  11   0.0508     98.520  0.0515    98.378  1415.25
  12   0.0728     97.510  0.0490    98.460  1543.62
  13   0.0942     97.020  0.0489    98.468  1671.94
  14   0.0536     98.320  0.0448    98.600  1800.27
  15   0.0582     98.150  0.0438    98.612  1928.47
  16   0.0686     98.000  0.0396    98.727  2056.76
  17   0.0371     98.820  0.0435    98.650  2185.12
  18   0.0570     98.280  0.0410    98.723  2313.45
  19   0.0527     98.460  0.0432    98.598  2441.66
  20   0.0536     98.330  0.0409    98.760  2569.83
  21   0.0457     98.760  0.0415    98.672  2698.05
  22   0.0442     98.740  0.0392    98.817  2826.29
  23   0.0493     98.650  0.0364    98.842  2954.62
  24   0.0466     98.590  0.0366    98.835  3082.91
  25   0.0393     98.810  0.0375    98.840  3211.24
  26   0.0366     98.800  0.0365    98.877  3339.54
  27   0.0410     98.790  0.0389    98.823  3467.80
  28   0.0425     98.640  0.0355    98.875  3596.08
  29   0.0528     98.600  0.0342    98.940  3724.31
  30   0.0443     98.550  0.0378    98.853  3852.58
  31   0.0582     98.150  0.0339    98.925  3980.93
  32   0.0418     98.680  0.0367    98.865  4109.15
  33   0.0290     99.190  0.0392    98.773  4237.49
  34   0.0444     98.580  0.0327    99.007  4365.76
  35   0.0511     98.370  0.0334    98.955  4494.08
  36   0.0523     98.450  0.0327    98.955  4622.33
  37   0.0501     98.590  0.0318    98.947  4750.54
  38   0.0478     98.720  0.0330    98.952  4878.82
  39   0.0429     98.620  0.0305    99.068  5007.00
  40   0.0423     98.780  0.0305    99.057  5135.21
  41   0.0368     98.920  0.0313    99.008  5263.44
  42   0.0385     98.690  0.0328    98.983  5391.74
  43   0.0313     98.930  0.0301    99.028  5519.98
  44   0.0387     98.800  0.0315    98.987  5648.32
  45   0.0688     98.070  0.0303    99.012  5776.54
  46   0.0389     98.880  0.0278    99.107  5904.76
  47   0.0451     98.810  0.0283    99.092  6032.98
  48   0.0245     99.260  0.0294    99.067  6161.20
  49   0.0421     98.660  0.0262    99.167  6289.44
  50   0.0548     98.220  0.0268    99.113  6417.75
  51   0.0360     98.820  0.0236    99.218  6546.07
  52   0.0279     99.120  0.0264    99.152  6674.35
  53   0.0487     98.730  0.0239    99.207  6802.60
  54   0.0790     98.370  0.0226    99.258  6930.89
  55   0.0370     98.880  0.0277    99.103  7059.11
  56   0.0352     99.090  0.0208    99.338  7187.41
  57   0.0446     98.660  0.0207    99.303  7315.72
  58   0.0275     99.160  0.0207    99.347  7444.02
  59   0.0283     99.170  0.0197    99.347  7572.23
  60   0.0281     99.040  0.0191    99.332  7700.47
  61   0.0266     99.140  0.0187    99.383  7828.79
  62   0.0222     99.290  0.0179    99.437  7957.08
  63   0.0354     99.140  0.0167    99.423  8085.29
  64   0.0273     99.250  0.0145    99.523  8213.56
  65   0.0284     99.110  0.0152    99.492  8341.80
  66   0.0327     99.080  0.0133    99.537  8470.05
  67   0.0323     98.960  0.0128    99.565  8598.22
  68   0.0413     98.930  0.0108    99.645  8726.40
  69   0.0309     99.060  0.0117    99.632  8854.70
  70   0.0256     99.230  0.0098    99.673  8983.00
  71   0.0275     99.210  0.0090    99.700  9111.30
  72   0.0286     99.150  0.0073    99.743  9239.56
  73   0.0266     99.270  0.0062    99.782  9367.84
  74   0.0357     99.070  0.0060    99.803  9496.09
  75   0.0275     99.230  0.0044    99.858  9624.24
  76   0.0288     99.280  0.0040    99.860  9752.54
  77   0.0387     99.080  0.0038    99.853  9880.89
  78   0.0303     99.260  0.0028    99.918  10009.25
  79   0.0286     99.290  0.0024    99.923  10137.49
  80   0.0367     99.170  0.0020    99.947  10265.82
  81   0.0330     99.220  0.0016    99.953  10394.12
  82   0.0355     99.200  0.0016    99.945  10522.45
  83   0.0363     99.210  0.0013    99.970  10650.79
  84   0.0348     99.290  0.0013    99.953  10779.03
  85   0.0403     99.190  0.0014    99.960  10907.31
  86   0.0318     99.250  0.0012    99.955  11035.52
  87   0.0395     99.140  0.0011    99.972  11163.79
  88   0.0353     99.160  0.0008    99.977  11292.05
  89   0.0368     99.170  0.0008    99.985  11420.24
  90   0.0412     99.130  0.0008    99.978  11548.47
