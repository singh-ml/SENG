Use GPU: 0 for training
==> Running with ['main_adahessian.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 32180217344 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3674     87.280  1.1046    62.763  132.70
   2   0.1649     94.420  0.2541    91.662  261.10
   3   0.1044     96.670  0.1302    95.928  389.48
   4   0.0806     97.500  0.0910    97.108  517.84
   5   0.0713     97.740  0.0744    97.592  646.15
   6   0.0772     97.570  0.0659    97.897  774.53
   7   0.0614     97.990  0.0584    98.135  902.83
   8   0.0429     98.600  0.0522    98.372  1031.12
   9   0.0545     98.230  0.0502    98.410  1159.43
  10   0.0549     98.110  0.0476    98.468  1287.72
  11   0.0485     98.450  0.0453    98.575  1416.07
  12   0.0754     97.690  0.0407    98.693  1544.41
  13   0.0812     97.280  0.0421    98.707  1672.74
  14   0.0529     98.260  0.0432    98.655  1801.11
  15   0.0614     98.110  0.0403    98.700  1929.50
  16   0.0524     98.370  0.0409    98.717  2057.86
  17   0.0544     98.280  0.0366    98.800  2186.20
  18   0.0632     97.960  0.0390    98.743  2314.60
  19   0.0434     98.590  0.0384    98.790  2442.91
  20   0.0426     98.660  0.0373    98.857  2571.27
  21   0.0463     98.620  0.0359    98.870  2699.65
  22   0.0484     98.430  0.0378    98.893  2828.03
  23   0.0354     98.870  0.0361    98.880  2956.43
  24   0.0489     98.500  0.0397    98.733  3084.82
  25   0.0614     98.200  0.0343    98.883  3213.21
  26   0.0533     98.520  0.0344    98.920  3341.60
  27   0.0516     98.440  0.0337    98.932  3469.92
  28   0.0512     98.630  0.0351    98.912  3598.25
  29   0.0303     99.000  0.0353    98.893  3726.55
  30   0.0454     98.620  0.0344    98.977  3854.88
  31   0.0615     97.970  0.0336    98.952  3983.28
  32   0.0569     98.470  0.0334    98.977  4111.65
  33   0.0571     98.040  0.0351    98.903  4240.03
  34   0.0513     98.450  0.0334    98.960  4368.39
  35   0.0394     98.760  0.0301    99.063  4496.77
  36   0.0459     98.610  0.0297    99.095  4625.08
  37   0.0385     98.870  0.0286    99.120  4753.46
  38   0.0394     98.850  0.0300    99.013  4881.88
  39   0.0597     98.130  0.0307    99.047  5010.27
  40   0.0505     98.430  0.0294    99.045  5138.65
  41   0.0395     98.690  0.0300    99.020  5267.01
  42   0.0435     98.740  0.0289    99.095  5395.39
  43   0.0520     98.290  0.0272    99.098  5523.83
  44   0.0403     98.910  0.0255    99.197  5652.21
  45   0.0297     99.010  0.0275    99.117  5780.61
  46   0.0489     98.550  0.0263    99.177  5909.04
  47   0.0265     99.180  0.0305    99.043  6037.37
  48   0.0399     98.720  0.0240    99.198  6165.77
  49   0.0314     99.030  0.0228    99.270  6294.20
  50   0.0492     98.620  0.0251    99.213  6422.60
  51   0.0462     98.610  0.0233    99.218  6550.96
  52   0.0471     98.720  0.0209    99.347  6679.36
  53   0.0450     98.630  0.0196    99.352  6807.76
  54   0.0346     98.890  0.0203    99.343  6936.16
  55   0.0323     99.080  0.0187    99.388  7064.50
  56   0.0338     99.060  0.0202    99.317  7192.92
  57   0.0376     98.910  0.0196    99.355  7321.28
  58   0.0411     98.900  0.0169    99.448  7449.68
  59   0.0281     99.120  0.0169    99.432  7578.06
  60   0.0329     99.020  0.0163    99.457  7706.44
  61   0.0337     98.860  0.0151    99.483  7834.83
  62   0.0377     98.990  0.0132    99.528  7963.20
  63   0.0340     99.060  0.0126    99.543  8091.53
  64   0.0333     99.030  0.0120    99.567  8219.91
  65   0.0328     99.210  0.0106    99.635  8348.24
  66   0.0479     98.700  0.0093    99.685  8476.55
  67   0.0233     99.250  0.0092    99.688  8604.96
  68   0.0336     99.030  0.0081    99.730  8733.36
  69   0.0331     99.050  0.0071    99.755  8861.75
  70   0.0331     99.170  0.0073    99.743  8990.07
  71   0.0390     99.000  0.0067    99.780  9118.47
  72   0.0300     99.190  0.0057    99.817  9246.83
  73   0.0359     99.180  0.0043    99.835  9375.22
  74   0.0328     99.230  0.0040    99.853  9503.61
  75   0.0378     99.050  0.0034    99.877  9632.00
  76   0.0394     99.090  0.0025    99.917  9760.38
  77   0.0353     99.280  0.0021    99.932  9888.69
  78   0.0431     99.050  0.0025    99.912  10017.00
  79   0.0398     99.000  0.0023    99.925  10145.38
  80   0.0388     99.130  0.0020    99.925  10273.69
  81   0.0478     99.060  0.0015    99.948  10402.06
  82   0.0482     99.150  0.0012    99.960  10530.49
  83   0.0451     99.070  0.0010    99.963  10658.85
  84   0.0383     99.250  0.0007    99.983  10787.25
  85   0.0390     99.170  0.0012    99.975  10915.65
  86   0.0467     99.140  0.0009    99.982  11043.92
  87   0.0472     99.090  0.0008    99.978  11172.24
  88   0.0499     99.150  0.0006    99.985  11300.55
  89   0.0473     99.130  0.0007    99.982  11428.94
  90   0.0401     99.310  0.0009    99.972  11557.33
