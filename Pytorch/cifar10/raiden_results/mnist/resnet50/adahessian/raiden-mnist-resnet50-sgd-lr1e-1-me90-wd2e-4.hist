Use GPU: 0 for training
==> Running with ['main_adahessian.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 32179168768 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.3643     87.590  1.0369    66.807  133.79
   2   0.1646     94.410  0.2435    91.847  262.49
   3   0.0936     96.950  0.1261    96.005  391.22
   4   0.0920     96.770  0.0939    96.995  519.97
   5   0.0611     97.870  0.0782    97.503  648.50
   6   0.0813     97.110  0.0668    97.923  777.10
   7   0.0520     98.180  0.0613    98.070  905.72
   8   0.0623     98.010  0.0561    98.240  1034.35
   9   0.0511     98.250  0.0561    98.225  1163.05
  10   0.0829     97.500  0.0458    98.508  1291.60
  11   0.0522     98.310  0.0464    98.558  1420.22
  12   0.0557     98.250  0.0494    98.395  1548.87
  13   0.0546     98.230  0.0462    98.562  1677.48
  14   0.0702     97.830  0.0443    98.632  1806.12
  15   0.0355     98.890  0.0448    98.593  1934.86
  16   0.0385     98.770  0.0421    98.705  2063.58
  17   0.0444     98.520  0.0435    98.618  2192.23
  18   0.0398     98.840  0.0445    98.628  2320.88
  19   0.0332     98.850  0.0449    98.583  2449.52
  20   0.0298     98.960  0.0365    98.877  2578.09
  21   0.0530     98.430  0.0370    98.875  2706.77
  22   0.0416     98.770  0.0417    98.730  2835.48
  23   0.0556     98.120  0.0415    98.722  2964.10
  24   0.0395     98.690  0.0383    98.810  3092.73
  25   0.0264     99.170  0.0382    98.832  3221.38
  26   0.0387     98.690  0.0372    98.843  3349.97
  27   0.0439     98.700  0.0363    98.847  3478.56
  28   0.0400     98.850  0.0352    98.900  3607.16
  29   0.0413     98.820  0.0344    98.873  3735.82
  30   0.0494     98.440  0.0371    98.837  3864.37
  31   0.0547     98.100  0.0382    98.770  3993.05
  32   0.0408     98.870  0.0325    98.955  4121.71
  33   0.0320     98.950  0.0314    99.035  4250.39
  34   0.0315     98.970  0.0334    98.947  4378.93
  35   0.0437     98.700  0.0352    98.898  4507.60
  36   0.0342     99.020  0.0334    98.952  4636.32
  37   0.0402     98.750  0.0323    98.963  4764.91
  38   0.0503     98.450  0.0310    99.038  4893.55
  39   0.0485     98.660  0.0317    98.965  5022.24
  40   0.0504     98.520  0.0314    98.972  5150.97
  41   0.0362     98.820  0.0293    99.068  5279.72
  42   0.0441     98.470  0.0294    99.050  5408.34
  43   0.0322     99.000  0.0356    98.872  5536.86
  44   0.0425     98.690  0.0299    99.053  5665.50
  45   0.0455     98.750  0.0291    99.055  5794.14
  46   0.0438     98.600  0.0281    99.093  5922.70
  47   0.0425     98.760  0.0267    99.128  6051.37
  48   0.0294     99.060  0.0304    99.037  6179.99
  49   0.0462     98.720  0.0258    99.143  6308.54
  50   0.0377     98.830  0.0272    99.130  6437.09
  51   0.0287     99.150  0.0281    99.112  6565.90
  52   0.0285     99.090  0.0256    99.177  6694.64
  53   0.0353     98.990  0.0221    99.270  6823.35
  54   0.0324     98.940  0.0219    99.278  6952.06
  55   0.0482     98.490  0.0240    99.190  7080.63
  56   0.0298     99.160  0.0228    99.227  7209.30
  57   0.0337     98.830  0.0208    99.293  7338.03
  58   0.0402     98.730  0.0218    99.297  7466.72
  59   0.0407     98.720  0.0213    99.307  7595.45
  60   0.0338     99.080  0.0194    99.352  7724.13
  61   0.0351     98.860  0.0184    99.373  7853.22
  62   0.0405     98.900  0.0163    99.447  7981.79
  63   0.0384     98.930  0.0158    99.430  8110.43
  64   0.0335     98.930  0.0171    99.423  8239.13
  65   0.0428     98.680  0.0137    99.542  8367.82
  66   0.0283     99.120  0.0133    99.557  8496.39
  67   0.0275     99.210  0.0122    99.602  8625.00
  68   0.0265     99.190  0.0108    99.628  8753.69
  69   0.0400     99.030  0.0120    99.572  8882.30
  70   0.0428     98.940  0.0103    99.645  9010.99
  71   0.0294     99.250  0.0081    99.727  9139.70
  72   0.0351     99.160  0.0070    99.768  9268.39
  73   0.0328     99.040  0.0067    99.783  9397.12
  74   0.0326     99.040  0.0064    99.767  9525.79
  75   0.0346     99.070  0.0058    99.797  9654.38
  76   0.0269     99.250  0.0044    99.855  9783.06
  77   0.0466     99.000  0.0039    99.863  9911.71
  78   0.0338     99.080  0.0032    99.898  10040.36
  79   0.0330     99.230  0.0024    99.922  10168.96
  80   0.0317     99.260  0.0027    99.928  10297.59
  81   0.0330     99.180  0.0023    99.935  10426.17
  82   0.0399     99.060  0.0022    99.928  10554.79
  83   0.0332     99.170  0.0019    99.950  10683.49
  84   0.0330     99.190  0.0016    99.953  10812.04
  85   0.0348     99.220  0.0013    99.965  10940.64
  86   0.0368     99.230  0.0011    99.972  11069.34
  87   0.0391     99.120  0.0010    99.977  11198.06
  88   0.0400     99.140  0.0009    99.983  11326.73
  89   0.0380     99.110  0.0008    99.980  11455.44
  90   0.0433     99.160  0.0009    99.980  11584.04
