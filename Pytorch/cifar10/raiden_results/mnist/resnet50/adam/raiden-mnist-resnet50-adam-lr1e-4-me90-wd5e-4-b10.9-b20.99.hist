Use GPU: 0 for training
==> Running with ['main_adam.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-4', '--weight-decay', '5e-4', '--beta1', '0.9', '--beta2', '0.99', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 13828049408 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   0.2625     91.520  0.8382    70.897  25.43
   2   0.1283     95.610  0.2030    93.408  48.57
   3   0.0954     96.900  0.1172    96.217  71.76
   4   0.0687     97.540  0.0868    97.223  94.89
   5   0.0622     97.910  0.0751    97.598  118.03
   6   0.0577     98.250  0.0656    97.977  141.20
   7   0.0417     98.510  0.0617    98.085  164.38
   8   0.0679     97.720  0.0543    98.287  187.53
   9   0.0744     97.500  0.0525    98.278  210.69
  10   0.0561     98.260  0.0521    98.428  233.80
  11   0.0493     98.380  0.0484    98.488  256.96
  12   0.0510     98.290  0.0481    98.507  280.13
  13   0.0440     98.550  0.0447    98.613  303.26
  14   0.0848     97.520  0.0441    98.613  326.38
  15   0.0608     98.120  0.0417    98.705  349.54
  16   0.0435     98.630  0.0423    98.652  372.67
  17   0.0363     98.830  0.0409    98.708  395.85
  18   0.0462     98.620  0.0396    98.750  418.99
  19   0.0379     98.840  0.0404    98.722  442.13
  20   0.0480     98.300  0.0354    98.902  465.29
  21   0.0337     98.900  0.0394    98.795  488.43
  22   0.0318     99.000  0.0384    98.837  511.56
  23   0.0340     98.880  0.0361    98.842  534.72
  24   0.0670     98.050  0.0356    98.857  557.87
  25   0.0557     98.260  0.0364    98.857  581.00
  26   0.0467     98.550  0.0350    98.957  604.12
  27   0.0626     97.990  0.0355    98.875  627.25
  28   0.0730     97.670  0.0347    98.907  650.43
  29   0.0522     98.430  0.0348    98.917  673.54
  30   0.0339     98.910  0.0344    98.915  696.65
  31   0.0482     98.500  0.0330    98.960  719.81
  32   0.0679     97.870  0.0342    98.955  742.95
  33   0.0396     98.650  0.0328    99.033  766.08
  34   0.0409     98.660  0.0347    98.927  789.26
  35   0.0346     98.910  0.0313    99.037  812.41
  36   0.0310     99.080  0.0317    99.018  835.52
  37   0.0498     98.460  0.0321    98.977  858.60
  38   0.0404     98.660  0.0309    99.087  881.73
  39   0.0514     98.320  0.0323    99.017  904.86
  40   0.0435     98.620  0.0299    99.113  928.03
  41   0.0383     98.840  0.0317    99.038  951.22
  42   0.0480     98.610  0.0308    99.112  974.33
  43   0.0449     98.680  0.0317    99.070  997.50
  44   0.0561     98.200  0.0310    99.068  1020.63
  45   0.0546     98.300  0.0302    99.073  1043.78
  46   0.0286     99.150  0.0281    99.167  1066.96
  47   0.0401     98.820  0.0294    99.108  1090.09
  48   0.0339     98.950  0.0301    99.112  1113.26
  49   0.0404     98.720  0.0299    99.063  1136.40
  50   0.0446     98.690  0.0272    99.205  1159.53
  51   0.0317     99.060  0.0292    99.108  1182.66
  52   0.0744     97.640  0.0271    99.207  1205.81
  53   0.0443     98.590  0.0274    99.172  1228.91
  54   0.0430     98.750  0.0264    99.212  1252.02
  55   0.0372     98.860  0.0266    99.210  1275.16
  56   0.0440     98.830  0.0260    99.243  1298.31
  57   0.0406     98.660  0.0271    99.188  1321.47
  58   0.0461     98.700  0.0260    99.228  1344.66
  59   0.0466     98.620  0.0266    99.208  1367.84
  60   0.0472     98.620  0.0252    99.280  1391.01
  61   0.0280     99.170  0.0262    99.213  1414.15
  62   0.0350     98.970  0.0251    99.267  1437.41
  63   0.0354     98.890  0.0259    99.247  1460.55
  64   0.0361     98.970  0.0239    99.293  1483.72
  65   0.0383     99.010  0.0259    99.227  1506.89
  66   0.0340     99.060  0.0249    99.272  1530.06
  67   0.0285     99.150  0.0229    99.337  1553.23
  68   0.0390     98.930  0.0242    99.288  1576.41
  69   0.0483     98.520  0.0225    99.347  1599.61
  70   0.0455     98.690  0.0242    99.267  1622.78
  71   0.0350     98.860  0.0227    99.322  1645.99
  72   0.0581     98.330  0.0227    99.353  1669.19
  73   0.0450     98.540  0.0230    99.327  1692.34
  74   0.0349     99.010  0.0228    99.378  1715.53
  75   0.0435     98.790  0.0225    99.332  1738.70
  76   0.0366     99.100  0.0219    99.342  1761.88
  77   0.0451     98.660  0.0211    99.367  1785.09
  78   0.0423     98.750  0.0237    99.310  1808.25
  79   0.0318     99.070  0.0216    99.355  1831.42
  80   0.0434     98.660  0.0212    99.392  1854.59
  81   0.0408     98.870  0.0223    99.360  1877.78
  82   0.0285     99.130  0.0201    99.418  1900.98
  83   0.0328     99.000  0.0208    99.375  1924.18
  84   0.0386     98.890  0.0193    99.408  1947.40
  85   0.0341     99.000  0.0201    99.372  1970.62
  86   0.0422     98.750  0.0195    99.428  1993.82
  87   0.0447     98.620  0.0231    99.293  2017.02
  88   0.0415     98.800  0.0206    99.388  2040.21
  89   0.0374     99.080  0.0200    99.427  2063.40
  90   0.0547     98.440  0.0194    99.448  2086.58
