Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '-m', '24', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 15431790592 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3799      9.470  16.7087     9.780  27.62
   2   2.3896      9.580  16.7084     9.737  53.04
   3   2.3897      9.990  16.7086     9.557  78.41
   4   2.3847      9.780  16.7082     9.733  103.79
   5   2.3785      9.930  16.7094     9.785  129.22
   6   2.3784      9.760  16.7092     9.717  154.42
   7   2.3803      9.580  16.7090     9.678  179.84
   8   2.3796      9.740  16.7101     9.692  205.22
   9   2.3894      9.560  16.7088     9.653  230.65
  10   2.3809      9.670  16.7086     9.747  256.10
  11   2.3782      9.760  16.7086     9.593  281.35
  12   2.3951      9.990  16.7079     9.848  306.63
  13   2.3853      9.430  16.7082     9.748  332.06
  14   2.3866      9.770  16.7094     9.735  357.41
  15   2.3837      9.960  16.7080     9.633  382.82
  16   2.3827      9.650  16.7094     9.695  408.09
  17   2.3794      9.860  16.7089     9.748  433.44
  18   2.3880     10.090  16.7094     9.567  458.88
  19   2.3918      9.840  16.7091     9.675  484.26
  20   2.3873      9.910  16.7103     9.627  509.53
  21   2.3784      9.330  16.7098     9.650  534.72
  22   2.3863      9.680  16.7086     9.967  559.92
  23   2.3777      9.450  16.7085     9.707  585.37
  24   2.3779      9.760  16.7086     9.662  610.75
  25   2.3858      9.490  16.7081     9.747  635.98
  26   2.3855      9.770  16.7084     9.767  661.31
  27   2.3793      9.600  16.7067     9.693  686.71
  28   2.3873      9.610  16.7081     9.863  711.91
  29   2.3810      9.630  16.7094     9.795  737.36
  30   2.3903      9.760  16.7088     9.782  762.77
  31   2.3880      9.940  16.7093     9.752  788.20
  32   2.3849      9.810  16.7080     9.777  813.49
  33   2.3832      9.880  16.7092     9.773  838.88
  34   2.3940      9.800  16.7076     9.718  864.29
  35   2.3916      9.740  16.7096     9.802  889.69
  36   2.3840      9.760  16.7094     9.640  915.03
  37   2.3817      9.950  16.7079     9.728  940.45
  38   2.3865      9.600  16.7085     9.730  965.83
  39   2.3753      9.750  16.7090     9.600  991.21
  40   2.3920      9.600  16.7091     9.788  1016.42
  41   2.3866      9.510  16.7090     9.685  1041.84
  42   2.3822      9.950  16.7076     9.895  1067.26
  43   2.3777      9.740  16.7083     9.625  1092.66
  44   2.3860      9.980  16.7090     9.403  1118.01
  45   2.3885      9.930  16.7095     9.763  1143.41
  46   2.3805      9.730  16.7081     9.905  1168.81
  47   2.3882      9.830  16.7088     9.642  1194.15
  48   2.3905      9.930  16.7091     9.688  1219.58
  49   2.3839      9.880  16.7083     9.787  1244.87
  50   2.3911      9.630  16.7084     9.692  1270.13
  51   2.3878     10.030  16.7091     9.663  1295.34
  52   2.3853      9.660  16.7090     9.637  1320.64
  53   2.3832      9.730  16.7088     9.757  1346.03
  54   2.3833      9.670  16.7070     9.820  1371.25
  55   2.3832      9.740  16.7084     9.783  1396.47
  56   2.3862      9.950  16.7099     9.535  1421.77
  57   2.3805     10.070  16.7085     9.703  1447.14
  58   2.3854      9.820  16.7087     9.748  1472.52
  59   2.3855      9.560  16.7094     9.565  1497.88
  60   2.3900     10.040  16.7086     9.647  1523.26
  61   2.3823      9.660  16.7091     9.785  1548.65
  62   2.3867     10.120  16.7082     9.657  1573.96
  63   2.3794      9.530  16.7083     9.720  1599.39
  64   2.3837      9.450  16.7090     9.538  1624.72
  65   2.3764      9.680  16.7094     9.657  1650.08
  66   2.3809      9.630  16.7086     9.840  1675.28
  67   2.3874      9.760  16.7089     9.537  1700.53
  68   2.3847      9.740  16.7090     9.888  1725.76
  69   2.3830      9.760  16.7083     9.568  1751.05
  70   2.3801      9.730  16.7084     9.892  1776.26
  71   2.3813      9.800  16.7081     9.822  1801.67
  72   2.3872      9.660  16.7089     9.623  1826.97
  73   2.3931      9.870  16.7082     9.797  1852.24
  74   2.3816      9.510  16.7096     9.720  1877.60
  75   2.3799      9.740  16.7084     9.777  1903.01
  76   2.3862      9.770  16.7088     9.703  1928.36
  77   2.3925      9.830  16.7092     9.560  1953.79
  78   2.3805      9.630  16.7090     9.577  1979.12
  79   2.3853      9.900  16.7068     9.658  2004.38
  80   2.3886      9.700  16.7094     9.632  2029.64
  81   2.3876      9.800  16.7095     9.613  2054.98
  82   2.3840      9.820  16.7079     9.732  2080.32
  83   2.3835      9.460  16.7097     9.627  2105.71
  84   2.3891      9.620  16.7083     9.872  2131.06
  85   2.3810     10.090  16.7077     9.672  2156.38
  86   2.3750      9.760  16.7091     9.690  2181.62
  87   2.3815      9.690  16.7085     9.733  2207.03
  88   2.3824      9.890  16.7097     9.763  2232.49
  89   2.3856      9.560  16.7086     9.658  2257.84
  90   2.3901      9.740  16.7089     9.550  2283.23
