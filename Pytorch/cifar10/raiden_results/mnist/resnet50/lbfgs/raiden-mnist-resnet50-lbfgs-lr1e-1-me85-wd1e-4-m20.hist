Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 18066667008 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3487     10.520  9.6711    10.498  30.61
   2   2.3041     13.370  9.4616    13.877  58.56
   3   2.3056     12.870  9.4604    13.970  86.39
   4   2.3050     12.990  9.4606    13.972  114.08
   5   2.3048     12.940  9.4602    13.878  141.94
   6   2.3042     13.640  9.4597    14.113  169.71
   7   2.3036     13.080  9.4596    13.910  197.42
   8   2.3066     13.330  9.4589    14.005  225.03
   9   2.3031     13.220  9.4602    13.890  252.70
  10   2.3013     13.330  9.4597    13.963  280.41
  11   2.3065     13.330  9.4605    13.972  308.13
  12   2.3048     12.780  9.4603    14.127  335.75
  13   2.3030     12.860  9.4600    14.080  363.39
  14   2.3075     13.110  9.4615    14.063  391.09
  15   2.3036     13.000  9.4594    14.140  418.64
  16   2.3033     13.530  9.4598    13.872  446.23
  17   2.3034     12.540  9.4603    13.777  473.95
  18   2.3055     12.900  9.4598    13.915  501.71
  19   2.3046     13.080  9.4599    13.967  529.49
  20   2.3022     13.290  9.4594    13.855  557.25
  21   2.3034     12.820  9.4605    13.792  584.95
  22   2.3048     13.530  9.4596    13.913  612.61
  23   2.3054     12.870  9.4608    13.818  640.39
  24   2.3028     12.780  9.4595    14.290  668.05
  25   2.3021     13.430  9.4598    13.963  695.83
  26   2.3043     13.530  9.4617    13.913  723.42
  27   2.3048     12.890  9.4602    14.133  751.19
  28   2.3030     13.110  9.4590    14.152  778.94
  29   2.3020     13.420  9.4602    13.988  806.73
  30   2.3021     13.250  9.4592    14.142  834.45
  31   2.3029     13.500  9.4603    13.892  862.03
  32   2.3027     12.850  9.4593    14.123  889.66
  33   2.3031     13.030  9.4589    14.125  917.27
  34   2.3054     13.070  9.4605    14.008  945.03
  35   2.3080     13.150  9.4603    14.033  972.76
  36   2.3066     12.300  9.4599    14.028  1000.47
  37   2.3061     12.960  9.4604    14.038  1028.25
  38   2.3053     12.470  9.4601    13.908  1056.01
  39   2.3057     12.860  9.4607    13.960  1083.65
  40   2.3038     13.080  9.4604    13.883  1111.34
  41   2.3058     13.350  9.4603    13.867  1138.93
  42   2.3038     13.370  9.4602    13.733  1166.57
  43   2.3036     13.040  9.4597    14.093  1194.35
  44   2.3064     12.940  9.4608    13.707  1222.09
  45   2.3071     12.720  9.4591    14.183  1249.81
  46   2.3034     13.420  9.4606    14.133  1277.52
  47   2.3054     13.010  9.4598    13.928  1305.30
  48   2.3054     12.500  9.4605    13.945  1333.06
  49   2.3071     12.200  9.4603    14.133  1360.83
  50   2.3028     13.600  9.4606    13.842  1388.54
  51   2.3048     13.200  9.4602    13.832  1416.29
  52   2.3041     13.070  9.4611    13.898  1444.03
  53   2.3055     13.360  9.4586    14.052  1471.81
  54   2.3033     13.560  9.4601    13.932  1499.57
  55   2.3032     12.940  9.4604    13.998  1527.14
  56   2.3039     13.060  9.4595    14.128  1554.89
  57   2.3032     12.870  9.4610    14.042  1582.58
  58   2.3038     13.620  9.4614    13.792  1610.25
  59   2.3031     13.780  9.4603    13.872  1637.91
  60   2.3041     12.980  9.4604    13.865  1665.50
  61   2.3041     13.670  9.4593    13.940  1693.09
  62   2.3059     12.530  9.4599    14.087  1720.70
  63   2.3043     13.760  9.4597    14.023  1748.48
  64   2.3053     13.000  9.4604    13.850  1776.29
  65   2.3055     13.550  9.4606    13.828  1804.07
  66   2.3033     12.910  9.4605    13.893  1831.77
  67   2.3030     13.910  9.4601    14.225  1859.35
  68   2.3029     13.590  9.4595    14.265  1887.00
  69   2.3044     13.050  9.4597    14.048  1914.66
  70   2.3029     13.960  9.4591    13.990  1942.36
  71   2.3058     12.870  9.4604    14.037  1970.07
  72   2.3034     13.910  9.4597    14.018  1997.80
  73   2.3030     13.220  9.4606    13.930  2025.52
  74   2.3025     13.520  9.4595    14.218  2053.29
  75   2.3037     12.700  9.4601    14.032  2081.07
  76   2.3042     13.060  9.4590    13.940  2108.79
  77   2.3040     12.800  9.4602    13.647  2136.54
  78   2.3037     13.320  9.4606    14.055  2164.31
  79   2.3023     13.130  9.4604    13.803  2192.14
  80   2.3056     12.920  9.4604    13.920  2219.90
  81   2.3057     12.450  9.4598    14.017  2247.62
  82   2.3034     13.310  9.4608    13.903  2275.38
  83   2.3056     13.000  9.4608    14.210  2303.03
  84   2.3038     13.080  9.4584    14.233  2330.64
  85   2.3056     13.410  9.4595    14.088  2358.32
