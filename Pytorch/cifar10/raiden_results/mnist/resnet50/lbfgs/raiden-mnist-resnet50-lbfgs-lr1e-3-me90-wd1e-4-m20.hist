Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 14867100672 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3921     10.660  9.5574    10.685  27.46
   2   2.3955     10.640  9.5572    10.765  52.40
   3   2.3950     10.650  9.5577    10.738  77.53
   4   2.3916     10.700  9.5577    10.698  102.57
   5   2.3932     10.690  9.5573    10.673  127.58
   6   2.3918     10.910  9.5582    10.662  152.49
   7   2.3935     10.460  9.5584    10.800  177.64
   8   2.3941     10.650  9.5570    10.682  202.63
   9   2.3943     10.970  9.5580    10.775  227.59
  10   2.3928     10.750  9.5588    10.605  252.61
  11   2.3943     10.850  9.5575    10.747  277.61
  12   2.3947     10.520  9.5573    10.702  302.67
  13   2.3956     10.600  9.5583    10.723  327.69
  14   2.3938     10.690  9.5585    10.732  352.64
  15   2.3939     10.740  9.5564    10.663  377.81
  16   2.3944     10.570  9.5571    10.708  402.87
  17   2.3924     10.940  9.5576    10.785  427.88
  18   2.3942     10.650  9.5579    10.617  452.86
  19   2.3964     10.670  9.5567    10.685  477.91
  20   2.3922     10.880  9.5584    10.647  502.98
  21   2.3994     10.500  9.5574    10.642  527.96
  22   2.3948     10.680  9.5588    10.667  552.97
  23   2.3950     10.750  9.5577    10.725  578.05
  24   2.3963     10.780  9.5570    10.730  603.12
  25   2.3900     10.760  9.5573    10.792  628.13
  26   2.3907     10.660  9.5579    10.760  653.08
  27   2.3964     10.710  9.5566    10.718  678.14
  28   2.3940     10.720  9.5575    10.767  703.22
  29   2.3906     10.610  9.5577    10.590  728.09
  30   2.3947     10.690  9.5588    10.613  753.16
  31   2.3922     10.820  9.5579    10.680  778.18
  32   2.3906     10.680  9.5573    10.722  803.23
  33   2.3946     10.910  9.5582    10.558  828.24
  34   2.3926     10.780  9.5580    10.692  853.32
  35   2.3932     10.910  9.5579    10.660  878.36
  36   2.3923     10.530  9.5566    10.872  903.32
  37   2.3897     10.700  9.5579    10.662  928.25
  38   2.3935     10.930  9.5577    10.738  953.30
  39   2.3917     10.610  9.5566    10.643  978.40
  40   2.3947     10.570  9.5581    10.680  1003.41
  41   2.3955     10.820  9.5571    10.637  1028.35
  42   2.3953     10.820  9.5581    10.677  1053.31
  43   2.3961     10.450  9.5561    10.733  1078.22
  44   2.3945     10.750  9.5575    10.753  1103.24
  45   2.3965     10.580  9.5581    10.702  1128.16
  46   2.3938     10.660  9.5583    10.778  1153.19
  47   2.3925     10.640  9.5569    10.717  1178.21
  48   2.3908     10.640  9.5573    10.595  1203.30
  49   2.3927     10.680  9.5583    10.587  1228.33
  50   2.3935     10.510  9.5581    10.673  1253.40
  51   2.3910     10.820  9.5578    10.657  1278.42
  52   2.3919     10.720  9.5580    10.702  1303.43
  53   2.3936     10.620  9.5570    10.670  1328.55
  54   2.3944     10.740  9.5575    10.592  1353.57
  55   2.3957     10.420  9.5574    10.683  1378.65
  56   2.3917     10.780  9.5580    10.693  1403.73
  57   2.3922     10.720  9.5574    10.735  1428.70
  58   2.3956     10.810  9.5576    10.753  1453.62
  59   2.3894     10.820  9.5585    10.685  1478.67
  60   2.3963     10.720  9.5588    10.593  1503.72
  61   2.3979     10.690  9.5576    10.703  1528.76
  62   2.3923     10.460  9.5573    10.702  1553.78
  63   2.3935     10.820  9.5568    10.755  1578.86
  64   2.3927     10.800  9.5575    10.738  1603.96
  65   2.3962     10.690  9.5577    10.713  1628.98
  66   2.3913     10.820  9.5578    10.528  1653.99
  67   2.3945     10.660  9.5580    10.803  1679.07
  68   2.3973     10.620  9.5572    10.653  1704.14
  69   2.3928     10.860  9.5578    10.825  1729.19
  70   2.3975     10.940  9.5573    10.720  1754.26
  71   2.3923     10.620  9.5579    10.657  1779.36
  72   2.3972     10.480  9.5579    10.713  1804.39
  73   2.3962     10.700  9.5575    10.643  1829.33
  74   2.3952     10.380  9.5582    10.740  1854.29
  75   2.3919     10.620  9.5576    10.717  1879.24
  76   2.3965     10.850  9.5574    10.658  1904.22
  77   2.3930     10.780  9.5577    10.772  1929.30
  78   2.3961     10.840  9.5574    10.700  1954.33
  79   2.3952     10.860  9.5576    10.782  1979.39
  80   2.3942     10.820  9.5593    10.743  2004.38
  81   2.3952     10.830  9.5589    10.785  2029.48
  82   2.3969     10.700  9.5569    10.748  2054.53
  83   2.3940     10.700  9.5567    10.713  2079.53
  84   2.3962     10.630  9.5573    10.652  2104.62
  85   2.3912     10.690  9.5586    10.760  2129.73
  86   2.3943     10.610  9.5566    10.700  2154.68
  87   2.3940     10.530  9.5576    10.782  2179.58
  88   2.3866     10.880  9.5575    10.803  2204.57
  89   2.3929     10.680  9.5575    10.612  2229.61
  90   2.3957     10.820  9.5579    10.607  2254.62
