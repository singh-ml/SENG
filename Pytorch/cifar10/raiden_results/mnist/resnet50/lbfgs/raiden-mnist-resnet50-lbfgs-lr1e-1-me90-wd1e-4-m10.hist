Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '-m', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 16183883264 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.4009     12.100  9.5546    12.393  28.86
   2   2.3032     10.860  9.4745    11.143  54.97
   3   2.3051     10.370  9.4680    10.818  80.85
   4   2.3062     10.650  9.4681    10.765  106.76
   5   2.3038     11.390  9.4669    10.750  132.62
   6   2.3065     11.010  9.4680    10.962  158.49
   7   2.3028     10.860  9.4684    10.755  184.39
   8   2.3016     10.880  9.4678    10.812  210.17
   9   2.3044     11.620  9.4673    10.770  236.02
  10   2.3050     11.100  9.4681    10.927  261.93
  11   2.3052     10.860  9.4669    10.845  287.84
  12   2.3070     10.320  9.4675    10.997  313.73
  13   2.3056     10.310  9.4673    10.953  339.57
  14   2.3057     10.480  9.4684    10.822  365.50
  15   2.3022     10.790  9.4680    10.787  391.39
  16   2.3036     10.980  9.4685    10.833  417.31
  17   2.3039     10.580  9.4684    10.913  443.26
  18   2.3056     10.790  9.4686    10.825  469.11
  19   2.3052     11.110  9.4686    10.893  494.95
  20   2.3039     11.190  9.4678    10.772  520.83
  21   2.3032     10.800  9.4683    10.792  546.69
  22   2.3034     10.390  9.4666    11.128  572.64
  23   2.3042     11.120  9.4685    10.803  598.54
  24   2.3055     10.620  9.4674    10.945  624.44
  25   2.3050     10.880  9.4675    10.578  650.29
  26   2.3064     10.610  9.4684    10.718  676.17
  27   2.3042     11.000  9.4675    10.903  701.97
  28   2.3051     10.870  9.4683    10.808  727.78
  29   2.3037     10.460  9.4689    10.822  753.65
  30   2.3055     10.900  9.4686    10.565  779.56
  31   2.3051     10.480  9.4676    10.853  805.45
  32   2.3043     11.410  9.4678    10.887  831.36
  33   2.3052     11.210  9.4676    10.838  857.22
  34   2.3056     10.630  9.4674    10.827  883.17
  35   2.3073     10.830  9.4685    10.643  908.96
  36   2.3034     10.830  9.4682    10.820  934.74
  37   2.3049     10.730  9.4674    10.868  960.53
  38   2.3056     10.740  9.4663    11.022  986.44
  39   2.3027     10.830  9.4678    10.717  1012.35
  40   2.3030     11.010  9.4680    10.972  1038.22
  41   2.3069     10.920  9.4685    10.772  1064.05
  42   2.3060     10.130  9.4682    10.885  1089.94
  43   2.3059     10.650  9.4678    10.827  1115.87
  44   2.3066     10.690  9.4674    11.018  1141.79
  45   2.3016     10.880  9.4678    10.847  1167.56
  46   2.3027     11.210  9.4691    10.775  1193.29
  47   2.3066     10.410  9.4675    10.830  1219.21
  48   2.3039     11.100  9.4674    10.842  1245.13
  49   2.3037     10.600  9.4686    10.677  1271.00
  50   2.3057     10.470  9.4678    10.867  1296.94
  51   2.3061     10.220  9.4679    10.923  1322.73
  52   2.3061     10.930  9.4682    10.757  1348.60
  53   2.3049     10.370  9.4674    10.937  1374.36
  54   2.3049     10.570  9.4674    11.027  1400.16
  55   2.3060     10.790  9.4683    10.747  1426.06
  56   2.3057     10.770  9.4681    10.865  1451.81
  57   2.3030     10.840  9.4685    10.730  1477.53
  58   2.3043     10.540  9.4676    10.702  1503.41
  59   2.3041     10.440  9.4666    10.868  1529.33
  60   2.3057     10.590  9.4673    11.052  1555.24
  61   2.3047     10.590  9.4665    11.068  1581.09
  62   2.3042     10.760  9.4672    10.843  1607.01
  63   2.3028     10.840  9.4671    10.905  1632.93
  64   2.3051     11.260  9.4681    10.995  1658.70
  65   2.3057     10.870  9.4673    10.940  1684.45
  66   2.3070     10.510  9.4678    10.843  1710.36
  67   2.3087     10.490  9.4684    10.768  1736.27
  68   2.3044     10.470  9.4687    10.658  1762.15
  69   2.3037     10.960  9.4678    10.775  1788.04
  70   2.3054     10.790  9.4677    10.945  1813.93
  71   2.3057     10.890  9.4677    10.893  1839.80
  72   2.3061     10.650  9.4680    10.990  1865.55
  73   2.3068     10.940  9.4680    10.950  1891.40
  74   2.3042     10.700  9.4669    10.840  1917.28
  75   2.3033     10.810  9.4690    10.703  1943.17
  76   2.3051     10.980  9.4684    10.803  1969.09
  77   2.3031     10.650  9.4671    10.725  1994.95
  78   2.3042     10.700  9.4671    10.880  2020.90
  79   2.3068     10.710  9.4666    11.117  2046.81
  80   2.3044     10.840  9.4686    10.752  2072.67
  81   2.3036     11.100  9.4677    11.032  2098.56
  82   2.3030     10.920  9.4677    10.820  2124.46
  83   2.3029     11.190  9.4681    10.702  2150.36
  84   2.3066     10.580  9.4685    10.782  2176.20
  85   2.3065     10.910  9.4683    10.737  2202.01
  86   2.3058     10.810  9.4681    10.860  2227.91
  87   2.3045     10.730  9.4685    10.862  2253.80
  88   2.3058     11.130  9.4688    10.685  2279.66
  89   2.3066     10.120  9.4687    10.757  2305.59
  90   2.3060     10.860  9.4684    11.058  2331.50
