Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '2e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 15431762944 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.5078      9.900  16.8341     9.727  28.24
   2   2.5086      9.940  16.8337     9.538  53.89
   3   2.4957     10.000  16.8348     9.490  79.50
   4   2.5156      9.970  16.8335     9.418  105.16
   5   2.5082      9.780  16.8350     9.490  130.90
   6   2.5089      9.800  16.8351     9.522  156.54
   7   2.5140     10.040  16.8344     9.600  182.28
   8   2.5171      9.670  16.8347     9.462  207.97
   9   2.5075      9.680  16.8342     9.525  233.67
  10   2.5077      9.920  16.8345     9.332  259.15
  11   2.5060      9.580  16.8345     9.383  284.90
  12   2.5143      9.910  16.8337     9.655  310.65
  13   2.5167      9.730  16.8340     9.560  336.21
  14   2.5119      9.580  16.8345     9.530  361.85
  15   2.5080      9.830  16.8340     9.393  387.51
  16   2.5100      9.570  16.8356     9.598  413.16
  17   2.5216     10.000  16.8329     9.522  438.81
  18   2.5217      9.900  16.8353     9.502  464.34
  19   2.5135      9.500  16.8349     9.413  489.87
  20   2.5084      9.600  16.8346     9.492  515.34
  21   2.5054      9.850  16.8355     9.413  540.88
  22   2.4984      9.790  16.8351     9.497  566.60
  23   2.5093      9.790  16.8355     9.553  592.32
  24   2.5194      9.520  16.8329     9.495  618.05
  25   2.5127      9.670  16.8337     9.595  643.66
  26   2.5242      9.520  16.8353     9.527  669.32
  27   2.5094      9.810  16.8357     9.510  695.00
  28   2.5038      9.790  16.8351     9.573  720.52
  29   2.5087      9.800  16.8331     9.580  746.09
  30   2.5076     10.170  16.8349     9.635  771.80
  31   2.5185      9.450  16.8345     9.552  797.45
  32   2.5282      9.520  16.8336     9.698  823.14
  33   2.5089      9.460  16.8340     9.613  848.71
  34   2.5122      9.680  16.8342     9.493  874.32
  35   2.5185      9.850  16.8341     9.620  899.99
  36   2.5069      9.620  16.8347     9.435  925.74
  37   2.5139      9.540  16.8342     9.578  951.19
  38   2.5168      9.560  16.8347     9.463  976.72
  39   2.5218      9.970  16.8354     9.562  1002.20
  40   2.5121      9.530  16.8334     9.672  1027.87
  41   2.5050      9.670  16.8354     9.433  1053.51
  42   2.5176      9.470  16.8346     9.577  1079.05
  43   2.5134      9.840  16.8349     9.620  1104.72
  44   2.5144      9.920  16.8346     9.427  1130.32
  45   2.5196      9.640  16.8341     9.503  1156.02
  46   2.5178      9.620  16.8335     9.490  1181.65
  47   2.5099      9.820  16.8354     9.573  1207.33
  48   2.5064      9.800  16.8344     9.547  1232.91
  49   2.5193      9.920  16.8339     9.515  1258.60
  50   2.5074      9.570  16.8348     9.570  1284.28
  51   2.5019      9.740  16.8355     9.618  1310.04
  52   2.5150      9.710  16.8347     9.615  1335.64
  53   2.5045      9.930  16.8352     9.588  1361.16
  54   2.5001     10.040  16.8348     9.538  1386.82
  55   2.5054      9.790  16.8345     9.548  1412.34
  56   2.5111      9.800  16.8351     9.492  1437.97
  57   2.5148      9.570  16.8358     9.563  1463.66
  58   2.5133      9.700  16.8342     9.395  1489.38
  59   2.5166      9.950  16.8345     9.560  1515.03
  60   2.5132      9.800  16.8344     9.647  1540.65
  61   2.5205     10.040  16.8334     9.553  1566.31
  62   2.5120      9.770  16.8351     9.435  1591.98
  63   2.5147      9.540  16.8341     9.542  1617.56
  64   2.5119      9.570  16.8351     9.598  1643.14
  65   2.5132      9.800  16.8341     9.605  1668.69
  66   2.5126      9.530  16.8347     9.600  1694.28
  67   2.5057      9.700  16.8346     9.595  1719.97
  68   2.5120      9.800  16.8357     9.458  1745.64
  69   2.5177      9.570  16.8351     9.445  1771.31
  70   2.5047      9.670  16.8347     9.510  1796.97
  71   2.5160      9.550  16.8345     9.353  1822.60
  72   2.5243      9.760  16.8353     9.543  1848.17
  73   2.5241      9.840  16.8351     9.435  1873.89
  74   2.5041      9.590  16.8348     9.493  1899.60
  75   2.5125      9.670  16.8355     9.573  1925.27
  76   2.5145     10.020  16.8346     9.600  1950.93
  77   2.5042      9.920  16.8337     9.523  1976.49
  78   2.5093      9.530  16.8348     9.482  2002.06
  79   2.5056      9.830  16.8357     9.550  2027.60
  80   2.5171      9.710  16.8341     9.448  2053.08
  81   2.5133      9.760  16.8347     9.633  2078.68
  82   2.5111      9.760  16.8342     9.525  2104.39
  83   2.5045      9.790  16.8351     9.610  2130.04
  84   2.5082      9.860  16.8345     9.458  2155.62
  85   2.5177      9.610  16.8340     9.518  2181.24
  86   2.5116      9.680  16.8339     9.523  2206.81
  87   2.5086     10.010  16.8353     9.533  2232.25
  88   2.5057     10.060  16.8347     9.467  2257.90
  89   2.5057      9.620  16.8333     9.460  2283.46
  90   2.5170      9.410  16.8346     9.498  2308.98
