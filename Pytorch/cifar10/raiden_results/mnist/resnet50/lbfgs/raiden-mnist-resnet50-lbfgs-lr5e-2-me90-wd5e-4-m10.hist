Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '-m', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 16185510400 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.5034      8.480  38.2889     8.823  28.50
   2   2.4999      8.440  38.2901     8.712  54.40
   3   2.4899      8.450  38.2887     8.893  80.24
   4   2.4979      8.490  38.2907     8.767  106.18
   5   2.4942      8.440  38.2889     8.810  132.13
   6   2.4900      8.560  38.2903     8.895  157.99
   7   2.4921      8.380  38.2894     8.735  183.92
   8   2.4965      8.430  38.2905     8.695  209.83
   9   2.4993      8.360  38.2913     8.740  235.77
  10   2.4828      8.310  38.2900     8.877  261.65
  11   2.4960      8.310  38.2897     8.750  287.57
  12   2.4891      8.070  38.2894     8.780  313.54
  13   2.4946      8.810  38.2901     8.825  339.50
  14   2.4838      8.340  38.2892     8.855  365.30
  15   2.4871      8.310  38.2875     8.735  391.15
  16   2.5018      8.270  38.2899     8.675  416.98
  17   2.5071      8.580  38.2901     8.735  442.83
  18   2.4967      8.420  38.2890     8.740  468.60
  19   2.4844      8.490  38.2887     8.792  494.43
  20   2.4863      8.270  38.2899     8.853  520.34
  21   2.5001      8.420  38.2897     8.687  546.29
  22   2.4931      8.330  38.2889     8.828  572.17
  23   2.4927      8.470  38.2900     8.805  598.12
  24   2.4933      8.480  38.2885     8.870  624.05
  25   2.4846      8.410  38.2898     8.770  649.99
  26   2.4858      8.460  38.2890     8.842  675.84
  27   2.5032      8.480  38.2899     8.780  701.67
  28   2.4929      8.360  38.2893     8.940  727.52
  29   2.4902      8.450  38.2891     8.723  753.34
  30   2.4940      8.280  38.2889     8.838  779.22
  31   2.5124      8.290  38.2886     8.860  805.20
  32   2.5027      8.540  38.2896     8.653  831.13
  33   2.5084      8.310  38.2891     8.883  857.11
  34   2.4857      8.560  38.2897     8.765  882.86
  35   2.4979      8.270  38.2896     8.722  908.84
  36   2.5020      8.350  38.2896     8.890  934.77
  37   2.5014      8.280  38.2901     8.748  960.71
  38   2.4931      8.210  38.2896     8.818  986.66
  39   2.4973      8.460  38.2897     8.672  1012.53
  40   2.5008      8.310  38.2894     8.745  1038.46
  41   2.4824      8.280  38.2893     8.898  1064.28
  42   2.5004      8.200  38.2884     8.862  1090.02
  43   2.4860      8.600  38.2899     8.735  1115.95
  44   2.4770      8.320  38.2905     8.820  1141.94
  45   2.4810      8.420  38.2904     8.748  1167.89
  46   2.4944      8.190  38.2894     8.798  1193.67
  47   2.5023      8.460  38.2890     8.858  1219.44
  48   2.4866      8.750  38.2899     8.850  1245.38
  49   2.5041      8.410  38.2894     8.745  1271.32
  50   2.4897      8.590  38.2902     8.802  1297.08
  51   2.4881      8.430  38.2896     8.713  1322.92
  52   2.4917      8.290  38.2894     8.912  1348.84
  53   2.4840      8.380  38.2904     8.733  1374.71
  54   2.4791      8.320  38.2901     8.905  1400.56
  55   2.4888      8.470  38.2884     8.885  1426.46
  56   2.4957      8.400  38.2901     8.805  1452.39
  57   2.4985      8.480  38.2894     8.823  1478.18
  58   2.4903      8.440  38.2897     8.793  1503.90
  59   2.4892      8.400  38.2900     8.810  1529.81
  60   2.4831      8.580  38.2889     8.762  1555.76
  61   2.4951      8.360  38.2895     8.727  1581.63
  62   2.4951      8.230  38.2895     8.848  1607.52
  63   2.4901      8.220  38.2893     8.873  1633.44
  64   2.4846      8.520  38.2888     8.912  1659.39
  65   2.4927      8.540  38.2892     8.778  1685.20
  66   2.4948      8.600  38.2897     8.830  1710.94
  67   2.4934      8.340  38.2901     8.738  1736.84
  68   2.5035      8.280  38.2884     8.902  1762.76
  69   2.4847      8.650  38.2901     8.855  1788.62
  70   2.4937      8.500  38.2896     8.777  1814.54
  71   2.4843      8.650  38.2895     8.695  1840.47
  72   2.4878      7.940  38.2887     8.942  1866.38
  73   2.4895      8.490  38.2903     8.957  1892.18
  74   2.4850      8.560  38.2894     8.815  1917.92
  75   2.4823      8.400  38.2884     8.947  1943.86
  76   2.4828      8.580  38.2900     8.697  1969.80
  77   2.5104      8.240  38.2898     8.767  1995.68
  78   2.4845      8.520  38.2889     8.705  2021.45
  79   2.5016      8.600  38.2898     8.717  2047.39
  80   2.4790      8.400  38.2899     8.722  2073.33
  81   2.4899      8.470  38.2890     8.892  2099.21
  82   2.4877      8.190  38.2895     8.820  2125.18
  83   2.5001      8.410  38.2905     8.747  2151.10
  84   2.5043      8.460  38.2907     8.800  2176.97
  85   2.4771      8.380  38.2894     8.862  2202.75
  86   2.5012      8.220  38.2890     8.860  2228.68
  87   2.4970      8.320  38.2893     8.827  2254.60
  88   2.4931      8.440  38.2901     8.760  2280.52
  89   2.4909      8.680  38.2878     8.773  2306.36
  90   2.4860      8.250  38.2890     8.762  2332.28
