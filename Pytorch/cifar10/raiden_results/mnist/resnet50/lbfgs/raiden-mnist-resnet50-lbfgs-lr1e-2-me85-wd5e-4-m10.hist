Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '85', '--arch', 'resnet50', '--lr-decay-epoch', '85', '-m', '10', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-2', '--weight-decay', '5e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 15432417792 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.3917     10.010  38.1888     9.755  27.68
   2   2.3923     10.030  38.1878     9.730  53.07
   3   2.3903     10.210  38.1880     9.798  78.35
   4   2.3791     10.100  38.1885     9.775  103.71
   5   2.3963     10.170  38.1870     9.797  129.05
   6   2.3797     10.060  38.1881     9.763  154.28
   7   2.3733     10.040  38.1901     9.735  179.45
   8   2.3789     10.220  38.1873     9.720  204.70
   9   2.3847      9.990  38.1873     9.832  230.09
  10   2.3901      9.920  38.1886     9.733  255.28
  11   2.3747     10.090  38.1884     9.668  280.58
  12   2.3751     10.010  38.1876     9.657  305.93
  13   2.3859     10.110  38.1882     9.717  331.24
  14   2.3806     10.080  38.1878     9.772  356.54
  15   2.3828     10.130  38.1881     9.705  381.93
  16   2.3800     10.220  38.1883     9.713  407.32
  17   2.3763     10.090  38.1881     9.732  432.55
  18   2.3860     10.100  38.1887     9.710  457.70
  19   2.3908     10.000  38.1884     9.647  483.06
  20   2.3828     10.070  38.1879     9.768  508.44
  21   2.3789     10.090  38.1875     9.822  533.74
  22   2.3907     10.020  38.1868     9.750  559.06
  23   2.3810      9.990  38.1882     9.742  584.32
  24   2.3799      9.970  38.1885     9.770  609.67
  25   2.3748     10.070  38.1882     9.767  634.97
  26   2.3813     10.050  38.1881     9.750  660.34
  27   2.3812     10.020  38.1886     9.683  685.71
  28   2.3887      9.930  38.1875     9.805  711.10
  29   2.3820     10.130  38.1892     9.723  736.53
  30   2.3834     10.150  38.1883     9.747  761.86
  31   2.3762     10.030  38.1876     9.820  787.31
  32   2.3866      9.980  38.1888     9.707  812.66
  33   2.3766     10.060  38.1878     9.823  838.01
  34   2.3792      9.980  38.1875     9.767  863.37
  35   2.3892     10.050  38.1881     9.738  888.73
  36   2.3795     10.200  38.1879     9.715  914.05
  37   2.3844     10.120  38.1881     9.745  939.39
  38   2.3749      9.910  38.1881     9.875  964.64
  39   2.3697      9.900  38.1884     9.747  989.87
  40   2.3903     10.090  38.1878     9.813  1015.04
  41   2.3824     10.150  38.1888     9.717  1040.30
  42   2.3873     10.110  38.1891     9.897  1065.50
  43   2.3745     10.200  38.1881     9.637  1090.67
  44   2.3800     10.210  38.1875     9.735  1115.91
  45   2.3811     10.120  38.1877     9.723  1141.14
  46   2.3824     10.010  38.1871     9.747  1166.40
  47   2.3886      9.970  38.1880     9.828  1191.73
  48   2.3786     10.230  38.1883     9.790  1217.13
  49   2.3861     10.110  38.1881     9.737  1242.46
  50   2.3842     10.060  38.1880     9.693  1267.67
  51   2.3908     10.110  38.1878     9.690  1292.86
  52   2.3732     10.120  38.1888     9.708  1318.08
  53   2.3841     10.130  38.1881     9.753  1343.42
  54   2.3824     10.190  38.1876     9.713  1368.79
  55   2.3821     10.130  38.1883     9.707  1394.05
  56   2.3805     10.220  38.1889     9.682  1419.42
  57   2.3888      9.980  38.1885     9.715  1444.75
  58   2.3832     10.000  38.1876     9.767  1470.03
  59   2.3906     10.130  38.1881     9.803  1495.32
  60   2.3756     10.050  38.1879     9.750  1520.57
  61   2.3789     10.000  38.1883     9.825  1545.91
  62   2.3787     10.150  38.1871     9.733  1571.21
  63   2.3881     10.030  38.1875     9.733  1596.56
  64   2.3818     10.130  38.1880     9.687  1621.97
  65   2.3899     10.010  38.1878     9.673  1647.31
  66   2.3837      9.870  38.1876     9.843  1672.61
  67   2.3916     10.160  38.1877     9.718  1698.00
  68   2.3847      9.970  38.1890     9.707  1723.35
  69   2.3799     10.010  38.1875     9.772  1748.72
  70   2.3857     10.140  38.1876     9.812  1774.00
  71   2.3902      9.950  38.1880     9.760  1799.42
  72   2.3855     10.200  38.1881     9.808  1824.75
  73   2.3852     10.020  38.1885     9.670  1850.03
  74   2.3780      9.960  38.1880     9.735  1875.38
  75   2.3849      9.990  38.1882     9.702  1900.72
  76   2.3874     10.240  38.1883     9.755  1926.06
  77   2.3710     10.130  38.1891     9.738  1951.32
  78   2.3817     10.090  38.1881     9.720  1976.53
  79   2.3776     10.220  38.1884     9.772  2001.73
  80   2.3687     10.150  38.1886     9.778  2026.94
  81   2.3844      9.980  38.1881     9.767  2052.17
  82   2.3859     10.090  38.1878     9.700  2077.52
  83   2.3812     10.120  38.1884     9.735  2102.88
  84   2.3843     10.000  38.1877     9.768  2128.19
  85   2.3871     10.250  38.1879     9.677  2153.60
