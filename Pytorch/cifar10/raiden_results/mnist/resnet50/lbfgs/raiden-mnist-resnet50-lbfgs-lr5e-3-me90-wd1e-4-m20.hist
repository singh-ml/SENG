Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '5e-3', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 15432443904 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.4039     10.020  9.5657    10.062  27.91
   2   2.4092     10.110  9.5653    10.065  53.29
   3   2.4056     10.150  9.5642    10.127  78.76
   4   2.4059     10.010  9.5644    10.182  104.17
   5   2.4043     10.180  9.5635    10.128  129.70
   6   2.4055     10.350  9.5655    10.038  155.17
   7   2.4068     10.310  9.5644    10.115  180.69
   8   2.4088     10.350  9.5640    10.230  206.15
   9   2.3988     10.040  9.5650    10.127  231.59
  10   2.4069     10.490  9.5650    10.107  256.95
  11   2.4072     10.410  9.5649    10.150  282.24
  12   2.4079     10.130  9.5640    10.202  307.70
  13   2.4081     10.060  9.5647    10.253  333.09
  14   2.4101     10.130  9.5638    10.070  358.55
  15   2.4034     10.240  9.5645    10.135  383.91
  16   2.4021     10.520  9.5643    10.160  409.39
  17   2.4070     10.310  9.5647    10.138  434.92
  18   2.4089     10.290  9.5645    10.187  460.44
  19   2.3987     10.380  9.5645    10.190  485.88
  20   2.4020     10.210  9.5642    10.185  511.39
  21   2.4046     10.020  9.5642    10.093  536.87
  22   2.4023     10.330  9.5647    10.222  562.24
  23   2.4026     10.290  9.5642    10.230  587.66
  24   2.4051     10.050  9.5645    10.132  613.12
  25   2.3996     10.580  9.5639    10.220  638.61
  26   2.4082     10.040  9.5646    10.195  664.02
  27   2.4034     10.440  9.5642    10.157  689.47
  28   2.4108     10.140  9.5658    10.033  714.97
  29   2.4060     10.210  9.5646    10.082  740.48
  30   2.4045     10.070  9.5653    10.068  765.92
  31   2.3991     10.350  9.5639    10.163  791.44
  32   2.4029     10.460  9.5641    10.130  816.81
  33   2.4051     10.250  9.5645    10.177  842.20
  34   2.4046     10.360  9.5651    10.105  867.63
  35   2.4013     10.550  9.5643    10.150  893.14
  36   2.4003     10.580  9.5656    10.130  918.60
  37   2.4041     10.340  9.5650    10.128  944.11
  38   2.4036     10.110  9.5636    10.158  969.53
  39   2.4095     10.270  9.5640    10.175  995.07
  40   2.4050     10.300  9.5652    10.102  1020.63
  41   2.4053     10.010  9.5641    10.218  1045.97
  42   2.4028     10.250  9.5644    10.123  1071.39
  43   2.4052     10.140  9.5645    10.193  1096.93
  44   2.4071     10.430  9.5647    10.165  1122.43
  45   2.4097     10.180  9.5646    10.180  1147.85
  46   2.4053      9.950  9.5636    10.280  1173.34
  47   2.4087      9.880  9.5643    10.272  1198.85
  48   2.4136     10.050  9.5637    10.210  1224.39
  49   2.4070     10.280  9.5648    10.188  1249.84
  50   2.4025     10.270  9.5646    10.125  1275.32
  51   2.4055     10.240  9.5649    10.085  1300.71
  52   2.4043     10.450  9.5643    10.138  1326.13
  53   2.4090     10.090  9.5632    10.112  1351.64
  54   2.4032     10.330  9.5649    10.202  1377.16
  55   2.4087     10.350  9.5633    10.147  1402.52
  56   2.4055     10.350  9.5640    10.232  1428.06
  57   2.4009     10.090  9.5638    10.223  1453.59
  58   2.4030     10.260  9.5647    10.143  1479.10
  59   2.4026     10.310  9.5649    10.200  1504.68
  60   2.4035     10.220  9.5649    10.205  1530.13
  61   2.4073     10.170  9.5629    10.157  1555.66
  62   2.4055     10.210  9.5627    10.193  1581.14
  63   2.4109     10.150  9.5658    10.257  1606.66
  64   2.4037     10.180  9.5648    10.120  1632.14
  65   2.3958     10.200  9.5645    10.140  1657.63
  66   2.4026     10.240  9.5642    10.242  1683.19
  67   2.4077     10.360  9.5639    10.240  1708.74
  68   2.4031     10.160  9.5644    10.185  1734.15
  69   2.4075     10.400  9.5645    10.140  1759.51
  70   2.4010     10.170  9.5641    10.182  1784.91
  71   2.4060     10.280  9.5641    10.172  1810.45
  72   2.4050     10.190  9.5646    10.168  1835.90
  73   2.4073     10.300  9.5657    10.062  1861.30
  74   2.4081     10.340  9.5642    10.150  1886.71
  75   2.4005     10.330  9.5647    10.120  1912.23
  76   2.4063     10.120  9.5633    10.072  1937.55
  77   2.4064     10.070  9.5653    10.143  1963.03
  78   2.4092     10.210  9.5661    10.132  1988.37
  79   2.3973     10.310  9.5646    10.112  2013.82
  80   2.4087     10.070  9.5641    10.165  2039.28
  81   2.4047     10.060  9.5646    10.072  2064.72
  82   2.4044     10.400  9.5649    10.148  2090.05
  83   2.4048     10.410  9.5655    10.085  2115.46
  84   2.4067     10.170  9.5641    10.035  2140.95
  85   2.4050     10.610  9.5641    10.092  2166.52
  86   2.4069     10.360  9.5650    10.228  2192.01
  87   2.4082     10.220  9.5645    10.168  2217.52
  88   2.4121     10.240  9.5628    10.210  2243.01
  89   2.4061     10.110  9.5636    10.238  2268.50
  90   2.4079     10.040  9.5645    10.202  2293.96
