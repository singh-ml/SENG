Use GPU: 0 for training
==> Running with ['main_lbfgs.py', '--epoch', '90', '--arch', 'resnet50', '--lr-decay-epoch', '90', '-m', '20', '--trainset', 'mnist', '--datadir', '/data/ghighdim/singh/data/', '--lr', '1e-1', '--weight-decay', '1e-4', '--lr-scheme', 'cosine', '--gpu', '0']
==> Building model..
==> Preparing data..
Memory peak: 18067975680 Bytes
Epoch  testloss  testacc  trainloss  trainacc  time
   1   2.2999     10.860  9.5482    12.423  31.03
   2   2.3046     10.720  9.4663    10.857  59.02
   3   2.3037     10.710  9.4667    10.763  87.05
   4   2.3023     10.770  9.4663    10.888  114.87
   5   2.3028     10.890  9.4657    10.890  142.87
   6   2.3027     10.160  9.4658    10.840  170.80
   7   2.2980     10.720  9.4662    10.880  198.76
   8   2.3044     10.510  9.4658    10.902  226.69
   9   2.3040     10.900  9.4659    10.737  254.56
  10   2.3016     10.600  9.4664    10.657  282.40
  11   2.3019     10.880  9.4656    10.762  310.36
  12   2.3045     10.690  9.4652    10.877  338.33
  13   2.3049     10.810  9.4657    10.795  366.13
  14   2.3041     10.930  9.4664    10.598  394.08
  15   2.3024     10.710  9.4655    10.862  422.02
  16   2.3024     10.930  9.4664    10.758  449.96
  17   2.3027     10.510  9.4658    10.902  477.83
  18   2.3019     10.750  9.4664    10.820  505.83
  19   2.3059     10.450  9.4660    10.722  533.67
  20   2.3014     10.620  9.4648    10.877  561.51
  21   2.3038     10.660  9.4659    10.797  589.28
  22   2.3015     10.520  9.4649    10.970  617.20
  23   2.3015     10.570  9.4655    10.738  645.18
  24   2.3023     10.520  9.4648    10.927  673.15
  25   2.3071     10.490  9.4663    10.960  701.16
  26   2.3057     10.640  9.4663    10.895  729.06
  27   2.3036     10.450  9.4655    10.822  757.00
  28   2.3025     10.670  9.4659    10.775  784.95
  29   2.3022     10.840  9.4665    10.782  812.86
  30   2.3018     10.530  9.4659    10.837  840.73
  31   2.3049     10.880  9.4656    10.908  868.68
  32   2.3042     10.550  9.4659    10.780  896.56
  33   2.3021     10.630  9.4668    10.755  924.50
  34   2.3032     10.700  9.4660    10.762  952.34
  35   2.3035     10.850  9.4659    10.852  980.11
  36   2.3037     10.390  9.4653    10.940  1007.93
  37   2.3036     10.310  9.4656    10.845  1035.74
  38   2.3042     10.370  9.4666    10.770  1063.57
  39   2.3060     10.460  9.4656    10.857  1091.46
  40   2.3047     10.790  9.4660    10.825  1119.43
  41   2.3076     10.450  9.4665    10.897  1147.36
  42   2.3009     10.450  9.4670    10.512  1175.30
  43   2.3025     10.550  9.4666    10.750  1203.17
  44   2.3055     10.850  9.4655    10.902  1230.92
  45   2.2993     11.010  9.4652    11.018  1258.76
  46   2.3025     10.670  9.4659    10.788  1286.57
  47   2.3066     10.320  9.4653    10.702  1314.50
  48   2.3045     10.810  9.4657    10.940  1342.35
  49   2.3028     10.450  9.4653    10.872  1370.27
  50   2.3037     10.830  9.4653    10.963  1398.18
  51   2.3043     10.240  9.4664    10.617  1426.04
  52   2.3010     10.850  9.4658    10.835  1453.99
  53   2.2997     10.490  9.4663    10.767  1481.87
  54   2.3038     10.730  9.4660    10.763  1509.84
  55   2.2994     10.870  9.4646    10.923  1537.74
  56   2.3019     10.690  9.4663    10.730  1565.52
  57   2.3048     10.550  9.4655    10.933  1593.28
  58   2.3019     11.040  9.4663    10.570  1621.09
  59   2.3021     10.600  9.4656    10.790  1649.04
  60   2.3043     10.760  9.4659    10.872  1676.90
  61   2.3032     10.550  9.4666    10.832  1704.65
  62   2.3053     10.510  9.4653    10.863  1732.60
  63   2.3041     10.610  9.4659    10.767  1760.60
  64   2.3028     10.280  9.4654    10.828  1788.49
  65   2.3028     10.880  9.4649    10.815  1816.46
  66   2.3007     10.570  9.4660    10.815  1844.27
  67   2.3079     10.360  9.4665    10.882  1872.19
  68   2.3027     10.750  9.4660    10.800  1900.18
  69   2.2991     10.870  9.4649    10.925  1928.02
  70   2.3035     10.610  9.4663    10.828  1955.77
  71   2.3044     10.510  9.4656    10.855  1983.59
  72   2.3035     10.440  9.4652    11.058  2011.50
  73   2.3011     10.460  9.4650    10.917  2039.47
  74   2.3032     10.660  9.4662    10.843  2067.30
  75   2.3042     10.860  9.4657    10.778  2095.16
  76   2.3038     10.930  9.4666    10.702  2122.97
  77   2.3007     10.810  9.4659    10.997  2150.79
  78   2.3004     10.680  9.4655    11.028  2178.64
  79   2.3022     10.700  9.4662    10.708  2206.52
  80   2.3017     10.620  9.4662    10.627  2234.38
  81   2.3031     10.820  9.4652    10.803  2262.40
  82   2.3055     10.460  9.4661    10.768  2290.34
  83   2.3014     10.870  9.4654    10.828  2318.36
  84   2.3012     10.870  9.4658    10.695  2346.29
  85   2.3010     10.690  9.4653    10.865  2374.14
  86   2.3031     10.570  9.4656    10.812  2402.09
  87   2.3035     10.630  9.4657    10.880  2430.02
  88   2.3038     10.630  9.4665    10.638  2457.93
  89   2.3048     10.630  9.4658    10.503  2485.93
  90   2.3051     10.890  9.4657    10.960  2513.74
